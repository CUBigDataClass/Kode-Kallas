,url,id,node_id,html_url,diff_url,patch_url,issue_url,number,state,locked,title,body,created_at,updated_at,closed_at,merged_at,merge_commit_sha,assignee,assignees,requested_reviewers,requested_teams,labels,milestone,draft,commits_url,review_comments_url,review_comment_url,comments_url,statuses_url,author_association,repo_name,owner,user.login,user.id,user.node_id,user.avatar_url,user.gravatar_id,user.url,user.html_url,user.followers_url,user.following_url,user.gists_url,user.starred_url,user.subscriptions_url,user.organizations_url,user.repos_url,user.events_url,user.received_events_url,user.type,user.site_admin,head.label,head.ref,head.sha,head.user.login,head.user.id,head.user.node_id,head.user.avatar_url,head.user.gravatar_id,head.user.url,head.user.html_url,head.user.followers_url,head.user.following_url,head.user.gists_url,head.user.starred_url,head.user.subscriptions_url,head.user.organizations_url,head.user.repos_url,head.user.events_url,head.user.received_events_url,head.user.type,head.user.site_admin,head.repo.id,head.repo.node_id,head.repo.name,head.repo.full_name,head.repo.private,head.repo.owner.login,head.repo.owner.id,head.repo.owner.node_id,head.repo.owner.avatar_url,head.repo.owner.gravatar_id,head.repo.owner.url,head.repo.owner.html_url,head.repo.owner.followers_url,head.repo.owner.following_url,head.repo.owner.gists_url,head.repo.owner.starred_url,head.repo.owner.subscriptions_url,head.repo.owner.organizations_url,head.repo.owner.repos_url,head.repo.owner.events_url,head.repo.owner.received_events_url,head.repo.owner.type,head.repo.owner.site_admin,head.repo.html_url,head.repo.description,head.repo.fork,head.repo.url,head.repo.forks_url,head.repo.keys_url,head.repo.collaborators_url,head.repo.teams_url,head.repo.hooks_url,head.repo.issue_events_url,head.repo.events_url,head.repo.assignees_url,head.repo.branches_url,head.repo.tags_url,head.repo.blobs_url,head.repo.git_tags_url,head.repo.git_refs_url,head.repo.trees_url,head.repo.statuses_url,head.repo.languages_url,head.repo.stargazers_url,head.repo.contributors_url,head.repo.subscribers_url,head.repo.subscription_url,head.repo.commits_url,head.repo.git_commits_url,head.repo.comments_url,head.repo.issue_comment_url,head.repo.contents_url,head.repo.compare_url,head.repo.merges_url,head.repo.archive_url,head.repo.downloads_url,head.repo.issues_url,head.repo.pulls_url,head.repo.milestones_url,head.repo.notifications_url,head.repo.labels_url,head.repo.releases_url,head.repo.deployments_url,head.repo.created_at,head.repo.updated_at,head.repo.pushed_at,head.repo.git_url,head.repo.ssh_url,head.repo.clone_url,head.repo.svn_url,head.repo.homepage,head.repo.size,head.repo.stargazers_count,head.repo.watchers_count,head.repo.language,head.repo.has_issues,head.repo.has_projects,head.repo.has_downloads,head.repo.has_wiki,head.repo.has_pages,head.repo.forks_count,head.repo.mirror_url,head.repo.archived,head.repo.disabled,head.repo.open_issues_count,head.repo.license.key,head.repo.license.name,head.repo.license.spdx_id,head.repo.license.url,head.repo.license.node_id,head.repo.forks,head.repo.open_issues,head.repo.watchers,head.repo.default_branch,base.label,base.ref,base.sha,base.user.login,base.user.id,base.user.node_id,base.user.avatar_url,base.user.gravatar_id,base.user.url,base.user.html_url,base.user.followers_url,base.user.following_url,base.user.gists_url,base.user.starred_url,base.user.subscriptions_url,base.user.organizations_url,base.user.repos_url,base.user.events_url,base.user.received_events_url,base.user.type,base.user.site_admin,base.repo.id,base.repo.node_id,base.repo.name,base.repo.full_name,base.repo.private,base.repo.owner.login,base.repo.owner.id,base.repo.owner.node_id,base.repo.owner.avatar_url,base.repo.owner.gravatar_id,base.repo.owner.url,base.repo.owner.html_url,base.repo.owner.followers_url,base.repo.owner.following_url,base.repo.owner.gists_url,base.repo.owner.starred_url,base.repo.owner.subscriptions_url,base.repo.owner.organizations_url,base.repo.owner.repos_url,base.repo.owner.events_url,base.repo.owner.received_events_url,base.repo.owner.type,base.repo.owner.site_admin,base.repo.html_url,base.repo.description,base.repo.fork,base.repo.url,base.repo.forks_url,base.repo.keys_url,base.repo.collaborators_url,base.repo.teams_url,base.repo.hooks_url,base.repo.issue_events_url,base.repo.events_url,base.repo.assignees_url,base.repo.branches_url,base.repo.tags_url,base.repo.blobs_url,base.repo.git_tags_url,base.repo.git_refs_url,base.repo.trees_url,base.repo.statuses_url,base.repo.languages_url,base.repo.stargazers_url,base.repo.contributors_url,base.repo.subscribers_url,base.repo.subscription_url,base.repo.commits_url,base.repo.git_commits_url,base.repo.comments_url,base.repo.issue_comment_url,base.repo.contents_url,base.repo.compare_url,base.repo.merges_url,base.repo.archive_url,base.repo.downloads_url,base.repo.issues_url,base.repo.pulls_url,base.repo.milestones_url,base.repo.notifications_url,base.repo.labels_url,base.repo.releases_url,base.repo.deployments_url,base.repo.created_at,base.repo.updated_at,base.repo.pushed_at,base.repo.git_url,base.repo.ssh_url,base.repo.clone_url,base.repo.svn_url,base.repo.homepage,base.repo.size,base.repo.stargazers_count,base.repo.watchers_count,base.repo.language,base.repo.has_issues,base.repo.has_projects,base.repo.has_downloads,base.repo.has_wiki,base.repo.has_pages,base.repo.forks_count,base.repo.mirror_url,base.repo.archived,base.repo.disabled,base.repo.open_issues_count,base.repo.license.key,base.repo.license.name,base.repo.license.spdx_id,base.repo.license.url,base.repo.license.node_id,base.repo.forks,base.repo.open_issues,base.repo.watchers,base.repo.default_branch,_links.self.href,_links.html.href,_links.issue.href,_links.comments.href,_links.review_comments.href,_links.review_comment.href,_links.commits.href,_links.statuses.href
0,https://api.github.com/repos/apache/spark/pulls/28185,402092174,MDExOlB1bGxSZXF1ZXN0NDAyMDkyMTc0,https://github.com/apache/spark/pull/28185,https://github.com/apache/spark/pull/28185.diff,https://github.com/apache/spark/pull/28185.patch,https://api.github.com/repos/apache/spark/issues/28185,28185,open,False,[SPARK-31419][SQL][DOCS] Document Table-valued Function and Inline Table,"### What changes were proposed in this pull request?
Document Table-valued Function and Inline Table

### Why are the changes needed?
To make SQL Reference complete


### Does this PR introduce any user-facing change?
Yes

<img width=""1050"" alt=""Screen Shot 2020-04-10 at 3 26 39 PM"" src=""https://user-images.githubusercontent.com/13592258/79027227-45f48e80-7b40-11ea-989d-8329577499e1.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-10 at 3 26 55 PM"" src=""https://user-images.githubusercontent.com/13592258/79027231-47be5200-7b40-11ea-8109-5438e6dce40e.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-10 at 3 27 20 PM"" src=""https://user-images.githubusercontent.com/13592258/79027236-49881580-7b40-11ea-8ace-84e1f96c0ac7.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-10 at 3 27 35 PM"" src=""https://user-images.githubusercontent.com/13592258/79027239-4bea6f80-7b40-11ea-9e0f-250bdbccb33e.png"">

Also, linked the newly added pages to select statement

<img width=""1050"" alt=""Screen Shot 2020-04-10 at 3 27 59 PM"" src=""https://user-images.githubusercontent.com/13592258/79027245-5147ba00-7b40-11ea-9b10-527fd9639958.png"">

### How was this patch tested?
Manually build and check",2020-04-10T22:33:44Z,2020-04-10T22:46:06Z,,,53de76151a669fd4eb4fdf014125fd36d6821c28,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28185/commits,https://api.github.com/repos/apache/spark/pulls/28185/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28185/comments,https://api.github.com/repos/apache/spark/statuses/2f74986c2fdbf0bc3290ed2e2576e96c05f4cbe6,CONTRIBUTOR,spark,apache,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,huaxingao:tvf,tvf,2f74986c2fdbf0bc3290ed2e2576e96c05f4cbe6,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,50813048,MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==,spark,huaxingao/spark,False,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,https://github.com/huaxingao/spark,Mirror of Apache Spark,True,https://api.github.com/repos/huaxingao/spark,https://api.github.com/repos/huaxingao/spark/forks,https://api.github.com/repos/huaxingao/spark/keys{/key_id},https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator},https://api.github.com/repos/huaxingao/spark/teams,https://api.github.com/repos/huaxingao/spark/hooks,https://api.github.com/repos/huaxingao/spark/issues/events{/number},https://api.github.com/repos/huaxingao/spark/events,https://api.github.com/repos/huaxingao/spark/assignees{/user},https://api.github.com/repos/huaxingao/spark/branches{/branch},https://api.github.com/repos/huaxingao/spark/tags,https://api.github.com/repos/huaxingao/spark/git/blobs{/sha},https://api.github.com/repos/huaxingao/spark/git/tags{/sha},https://api.github.com/repos/huaxingao/spark/git/refs{/sha},https://api.github.com/repos/huaxingao/spark/git/trees{/sha},https://api.github.com/repos/huaxingao/spark/statuses/{sha},https://api.github.com/repos/huaxingao/spark/languages,https://api.github.com/repos/huaxingao/spark/stargazers,https://api.github.com/repos/huaxingao/spark/contributors,https://api.github.com/repos/huaxingao/spark/subscribers,https://api.github.com/repos/huaxingao/spark/subscription,https://api.github.com/repos/huaxingao/spark/commits{/sha},https://api.github.com/repos/huaxingao/spark/git/commits{/sha},https://api.github.com/repos/huaxingao/spark/comments{/number},https://api.github.com/repos/huaxingao/spark/issues/comments{/number},https://api.github.com/repos/huaxingao/spark/contents/{+path},https://api.github.com/repos/huaxingao/spark/compare/{base}...{head},https://api.github.com/repos/huaxingao/spark/merges,https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref},https://api.github.com/repos/huaxingao/spark/downloads,https://api.github.com/repos/huaxingao/spark/issues{/number},https://api.github.com/repos/huaxingao/spark/pulls{/number},https://api.github.com/repos/huaxingao/spark/milestones{/number},"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}",https://api.github.com/repos/huaxingao/spark/labels{/name},https://api.github.com/repos/huaxingao/spark/releases{/id},https://api.github.com/repos/huaxingao/spark/deployments,2016-02-01T04:09:11Z,2020-04-10T00:47:54Z,2020-04-10T22:29:44Z,git://github.com/huaxingao/spark.git,git@github.com:huaxingao/spark.git,https://github.com/huaxingao/spark.git,https://github.com/huaxingao/spark,,312619,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28185,https://github.com/apache/spark/pull/28185,https://api.github.com/repos/apache/spark/issues/28185,https://api.github.com/repos/apache/spark/issues/28185/comments,https://api.github.com/repos/apache/spark/pulls/28185/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28185/commits,https://api.github.com/repos/apache/spark/statuses/2f74986c2fdbf0bc3290ed2e2576e96c05f4cbe6
1,https://api.github.com/repos/apache/spark/pulls/28184,402016942,MDExOlB1bGxSZXF1ZXN0NDAyMDE2OTQy,https://github.com/apache/spark/pull/28184,https://github.com/apache/spark/pull/28184.diff,https://github.com/apache/spark/pull/28184.patch,https://api.github.com/repos/apache/spark/issues/28184,28184,open,False,[SPARK-31416][SQL] Check more strictly that a field name can be used as a valid Java identifier for codegen,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Check more strictly that a field name can be used as a valid Java identifier in `ScalaReflection.serializerFor`
To check that, `SourceVersion` is used so that we need not add reserved keywords to be checked manually for the future Java versions (e.g, underscore, var, yield), .

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
In the current implementation, `enum` is not checked even though it's a reserved keyword.
Also, there are lots of characters and sequences of character including numeric literals but they are not checked.
So we can't get better error message with following code.
```
case class  Data(`0`: Int)
Seq(Data(1)).toDF.show

20/04/11 03:24:24 ERROR CodeGenerator: failed to compile: org.codehaus.commons.compiler.CompileException: File 'generated.java', Line 43, Column 1: Expression ""value_0 = value_3"" is not a type
org.codehaus.commons.compiler.CompileException: File 'generated.java', Line 43, Column 1: Expression ""value_0 = value_3"" is not a type

...

```

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes. With this change and the code example above, we can get following error message.
```
java.lang.UnsupportedOperationException: `0` is not a valid identifier of Java and cannot be used as field name
- root class: ""Data""

...
```

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Add another assertion to existing test case.",2020-04-10T18:30:10Z,2020-04-10T23:22:05Z,,,6888689aff716f8eb86be3c0b5ec6cda301e5aba,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28184/commits,https://api.github.com/repos/apache/spark/pulls/28184/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28184/comments,https://api.github.com/repos/apache/spark/statuses/14bb7ba56d9ae6fcbed0f4b6e90407b388d14f61,CONTRIBUTOR,spark,apache,sarutak,4736016,MDQ6VXNlcjQ3MzYwMTY=,https://avatars3.githubusercontent.com/u/4736016?v=4,,https://api.github.com/users/sarutak,https://github.com/sarutak,https://api.github.com/users/sarutak/followers,https://api.github.com/users/sarutak/following{/other_user},https://api.github.com/users/sarutak/gists{/gist_id},https://api.github.com/users/sarutak/starred{/owner}{/repo},https://api.github.com/users/sarutak/subscriptions,https://api.github.com/users/sarutak/orgs,https://api.github.com/users/sarutak/repos,https://api.github.com/users/sarutak/events{/privacy},https://api.github.com/users/sarutak/received_events,User,False,sarutak:improve-identifier-check,improve-identifier-check,14bb7ba56d9ae6fcbed0f4b6e90407b388d14f61,sarutak,4736016,MDQ6VXNlcjQ3MzYwMTY=,https://avatars3.githubusercontent.com/u/4736016?v=4,,https://api.github.com/users/sarutak,https://github.com/sarutak,https://api.github.com/users/sarutak/followers,https://api.github.com/users/sarutak/following{/other_user},https://api.github.com/users/sarutak/gists{/gist_id},https://api.github.com/users/sarutak/starred{/owner}{/repo},https://api.github.com/users/sarutak/subscriptions,https://api.github.com/users/sarutak/orgs,https://api.github.com/users/sarutak/repos,https://api.github.com/users/sarutak/events{/privacy},https://api.github.com/users/sarutak/received_events,User,False,19300892,MDEwOlJlcG9zaXRvcnkxOTMwMDg5Mg==,spark,sarutak/spark,False,sarutak,4736016,MDQ6VXNlcjQ3MzYwMTY=,https://avatars3.githubusercontent.com/u/4736016?v=4,,https://api.github.com/users/sarutak,https://github.com/sarutak,https://api.github.com/users/sarutak/followers,https://api.github.com/users/sarutak/following{/other_user},https://api.github.com/users/sarutak/gists{/gist_id},https://api.github.com/users/sarutak/starred{/owner}{/repo},https://api.github.com/users/sarutak/subscriptions,https://api.github.com/users/sarutak/orgs,https://api.github.com/users/sarutak/repos,https://api.github.com/users/sarutak/events{/privacy},https://api.github.com/users/sarutak/received_events,User,False,https://github.com/sarutak/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sarutak/spark,https://api.github.com/repos/sarutak/spark/forks,https://api.github.com/repos/sarutak/spark/keys{/key_id},https://api.github.com/repos/sarutak/spark/collaborators{/collaborator},https://api.github.com/repos/sarutak/spark/teams,https://api.github.com/repos/sarutak/spark/hooks,https://api.github.com/repos/sarutak/spark/issues/events{/number},https://api.github.com/repos/sarutak/spark/events,https://api.github.com/repos/sarutak/spark/assignees{/user},https://api.github.com/repos/sarutak/spark/branches{/branch},https://api.github.com/repos/sarutak/spark/tags,https://api.github.com/repos/sarutak/spark/git/blobs{/sha},https://api.github.com/repos/sarutak/spark/git/tags{/sha},https://api.github.com/repos/sarutak/spark/git/refs{/sha},https://api.github.com/repos/sarutak/spark/git/trees{/sha},https://api.github.com/repos/sarutak/spark/statuses/{sha},https://api.github.com/repos/sarutak/spark/languages,https://api.github.com/repos/sarutak/spark/stargazers,https://api.github.com/repos/sarutak/spark/contributors,https://api.github.com/repos/sarutak/spark/subscribers,https://api.github.com/repos/sarutak/spark/subscription,https://api.github.com/repos/sarutak/spark/commits{/sha},https://api.github.com/repos/sarutak/spark/git/commits{/sha},https://api.github.com/repos/sarutak/spark/comments{/number},https://api.github.com/repos/sarutak/spark/issues/comments{/number},https://api.github.com/repos/sarutak/spark/contents/{+path},https://api.github.com/repos/sarutak/spark/compare/{base}...{head},https://api.github.com/repos/sarutak/spark/merges,https://api.github.com/repos/sarutak/spark/{archive_format}{/ref},https://api.github.com/repos/sarutak/spark/downloads,https://api.github.com/repos/sarutak/spark/issues{/number},https://api.github.com/repos/sarutak/spark/pulls{/number},https://api.github.com/repos/sarutak/spark/milestones{/number},"https://api.github.com/repos/sarutak/spark/notifications{?since,all,participating}",https://api.github.com/repos/sarutak/spark/labels{/name},https://api.github.com/repos/sarutak/spark/releases{/id},https://api.github.com/repos/sarutak/spark/deployments,2014-04-30T04:35:03Z,2019-07-18T09:44:40Z,2020-04-10T23:13:54Z,git://github.com/sarutak/spark.git,git@github.com:sarutak/spark.git,https://github.com/sarutak/spark.git,https://github.com/sarutak/spark,,320646,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28184,https://github.com/apache/spark/pull/28184,https://api.github.com/repos/apache/spark/issues/28184,https://api.github.com/repos/apache/spark/issues/28184/comments,https://api.github.com/repos/apache/spark/pulls/28184/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28184/commits,https://api.github.com/repos/apache/spark/statuses/14bb7ba56d9ae6fcbed0f4b6e90407b388d14f61
2,https://api.github.com/repos/apache/spark/pulls/28183,401966659,MDExOlB1bGxSZXF1ZXN0NDAxOTY2NjU5,https://github.com/apache/spark/pull/28183,https://github.com/apache/spark/pull/28183.diff,https://github.com/apache/spark/pull/28183.patch,https://api.github.com/repos/apache/spark/issues/28183,28183,open,False,[SPARK-29791][CORE][SCHEDULER]add an implemention for issue SPARK-29791.,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
    We can config the executor cores by ""spark.executor.cores"". For example, if we config 8 cores for a executor, then the driver can only scheduler 8 tasks to this executor concurrently. In fact, most cases a task does not always occupy a core or more. More time, tasks spent on disk IO or network IO, so we can make driver to scheduler more than 8 tasks(virtual the cores to 16, 32 or more the executor report to driver) to this executor concurrently, it will make the whole job execute more quickly. This pull request add an implemention for it.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
We can use more virtual cores to scheduler more tasks at the same time.
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
Add a test case.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-04-10T16:00:12Z,2020-04-10T16:07:06Z,,,afdfb299bd617b9f5ac95afe44d39d45662e6dc6,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28183/commits,https://api.github.com/repos/apache/spark/pulls/28183/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28183/comments,https://api.github.com/repos/apache/spark/statuses/f326ec521016122cf163939b5fa1a34cc39f41fc,NONE,spark,apache,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,zengruios:SPARK-29791,SPARK-29791,f326ec521016122cf163939b5fa1a34cc39f41fc,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,220261992,MDEwOlJlcG9zaXRvcnkyMjAyNjE5OTI=,spark,zengruios/spark,False,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,https://github.com/zengruios/spark,Apache Spark,True,https://api.github.com/repos/zengruios/spark,https://api.github.com/repos/zengruios/spark/forks,https://api.github.com/repos/zengruios/spark/keys{/key_id},https://api.github.com/repos/zengruios/spark/collaborators{/collaborator},https://api.github.com/repos/zengruios/spark/teams,https://api.github.com/repos/zengruios/spark/hooks,https://api.github.com/repos/zengruios/spark/issues/events{/number},https://api.github.com/repos/zengruios/spark/events,https://api.github.com/repos/zengruios/spark/assignees{/user},https://api.github.com/repos/zengruios/spark/branches{/branch},https://api.github.com/repos/zengruios/spark/tags,https://api.github.com/repos/zengruios/spark/git/blobs{/sha},https://api.github.com/repos/zengruios/spark/git/tags{/sha},https://api.github.com/repos/zengruios/spark/git/refs{/sha},https://api.github.com/repos/zengruios/spark/git/trees{/sha},https://api.github.com/repos/zengruios/spark/statuses/{sha},https://api.github.com/repos/zengruios/spark/languages,https://api.github.com/repos/zengruios/spark/stargazers,https://api.github.com/repos/zengruios/spark/contributors,https://api.github.com/repos/zengruios/spark/subscribers,https://api.github.com/repos/zengruios/spark/subscription,https://api.github.com/repos/zengruios/spark/commits{/sha},https://api.github.com/repos/zengruios/spark/git/commits{/sha},https://api.github.com/repos/zengruios/spark/comments{/number},https://api.github.com/repos/zengruios/spark/issues/comments{/number},https://api.github.com/repos/zengruios/spark/contents/{+path},https://api.github.com/repos/zengruios/spark/compare/{base}...{head},https://api.github.com/repos/zengruios/spark/merges,https://api.github.com/repos/zengruios/spark/{archive_format}{/ref},https://api.github.com/repos/zengruios/spark/downloads,https://api.github.com/repos/zengruios/spark/issues{/number},https://api.github.com/repos/zengruios/spark/pulls{/number},https://api.github.com/repos/zengruios/spark/milestones{/number},"https://api.github.com/repos/zengruios/spark/notifications{?since,all,participating}",https://api.github.com/repos/zengruios/spark/labels{/name},https://api.github.com/repos/zengruios/spark/releases{/id},https://api.github.com/repos/zengruios/spark/deployments,2019-11-07T14:58:06Z,2020-04-10T14:22:53Z,2020-04-10T15:53:47Z,git://github.com/zengruios/spark.git,git@github.com:zengruios/spark.git,https://github.com/zengruios/spark.git,https://github.com/zengruios/spark,,325067,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28183,https://github.com/apache/spark/pull/28183,https://api.github.com/repos/apache/spark/issues/28183,https://api.github.com/repos/apache/spark/issues/28183/comments,https://api.github.com/repos/apache/spark/pulls/28183/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28183/commits,https://api.github.com/repos/apache/spark/statuses/f326ec521016122cf163939b5fa1a34cc39f41fc
3,https://api.github.com/repos/apache/spark/pulls/28182,401948625,MDExOlB1bGxSZXF1ZXN0NDAxOTQ4NjI1,https://github.com/apache/spark/pull/28182,https://github.com/apache/spark/pull/28182.diff,https://github.com/apache/spark/pull/28182.patch,https://api.github.com/repos/apache/spark/issues/28182,28182,open,False,[SPARK-29799][Streaming] add an implemention for issue SPARK-29799.,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
    When we use Spark Streaming to consume records from kafka, the generated KafkaRDD‘s partition number is equal to kafka topic's partition number, so we can not use more cpu cores to execute the streaming task except we change the topic's partition number, but we can not increase the topic's partition number infinitely.
    We can split a kafka partition into multiple KafkaRDD partitions, and we can config it, then we can use more cpu cores to execute the streaming task. This pull request add an implemention for it.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
We can use more cpu cores to consume kafka topic records faster.
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
Test it in a real environment.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-04-10T15:14:43Z,2020-04-10T15:21:04Z,,,9fdcb5dce04dcc673eb19791c7cbdb405abd11ab,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28182/commits,https://api.github.com/repos/apache/spark/pulls/28182/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28182/comments,https://api.github.com/repos/apache/spark/statuses/ab87cf9415dced0ebbb92ab2088300c0f60a46fa,NONE,spark,apache,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,zengruios:SPARK-29799,SPARK-29799,ab87cf9415dced0ebbb92ab2088300c0f60a46fa,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,220261992,MDEwOlJlcG9zaXRvcnkyMjAyNjE5OTI=,spark,zengruios/spark,False,zengruios,26316365,MDQ6VXNlcjI2MzE2MzY1,https://avatars3.githubusercontent.com/u/26316365?v=4,,https://api.github.com/users/zengruios,https://github.com/zengruios,https://api.github.com/users/zengruios/followers,https://api.github.com/users/zengruios/following{/other_user},https://api.github.com/users/zengruios/gists{/gist_id},https://api.github.com/users/zengruios/starred{/owner}{/repo},https://api.github.com/users/zengruios/subscriptions,https://api.github.com/users/zengruios/orgs,https://api.github.com/users/zengruios/repos,https://api.github.com/users/zengruios/events{/privacy},https://api.github.com/users/zengruios/received_events,User,False,https://github.com/zengruios/spark,Apache Spark,True,https://api.github.com/repos/zengruios/spark,https://api.github.com/repos/zengruios/spark/forks,https://api.github.com/repos/zengruios/spark/keys{/key_id},https://api.github.com/repos/zengruios/spark/collaborators{/collaborator},https://api.github.com/repos/zengruios/spark/teams,https://api.github.com/repos/zengruios/spark/hooks,https://api.github.com/repos/zengruios/spark/issues/events{/number},https://api.github.com/repos/zengruios/spark/events,https://api.github.com/repos/zengruios/spark/assignees{/user},https://api.github.com/repos/zengruios/spark/branches{/branch},https://api.github.com/repos/zengruios/spark/tags,https://api.github.com/repos/zengruios/spark/git/blobs{/sha},https://api.github.com/repos/zengruios/spark/git/tags{/sha},https://api.github.com/repos/zengruios/spark/git/refs{/sha},https://api.github.com/repos/zengruios/spark/git/trees{/sha},https://api.github.com/repos/zengruios/spark/statuses/{sha},https://api.github.com/repos/zengruios/spark/languages,https://api.github.com/repos/zengruios/spark/stargazers,https://api.github.com/repos/zengruios/spark/contributors,https://api.github.com/repos/zengruios/spark/subscribers,https://api.github.com/repos/zengruios/spark/subscription,https://api.github.com/repos/zengruios/spark/commits{/sha},https://api.github.com/repos/zengruios/spark/git/commits{/sha},https://api.github.com/repos/zengruios/spark/comments{/number},https://api.github.com/repos/zengruios/spark/issues/comments{/number},https://api.github.com/repos/zengruios/spark/contents/{+path},https://api.github.com/repos/zengruios/spark/compare/{base}...{head},https://api.github.com/repos/zengruios/spark/merges,https://api.github.com/repos/zengruios/spark/{archive_format}{/ref},https://api.github.com/repos/zengruios/spark/downloads,https://api.github.com/repos/zengruios/spark/issues{/number},https://api.github.com/repos/zengruios/spark/pulls{/number},https://api.github.com/repos/zengruios/spark/milestones{/number},"https://api.github.com/repos/zengruios/spark/notifications{?since,all,participating}",https://api.github.com/repos/zengruios/spark/labels{/name},https://api.github.com/repos/zengruios/spark/releases{/id},https://api.github.com/repos/zengruios/spark/deployments,2019-11-07T14:58:06Z,2020-04-10T14:22:53Z,2020-04-10T15:53:47Z,git://github.com/zengruios/spark.git,git@github.com:zengruios/spark.git,https://github.com/zengruios/spark.git,https://github.com/zengruios/spark,,325067,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28182,https://github.com/apache/spark/pull/28182,https://api.github.com/repos/apache/spark/issues/28182,https://api.github.com/repos/apache/spark/issues/28182/comments,https://api.github.com/repos/apache/spark/pulls/28182/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28182/commits,https://api.github.com/repos/apache/spark/statuses/ab87cf9415dced0ebbb92ab2088300c0f60a46fa
4,https://api.github.com/repos/apache/spark/pulls/28181,401893769,MDExOlB1bGxSZXF1ZXN0NDAxODkzNzY5,https://github.com/apache/spark/pull/28181,https://github.com/apache/spark/pull/28181.diff,https://github.com/apache/spark/pull/28181.patch,https://api.github.com/repos/apache/spark/issues/28181,28181,open,False,[SPARK-31414][SQL] Fix performance regression with new TimestampFormatter for json and csv time parsing,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?

With benchmark original, where the timestamp values are valid to the new parser

the result is
```scala
[info] Running benchmark: Read dates and timestamps
[info]   Running case: timestamp strings
[info]   Stopped after 3 iterations, 5781 ms
[info]   Running case: parse timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 44764 ms
[info]   Running case: infer timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 93764 ms
[info]   Running case: from_json(timestamp)
[info]   Stopped after 3 iterations, 59021 ms
```
When we modify the benchmark to

```scala
     def timestampStr: Dataset[String] = {
        spark.range(0, rowsNum, 1, 1).mapPartitions { iter =>
          iter.map(i => s""""""{""timestamp"":""1970-01-01T01:02:03.${i % 100}""}"""""")
        }.select($""value"".as(""timestamp"")).as[String]
      }

      readBench.addCase(""timestamp strings"", numIters) { _ =>
        timestampStr.noop()
      }

      readBench.addCase(""parse timestamps from Dataset[String]"", numIters) { _ =>
        spark.read.schema(tsSchema).json(timestampStr).noop()
      }

      readBench.addCase(""infer timestamps from Dataset[String]"", numIters) { _ =>
        spark.read.json(timestampStr).noop()
      }
```
where the timestamp values are invalid for the new parser which causes a fallback to legacy parser(2.4).
the result is

```scala
[info] Running benchmark: Read dates and timestamps
[info]   Running case: timestamp strings
[info]   Stopped after 3 iterations, 5623 ms
[info]   Running case: parse timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 506637 ms
[info]   Running case: infer timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 509076 ms
```
About 10x perf-regression

BUT if we modify the timestamp pattern to `....HH:mm:ss[.SSS][XXX]` which make all timestamp values valid for the new parser to prohibit fallback, the result is 

```scala
[info] Running benchmark: Read dates and timestamps
[info]   Running case: timestamp strings
[info]   Stopped after 3 iterations, 5623 ms
[info]   Running case: parse timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 506637 ms
[info]   Running case: infer timestamps from Dataset[String]
[info]   Stopped after 3 iterations, 509076 ms
```

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
 Fix performance regression.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

NO
### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
new tests added.",2020-04-10T12:41:32Z,2020-04-10T21:07:05Z,,,ded5f733ca9e384040f7a33b54689a970b0e96db,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28181/commits,https://api.github.com/repos/apache/spark/pulls/28181/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28181/comments,https://api.github.com/repos/apache/spark/statuses/a63824be4b8ff9df8de3287fc3286eae895bc4bc,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:SPARK-31414,SPARK-31414,a63824be4b8ff9df8de3287fc3286eae895bc4bc,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28181,https://github.com/apache/spark/pull/28181,https://api.github.com/repos/apache/spark/issues/28181,https://api.github.com/repos/apache/spark/issues/28181/comments,https://api.github.com/repos/apache/spark/pulls/28181/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28181/commits,https://api.github.com/repos/apache/spark/statuses/a63824be4b8ff9df8de3287fc3286eae895bc4bc
5,https://api.github.com/repos/apache/spark/pulls/28179,401807244,MDExOlB1bGxSZXF1ZXN0NDAxODA3MjQ0,https://github.com/apache/spark/pull/28179,https://github.com/apache/spark/pull/28179.diff,https://github.com/apache/spark/pull/28179.patch,https://api.github.com/repos/apache/spark/issues/28179,28179,open,False,[SPARK-31411][UI] Show submitted time and duration in job details page,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Show submitted time and duration of a job in its details page


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
When we check job details from the SQL execution page, it will be more convenient if we can get the submission time and duration from the job page, instead of finding the info from job list page.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes. After changes, the job details page shows the submitted time and duration.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Manual check
![image](https://user-images.githubusercontent.com/1097932/78974997-0a1de280-7ac8-11ea-8072-ce7a001b1b0c.png)
",2020-04-10T08:10:26Z,2020-04-10T23:59:05Z,,,619ec3deefc75606dd3bec2c05d08af014a6a163,,[],"[{'login': 'srowen', 'id': 822522, 'node_id': 'MDQ6VXNlcjgyMjUyMg==', 'avatar_url': 'https://avatars0.githubusercontent.com/u/822522?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/srowen', 'html_url': 'https://github.com/srowen', 'followers_url': 'https://api.github.com/users/srowen/followers', 'following_url': 'https://api.github.com/users/srowen/following{/other_user}', 'gists_url': 'https://api.github.com/users/srowen/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/srowen/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/srowen/subscriptions', 'organizations_url': 'https://api.github.com/users/srowen/orgs', 'repos_url': 'https://api.github.com/users/srowen/repos', 'events_url': 'https://api.github.com/users/srowen/events{/privacy}', 'received_events_url': 'https://api.github.com/users/srowen/received_events', 'type': 'User', 'site_admin': False}, {'login': 'sarutak', 'id': 4736016, 'node_id': 'MDQ6VXNlcjQ3MzYwMTY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/4736016?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/sarutak', 'html_url': 'https://github.com/sarutak', 'followers_url': 'https://api.github.com/users/sarutak/followers', 'following_url': 'https://api.github.com/users/sarutak/following{/other_user}', 'gists_url': 'https://api.github.com/users/sarutak/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/sarutak/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/sarutak/subscriptions', 'organizations_url': 'https://api.github.com/users/sarutak/orgs', 'repos_url': 'https://api.github.com/users/sarutak/repos', 'events_url': 'https://api.github.com/users/sarutak/events{/privacy}', 'received_events_url': 'https://api.github.com/users/sarutak/received_events', 'type': 'User', 'site_admin': False}]",[],[],,False,https://api.github.com/repos/apache/spark/pulls/28179/commits,https://api.github.com/repos/apache/spark/pulls/28179/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28179/comments,https://api.github.com/repos/apache/spark/statuses/f1c3f917623ce08f4e72ef0316c4a7aa4fd7f9b4,MEMBER,spark,apache,gengliangwang,1097932,MDQ6VXNlcjEwOTc5MzI=,https://avatars0.githubusercontent.com/u/1097932?v=4,,https://api.github.com/users/gengliangwang,https://github.com/gengliangwang,https://api.github.com/users/gengliangwang/followers,https://api.github.com/users/gengliangwang/following{/other_user},https://api.github.com/users/gengliangwang/gists{/gist_id},https://api.github.com/users/gengliangwang/starred{/owner}{/repo},https://api.github.com/users/gengliangwang/subscriptions,https://api.github.com/users/gengliangwang/orgs,https://api.github.com/users/gengliangwang/repos,https://api.github.com/users/gengliangwang/events{/privacy},https://api.github.com/users/gengliangwang/received_events,User,False,gengliangwang:addSubmittedTimeAndDuration,addSubmittedTimeAndDuration,f1c3f917623ce08f4e72ef0316c4a7aa4fd7f9b4,gengliangwang,1097932,MDQ6VXNlcjEwOTc5MzI=,https://avatars0.githubusercontent.com/u/1097932?v=4,,https://api.github.com/users/gengliangwang,https://github.com/gengliangwang,https://api.github.com/users/gengliangwang/followers,https://api.github.com/users/gengliangwang/following{/other_user},https://api.github.com/users/gengliangwang/gists{/gist_id},https://api.github.com/users/gengliangwang/starred{/owner}{/repo},https://api.github.com/users/gengliangwang/subscriptions,https://api.github.com/users/gengliangwang/orgs,https://api.github.com/users/gengliangwang/repos,https://api.github.com/users/gengliangwang/events{/privacy},https://api.github.com/users/gengliangwang/received_events,User,False,95047635,MDEwOlJlcG9zaXRvcnk5NTA0NzYzNQ==,spark,gengliangwang/spark,False,gengliangwang,1097932,MDQ6VXNlcjEwOTc5MzI=,https://avatars0.githubusercontent.com/u/1097932?v=4,,https://api.github.com/users/gengliangwang,https://github.com/gengliangwang,https://api.github.com/users/gengliangwang/followers,https://api.github.com/users/gengliangwang/following{/other_user},https://api.github.com/users/gengliangwang/gists{/gist_id},https://api.github.com/users/gengliangwang/starred{/owner}{/repo},https://api.github.com/users/gengliangwang/subscriptions,https://api.github.com/users/gengliangwang/orgs,https://api.github.com/users/gengliangwang/repos,https://api.github.com/users/gengliangwang/events{/privacy},https://api.github.com/users/gengliangwang/received_events,User,False,https://github.com/gengliangwang/spark,Mirror of Apache Spark,True,https://api.github.com/repos/gengliangwang/spark,https://api.github.com/repos/gengliangwang/spark/forks,https://api.github.com/repos/gengliangwang/spark/keys{/key_id},https://api.github.com/repos/gengliangwang/spark/collaborators{/collaborator},https://api.github.com/repos/gengliangwang/spark/teams,https://api.github.com/repos/gengliangwang/spark/hooks,https://api.github.com/repos/gengliangwang/spark/issues/events{/number},https://api.github.com/repos/gengliangwang/spark/events,https://api.github.com/repos/gengliangwang/spark/assignees{/user},https://api.github.com/repos/gengliangwang/spark/branches{/branch},https://api.github.com/repos/gengliangwang/spark/tags,https://api.github.com/repos/gengliangwang/spark/git/blobs{/sha},https://api.github.com/repos/gengliangwang/spark/git/tags{/sha},https://api.github.com/repos/gengliangwang/spark/git/refs{/sha},https://api.github.com/repos/gengliangwang/spark/git/trees{/sha},https://api.github.com/repos/gengliangwang/spark/statuses/{sha},https://api.github.com/repos/gengliangwang/spark/languages,https://api.github.com/repos/gengliangwang/spark/stargazers,https://api.github.com/repos/gengliangwang/spark/contributors,https://api.github.com/repos/gengliangwang/spark/subscribers,https://api.github.com/repos/gengliangwang/spark/subscription,https://api.github.com/repos/gengliangwang/spark/commits{/sha},https://api.github.com/repos/gengliangwang/spark/git/commits{/sha},https://api.github.com/repos/gengliangwang/spark/comments{/number},https://api.github.com/repos/gengliangwang/spark/issues/comments{/number},https://api.github.com/repos/gengliangwang/spark/contents/{+path},https://api.github.com/repos/gengliangwang/spark/compare/{base}...{head},https://api.github.com/repos/gengliangwang/spark/merges,https://api.github.com/repos/gengliangwang/spark/{archive_format}{/ref},https://api.github.com/repos/gengliangwang/spark/downloads,https://api.github.com/repos/gengliangwang/spark/issues{/number},https://api.github.com/repos/gengliangwang/spark/pulls{/number},https://api.github.com/repos/gengliangwang/spark/milestones{/number},"https://api.github.com/repos/gengliangwang/spark/notifications{?since,all,participating}",https://api.github.com/repos/gengliangwang/spark/labels{/name},https://api.github.com/repos/gengliangwang/spark/releases{/id},https://api.github.com/repos/gengliangwang/spark/deployments,2017-06-21T21:26:20Z,2018-09-06T08:35:28Z,2020-04-10T19:07:33Z,git://github.com/gengliangwang/spark.git,git@github.com:gengliangwang/spark.git,https://github.com/gengliangwang/spark.git,https://github.com/gengliangwang/spark,,322973,0,0,Scala,False,True,True,True,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a454510917badb22be53869420f76babac6fa38d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28179,https://github.com/apache/spark/pull/28179,https://api.github.com/repos/apache/spark/issues/28179,https://api.github.com/repos/apache/spark/issues/28179/comments,https://api.github.com/repos/apache/spark/pulls/28179/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28179/commits,https://api.github.com/repos/apache/spark/statuses/f1c3f917623ce08f4e72ef0316c4a7aa4fd7f9b4
6,https://api.github.com/repos/apache/spark/pulls/28178,401800655,MDExOlB1bGxSZXF1ZXN0NDAxODAwNjU1,https://github.com/apache/spark/pull/28178,https://github.com/apache/spark/pull/28178.diff,https://github.com/apache/spark/pull/28178.patch,https://api.github.com/repos/apache/spark/issues/28178,28178,open,False,[SPARK-31409][SQL][TEST] Fix failed tests due to result order changing when enable AQE,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This PR fix two tests by avoid result order changing when we enable AQE:

1. In `SQLQueryTestSuite`, disable BHJ optimization to avoid changing result order

2. In test `SQLQuerySuite#check outputs of expression examples`, disable  `spark.sql.adaptive.coalescePartitions.enabled`  to avoid changing result order


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

query 147 in SQLQueryTestSuite#""udf/postgreSQL/udf-join.sql - Scala UDF"" and test sql/SQLQuerySuite#""check outputs of expression examples"" can fail when enable AQE due to result order changing. And this PR fix them.


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Tested manually with AQE enabled.
",2020-04-10T07:50:45Z,2020-04-10T14:30:05Z,,,30d3c054c056a7f535e87e85f173bc1f262172fc,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28178/commits,https://api.github.com/repos/apache/spark/pulls/28178/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28178/comments,https://api.github.com/repos/apache/spark/statuses/780b5cb529d1bf026ea3d3e51e2edb335b67bf01,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:fix_order,fix_order,780b5cb529d1bf026ea3d3e51e2edb335b67bf01,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,a454510917badb22be53869420f76babac6fa38d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28178,https://github.com/apache/spark/pull/28178,https://api.github.com/repos/apache/spark/issues/28178,https://api.github.com/repos/apache/spark/issues/28178/comments,https://api.github.com/repos/apache/spark/pulls/28178/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28178/commits,https://api.github.com/repos/apache/spark/statuses/780b5cb529d1bf026ea3d3e51e2edb335b67bf01
7,https://api.github.com/repos/apache/spark/pulls/28177,401784235,MDExOlB1bGxSZXF1ZXN0NDAxNzg0MjM1,https://github.com/apache/spark/pull/28177,https://github.com/apache/spark/pull/28177.diff,https://github.com/apache/spark/pull/28177.patch,https://api.github.com/repos/apache/spark/issues/28177,28177,open,False,[SPARK-31407][SQL][TEST] Fix hive/SQLQuerySuite.derived from Hive query file: drop_database_removes_partition_dirs.q,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Fix test ""derived from Hive query file: drop_database_removes_partition_dirs.q"" to make it be successful when we run it separately:

We should not expect the `src` table from `default` database after we switched database to `test_database`.



### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

The test now can only pass when we run it with the whole test suit but fail when run it separately.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Updated the test.",2020-04-10T06:55:27Z,2020-04-10T08:57:14Z,,,5bb8ed25c17225f83c106d926ba25c4356a15eec,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28177/commits,https://api.github.com/repos/apache/spark/pulls/28177/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28177/comments,https://api.github.com/repos/apache/spark/statuses/52e63daf4bea37de89409541dd43af7bdf8e0ffa,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:fix_derived,fix_derived,52e63daf4bea37de89409541dd43af7bdf8e0ffa,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,e42a3945acd614a26c7941a9eed161b500fb4520,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28177,https://github.com/apache/spark/pull/28177,https://api.github.com/repos/apache/spark/issues/28177,https://api.github.com/repos/apache/spark/issues/28177/comments,https://api.github.com/repos/apache/spark/pulls/28177/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28177/commits,https://api.github.com/repos/apache/spark/statuses/52e63daf4bea37de89409541dd43af7bdf8e0ffa
8,https://api.github.com/repos/apache/spark/pulls/28176,401745620,MDExOlB1bGxSZXF1ZXN0NDAxNzQ1NjIw,https://github.com/apache/spark/pull/28176,https://github.com/apache/spark/pull/28176.diff,https://github.com/apache/spark/pull/28176.patch,https://api.github.com/repos/apache/spark/issues/28176,28176,open,False,[SPARK-31301][ML] Flatten the result dataframe of tests in testChiSquare,"### What changes were proposed in this pull request?
1, remove newly added method: `def testChiSquare(dataset: Dataset[_], featuresCol: String, labelCol: String): Array[SelectionTestResult]`, because: 1) it is only used in `ChiSqSelector`; 2, since the returned dataframe of `def test(dataset: DataFrame, featuresCol: String, labelCol: String): DataFrame` only contains one row, after collect it back to driver, the results are similar;
2, add method `def test(dataset: DataFrame, featuresCol: String, labelCol: String, flatten: Boolean): DataFrame` to return the flatten results;


### Why are the changes needed?
1, when get returned result dataframe, we may want to filter it like `pValue<0.1`, but current returned dataframe is hard to use;
2, current impl need to collect all test results of all columns back to the driver, this is a bottleneck, if we return the flatten datafame, we no longer to collect them to driver;

### Does this PR introduce any user-facing change?
Yes:
1, `def testChiSquare(dataset: Dataset[_], featuresCol: String, labelCol: String): Array[SelectionTestResult]` removed;
2, the returned dataframe need an action to trigger computation;


### How was this patch tested?
updated testsuites",2020-04-10T03:56:28Z,2020-04-10T14:10:15Z,,,fb01cb08bf1d1ff1d1ce53295bc240f395bd6eed,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28176/commits,https://api.github.com/repos/apache/spark/pulls/28176/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28176/comments,https://api.github.com/repos/apache/spark/statuses/02bc72b05329780709e1758a993dfd357aceb693,CONTRIBUTOR,spark,apache,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,zhengruifeng:flatten_chisq,flatten_chisq,02bc72b05329780709e1758a993dfd357aceb693,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,51584791,MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==,spark,zhengruifeng/spark,False,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,https://github.com/zhengruifeng/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zhengruifeng/spark,https://api.github.com/repos/zhengruifeng/spark/forks,https://api.github.com/repos/zhengruifeng/spark/keys{/key_id},https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator},https://api.github.com/repos/zhengruifeng/spark/teams,https://api.github.com/repos/zhengruifeng/spark/hooks,https://api.github.com/repos/zhengruifeng/spark/issues/events{/number},https://api.github.com/repos/zhengruifeng/spark/events,https://api.github.com/repos/zhengruifeng/spark/assignees{/user},https://api.github.com/repos/zhengruifeng/spark/branches{/branch},https://api.github.com/repos/zhengruifeng/spark/tags,https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha},https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha},https://api.github.com/repos/zhengruifeng/spark/statuses/{sha},https://api.github.com/repos/zhengruifeng/spark/languages,https://api.github.com/repos/zhengruifeng/spark/stargazers,https://api.github.com/repos/zhengruifeng/spark/contributors,https://api.github.com/repos/zhengruifeng/spark/subscribers,https://api.github.com/repos/zhengruifeng/spark/subscription,https://api.github.com/repos/zhengruifeng/spark/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/comments{/number},https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number},https://api.github.com/repos/zhengruifeng/spark/contents/{+path},https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head},https://api.github.com/repos/zhengruifeng/spark/merges,https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref},https://api.github.com/repos/zhengruifeng/spark/downloads,https://api.github.com/repos/zhengruifeng/spark/issues{/number},https://api.github.com/repos/zhengruifeng/spark/pulls{/number},https://api.github.com/repos/zhengruifeng/spark/milestones{/number},"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}",https://api.github.com/repos/zhengruifeng/spark/labels{/name},https://api.github.com/repos/zhengruifeng/spark/releases{/id},https://api.github.com/repos/zhengruifeng/spark/deployments,2016-02-12T11:58:00Z,2020-02-07T03:38:20Z,2020-04-10T12:55:52Z,git://github.com/zhengruifeng/spark.git,git@github.com:zhengruifeng/spark.git,https://github.com/zhengruifeng/spark.git,https://github.com/zhengruifeng/spark,,305206,1,1,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28176,https://github.com/apache/spark/pull/28176,https://api.github.com/repos/apache/spark/issues/28176,https://api.github.com/repos/apache/spark/issues/28176/comments,https://api.github.com/repos/apache/spark/pulls/28176/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28176/commits,https://api.github.com/repos/apache/spark/statuses/02bc72b05329780709e1758a993dfd357aceb693
9,https://api.github.com/repos/apache/spark/pulls/28175,401744023,MDExOlB1bGxSZXF1ZXN0NDAxNzQ0MDIz,https://github.com/apache/spark/pull/28175,https://github.com/apache/spark/pull/28175.diff,https://github.com/apache/spark/pull/28175.patch,https://api.github.com/repos/apache/spark/issues/28175,28175,open,False,[SPARK-31253][SQL][FOLLOW-UP] Improve the partition data size metrics in CustomShuffleReaderExec,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
Currently the partition data size metrics contain three entries (min/max/avg)  in Spark UI, which is not user friendly. This PR lets the metrics with min/max/avg in one entry by calling SQLMetrics.postDriverMetricUpdates multiple times.
Before this PR, the spark UI is shown in the following:
![image](https://user-images.githubusercontent.com/11972570/78980137-da1a2200-7b4f-11ea-81ee-76858e887bde.png)

After this PR. the spark UI is shown in the following:
![image](https://user-images.githubusercontent.com/11972570/78980192-fae27780-7b4f-11ea-9faa-07f58699acfd.png)


<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
Improving UI
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
existing ut
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-04-10T03:47:02Z,2020-04-10T11:22:05Z,,,b6ba3e15ae8411ad2193a0c126551a5489cb22af,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28175/commits,https://api.github.com/repos/apache/spark/pulls/28175/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28175/comments,https://api.github.com/repos/apache/spark/statuses/4aabfaa9f6b9162024664843afec8af47264a814,CONTRIBUTOR,spark,apache,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,JkSelf:improveAqeMetrics,improveAqeMetrics,4aabfaa9f6b9162024664843afec8af47264a814,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,159634260,MDEwOlJlcG9zaXRvcnkxNTk2MzQyNjA=,spark,JkSelf/spark,False,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,https://github.com/JkSelf/spark,Mirror of Apache Spark,True,https://api.github.com/repos/JkSelf/spark,https://api.github.com/repos/JkSelf/spark/forks,https://api.github.com/repos/JkSelf/spark/keys{/key_id},https://api.github.com/repos/JkSelf/spark/collaborators{/collaborator},https://api.github.com/repos/JkSelf/spark/teams,https://api.github.com/repos/JkSelf/spark/hooks,https://api.github.com/repos/JkSelf/spark/issues/events{/number},https://api.github.com/repos/JkSelf/spark/events,https://api.github.com/repos/JkSelf/spark/assignees{/user},https://api.github.com/repos/JkSelf/spark/branches{/branch},https://api.github.com/repos/JkSelf/spark/tags,https://api.github.com/repos/JkSelf/spark/git/blobs{/sha},https://api.github.com/repos/JkSelf/spark/git/tags{/sha},https://api.github.com/repos/JkSelf/spark/git/refs{/sha},https://api.github.com/repos/JkSelf/spark/git/trees{/sha},https://api.github.com/repos/JkSelf/spark/statuses/{sha},https://api.github.com/repos/JkSelf/spark/languages,https://api.github.com/repos/JkSelf/spark/stargazers,https://api.github.com/repos/JkSelf/spark/contributors,https://api.github.com/repos/JkSelf/spark/subscribers,https://api.github.com/repos/JkSelf/spark/subscription,https://api.github.com/repos/JkSelf/spark/commits{/sha},https://api.github.com/repos/JkSelf/spark/git/commits{/sha},https://api.github.com/repos/JkSelf/spark/comments{/number},https://api.github.com/repos/JkSelf/spark/issues/comments{/number},https://api.github.com/repos/JkSelf/spark/contents/{+path},https://api.github.com/repos/JkSelf/spark/compare/{base}...{head},https://api.github.com/repos/JkSelf/spark/merges,https://api.github.com/repos/JkSelf/spark/{archive_format}{/ref},https://api.github.com/repos/JkSelf/spark/downloads,https://api.github.com/repos/JkSelf/spark/issues{/number},https://api.github.com/repos/JkSelf/spark/pulls{/number},https://api.github.com/repos/JkSelf/spark/milestones{/number},"https://api.github.com/repos/JkSelf/spark/notifications{?since,all,participating}",https://api.github.com/repos/JkSelf/spark/labels{/name},https://api.github.com/repos/JkSelf/spark/releases{/id},https://api.github.com/repos/JkSelf/spark/deployments,2018-11-29T08:40:39Z,2020-02-18T05:52:18Z,2020-04-10T09:27:16Z,git://github.com/JkSelf/spark.git,git@github.com:JkSelf/spark.git,https://github.com/JkSelf/spark.git,https://github.com/JkSelf/spark,,322143,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28175,https://github.com/apache/spark/pull/28175,https://api.github.com/repos/apache/spark/issues/28175,https://api.github.com/repos/apache/spark/issues/28175/comments,https://api.github.com/repos/apache/spark/pulls/28175/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28175/commits,https://api.github.com/repos/apache/spark/statuses/4aabfaa9f6b9162024664843afec8af47264a814
10,https://api.github.com/repos/apache/spark/pulls/28173,401677252,MDExOlB1bGxSZXF1ZXN0NDAxNjc3MjUy,https://github.com/apache/spark/pull/28173,https://github.com/apache/spark/pull/28173.diff,https://github.com/apache/spark/pull/28173.patch,https://api.github.com/repos/apache/spark/issues/28173,28173,open,False,[SPARK-31389][SQL][TESTS] Ensure all tests in org.apache.spark.sql.execution.metric.SQLMetricsSuite run with both codegen on and off,"### What changes were proposed in this pull request?
Adding missing unit tests in SQLMetricSuite to cover the code generated path.
**Additional tests were added in the following unit tests.**
Filter metrics, SortMergeJoin metrics, SortMergeJoin(outer) metrics, BroadcastHashJoin metrics,  ShuffledHashJoin metrics, BroadcastHashJoin(outer) metrics, BroadcastNestedLoopJoin metrics, BroadcastLeftSemiJoinHash metrics, CartesianProduct metrics,  SortMergeJoin(left-anti) metrics

### Why are the changes needed?
The existing tests in SQLMetricSuite only cover the interpreted path.
It is necessary for the tests to cover code generated path as well since CodeGenerated path is often used in production.

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
I added debug statements in the code to make sure both Code generated and Interpreted paths are being exercised.
I further used Intellij debugger to ensure that the newly added unit tests are in fact exercising both code generated and interpreted paths.",2020-04-09T22:35:58Z,2020-04-10T21:13:09Z,,,af59e1e994563b741db14079ef2b1be5275d0c23,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28173/commits,https://api.github.com/repos/apache/spark/pulls/28173/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28173/comments,https://api.github.com/repos/apache/spark/statuses/8ac7fe54a56ea06035dff901a81e93eb8b5ded6f,NONE,spark,apache,sririshindra,9795421,MDQ6VXNlcjk3OTU0MjE=,https://avatars0.githubusercontent.com/u/9795421?v=4,,https://api.github.com/users/sririshindra,https://github.com/sririshindra,https://api.github.com/users/sririshindra/followers,https://api.github.com/users/sririshindra/following{/other_user},https://api.github.com/users/sririshindra/gists{/gist_id},https://api.github.com/users/sririshindra/starred{/owner}{/repo},https://api.github.com/users/sririshindra/subscriptions,https://api.github.com/users/sririshindra/orgs,https://api.github.com/users/sririshindra/repos,https://api.github.com/users/sririshindra/events{/privacy},https://api.github.com/users/sririshindra/received_events,User,False,sririshindra:SPARK-31389,SPARK-31389,8ac7fe54a56ea06035dff901a81e93eb8b5ded6f,sririshindra,9795421,MDQ6VXNlcjk3OTU0MjE=,https://avatars0.githubusercontent.com/u/9795421?v=4,,https://api.github.com/users/sririshindra,https://github.com/sririshindra,https://api.github.com/users/sririshindra/followers,https://api.github.com/users/sririshindra/following{/other_user},https://api.github.com/users/sririshindra/gists{/gist_id},https://api.github.com/users/sririshindra/starred{/owner}{/repo},https://api.github.com/users/sririshindra/subscriptions,https://api.github.com/users/sririshindra/orgs,https://api.github.com/users/sririshindra/repos,https://api.github.com/users/sririshindra/events{/privacy},https://api.github.com/users/sririshindra/received_events,User,False,245021426,MDEwOlJlcG9zaXRvcnkyNDUwMjE0MjY=,spark,sririshindra/spark,False,sririshindra,9795421,MDQ6VXNlcjk3OTU0MjE=,https://avatars0.githubusercontent.com/u/9795421?v=4,,https://api.github.com/users/sririshindra,https://github.com/sririshindra,https://api.github.com/users/sririshindra/followers,https://api.github.com/users/sririshindra/following{/other_user},https://api.github.com/users/sririshindra/gists{/gist_id},https://api.github.com/users/sririshindra/starred{/owner}{/repo},https://api.github.com/users/sririshindra/subscriptions,https://api.github.com/users/sririshindra/orgs,https://api.github.com/users/sririshindra/repos,https://api.github.com/users/sririshindra/events{/privacy},https://api.github.com/users/sririshindra/received_events,User,False,https://github.com/sririshindra/spark,Apache Spark,True,https://api.github.com/repos/sririshindra/spark,https://api.github.com/repos/sririshindra/spark/forks,https://api.github.com/repos/sririshindra/spark/keys{/key_id},https://api.github.com/repos/sririshindra/spark/collaborators{/collaborator},https://api.github.com/repos/sririshindra/spark/teams,https://api.github.com/repos/sririshindra/spark/hooks,https://api.github.com/repos/sririshindra/spark/issues/events{/number},https://api.github.com/repos/sririshindra/spark/events,https://api.github.com/repos/sririshindra/spark/assignees{/user},https://api.github.com/repos/sririshindra/spark/branches{/branch},https://api.github.com/repos/sririshindra/spark/tags,https://api.github.com/repos/sririshindra/spark/git/blobs{/sha},https://api.github.com/repos/sririshindra/spark/git/tags{/sha},https://api.github.com/repos/sririshindra/spark/git/refs{/sha},https://api.github.com/repos/sririshindra/spark/git/trees{/sha},https://api.github.com/repos/sririshindra/spark/statuses/{sha},https://api.github.com/repos/sririshindra/spark/languages,https://api.github.com/repos/sririshindra/spark/stargazers,https://api.github.com/repos/sririshindra/spark/contributors,https://api.github.com/repos/sririshindra/spark/subscribers,https://api.github.com/repos/sririshindra/spark/subscription,https://api.github.com/repos/sririshindra/spark/commits{/sha},https://api.github.com/repos/sririshindra/spark/git/commits{/sha},https://api.github.com/repos/sririshindra/spark/comments{/number},https://api.github.com/repos/sririshindra/spark/issues/comments{/number},https://api.github.com/repos/sririshindra/spark/contents/{+path},https://api.github.com/repos/sririshindra/spark/compare/{base}...{head},https://api.github.com/repos/sririshindra/spark/merges,https://api.github.com/repos/sririshindra/spark/{archive_format}{/ref},https://api.github.com/repos/sririshindra/spark/downloads,https://api.github.com/repos/sririshindra/spark/issues{/number},https://api.github.com/repos/sririshindra/spark/pulls{/number},https://api.github.com/repos/sririshindra/spark/milestones{/number},"https://api.github.com/repos/sririshindra/spark/notifications{?since,all,participating}",https://api.github.com/repos/sririshindra/spark/labels{/name},https://api.github.com/repos/sririshindra/spark/releases{/id},https://api.github.com/repos/sririshindra/spark/deployments,2020-03-04T22:57:17Z,2020-04-09T20:20:36Z,2020-04-10T19:50:12Z,git://github.com/sririshindra/spark.git,git@github.com:sririshindra/spark.git,https://github.com/sririshindra/spark.git,https://github.com/sririshindra/spark,,325996,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,61f903fa7aa853e6462362aa8d335e3fc192d831,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28173,https://github.com/apache/spark/pull/28173,https://api.github.com/repos/apache/spark/issues/28173,https://api.github.com/repos/apache/spark/issues/28173/comments,https://api.github.com/repos/apache/spark/pulls/28173/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28173/commits,https://api.github.com/repos/apache/spark/statuses/8ac7fe54a56ea06035dff901a81e93eb8b5ded6f
11,https://api.github.com/repos/apache/spark/pulls/28172,401627064,MDExOlB1bGxSZXF1ZXN0NDAxNjI3MDY0,https://github.com/apache/spark/pull/28172,https://github.com/apache/spark/pull/28172.diff,https://github.com/apache/spark/pull/28172.patch,https://api.github.com/repos/apache/spark/issues/28172,28172,open,False,[SPARK-31402][SQL] Fix rebasing of BCE dates/timestamps,"### What changes were proposed in this pull request?
In the PR, I propose to fallback to rebasing via local dates/timestamps for days/micros of before common era (BCE). 

### Why are the changes needed?
It fixes the bug of rebasing dates/timestamps of BCE.

### Does this PR introduce any user-facing change?
Yes

### How was this patch tested?
- By existing tests in `RebaseDateTimeSuite` and `DateTimeUtilsSuite`
- Added tests for negative years to `RebaseDateTimeSuite`",2020-04-09T20:24:20Z,2020-04-10T23:05:07Z,,,aeffc6bdbceea7f6ea4bc6fc674857131f2c3a96,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28172/commits,https://api.github.com/repos/apache/spark/pulls/28172/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28172/comments,https://api.github.com/repos/apache/spark/statuses/68cebb9696f6f43003e105f4890a1b43894663f7,CONTRIBUTOR,spark,apache,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,MaxGekk:fix-era-in-date-micros-rebasing,fix-era-in-date-micros-rebasing,68cebb9696f6f43003e105f4890a1b43894663f7,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,123690489,MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=,spark,MaxGekk/spark,False,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,https://github.com/MaxGekk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/MaxGekk/spark,https://api.github.com/repos/MaxGekk/spark/forks,https://api.github.com/repos/MaxGekk/spark/keys{/key_id},https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator},https://api.github.com/repos/MaxGekk/spark/teams,https://api.github.com/repos/MaxGekk/spark/hooks,https://api.github.com/repos/MaxGekk/spark/issues/events{/number},https://api.github.com/repos/MaxGekk/spark/events,https://api.github.com/repos/MaxGekk/spark/assignees{/user},https://api.github.com/repos/MaxGekk/spark/branches{/branch},https://api.github.com/repos/MaxGekk/spark/tags,https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha},https://api.github.com/repos/MaxGekk/spark/git/tags{/sha},https://api.github.com/repos/MaxGekk/spark/git/refs{/sha},https://api.github.com/repos/MaxGekk/spark/git/trees{/sha},https://api.github.com/repos/MaxGekk/spark/statuses/{sha},https://api.github.com/repos/MaxGekk/spark/languages,https://api.github.com/repos/MaxGekk/spark/stargazers,https://api.github.com/repos/MaxGekk/spark/contributors,https://api.github.com/repos/MaxGekk/spark/subscribers,https://api.github.com/repos/MaxGekk/spark/subscription,https://api.github.com/repos/MaxGekk/spark/commits{/sha},https://api.github.com/repos/MaxGekk/spark/git/commits{/sha},https://api.github.com/repos/MaxGekk/spark/comments{/number},https://api.github.com/repos/MaxGekk/spark/issues/comments{/number},https://api.github.com/repos/MaxGekk/spark/contents/{+path},https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head},https://api.github.com/repos/MaxGekk/spark/merges,https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref},https://api.github.com/repos/MaxGekk/spark/downloads,https://api.github.com/repos/MaxGekk/spark/issues{/number},https://api.github.com/repos/MaxGekk/spark/pulls{/number},https://api.github.com/repos/MaxGekk/spark/milestones{/number},"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}",https://api.github.com/repos/MaxGekk/spark/labels{/name},https://api.github.com/repos/MaxGekk/spark/releases{/id},https://api.github.com/repos/MaxGekk/spark/deployments,2018-03-03T12:37:00Z,2020-04-10T19:15:57Z,2020-04-10T20:37:52Z,git://github.com/MaxGekk/spark.git,git@github.com:MaxGekk/spark.git,https://github.com/MaxGekk/spark.git,https://github.com/MaxGekk/spark,,325420,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28172,https://github.com/apache/spark/pull/28172,https://api.github.com/repos/apache/spark/issues/28172,https://api.github.com/repos/apache/spark/issues/28172/comments,https://api.github.com/repos/apache/spark/pulls/28172/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28172/commits,https://api.github.com/repos/apache/spark/statuses/68cebb9696f6f43003e105f4890a1b43894663f7
12,https://api.github.com/repos/apache/spark/pulls/28169,401366132,MDExOlB1bGxSZXF1ZXN0NDAxMzY2MTMy,https://github.com/apache/spark/pull/28169,https://github.com/apache/spark/pull/28169.diff,https://github.com/apache/spark/pull/28169.patch,https://api.github.com/repos/apache/spark/issues/28169,28169,open,False,[SPARK-31398][SQL] Speed up reading dates in ORC,"### What changes were proposed in this pull request?
In regular ORC reader when `spark.sql.orc.enableVectorizedReader` is set to `false`, I propose to use `DaysWritable` in reading DATE values from ORC files. Currently, days from ORC files are converted to java.sql.Date, and then to days in Proleptic Gregorian calendar. So, the conversion to Java type can be eliminated.

### Why are the changes needed?
The changes improve performance of regular ORC reader for DATE columns.
Before (on JDK 8):
```
Load dates from ORC:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, vec off                               39651          39686          31          2.5         396.5       1.0X
after 1582, vec on                                 3647           3660          13         27.4          36.5      10.9X
before 1582, vec off                              38155          38219          61          2.6         381.6       1.0X
before 1582, vec on                                4041           4046           6         24.7          40.4       9.8X
```

After:
```
Load dates from ORC:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, vec off                               10947          10971          28          9.1         109.5       1.0X
after 1582, vec on                                 3677           3702          36         27.2          36.8       3.0X
before 1582, vec off                              11456          11472          21          8.7         114.6       1.0X
before 1582, vec on                                4079           4103          21         24.5          40.8       2.7X
```

**Performance improvement is ~ 3.6 times.**

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
- By existing tests suites like `DateTimeUtilsSuite`
- Checked for `hive-1.2` by:
```
./build/sbt -Phive-1.2 ""test:testOnly *OrcHadoopFsRelationSuite""
```
- Re-run `DateTimeRebaseBenchmark` in the environment:

| Item | Description |
| ---- | ----|
| Region | us-west-2 (Oregon) |
| Instance | r3.xlarge |
| AMI | ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-20190722.1 (ami-06f2f779464715dc5) |
| Java | OpenJDK 64-Bit Server VM 1.8.0_242 and OpenJDK 64-Bit Server VM 11.0.6+10 |",2020-04-09T11:20:55Z,2020-04-10T20:44:07Z,,,d5c82a936c134c1eb7b4b0721bbc8b9e468598d8,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28169/commits,https://api.github.com/repos/apache/spark/pulls/28169/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28169/comments,https://api.github.com/repos/apache/spark/statuses/69bcf238406628bb999e59218c60a919c1726d95,CONTRIBUTOR,spark,apache,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,MaxGekk:orc-optimize-dates,orc-optimize-dates,69bcf238406628bb999e59218c60a919c1726d95,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,123690489,MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=,spark,MaxGekk/spark,False,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,https://github.com/MaxGekk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/MaxGekk/spark,https://api.github.com/repos/MaxGekk/spark/forks,https://api.github.com/repos/MaxGekk/spark/keys{/key_id},https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator},https://api.github.com/repos/MaxGekk/spark/teams,https://api.github.com/repos/MaxGekk/spark/hooks,https://api.github.com/repos/MaxGekk/spark/issues/events{/number},https://api.github.com/repos/MaxGekk/spark/events,https://api.github.com/repos/MaxGekk/spark/assignees{/user},https://api.github.com/repos/MaxGekk/spark/branches{/branch},https://api.github.com/repos/MaxGekk/spark/tags,https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha},https://api.github.com/repos/MaxGekk/spark/git/tags{/sha},https://api.github.com/repos/MaxGekk/spark/git/refs{/sha},https://api.github.com/repos/MaxGekk/spark/git/trees{/sha},https://api.github.com/repos/MaxGekk/spark/statuses/{sha},https://api.github.com/repos/MaxGekk/spark/languages,https://api.github.com/repos/MaxGekk/spark/stargazers,https://api.github.com/repos/MaxGekk/spark/contributors,https://api.github.com/repos/MaxGekk/spark/subscribers,https://api.github.com/repos/MaxGekk/spark/subscription,https://api.github.com/repos/MaxGekk/spark/commits{/sha},https://api.github.com/repos/MaxGekk/spark/git/commits{/sha},https://api.github.com/repos/MaxGekk/spark/comments{/number},https://api.github.com/repos/MaxGekk/spark/issues/comments{/number},https://api.github.com/repos/MaxGekk/spark/contents/{+path},https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head},https://api.github.com/repos/MaxGekk/spark/merges,https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref},https://api.github.com/repos/MaxGekk/spark/downloads,https://api.github.com/repos/MaxGekk/spark/issues{/number},https://api.github.com/repos/MaxGekk/spark/pulls{/number},https://api.github.com/repos/MaxGekk/spark/milestones{/number},"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}",https://api.github.com/repos/MaxGekk/spark/labels{/name},https://api.github.com/repos/MaxGekk/spark/releases{/id},https://api.github.com/repos/MaxGekk/spark/deployments,2018-03-03T12:37:00Z,2020-04-10T19:15:57Z,2020-04-10T20:37:52Z,git://github.com/MaxGekk/spark.git,git@github.com:MaxGekk/spark.git,https://github.com/MaxGekk/spark.git,https://github.com/MaxGekk/spark,,325420,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,8b4862953a879a9b3ba6f57e669efc383df68b7c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28169,https://github.com/apache/spark/pull/28169,https://api.github.com/repos/apache/spark/issues/28169,https://api.github.com/repos/apache/spark/issues/28169/comments,https://api.github.com/repos/apache/spark/pulls/28169/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28169/commits,https://api.github.com/repos/apache/spark/statuses/69bcf238406628bb999e59218c60a919c1726d95
13,https://api.github.com/repos/apache/spark/pulls/28167,401345235,MDExOlB1bGxSZXF1ZXN0NDAxMzQ1MjM1,https://github.com/apache/spark/pull/28167,https://github.com/apache/spark/pull/28167.diff,https://github.com/apache/spark/pull/28167.patch,https://api.github.com/repos/apache/spark/issues/28167,28167,open,False,[SPARK-31106][SQL] Support is_json function,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
In this PR, I am proposing a JSON function `is_json`.
This function will check whether a given string is valid JSON string or not. It it is valid it will return `true`, if it is invalid it will return `false`. In case of `NULL` input `NULL` will be returned.

```
scala> sql(""select is_json('{[]}')"").show
+-------------+
|is_json({[]})|
+-------------+
|        false|
+-------------+


scala> sql(""select is_json('[1, 2, 3]')"").show
+------------------+
|is_json([1, 2, 3])|
+------------------+
|              true|
+------------------+


scala> sql(""select is_json(null)"").show
+-----------------------------+
|is_json(CAST(NULL AS STRING))|
+-----------------------------+
|                         null|
+-----------------------------+
```
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
This is one the most basic and required functions when we are dealing with JSON data. 
Say, user is reading a table then he can segregate the table into rows with valid JSON and rows with invalid JSON. Now user only needs to process on the rows containing valid/invalid JSON.

This function is supported by some popular databases as well. Some of them are :
- MySQL
- SQL Server
- IBM Db2
- Sqlite
- MariaDB
- Amazon Redshift

<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
Yes, Now users can use is_json() function to verify whether the given JSON string is valid or not.
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
UT added.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->",2020-04-09T10:35:03Z,2020-04-10T14:22:05Z,,,0b65d9c683e09f6a36e78c343abc8231235907d9,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28167/commits,https://api.github.com/repos/apache/spark/pulls/28167/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28167/comments,https://api.github.com/repos/apache/spark/statuses/c06abe06086a3a50a2c126cfe68ea94dd1647af2,CONTRIBUTOR,spark,apache,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,iRakson:isJSON,isJSON,c06abe06086a3a50a2c126cfe68ea94dd1647af2,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,205127207,MDEwOlJlcG9zaXRvcnkyMDUxMjcyMDc=,spark,iRakson/spark,False,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,https://github.com/iRakson/spark,Apache Spark,True,https://api.github.com/repos/iRakson/spark,https://api.github.com/repos/iRakson/spark/forks,https://api.github.com/repos/iRakson/spark/keys{/key_id},https://api.github.com/repos/iRakson/spark/collaborators{/collaborator},https://api.github.com/repos/iRakson/spark/teams,https://api.github.com/repos/iRakson/spark/hooks,https://api.github.com/repos/iRakson/spark/issues/events{/number},https://api.github.com/repos/iRakson/spark/events,https://api.github.com/repos/iRakson/spark/assignees{/user},https://api.github.com/repos/iRakson/spark/branches{/branch},https://api.github.com/repos/iRakson/spark/tags,https://api.github.com/repos/iRakson/spark/git/blobs{/sha},https://api.github.com/repos/iRakson/spark/git/tags{/sha},https://api.github.com/repos/iRakson/spark/git/refs{/sha},https://api.github.com/repos/iRakson/spark/git/trees{/sha},https://api.github.com/repos/iRakson/spark/statuses/{sha},https://api.github.com/repos/iRakson/spark/languages,https://api.github.com/repos/iRakson/spark/stargazers,https://api.github.com/repos/iRakson/spark/contributors,https://api.github.com/repos/iRakson/spark/subscribers,https://api.github.com/repos/iRakson/spark/subscription,https://api.github.com/repos/iRakson/spark/commits{/sha},https://api.github.com/repos/iRakson/spark/git/commits{/sha},https://api.github.com/repos/iRakson/spark/comments{/number},https://api.github.com/repos/iRakson/spark/issues/comments{/number},https://api.github.com/repos/iRakson/spark/contents/{+path},https://api.github.com/repos/iRakson/spark/compare/{base}...{head},https://api.github.com/repos/iRakson/spark/merges,https://api.github.com/repos/iRakson/spark/{archive_format}{/ref},https://api.github.com/repos/iRakson/spark/downloads,https://api.github.com/repos/iRakson/spark/issues{/number},https://api.github.com/repos/iRakson/spark/pulls{/number},https://api.github.com/repos/iRakson/spark/milestones{/number},"https://api.github.com/repos/iRakson/spark/notifications{?since,all,participating}",https://api.github.com/repos/iRakson/spark/labels{/name},https://api.github.com/repos/iRakson/spark/releases{/id},https://api.github.com/repos/iRakson/spark/deployments,2019-08-29T09:22:50Z,2019-10-23T11:47:43Z,2020-04-10T09:12:57Z,git://github.com/iRakson/spark.git,git@github.com:iRakson/spark.git,https://github.com/iRakson/spark.git,https://github.com/iRakson/spark,,325766,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c279e6b0914014a99b84076420240dceaf3b895d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28167,https://github.com/apache/spark/pull/28167,https://api.github.com/repos/apache/spark/issues/28167,https://api.github.com/repos/apache/spark/issues/28167/comments,https://api.github.com/repos/apache/spark/pulls/28167/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28167/commits,https://api.github.com/repos/apache/spark/statuses/c06abe06086a3a50a2c126cfe68ea94dd1647af2
14,https://api.github.com/repos/apache/spark/pulls/28164,401251229,MDExOlB1bGxSZXF1ZXN0NDAxMjUxMjI5,https://github.com/apache/spark/pull/28164,https://github.com/apache/spark/pull/28164.diff,https://github.com/apache/spark/pull/28164.patch,https://api.github.com/repos/apache/spark/issues/28164,28164,open,False,[SPARK-31393][SQL] Show the correct alias in a more elegant way that override the prettyName ,"### What changes were proposed in this pull request?
Spark SQL exists some function no elegant implementation.
For example: `BitwiseCount` override the sql method show below:
`override def sql: String = s""bit_count(${child.sql})""`

I don't think it's elegant enough.
Because `Expression` gives the following definitions.
```
  def sql: String = {
    val childrenSQL = children.map(_.sql).mkString("", "")
    s""$prettyName($childrenSQL)""
  }
```
By this definition, `BitwiseCount` should override `prettyName` method.
This PR will correct the issue for some function as follows:

- `TimeWindow`
- `MaxBy`
- `MinBy`
- `UnaryMinus`
- `BitwiseCount`

### Why are the changes needed?
Improve the implement of some expression.


### Does this PR introduce any user-facing change?
 'No'


### How was this patch tested?
Jenkins test.
",2020-04-09T07:14:57Z,2020-04-10T13:33:38Z,,,bfbd5994e29fdd622895916ca1de5aa0a3954d24,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28164/commits,https://api.github.com/repos/apache/spark/pulls/28164/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28164/comments,https://api.github.com/repos/apache/spark/statuses/67c868b64bc5727a640b27c266384598bc9f1e61,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:elegant-pretty-name-for-function,elegant-pretty-name-for-function,67c868b64bc5727a640b27c266384598bc9f1e61,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,d89fcc64dbe422fe8695d92d90b3448bad24c0fa,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28164,https://github.com/apache/spark/pull/28164,https://api.github.com/repos/apache/spark/issues/28164,https://api.github.com/repos/apache/spark/issues/28164/comments,https://api.github.com/repos/apache/spark/pulls/28164/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28164/commits,https://api.github.com/repos/apache/spark/statuses/67c868b64bc5727a640b27c266384598bc9f1e61
15,https://api.github.com/repos/apache/spark/pulls/28162,401246522,MDExOlB1bGxSZXF1ZXN0NDAxMjQ2NTIy,https://github.com/apache/spark/pull/28162,https://github.com/apache/spark/pull/28162.diff,https://github.com/apache/spark/pull/28162.patch,https://api.github.com/repos/apache/spark/issues/28162,28162,open,False,[SPARK-31391][SQL][TEST] Add AdaptiveTestUtils to ease the test of AQE,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This PR adds `AdaptiveTestUtils` to make AQE test simpler, which includes:

`IgnoreIfAdaptiveExecution` - a test tag to skip a single test case if AQE is enabled.
`EnableAdaptiveExecution` - a helper trait to enable AQE for all tests except those tagged with `IgnoreIfAdaptiveExecution`.
`DisableAdaptiveExecution` - a helper trait to disable AQE for all tests.
`assertExceptionMessage` - a method to handle message of normal or AQE exception in a consistent way.
`assertExceptionCause` - a method to handle cause of normal or AQE exception in a consistent way.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

With this utils, we can:
- reduce much more duplicate codes;
- handle normal or AQE exception in a consistent way;
- improve the stability of AQE tests;

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Updated tests with the util.
",2020-04-09T07:02:38Z,2020-04-10T13:49:06Z,,,8596eeb54d090bd4e42f315306fea255e0baae73,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28162/commits,https://api.github.com/repos/apache/spark/pulls/28162/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28162/comments,https://api.github.com/repos/apache/spark/statuses/9aaf73ff525dd2a8d4e94a564f77404a43398340,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:add_aqe_test_utils,add_aqe_test_utils,9aaf73ff525dd2a8d4e94a564f77404a43398340,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,d89fcc64dbe422fe8695d92d90b3448bad24c0fa,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28162,https://github.com/apache/spark/pull/28162,https://api.github.com/repos/apache/spark/issues/28162,https://api.github.com/repos/apache/spark/issues/28162/comments,https://api.github.com/repos/apache/spark/pulls/28162/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28162/commits,https://api.github.com/repos/apache/spark/statuses/9aaf73ff525dd2a8d4e94a564f77404a43398340
16,https://api.github.com/repos/apache/spark/pulls/28159,401192082,MDExOlB1bGxSZXF1ZXN0NDAxMTkyMDgy,https://github.com/apache/spark/pull/28159,https://github.com/apache/spark/pull/28159.diff,https://github.com/apache/spark/pull/28159.patch,https://api.github.com/repos/apache/spark/issues/28159,28159,open,False,[WIP][SPARK-31363][SQL] Add DataSourceRegisterV2,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
Add DataSourceRegisterV2, an alternative method for DataSourceV2 plugins to register themselves. The motivation is to add a layer of indirection between the data source registration and data source provider, so plugin developers have a chance choose at runtime which implementation Spark should use.  Discussion at:

http://apache-spark-developers-list.1001551.n3.nabble.com/DSv2-amp-DataSourceRegister-td29187.html

<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
As the DSv2 API evolves, some breaking changes are occasionally made to the API. It's possible to split a plugin into a ""common"" part and multiple version-specific parts and this works good to have a single artifact for users. The one part that can't be currently worked around is the DataSourceRegister trait. This is an issue because users cargo-cult configuration values, and choosing the wrong plugin version gives a particularly baroque error message that bubbles up through ServiceLoader.


<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No, developer only.
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Unit tests were added
",2020-04-09T03:50:09Z,2020-04-10T09:01:30Z,,,126bf0eb297bb83e0e65c7d9d22f07b8934cad6e,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28159/commits,https://api.github.com/repos/apache/spark/pulls/28159/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28159/comments,https://api.github.com/repos/apache/spark/statuses/ff6b14b5206347d4b2e8a372993440efef95030e,NONE,spark,apache,PerilousApricot,93354,MDQ6VXNlcjkzMzU0,https://avatars0.githubusercontent.com/u/93354?v=4,,https://api.github.com/users/PerilousApricot,https://github.com/PerilousApricot,https://api.github.com/users/PerilousApricot/followers,https://api.github.com/users/PerilousApricot/following{/other_user},https://api.github.com/users/PerilousApricot/gists{/gist_id},https://api.github.com/users/PerilousApricot/starred{/owner}{/repo},https://api.github.com/users/PerilousApricot/subscriptions,https://api.github.com/users/PerilousApricot/orgs,https://api.github.com/users/PerilousApricot/repos,https://api.github.com/users/PerilousApricot/events{/privacy},https://api.github.com/users/PerilousApricot/received_events,User,False,PerilousApricot:feature/registerv2,feature/registerv2,ff6b14b5206347d4b2e8a372993440efef95030e,PerilousApricot,93354,MDQ6VXNlcjkzMzU0,https://avatars0.githubusercontent.com/u/93354?v=4,,https://api.github.com/users/PerilousApricot,https://github.com/PerilousApricot,https://api.github.com/users/PerilousApricot/followers,https://api.github.com/users/PerilousApricot/following{/other_user},https://api.github.com/users/PerilousApricot/gists{/gist_id},https://api.github.com/users/PerilousApricot/starred{/owner}{/repo},https://api.github.com/users/PerilousApricot/subscriptions,https://api.github.com/users/PerilousApricot/orgs,https://api.github.com/users/PerilousApricot/repos,https://api.github.com/users/PerilousApricot/events{/privacy},https://api.github.com/users/PerilousApricot/received_events,User,False,254262187,MDEwOlJlcG9zaXRvcnkyNTQyNjIxODc=,spark,PerilousApricot/spark,False,PerilousApricot,93354,MDQ6VXNlcjkzMzU0,https://avatars0.githubusercontent.com/u/93354?v=4,,https://api.github.com/users/PerilousApricot,https://github.com/PerilousApricot,https://api.github.com/users/PerilousApricot/followers,https://api.github.com/users/PerilousApricot/following{/other_user},https://api.github.com/users/PerilousApricot/gists{/gist_id},https://api.github.com/users/PerilousApricot/starred{/owner}{/repo},https://api.github.com/users/PerilousApricot/subscriptions,https://api.github.com/users/PerilousApricot/orgs,https://api.github.com/users/PerilousApricot/repos,https://api.github.com/users/PerilousApricot/events{/privacy},https://api.github.com/users/PerilousApricot/received_events,User,False,https://github.com/PerilousApricot/spark,Apache Spark - A unified analytics engine for large-scale data processing,True,https://api.github.com/repos/PerilousApricot/spark,https://api.github.com/repos/PerilousApricot/spark/forks,https://api.github.com/repos/PerilousApricot/spark/keys{/key_id},https://api.github.com/repos/PerilousApricot/spark/collaborators{/collaborator},https://api.github.com/repos/PerilousApricot/spark/teams,https://api.github.com/repos/PerilousApricot/spark/hooks,https://api.github.com/repos/PerilousApricot/spark/issues/events{/number},https://api.github.com/repos/PerilousApricot/spark/events,https://api.github.com/repos/PerilousApricot/spark/assignees{/user},https://api.github.com/repos/PerilousApricot/spark/branches{/branch},https://api.github.com/repos/PerilousApricot/spark/tags,https://api.github.com/repos/PerilousApricot/spark/git/blobs{/sha},https://api.github.com/repos/PerilousApricot/spark/git/tags{/sha},https://api.github.com/repos/PerilousApricot/spark/git/refs{/sha},https://api.github.com/repos/PerilousApricot/spark/git/trees{/sha},https://api.github.com/repos/PerilousApricot/spark/statuses/{sha},https://api.github.com/repos/PerilousApricot/spark/languages,https://api.github.com/repos/PerilousApricot/spark/stargazers,https://api.github.com/repos/PerilousApricot/spark/contributors,https://api.github.com/repos/PerilousApricot/spark/subscribers,https://api.github.com/repos/PerilousApricot/spark/subscription,https://api.github.com/repos/PerilousApricot/spark/commits{/sha},https://api.github.com/repos/PerilousApricot/spark/git/commits{/sha},https://api.github.com/repos/PerilousApricot/spark/comments{/number},https://api.github.com/repos/PerilousApricot/spark/issues/comments{/number},https://api.github.com/repos/PerilousApricot/spark/contents/{+path},https://api.github.com/repos/PerilousApricot/spark/compare/{base}...{head},https://api.github.com/repos/PerilousApricot/spark/merges,https://api.github.com/repos/PerilousApricot/spark/{archive_format}{/ref},https://api.github.com/repos/PerilousApricot/spark/downloads,https://api.github.com/repos/PerilousApricot/spark/issues{/number},https://api.github.com/repos/PerilousApricot/spark/pulls{/number},https://api.github.com/repos/PerilousApricot/spark/milestones{/number},"https://api.github.com/repos/PerilousApricot/spark/notifications{?since,all,participating}",https://api.github.com/repos/PerilousApricot/spark/labels{/name},https://api.github.com/repos/PerilousApricot/spark/releases{/id},https://api.github.com/repos/PerilousApricot/spark/deployments,2020-04-09T03:30:03Z,2020-04-09T03:30:06Z,2020-04-10T09:01:29Z,git://github.com/PerilousApricot/spark.git,git@github.com:PerilousApricot/spark.git,https://github.com/PerilousApricot/spark.git,https://github.com/PerilousApricot/spark,https://spark.apache.org/,326797,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28159,https://github.com/apache/spark/pull/28159,https://api.github.com/repos/apache/spark/issues/28159,https://api.github.com/repos/apache/spark/issues/28159/comments,https://api.github.com/repos/apache/spark/pulls/28159/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28159/commits,https://api.github.com/repos/apache/spark/statuses/ff6b14b5206347d4b2e8a372993440efef95030e
17,https://api.github.com/repos/apache/spark/pulls/28157,401164406,MDExOlB1bGxSZXF1ZXN0NDAxMTY0NDA2,https://github.com/apache/spark/pull/28157,https://github.com/apache/spark/pull/28157.diff,https://github.com/apache/spark/pull/28157.patch,https://api.github.com/repos/apache/spark/issues/28157,28157,open,False,[SPARK-31390][SQL][DOCS] Document Window Function,"
### What changes were proposed in this pull request?
Document Window Function


### Why are the changes needed?
To make SQL reference complete


### Does this PR introduce any user-facing change?
Yes

<img width=""1050"" alt=""Screen Shot 2020-04-08 at 6 32 23 PM"" src=""https://user-images.githubusercontent.com/13592258/78849624-db214700-79c9-11ea-8dce-75c2f423895d.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-08 at 6 32 58 PM"" src=""https://user-images.githubusercontent.com/13592258/78849627-dd83a100-79c9-11ea-9131-e9ee20d22d53.png"">


<img width=""1049"" alt=""Screen Shot 2020-04-08 at 6 33 18 PM"" src=""https://user-images.githubusercontent.com/13592258/78849630-e07e9180-79c9-11ea-8ea2-84383a2a7bb5.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-08 at 6 33 52 PM"" src=""https://user-images.githubusercontent.com/13592258/78849633-e2485500-79c9-11ea-9ddf-ec09915612a4.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-08 at 6 34 17 PM"" src=""https://user-images.githubusercontent.com/13592258/78849641-e4aaaf00-79c9-11ea-99dc-703a7b1e1701.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-08 at 6 34 31 PM"" src=""https://user-images.githubusercontent.com/13592258/78849646-e70d0900-79c9-11ea-828e-1e44117b906e.png"">



### How was this patch tested?
Manually build and check
",2020-04-09T01:52:16Z,2020-04-10T05:13:06Z,,,088720a7758af4ecfa6668feb29d87c4f4421a2b,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28157/commits,https://api.github.com/repos/apache/spark/pulls/28157/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28157/comments,https://api.github.com/repos/apache/spark/statuses/36cbcb7168fd62b7f9acee320ae3809ec63f7cce,CONTRIBUTOR,spark,apache,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,huaxingao:window,window,36cbcb7168fd62b7f9acee320ae3809ec63f7cce,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,50813048,MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==,spark,huaxingao/spark,False,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,https://github.com/huaxingao/spark,Mirror of Apache Spark,True,https://api.github.com/repos/huaxingao/spark,https://api.github.com/repos/huaxingao/spark/forks,https://api.github.com/repos/huaxingao/spark/keys{/key_id},https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator},https://api.github.com/repos/huaxingao/spark/teams,https://api.github.com/repos/huaxingao/spark/hooks,https://api.github.com/repos/huaxingao/spark/issues/events{/number},https://api.github.com/repos/huaxingao/spark/events,https://api.github.com/repos/huaxingao/spark/assignees{/user},https://api.github.com/repos/huaxingao/spark/branches{/branch},https://api.github.com/repos/huaxingao/spark/tags,https://api.github.com/repos/huaxingao/spark/git/blobs{/sha},https://api.github.com/repos/huaxingao/spark/git/tags{/sha},https://api.github.com/repos/huaxingao/spark/git/refs{/sha},https://api.github.com/repos/huaxingao/spark/git/trees{/sha},https://api.github.com/repos/huaxingao/spark/statuses/{sha},https://api.github.com/repos/huaxingao/spark/languages,https://api.github.com/repos/huaxingao/spark/stargazers,https://api.github.com/repos/huaxingao/spark/contributors,https://api.github.com/repos/huaxingao/spark/subscribers,https://api.github.com/repos/huaxingao/spark/subscription,https://api.github.com/repos/huaxingao/spark/commits{/sha},https://api.github.com/repos/huaxingao/spark/git/commits{/sha},https://api.github.com/repos/huaxingao/spark/comments{/number},https://api.github.com/repos/huaxingao/spark/issues/comments{/number},https://api.github.com/repos/huaxingao/spark/contents/{+path},https://api.github.com/repos/huaxingao/spark/compare/{base}...{head},https://api.github.com/repos/huaxingao/spark/merges,https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref},https://api.github.com/repos/huaxingao/spark/downloads,https://api.github.com/repos/huaxingao/spark/issues{/number},https://api.github.com/repos/huaxingao/spark/pulls{/number},https://api.github.com/repos/huaxingao/spark/milestones{/number},"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}",https://api.github.com/repos/huaxingao/spark/labels{/name},https://api.github.com/repos/huaxingao/spark/releases{/id},https://api.github.com/repos/huaxingao/spark/deployments,2016-02-01T04:09:11Z,2020-04-10T00:47:54Z,2020-04-10T22:29:44Z,git://github.com/huaxingao/spark.git,git@github.com:huaxingao/spark.git,https://github.com/huaxingao/spark.git,https://github.com/huaxingao/spark,,312619,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ca2ba4fe647cd60668410b68014a3991ad7fd5c9,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28157,https://github.com/apache/spark/pull/28157,https://api.github.com/repos/apache/spark/issues/28157,https://api.github.com/repos/apache/spark/issues/28157/comments,https://api.github.com/repos/apache/spark/pulls/28157/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28157/commits,https://api.github.com/repos/apache/spark/statuses/36cbcb7168fd62b7f9acee320ae3809ec63f7cce
18,https://api.github.com/repos/apache/spark/pulls/28156,401000968,MDExOlB1bGxSZXF1ZXN0NDAxMDAwOTY4,https://github.com/apache/spark/pull/28156,https://github.com/apache/spark/pull/28156.diff,https://github.com/apache/spark/pull/28156.patch,https://api.github.com/repos/apache/spark/issues/28156,28156,open,False,[SPARK-31388][SQL][TESTS] org.apache.spark.sql.hive.thriftserver.CliSuite doesn't match results correctly,"### What changes were proposed in this pull request?

`CliSuite.runCliWithin` was not matching for expected results correctly. It was matching for expected lines anywhere in stdout or stderr.
On the example of `Single command with --database` test:
In
```
    runCliWithin(2.minute)(
      ""CREATE DATABASE hive_db_test;""
        -> """",
      ""USE hive_test;""
        -> """",
      ""CREATE TABLE hive_test(key INT, val STRING);""
        -> """",
      ""SHOW TABLES;""
        -> ""hive_test""
    )
```
It was looking for lines containing """", """", """" and then ""hive_test"".
However, the string ""hive_test"" was contained in ""hive_test_db"", and hence:
```
2020-04-08 17:53:12,752 INFO  CliSuite - 2020-04-08 17:53:12.752 - stderr> Spark master: local, Application Id: local-1586368384172
2020-04-08 17:53:12,765 INFO  CliSuite - stderr> found expected output line 0: """"
2020-04-08 17:53:12,765 INFO  CliSuite - 2020-04-08 17:53:12.765 - stdout> spark-sql> CREATE DATABASE hive_db_test;
2020-04-08 17:53:12,765 INFO  CliSuite - stdout> found expected output line 1: """"
2020-04-08 17:53:17,688 INFO  CliSuite - 2020-04-08 17:53:17.688 - stderr> chgrp: changing ownership of 'file:///tmp/spark-8811f069-4cba-4c71-a5d6-62dd925fb5ff': chown: changing group of '/tmp/spark-8811f069-4cba-4c71-a5d6-62dd925fb5ff': Operation not permitted
2020-04-08 17:53:12,765 INFO  CliSuite - stderr> found expected output line 2: """"
2020-04-08 17:53:18,069 INFO  CliSuite - 2020-04-08 17:53:18.069 - stderr> Time taken: 5.265 seconds
2020-04-08 17:53:18,087 INFO  CliSuite - 2020-04-08 17:53:18.087 - stdout> spark-sql> USE hive_test;
2020-04-08 17:53:12,765 INFO  CliSuite - stdout> found expected output line 3: ""hive_test""
2020-04-08 17:53:21,742 INFO  CliSuite - Found all expected output.
```
Because of that, it could kill the CLI process without really even creating the table. This was not expected. The test could be flaky depending on whether process.destroy() in the finally block managed to kill it before it actually creates the table.

I make the output checking more robust to not match on unexpected output, by making it check the echo of query output on the CLI. Also, wait for the CLI process to finish gracefully (triggered by closing its stdin), instead of killing it forcibly.

### Why are the changes needed?

org.apache.spark.sql.hive.thriftserver.CliSuite was flaky, and didn't test outputs as expected.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

Existing tests in CLISuite. Tested several times with no flakiness. Was getting flaky results almost on every run before.
```
[info] CliSuite:
[info] - load warehouse dir from hive-site.xml (12 seconds, 568 milliseconds)
[info] - load warehouse dir from --hiveconf (10 seconds, 648 milliseconds)
[info] - load warehouse dir from --conf spark(.hadoop).hive.* (20 seconds, 653 milliseconds)
[info] - load warehouse dir from spark.sql.warehouse.dir (9 seconds, 763 milliseconds)
[info] - Simple commands (16 seconds, 238 milliseconds)
[info] - Single command with -e (9 seconds, 967 milliseconds)
[info] - Single command with --database (21 seconds, 205 milliseconds)
[info] - Commands using SerDe provided in --jars (15 seconds, 51 milliseconds)
[info] - SPARK-29022: Commands using SerDe provided in --hive.aux.jars.path (14 seconds, 625 milliseconds)
[info] - SPARK-11188 Analysis error reporting (7 seconds, 960 milliseconds)
[info] - SPARK-11624 Spark SQL CLI should set sessionState only once (7 seconds, 424 milliseconds)
[info] - list jars (9 seconds, 520 milliseconds)
[info] - list jar <jarfile> (9 seconds, 277 milliseconds)
[info] - list files (9 seconds, 828 milliseconds)
[info] - list file <filepath> (9 seconds, 646 milliseconds)
[info] - apply hiveconf from cli command (9 seconds, 469 milliseconds)
[info] - Support hive.aux.jars.path (10 seconds, 676 milliseconds)
[info] - SPARK-28840 test --jars command (10 seconds, 921 milliseconds)
[info] - SPARK-28840 test --jars and hive.aux.jars.path command (11 seconds, 49 milliseconds)
[info] - SPARK-29022 Commands using SerDe provided in ADD JAR sql (14 seconds, 210 milliseconds)
[info] - SPARK-26321 Should not split semicolon within quoted string literals (12 seconds, 729 milliseconds)
[info] - Pad Decimal numbers with trailing zeros to the scale of the column (10 seconds, 381 milliseconds)
[info] - SPARK-30049 Should not complain for quotes in commented lines (10 seconds, 935 milliseconds)
[info] - SPARK-30049 Should not complain for quotes in commented with multi-lines (20 seconds, 731 milliseconds)
```",2020-04-08T18:12:47Z,2020-04-09T10:02:06Z,,,22149583078b502786c3e80ef081fbdd2daf86db,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406606402, 'node_id': 'MDU6TGFiZWwxNDA2NjA2NDAy', 'url': 'https://api.github.com/repos/apache/spark/labels/TESTS', 'name': 'TESTS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28156/commits,https://api.github.com/repos/apache/spark/pulls/28156/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28156/comments,https://api.github.com/repos/apache/spark/statuses/9bbfec06f3b0a174332609e11d2ed14b9e68c250,CONTRIBUTOR,spark,apache,juliuszsompolski,25019163,MDQ6VXNlcjI1MDE5MTYz,https://avatars0.githubusercontent.com/u/25019163?v=4,,https://api.github.com/users/juliuszsompolski,https://github.com/juliuszsompolski,https://api.github.com/users/juliuszsompolski/followers,https://api.github.com/users/juliuszsompolski/following{/other_user},https://api.github.com/users/juliuszsompolski/gists{/gist_id},https://api.github.com/users/juliuszsompolski/starred{/owner}{/repo},https://api.github.com/users/juliuszsompolski/subscriptions,https://api.github.com/users/juliuszsompolski/orgs,https://api.github.com/users/juliuszsompolski/repos,https://api.github.com/users/juliuszsompolski/events{/privacy},https://api.github.com/users/juliuszsompolski/received_events,User,False,juliuszsompolski:SPARK-31388,SPARK-31388,9bbfec06f3b0a174332609e11d2ed14b9e68c250,juliuszsompolski,25019163,MDQ6VXNlcjI1MDE5MTYz,https://avatars0.githubusercontent.com/u/25019163?v=4,,https://api.github.com/users/juliuszsompolski,https://github.com/juliuszsompolski,https://api.github.com/users/juliuszsompolski/followers,https://api.github.com/users/juliuszsompolski/following{/other_user},https://api.github.com/users/juliuszsompolski/gists{/gist_id},https://api.github.com/users/juliuszsompolski/starred{/owner}{/repo},https://api.github.com/users/juliuszsompolski/subscriptions,https://api.github.com/users/juliuszsompolski/orgs,https://api.github.com/users/juliuszsompolski/repos,https://api.github.com/users/juliuszsompolski/events{/privacy},https://api.github.com/users/juliuszsompolski/received_events,User,False,82301030,MDEwOlJlcG9zaXRvcnk4MjMwMTAzMA==,apache-spark,juliuszsompolski/apache-spark,False,juliuszsompolski,25019163,MDQ6VXNlcjI1MDE5MTYz,https://avatars0.githubusercontent.com/u/25019163?v=4,,https://api.github.com/users/juliuszsompolski,https://github.com/juliuszsompolski,https://api.github.com/users/juliuszsompolski/followers,https://api.github.com/users/juliuszsompolski/following{/other_user},https://api.github.com/users/juliuszsompolski/gists{/gist_id},https://api.github.com/users/juliuszsompolski/starred{/owner}{/repo},https://api.github.com/users/juliuszsompolski/subscriptions,https://api.github.com/users/juliuszsompolski/orgs,https://api.github.com/users/juliuszsompolski/repos,https://api.github.com/users/juliuszsompolski/events{/privacy},https://api.github.com/users/juliuszsompolski/received_events,User,False,https://github.com/juliuszsompolski/apache-spark,Mirror of Apache Spark,True,https://api.github.com/repos/juliuszsompolski/apache-spark,https://api.github.com/repos/juliuszsompolski/apache-spark/forks,https://api.github.com/repos/juliuszsompolski/apache-spark/keys{/key_id},https://api.github.com/repos/juliuszsompolski/apache-spark/collaborators{/collaborator},https://api.github.com/repos/juliuszsompolski/apache-spark/teams,https://api.github.com/repos/juliuszsompolski/apache-spark/hooks,https://api.github.com/repos/juliuszsompolski/apache-spark/issues/events{/number},https://api.github.com/repos/juliuszsompolski/apache-spark/events,https://api.github.com/repos/juliuszsompolski/apache-spark/assignees{/user},https://api.github.com/repos/juliuszsompolski/apache-spark/branches{/branch},https://api.github.com/repos/juliuszsompolski/apache-spark/tags,https://api.github.com/repos/juliuszsompolski/apache-spark/git/blobs{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/git/tags{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/git/refs{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/git/trees{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/statuses/{sha},https://api.github.com/repos/juliuszsompolski/apache-spark/languages,https://api.github.com/repos/juliuszsompolski/apache-spark/stargazers,https://api.github.com/repos/juliuszsompolski/apache-spark/contributors,https://api.github.com/repos/juliuszsompolski/apache-spark/subscribers,https://api.github.com/repos/juliuszsompolski/apache-spark/subscription,https://api.github.com/repos/juliuszsompolski/apache-spark/commits{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/git/commits{/sha},https://api.github.com/repos/juliuszsompolski/apache-spark/comments{/number},https://api.github.com/repos/juliuszsompolski/apache-spark/issues/comments{/number},https://api.github.com/repos/juliuszsompolski/apache-spark/contents/{+path},https://api.github.com/repos/juliuszsompolski/apache-spark/compare/{base}...{head},https://api.github.com/repos/juliuszsompolski/apache-spark/merges,https://api.github.com/repos/juliuszsompolski/apache-spark/{archive_format}{/ref},https://api.github.com/repos/juliuszsompolski/apache-spark/downloads,https://api.github.com/repos/juliuszsompolski/apache-spark/issues{/number},https://api.github.com/repos/juliuszsompolski/apache-spark/pulls{/number},https://api.github.com/repos/juliuszsompolski/apache-spark/milestones{/number},"https://api.github.com/repos/juliuszsompolski/apache-spark/notifications{?since,all,participating}",https://api.github.com/repos/juliuszsompolski/apache-spark/labels{/name},https://api.github.com/repos/juliuszsompolski/apache-spark/releases{/id},https://api.github.com/repos/juliuszsompolski/apache-spark/deployments,2017-02-17T13:42:06Z,2017-02-17T13:43:12Z,2020-04-09T09:21:51Z,git://github.com/juliuszsompolski/apache-spark.git,git@github.com:juliuszsompolski/apache-spark.git,https://github.com/juliuszsompolski/apache-spark.git,https://github.com/juliuszsompolski/apache-spark,,314039,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,5dc9b9c7c18b853cb3bdcb50041ef46888922308,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28156,https://github.com/apache/spark/pull/28156,https://api.github.com/repos/apache/spark/issues/28156,https://api.github.com/repos/apache/spark/issues/28156/comments,https://api.github.com/repos/apache/spark/pulls/28156/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28156/commits,https://api.github.com/repos/apache/spark/statuses/9bbfec06f3b0a174332609e11d2ed14b9e68c250
19,https://api.github.com/repos/apache/spark/pulls/28155,400999612,MDExOlB1bGxSZXF1ZXN0NDAwOTk5NjEy,https://github.com/apache/spark/pull/28155,https://github.com/apache/spark/pull/28155.diff,https://github.com/apache/spark/pull/28155.patch,https://api.github.com/repos/apache/spark/issues/28155,28155,open,False,[SPARK-31387] Handle unknown operation/session ID in HiveThriftServer2Listener,"

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

The update methods in HiveThriftServer2Listener now check if the parameter operation/session ID actually exist in the `sessionList` and `executionList` respectively. This prevents NullPointerExceptions if the operation or session ID is unknown. Instead, a warning is written to the log.

Also, in HiveSessionImpl.close(), we catch any exception thrown by `operationManager.closeOperation`. If for any reason this throws an exception, other operations are not prevented from being closed.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
The listener's update methods would throw an exception if the operation or session ID is unknown. In Spark 2, where the listener is called directly, this hampers with the caller's control flow. In Spark 3, the exception is caught by the ListenerBus but results in an uninformative NullPointerException.

In HiveSessionImpl.close(), if an exception is thrown when closing an operation, all following operations are not closed.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Unit tests",2020-04-08T18:09:39Z,2020-04-09T15:01:37Z,,,e3c34856a69fe57c3fb15f0bf16f80ad30ebc4b1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28155/commits,https://api.github.com/repos/apache/spark/pulls/28155/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28155/comments,https://api.github.com/repos/apache/spark/statuses/e65424e312d20d8c495fc8abdf6661d6480ce761,NONE,spark,apache,alismess-db,57817135,MDQ6VXNlcjU3ODE3MTM1,https://avatars3.githubusercontent.com/u/57817135?v=4,,https://api.github.com/users/alismess-db,https://github.com/alismess-db,https://api.github.com/users/alismess-db/followers,https://api.github.com/users/alismess-db/following{/other_user},https://api.github.com/users/alismess-db/gists{/gist_id},https://api.github.com/users/alismess-db/starred{/owner}{/repo},https://api.github.com/users/alismess-db/subscriptions,https://api.github.com/users/alismess-db/orgs,https://api.github.com/users/alismess-db/repos,https://api.github.com/users/alismess-db/events{/privacy},https://api.github.com/users/alismess-db/received_events,User,False,alismess-db:hive-thriftserver-listener-update-safer,hive-thriftserver-listener-update-safer,e65424e312d20d8c495fc8abdf6661d6480ce761,alismess-db,57817135,MDQ6VXNlcjU3ODE3MTM1,https://avatars3.githubusercontent.com/u/57817135?v=4,,https://api.github.com/users/alismess-db,https://github.com/alismess-db,https://api.github.com/users/alismess-db/followers,https://api.github.com/users/alismess-db/following{/other_user},https://api.github.com/users/alismess-db/gists{/gist_id},https://api.github.com/users/alismess-db/starred{/owner}{/repo},https://api.github.com/users/alismess-db/subscriptions,https://api.github.com/users/alismess-db/orgs,https://api.github.com/users/alismess-db/repos,https://api.github.com/users/alismess-db/events{/privacy},https://api.github.com/users/alismess-db/received_events,User,False,254159522,MDEwOlJlcG9zaXRvcnkyNTQxNTk1MjI=,spark,alismess-db/spark,False,alismess-db,57817135,MDQ6VXNlcjU3ODE3MTM1,https://avatars3.githubusercontent.com/u/57817135?v=4,,https://api.github.com/users/alismess-db,https://github.com/alismess-db,https://api.github.com/users/alismess-db/followers,https://api.github.com/users/alismess-db/following{/other_user},https://api.github.com/users/alismess-db/gists{/gist_id},https://api.github.com/users/alismess-db/starred{/owner}{/repo},https://api.github.com/users/alismess-db/subscriptions,https://api.github.com/users/alismess-db/orgs,https://api.github.com/users/alismess-db/repos,https://api.github.com/users/alismess-db/events{/privacy},https://api.github.com/users/alismess-db/received_events,User,False,https://github.com/alismess-db/spark,Apache Spark - A unified analytics engine for large-scale data processing,True,https://api.github.com/repos/alismess-db/spark,https://api.github.com/repos/alismess-db/spark/forks,https://api.github.com/repos/alismess-db/spark/keys{/key_id},https://api.github.com/repos/alismess-db/spark/collaborators{/collaborator},https://api.github.com/repos/alismess-db/spark/teams,https://api.github.com/repos/alismess-db/spark/hooks,https://api.github.com/repos/alismess-db/spark/issues/events{/number},https://api.github.com/repos/alismess-db/spark/events,https://api.github.com/repos/alismess-db/spark/assignees{/user},https://api.github.com/repos/alismess-db/spark/branches{/branch},https://api.github.com/repos/alismess-db/spark/tags,https://api.github.com/repos/alismess-db/spark/git/blobs{/sha},https://api.github.com/repos/alismess-db/spark/git/tags{/sha},https://api.github.com/repos/alismess-db/spark/git/refs{/sha},https://api.github.com/repos/alismess-db/spark/git/trees{/sha},https://api.github.com/repos/alismess-db/spark/statuses/{sha},https://api.github.com/repos/alismess-db/spark/languages,https://api.github.com/repos/alismess-db/spark/stargazers,https://api.github.com/repos/alismess-db/spark/contributors,https://api.github.com/repos/alismess-db/spark/subscribers,https://api.github.com/repos/alismess-db/spark/subscription,https://api.github.com/repos/alismess-db/spark/commits{/sha},https://api.github.com/repos/alismess-db/spark/git/commits{/sha},https://api.github.com/repos/alismess-db/spark/comments{/number},https://api.github.com/repos/alismess-db/spark/issues/comments{/number},https://api.github.com/repos/alismess-db/spark/contents/{+path},https://api.github.com/repos/alismess-db/spark/compare/{base}...{head},https://api.github.com/repos/alismess-db/spark/merges,https://api.github.com/repos/alismess-db/spark/{archive_format}{/ref},https://api.github.com/repos/alismess-db/spark/downloads,https://api.github.com/repos/alismess-db/spark/issues{/number},https://api.github.com/repos/alismess-db/spark/pulls{/number},https://api.github.com/repos/alismess-db/spark/milestones{/number},"https://api.github.com/repos/alismess-db/spark/notifications{?since,all,participating}",https://api.github.com/repos/alismess-db/spark/labels{/name},https://api.github.com/repos/alismess-db/spark/releases{/id},https://api.github.com/repos/alismess-db/spark/deployments,2020-04-08T17:45:14Z,2020-04-08T17:45:19Z,2020-04-08T18:03:24Z,git://github.com/alismess-db/spark.git,git@github.com:alismess-db/spark.git,https://github.com/alismess-db/spark.git,https://github.com/alismess-db/spark,https://spark.apache.org/,326847,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,5dc9b9c7c18b853cb3bdcb50041ef46888922308,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28155,https://github.com/apache/spark/pull/28155,https://api.github.com/repos/apache/spark/issues/28155,https://api.github.com/repos/apache/spark/issues/28155/comments,https://api.github.com/repos/apache/spark/pulls/28155/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28155/commits,https://api.github.com/repos/apache/spark/statuses/e65424e312d20d8c495fc8abdf6661d6480ce761
20,https://api.github.com/repos/apache/spark/pulls/28154,400817785,MDExOlB1bGxSZXF1ZXN0NDAwODE3Nzg1,https://github.com/apache/spark/pull/28154,https://github.com/apache/spark/pull/28154.diff,https://github.com/apache/spark/pull/28154.patch,https://api.github.com/repos/apache/spark/issues/28154,28154,open,False,[WIP][SPARK-31372][SQL] Check the validity of built-in function aliases,"### What changes were proposed in this pull request?
Although SPARK-30184 Implement a helper method for aliasing functions, developers always forget to using this improvement.
We need to add more powerful guarantees so that aliases outputed by built-in functions are correct.
This PR found four issue and resolved it.

- `ln`
- `negative`
- `div`
- `position`
- `bit_count`



### Why are the changes needed?
Ensure that the output alias is correct


### Does this PR introduce any user-facing change?
'No'.


### How was this patch tested?
Jenkins test.
",2020-04-08T12:27:07Z,2020-04-10T13:31:18Z,,,30ad6c6d1ff3e2b480e48d53d267a4344ecefffe,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28154/commits,https://api.github.com/repos/apache/spark/pulls/28154/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28154/comments,https://api.github.com/repos/apache/spark/statuses/1331c8d471ccdf42f5d9decbb83fb782ed71c193,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:check-fun-alias-valid,check-fun-alias-valid,1331c8d471ccdf42f5d9decbb83fb782ed71c193,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a2789c2a5179f6ed5613c24130bc80bf1bbfd753,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28154,https://github.com/apache/spark/pull/28154,https://api.github.com/repos/apache/spark/issues/28154,https://api.github.com/repos/apache/spark/issues/28154/comments,https://api.github.com/repos/apache/spark/pulls/28154/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28154/commits,https://api.github.com/repos/apache/spark/statuses/1331c8d471ccdf42f5d9decbb83fb782ed71c193
21,https://api.github.com/repos/apache/spark/pulls/28151,400690859,MDExOlB1bGxSZXF1ZXN0NDAwNjkwODU5,https://github.com/apache/spark/pull/28151,https://github.com/apache/spark/pull/28151.diff,https://github.com/apache/spark/pull/28151.patch,https://api.github.com/repos/apache/spark/issues/28151,28151,open,False,[SPARK-31383][SQL][DOC] Clean up the SQL documents in docs/sql-ref*,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR intends to clean up the SQL documents in `doc/sql-ref*`.
Main changes are as follows;

 - Fixes wrong syntaxes and capitalize sub-titles
 - Adds some DDL queries in `Examples` so that users can run examples there
 - Makes query output in `Examples` follows the `Dataset.showString` (right-aligned) format 
 - Adds/Removes spaces, Indents, or blank lines to follow the format below;

```
---
license...
---

### Description

Writes what's the syntax is.

### Syntax

{% highlight sql %}
SELECT...
    WHERE... // 4 indents after the second line
    ...
{% endhighlight %}

### Parameters

<dl>
  <!-- 2 indents in this section -->
  <dt><code><em>Param Name</em></code></dt>
  <dd>
    Param Description
  </dd>
  ...
</dl>

### Examples

{% highlight sql %}
-- It is better that users are able to execute example queries here.
-- So, we prepare test data in the first section if possible.
CREATE TABLE t (key STRING, value DOUBLE);
INSERT INTO t VALUES
    ('a', 1.0), ('a', 2.0), ('b', 3.0), ('c', 4.0);

-- query output has 2 indents and it follows the `Dataset.showString`
-- format (right-aligned).
SELECT * FROM t;
  +---+-----+
  |key|value|
  +---+-----+
  |  a|  1.0|
  |  a|  2.0|
  |  b|  3.0|
  |  c|  4.0|
  +---+-----+

-- Query statements after the second line have 4 indents.
SELECT key, SUM(value)
    FROM t
    GROUP BY key;
  +---+----------+                                                                
  |key|sum(value)|
  +---+----------+
  |  c|       4.0|
  |  b|       3.0|
  |  a|       3.0|
  +---+----------+
...
{% endhighlight %}

### Related Statements

 * [XXX](xxx.html)
 * ...
```

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
The most changes of this PR are pretty minor, but I think the consistent formats/rules to write documents are important for long-term maintenance in our community

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Manually checked.
",2020-04-08T08:00:12Z,2020-04-10T17:22:54Z,,,d37c43b462c2fcb4c5fcbc6937a9f57b8b99eed7,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28151/commits,https://api.github.com/repos/apache/spark/pulls/28151/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28151/comments,https://api.github.com/repos/apache/spark/statuses/945b28c51193017fb93b1d5e7710e1f7b14ae014,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:MakeRightAligned,MakeRightAligned,945b28c51193017fb93b1d5e7710e1f7b14ae014,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,148950fa2ba7ad03d7536c8c2201ba18b9345c0e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28151,https://github.com/apache/spark/pull/28151,https://api.github.com/repos/apache/spark/issues/28151,https://api.github.com/repos/apache/spark/issues/28151/comments,https://api.github.com/repos/apache/spark/pulls/28151/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28151/commits,https://api.github.com/repos/apache/spark/statuses/945b28c51193017fb93b1d5e7710e1f7b14ae014
22,https://api.github.com/repos/apache/spark/pulls/28148,400582191,MDExOlB1bGxSZXF1ZXN0NDAwNTgyMTkx,https://github.com/apache/spark/pull/28148,https://github.com/apache/spark/pull/28148.diff,https://github.com/apache/spark/pull/28148.patch,https://api.github.com/repos/apache/spark/issues/28148,28148,open,False,[WIP][SPARK-31381][SPARK-29245][SQL][test-hadoop3.2][test-java11] Upgrade built-in Hive 2.3.6 to 2.3.7,"### What changes were proposed in this pull request?

**Hive 2.3.7** fixed these issues:
- HIVE-21508: ClassCastException when initializing HiveMetaStoreClient on JDK10 or newer
- HIVE-21980:Parsing time can be high in case of deeply nested subqueries
- HIVE-22249: Support Parquet through HCatalog


### Why are the changes needed?
Fix CCE during creating HiveMetaStoreClient: [SPARK-29245](https://issues.apache.org/jira/browse/SPARK-29245).


### Does this PR introduce any user-facing change?
No.

### How was this patch tested?

- [x] Test Jenkins with Hadoop 2.7 (https://github.com/apache/spark/pull/28148#issuecomment-610915941)
- [ ] Test Jenkins with Hadoop 3.2 (https://github.com/apache/spark/pull/28148#issuecomment-612185227)
- [ ] Test Jenkins with Hadoop 3.2 on JDK11
- [ ] Manual test with remote hive metastore.

Hive side:

```
export JAVA_HOME=/usr/lib/jdk1.8.0_221
export PATH=$JAVA_HOME/bin:$PATH
cd /usr/lib/hive-2.3.6 # Start Hive metastore with Hive 2.3.6
bin/schematool -dbType derby -initSchema --verbose
bin/hive --service metastore
```

Spark side:

```
export JAVA_HOME=/usr/lib/jdk-11.0.3
export PATH=$JAVA_HOME/bin:$PATH
build/sbt clean package -Phive -Phadoop-3.2 -Phive-thriftserver
export SPARK_PREPEND_CLASSES=true
bin/spark-sql --conf spark.hadoop.hive.metastore.uris=thrift://localhost:9083
```
",2020-04-08T01:39:26Z,2020-04-10T22:59:11Z,,,ff3d8854f174ecc434eb7d32ade2714d01934d9f,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28148/commits,https://api.github.com/repos/apache/spark/pulls/28148/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28148/comments,https://api.github.com/repos/apache/spark/statuses/cf5f7c6a653523dc8b695eaffaf31f41e62f7adb,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-31381,SPARK-31381,cf5f7c6a653523dc8b695eaffaf31f41e62f7adb,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,8ab2a0c5f23a59c00a9b4191afd976af50d913ba,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28148,https://github.com/apache/spark/pull/28148,https://api.github.com/repos/apache/spark/issues/28148,https://api.github.com/repos/apache/spark/issues/28148/comments,https://api.github.com/repos/apache/spark/pulls/28148/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28148/commits,https://api.github.com/repos/apache/spark/statuses/cf5f7c6a653523dc8b695eaffaf31f41e62f7adb
23,https://api.github.com/repos/apache/spark/pulls/28147,400558221,MDExOlB1bGxSZXF1ZXN0NDAwNTU4MjIx,https://github.com/apache/spark/pull/28147,https://github.com/apache/spark/pull/28147.diff,https://github.com/apache/spark/pull/28147.patch,https://api.github.com/repos/apache/spark/issues/28147,28147,open,False,[SPARK-31357][SQL][WIP] Catalog API for view metadata,"### What changes were proposed in this pull request?

- View catalog interface
- View resolution rules
- View SQL DDL implementations

In this PR, ""view"" stands for persisted view by default.

These view SQL DDLs will be done in follow-up PRs:
- SHOW TBLPROPERTIES
- SHOW VIEWS

### Why are the changes needed?

Support view catalog in DataSourceV2. Details in [SPIP](https://docs.google.com/document/d/1XOxFtloiMuW24iqJ-zJnDzHl2KMxipTjJoxleJFz66A/edit?usp=sharing).

### Does this PR introduce any user-facing change?

- View SQL DDLs
- DataFrame.table(""catalog.db.view"")

### How was this patch tested?

TODO: new unit tests

Regression
- DDLParserSuite
- PlanResolutionSuite
- DataSourceV2SQLSuite",2020-04-07T23:57:03Z,2020-04-10T21:36:05Z,,,7a255b78695d62040bbf715bb6cf391fa2222369,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28147/commits,https://api.github.com/repos/apache/spark/pulls/28147/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28147/comments,https://api.github.com/repos/apache/spark/statuses/44678b12addada81d14f2d96bb4eb22927e70534,MEMBER,spark,apache,jzhuge,1883812,MDQ6VXNlcjE4ODM4MTI=,https://avatars2.githubusercontent.com/u/1883812?v=4,,https://api.github.com/users/jzhuge,https://github.com/jzhuge,https://api.github.com/users/jzhuge/followers,https://api.github.com/users/jzhuge/following{/other_user},https://api.github.com/users/jzhuge/gists{/gist_id},https://api.github.com/users/jzhuge/starred{/owner}{/repo},https://api.github.com/users/jzhuge/subscriptions,https://api.github.com/users/jzhuge/orgs,https://api.github.com/users/jzhuge/repos,https://api.github.com/users/jzhuge/events{/privacy},https://api.github.com/users/jzhuge/received_events,User,False,jzhuge:SPARK-31357,SPARK-31357,44678b12addada81d14f2d96bb4eb22927e70534,jzhuge,1883812,MDQ6VXNlcjE4ODM4MTI=,https://avatars2.githubusercontent.com/u/1883812?v=4,,https://api.github.com/users/jzhuge,https://github.com/jzhuge,https://api.github.com/users/jzhuge/followers,https://api.github.com/users/jzhuge/following{/other_user},https://api.github.com/users/jzhuge/gists{/gist_id},https://api.github.com/users/jzhuge/starred{/owner}{/repo},https://api.github.com/users/jzhuge/subscriptions,https://api.github.com/users/jzhuge/orgs,https://api.github.com/users/jzhuge/repos,https://api.github.com/users/jzhuge/events{/privacy},https://api.github.com/users/jzhuge/received_events,User,False,102246817,MDEwOlJlcG9zaXRvcnkxMDIyNDY4MTc=,spark,jzhuge/spark,False,jzhuge,1883812,MDQ6VXNlcjE4ODM4MTI=,https://avatars2.githubusercontent.com/u/1883812?v=4,,https://api.github.com/users/jzhuge,https://github.com/jzhuge,https://api.github.com/users/jzhuge/followers,https://api.github.com/users/jzhuge/following{/other_user},https://api.github.com/users/jzhuge/gists{/gist_id},https://api.github.com/users/jzhuge/starred{/owner}{/repo},https://api.github.com/users/jzhuge/subscriptions,https://api.github.com/users/jzhuge/orgs,https://api.github.com/users/jzhuge/repos,https://api.github.com/users/jzhuge/events{/privacy},https://api.github.com/users/jzhuge/received_events,User,False,https://github.com/jzhuge/spark,Mirror of Apache Spark,True,https://api.github.com/repos/jzhuge/spark,https://api.github.com/repos/jzhuge/spark/forks,https://api.github.com/repos/jzhuge/spark/keys{/key_id},https://api.github.com/repos/jzhuge/spark/collaborators{/collaborator},https://api.github.com/repos/jzhuge/spark/teams,https://api.github.com/repos/jzhuge/spark/hooks,https://api.github.com/repos/jzhuge/spark/issues/events{/number},https://api.github.com/repos/jzhuge/spark/events,https://api.github.com/repos/jzhuge/spark/assignees{/user},https://api.github.com/repos/jzhuge/spark/branches{/branch},https://api.github.com/repos/jzhuge/spark/tags,https://api.github.com/repos/jzhuge/spark/git/blobs{/sha},https://api.github.com/repos/jzhuge/spark/git/tags{/sha},https://api.github.com/repos/jzhuge/spark/git/refs{/sha},https://api.github.com/repos/jzhuge/spark/git/trees{/sha},https://api.github.com/repos/jzhuge/spark/statuses/{sha},https://api.github.com/repos/jzhuge/spark/languages,https://api.github.com/repos/jzhuge/spark/stargazers,https://api.github.com/repos/jzhuge/spark/contributors,https://api.github.com/repos/jzhuge/spark/subscribers,https://api.github.com/repos/jzhuge/spark/subscription,https://api.github.com/repos/jzhuge/spark/commits{/sha},https://api.github.com/repos/jzhuge/spark/git/commits{/sha},https://api.github.com/repos/jzhuge/spark/comments{/number},https://api.github.com/repos/jzhuge/spark/issues/comments{/number},https://api.github.com/repos/jzhuge/spark/contents/{+path},https://api.github.com/repos/jzhuge/spark/compare/{base}...{head},https://api.github.com/repos/jzhuge/spark/merges,https://api.github.com/repos/jzhuge/spark/{archive_format}{/ref},https://api.github.com/repos/jzhuge/spark/downloads,https://api.github.com/repos/jzhuge/spark/issues{/number},https://api.github.com/repos/jzhuge/spark/pulls{/number},https://api.github.com/repos/jzhuge/spark/milestones{/number},"https://api.github.com/repos/jzhuge/spark/notifications{?since,all,participating}",https://api.github.com/repos/jzhuge/spark/labels{/name},https://api.github.com/repos/jzhuge/spark/releases{/id},https://api.github.com/repos/jzhuge/spark/deployments,2017-09-03T06:57:08Z,2019-05-15T07:00:38Z,2020-04-10T17:03:25Z,git://github.com/jzhuge/spark.git,git@github.com:jzhuge/spark.git,https://github.com/jzhuge/spark.git,https://github.com/jzhuge/spark,,324402,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a3d83948b81cb5c47f6e084801373443f54747d8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28147,https://github.com/apache/spark/pull/28147,https://api.github.com/repos/apache/spark/issues/28147,https://api.github.com/repos/apache/spark/issues/28147/comments,https://api.github.com/repos/apache/spark/pulls/28147/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28147/commits,https://api.github.com/repos/apache/spark/statuses/44678b12addada81d14f2d96bb4eb22927e70534
24,https://api.github.com/repos/apache/spark/pulls/28138,399962742,MDExOlB1bGxSZXF1ZXN0Mzk5OTYyNzQy,https://github.com/apache/spark/pull/28138,https://github.com/apache/spark/pull/28138.diff,https://github.com/apache/spark/pull/28138.patch,https://api.github.com/repos/apache/spark/issues/28138,28138,open,False,[SPARK-31366][DOCS][SQL] Add doc for the aggregation in SQL reference guide,"
### What changes were proposed in this pull request?
Add aggregation doc in SQL reference, adding a structure to point to the CUBE, ROLLUP and GROUPING SETS part of aggregation and also the built-in aggregate functions.

### Why are the changes needed?
Needed for SQL Reference guide

### Does this PR introduce any user-facing change?
Yes. New doc.

![image](https://user-images.githubusercontent.com/16563220/78615526-a6c15580-7826-11ea-9205-5b5b3c608b44.png)


### How was this patch tested?
Manually by generating the doc.",2020-04-06T23:50:56Z,2020-04-07T00:52:57Z,,,150d69de77378104e31967b78f8c98859d0265ab,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28138/commits,https://api.github.com/repos/apache/spark/pulls/28138/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28138/comments,https://api.github.com/repos/apache/spark/statuses/37e16761d7263cd182627b28e72202cb2cd6e8cf,CONTRIBUTOR,spark,apache,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,skambha:aggdoc,aggdoc,37e16761d7263cd182627b28e72202cb2cd6e8cf,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,49237548,MDEwOlJlcG9zaXRvcnk0OTIzNzU0OA==,spark,skambha/spark,False,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,https://github.com/skambha/spark,Mirror of Apache Spark,True,https://api.github.com/repos/skambha/spark,https://api.github.com/repos/skambha/spark/forks,https://api.github.com/repos/skambha/spark/keys{/key_id},https://api.github.com/repos/skambha/spark/collaborators{/collaborator},https://api.github.com/repos/skambha/spark/teams,https://api.github.com/repos/skambha/spark/hooks,https://api.github.com/repos/skambha/spark/issues/events{/number},https://api.github.com/repos/skambha/spark/events,https://api.github.com/repos/skambha/spark/assignees{/user},https://api.github.com/repos/skambha/spark/branches{/branch},https://api.github.com/repos/skambha/spark/tags,https://api.github.com/repos/skambha/spark/git/blobs{/sha},https://api.github.com/repos/skambha/spark/git/tags{/sha},https://api.github.com/repos/skambha/spark/git/refs{/sha},https://api.github.com/repos/skambha/spark/git/trees{/sha},https://api.github.com/repos/skambha/spark/statuses/{sha},https://api.github.com/repos/skambha/spark/languages,https://api.github.com/repos/skambha/spark/stargazers,https://api.github.com/repos/skambha/spark/contributors,https://api.github.com/repos/skambha/spark/subscribers,https://api.github.com/repos/skambha/spark/subscription,https://api.github.com/repos/skambha/spark/commits{/sha},https://api.github.com/repos/skambha/spark/git/commits{/sha},https://api.github.com/repos/skambha/spark/comments{/number},https://api.github.com/repos/skambha/spark/issues/comments{/number},https://api.github.com/repos/skambha/spark/contents/{+path},https://api.github.com/repos/skambha/spark/compare/{base}...{head},https://api.github.com/repos/skambha/spark/merges,https://api.github.com/repos/skambha/spark/{archive_format}{/ref},https://api.github.com/repos/skambha/spark/downloads,https://api.github.com/repos/skambha/spark/issues{/number},https://api.github.com/repos/skambha/spark/pulls{/number},https://api.github.com/repos/skambha/spark/milestones{/number},"https://api.github.com/repos/skambha/spark/notifications{?since,all,participating}",https://api.github.com/repos/skambha/spark/labels{/name},https://api.github.com/repos/skambha/spark/releases{/id},https://api.github.com/repos/skambha/spark/deployments,2016-01-07T23:39:32Z,2019-01-29T18:39:30Z,2020-04-08T20:09:33Z,git://github.com/skambha/spark.git,git@github.com:skambha/spark.git,https://github.com/skambha/spark.git,https://github.com/skambha/spark,,305083,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f5250a581b765ef8c9044438b5d27461f843b7fd,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28138,https://github.com/apache/spark/pull/28138,https://api.github.com/repos/apache/spark/issues/28138,https://api.github.com/repos/apache/spark/issues/28138/comments,https://api.github.com/repos/apache/spark/pulls/28138/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28138/commits,https://api.github.com/repos/apache/spark/statuses/37e16761d7263cd182627b28e72202cb2cd6e8cf
25,https://api.github.com/repos/apache/spark/pulls/28137,399682325,MDExOlB1bGxSZXF1ZXN0Mzk5NjgyMzI1,https://github.com/apache/spark/pull/28137,https://github.com/apache/spark/pull/28137.diff,https://github.com/apache/spark/pull/28137.patch,https://api.github.com/repos/apache/spark/issues/28137,28137,open,False,[SPARK-31361][SQL] Rebase datetime in parquet/avro according to file written Spark version,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR makes two changes:
1. always write the datetime values to parquet/avro without rebasing
2. Do not rebase datetime values when reading parquet/avro, if we know the file written version and it's `> ""3.0""`.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
It's very easy to have mixed-calendar parquet/avro files: e.g. A user upgrades to Spark 3.0 and writes some parquet files to an existing directory. Then he realizes that the directory contains legacy datetime values before 1582. However, it's too late and he has to find out all the legacy files manually and read them separately.

To support mixed-calendar parquet/avro files, we need to decide to rebase or not based on the file written Spark version. After this, we can simplify the write side and never rebase.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Updated test",2020-04-06T14:21:55Z,2020-04-07T13:15:23Z,,,6d9d5d0875292b1527a370703730df8b88a7e83a,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28137/commits,https://api.github.com/repos/apache/spark/pulls/28137/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28137/comments,https://api.github.com/repos/apache/spark/statuses/829554925233803c17c72b08ec9096c3a1c41a15,CONTRIBUTOR,spark,apache,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,cloud-fan:datetime,datetime,829554925233803c17c72b08ec9096c3a1c41a15,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,19689699,MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==,spark,cloud-fan/spark,False,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,https://github.com/cloud-fan/spark,Mirror of Apache Spark,True,https://api.github.com/repos/cloud-fan/spark,https://api.github.com/repos/cloud-fan/spark/forks,https://api.github.com/repos/cloud-fan/spark/keys{/key_id},https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator},https://api.github.com/repos/cloud-fan/spark/teams,https://api.github.com/repos/cloud-fan/spark/hooks,https://api.github.com/repos/cloud-fan/spark/issues/events{/number},https://api.github.com/repos/cloud-fan/spark/events,https://api.github.com/repos/cloud-fan/spark/assignees{/user},https://api.github.com/repos/cloud-fan/spark/branches{/branch},https://api.github.com/repos/cloud-fan/spark/tags,https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha},https://api.github.com/repos/cloud-fan/spark/git/tags{/sha},https://api.github.com/repos/cloud-fan/spark/git/refs{/sha},https://api.github.com/repos/cloud-fan/spark/git/trees{/sha},https://api.github.com/repos/cloud-fan/spark/statuses/{sha},https://api.github.com/repos/cloud-fan/spark/languages,https://api.github.com/repos/cloud-fan/spark/stargazers,https://api.github.com/repos/cloud-fan/spark/contributors,https://api.github.com/repos/cloud-fan/spark/subscribers,https://api.github.com/repos/cloud-fan/spark/subscription,https://api.github.com/repos/cloud-fan/spark/commits{/sha},https://api.github.com/repos/cloud-fan/spark/git/commits{/sha},https://api.github.com/repos/cloud-fan/spark/comments{/number},https://api.github.com/repos/cloud-fan/spark/issues/comments{/number},https://api.github.com/repos/cloud-fan/spark/contents/{+path},https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head},https://api.github.com/repos/cloud-fan/spark/merges,https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref},https://api.github.com/repos/cloud-fan/spark/downloads,https://api.github.com/repos/cloud-fan/spark/issues{/number},https://api.github.com/repos/cloud-fan/spark/pulls{/number},https://api.github.com/repos/cloud-fan/spark/milestones{/number},"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}",https://api.github.com/repos/cloud-fan/spark/labels{/name},https://api.github.com/repos/cloud-fan/spark/releases{/id},https://api.github.com/repos/cloud-fan/spark/deployments,2014-05-12T07:32:26Z,2017-06-22T06:57:26Z,2020-04-10T08:35:09Z,git://github.com/cloud-fan/spark.git,git@github.com:cloud-fan/spark.git,https://github.com/cloud-fan/spark.git,https://github.com/cloud-fan/spark,,319781,1,1,Scala,False,True,True,False,False,1,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,1,1,master,apache:master,master,724d311ef0d5afb86eae020da67eb53ed57f291d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28137,https://github.com/apache/spark/pull/28137,https://api.github.com/repos/apache/spark/issues/28137,https://api.github.com/repos/apache/spark/issues/28137/comments,https://api.github.com/repos/apache/spark/pulls/28137/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28137/commits,https://api.github.com/repos/apache/spark/statuses/829554925233803c17c72b08ec9096c3a1c41a15
26,https://api.github.com/repos/apache/spark/pulls/28133,399333372,MDExOlB1bGxSZXF1ZXN0Mzk5MzMzMzcy,https://github.com/apache/spark/pull/28133,https://github.com/apache/spark/pull/28133.diff,https://github.com/apache/spark/pull/28133.patch,https://api.github.com/repos/apache/spark/issues/28133,28133,open,False,[SPARK-31156][SQL] DataFrameStatFunctions API to be consistent with respect to Column type,"### What changes were proposed in this pull request?

PR introduces overloaded methods for
* `stat.approxQuantile`
* `stat.corr`
* `stat.cov`
* `stat.crosstab`
* `stat.freqItems`

to work with arguments passed as `Column`s rather than column names.

### Why are the changes needed?

Some other functions from `StatFunctions` module already provide `Column`-based versions, namely:
* `stat.bloomFilter`
* `stat.countMinSketch`
* `stat.sampleBy`

The change proposed allows more flexible usage patterns along side with API consistency.

### Does this PR introduce any user-facing change?

Yes, new signatures for stat API functions.

### How was this patch tested?

Corresponding test cases are included.

### Thoughts

* Python and R API should probably also be revisited (I can do this in separate PR or include here)
* `stat.freqItems` with `Array` argument is overloaded, but `stat.freqItems` with Scala-only `Seq` API could not be overloaded to provide same functionality (because of type erasure)
* I decided to keep old versions of helper functions from `StatFunctions`, e.g. `pearsonCorrelation` and add new `pearsonCorrelationByColumn` (it seems like API is internal but it's public and removal of public method might introduce issues)
* `resolveColumn` helper introduces for `StatFunctions` should probably be the part of `Dataset` API (e.g. `Dataset.drop` uses quite the same approach when dealing with `Column` arguments), should I move it in this PR or create another one (don't want to put to many changes in a single bucket)?",2020-04-06T01:21:37Z,2020-04-07T13:15:06Z,,,23077f709a285154be0480b60e90cc1e145707ea,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28133/commits,https://api.github.com/repos/apache/spark/pulls/28133/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28133/comments,https://api.github.com/repos/apache/spark/statuses/c580634e16b246af621dce1abf0ed26fa8449bb2,CONTRIBUTOR,spark,apache,kachayev,485647,MDQ6VXNlcjQ4NTY0Nw==,https://avatars1.githubusercontent.com/u/485647?v=4,,https://api.github.com/users/kachayev,https://github.com/kachayev,https://api.github.com/users/kachayev/followers,https://api.github.com/users/kachayev/following{/other_user},https://api.github.com/users/kachayev/gists{/gist_id},https://api.github.com/users/kachayev/starred{/owner}{/repo},https://api.github.com/users/kachayev/subscriptions,https://api.github.com/users/kachayev/orgs,https://api.github.com/users/kachayev/repos,https://api.github.com/users/kachayev/events{/privacy},https://api.github.com/users/kachayev/received_events,User,False,kachayev:fix-31156,fix-31156,c580634e16b246af621dce1abf0ed26fa8449bb2,kachayev,485647,MDQ6VXNlcjQ4NTY0Nw==,https://avatars1.githubusercontent.com/u/485647?v=4,,https://api.github.com/users/kachayev,https://github.com/kachayev,https://api.github.com/users/kachayev/followers,https://api.github.com/users/kachayev/following{/other_user},https://api.github.com/users/kachayev/gists{/gist_id},https://api.github.com/users/kachayev/starred{/owner}{/repo},https://api.github.com/users/kachayev/subscriptions,https://api.github.com/users/kachayev/orgs,https://api.github.com/users/kachayev/repos,https://api.github.com/users/kachayev/events{/privacy},https://api.github.com/users/kachayev/received_events,User,False,244213711,MDEwOlJlcG9zaXRvcnkyNDQyMTM3MTE=,spark,kachayev/spark,False,kachayev,485647,MDQ6VXNlcjQ4NTY0Nw==,https://avatars1.githubusercontent.com/u/485647?v=4,,https://api.github.com/users/kachayev,https://github.com/kachayev,https://api.github.com/users/kachayev/followers,https://api.github.com/users/kachayev/following{/other_user},https://api.github.com/users/kachayev/gists{/gist_id},https://api.github.com/users/kachayev/starred{/owner}{/repo},https://api.github.com/users/kachayev/subscriptions,https://api.github.com/users/kachayev/orgs,https://api.github.com/users/kachayev/repos,https://api.github.com/users/kachayev/events{/privacy},https://api.github.com/users/kachayev/received_events,User,False,https://github.com/kachayev/spark,Apache Spark,True,https://api.github.com/repos/kachayev/spark,https://api.github.com/repos/kachayev/spark/forks,https://api.github.com/repos/kachayev/spark/keys{/key_id},https://api.github.com/repos/kachayev/spark/collaborators{/collaborator},https://api.github.com/repos/kachayev/spark/teams,https://api.github.com/repos/kachayev/spark/hooks,https://api.github.com/repos/kachayev/spark/issues/events{/number},https://api.github.com/repos/kachayev/spark/events,https://api.github.com/repos/kachayev/spark/assignees{/user},https://api.github.com/repos/kachayev/spark/branches{/branch},https://api.github.com/repos/kachayev/spark/tags,https://api.github.com/repos/kachayev/spark/git/blobs{/sha},https://api.github.com/repos/kachayev/spark/git/tags{/sha},https://api.github.com/repos/kachayev/spark/git/refs{/sha},https://api.github.com/repos/kachayev/spark/git/trees{/sha},https://api.github.com/repos/kachayev/spark/statuses/{sha},https://api.github.com/repos/kachayev/spark/languages,https://api.github.com/repos/kachayev/spark/stargazers,https://api.github.com/repos/kachayev/spark/contributors,https://api.github.com/repos/kachayev/spark/subscribers,https://api.github.com/repos/kachayev/spark/subscription,https://api.github.com/repos/kachayev/spark/commits{/sha},https://api.github.com/repos/kachayev/spark/git/commits{/sha},https://api.github.com/repos/kachayev/spark/comments{/number},https://api.github.com/repos/kachayev/spark/issues/comments{/number},https://api.github.com/repos/kachayev/spark/contents/{+path},https://api.github.com/repos/kachayev/spark/compare/{base}...{head},https://api.github.com/repos/kachayev/spark/merges,https://api.github.com/repos/kachayev/spark/{archive_format}{/ref},https://api.github.com/repos/kachayev/spark/downloads,https://api.github.com/repos/kachayev/spark/issues{/number},https://api.github.com/repos/kachayev/spark/pulls{/number},https://api.github.com/repos/kachayev/spark/milestones{/number},"https://api.github.com/repos/kachayev/spark/notifications{?since,all,participating}",https://api.github.com/repos/kachayev/spark/labels{/name},https://api.github.com/repos/kachayev/spark/releases{/id},https://api.github.com/repos/kachayev/spark/deployments,2020-03-01T19:52:24Z,2020-04-05T08:25:26Z,2020-04-07T05:46:33Z,git://github.com/kachayev/spark.git,git@github.com:kachayev/spark.git,https://github.com/kachayev/spark.git,https://github.com/kachayev/spark,,325567,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1f0287148977adb416001cb0988e919a2698c8e0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28133,https://github.com/apache/spark/pull/28133,https://api.github.com/repos/apache/spark/issues/28133,https://api.github.com/repos/apache/spark/issues/28133/comments,https://api.github.com/repos/apache/spark/pulls/28133/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28133/commits,https://api.github.com/repos/apache/spark/statuses/c580634e16b246af621dce1abf0ed26fa8449bb2
27,https://api.github.com/repos/apache/spark/pulls/28129,399150420,MDExOlB1bGxSZXF1ZXN0Mzk5MTUwNDIw,https://github.com/apache/spark/pull/28129,https://github.com/apache/spark/pull/28129.diff,https://github.com/apache/spark/pull/28129.patch,https://api.github.com/repos/apache/spark/issues/28129,28129,open,False,[SPARK-31346][SQL]Add new configuration to make sure temporary directory cleaned,"### Why are the changes needed?
In InsertIntoHiveTable and InsertIntoHiveDirCommand, we use deleteExternalTmpPath to clean temporary directories after Job committed and cancel deleteOnExit if succeeded. 
But sometimes (e.g., when speculative task is enabled), temporary directories may be left uncleaned. This is happened if there are still some tasks running after we called deleteExternalTmpPath. Thus it maybe necessary to keep deleteOnExit, even if temporary directory has already deleted, to make sure the temporary directories cleaned.

### How was this patch tested?
run tests
",2020-04-05T16:12:07Z,2020-04-08T16:19:40Z,,,95a57c0b7606af98d13ea12c3284c1d9927f3e99,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28129/commits,https://api.github.com/repos/apache/spark/pulls/28129/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28129/comments,https://api.github.com/repos/apache/spark/statuses/2f9dc05e7dbf5f1c6724407741137fcc6153e7d0,CONTRIBUTOR,spark,apache,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,stczwd:SPARK-31346,SPARK-31346,2f9dc05e7dbf5f1c6724407741137fcc6153e7d0,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,150664479,MDEwOlJlcG9zaXRvcnkxNTA2NjQ0Nzk=,spark,stczwd/spark,False,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,https://github.com/stczwd/spark,Mirror of Apache Spark,True,https://api.github.com/repos/stczwd/spark,https://api.github.com/repos/stczwd/spark/forks,https://api.github.com/repos/stczwd/spark/keys{/key_id},https://api.github.com/repos/stczwd/spark/collaborators{/collaborator},https://api.github.com/repos/stczwd/spark/teams,https://api.github.com/repos/stczwd/spark/hooks,https://api.github.com/repos/stczwd/spark/issues/events{/number},https://api.github.com/repos/stczwd/spark/events,https://api.github.com/repos/stczwd/spark/assignees{/user},https://api.github.com/repos/stczwd/spark/branches{/branch},https://api.github.com/repos/stczwd/spark/tags,https://api.github.com/repos/stczwd/spark/git/blobs{/sha},https://api.github.com/repos/stczwd/spark/git/tags{/sha},https://api.github.com/repos/stczwd/spark/git/refs{/sha},https://api.github.com/repos/stczwd/spark/git/trees{/sha},https://api.github.com/repos/stczwd/spark/statuses/{sha},https://api.github.com/repos/stczwd/spark/languages,https://api.github.com/repos/stczwd/spark/stargazers,https://api.github.com/repos/stczwd/spark/contributors,https://api.github.com/repos/stczwd/spark/subscribers,https://api.github.com/repos/stczwd/spark/subscription,https://api.github.com/repos/stczwd/spark/commits{/sha},https://api.github.com/repos/stczwd/spark/git/commits{/sha},https://api.github.com/repos/stczwd/spark/comments{/number},https://api.github.com/repos/stczwd/spark/issues/comments{/number},https://api.github.com/repos/stczwd/spark/contents/{+path},https://api.github.com/repos/stczwd/spark/compare/{base}...{head},https://api.github.com/repos/stczwd/spark/merges,https://api.github.com/repos/stczwd/spark/{archive_format}{/ref},https://api.github.com/repos/stczwd/spark/downloads,https://api.github.com/repos/stczwd/spark/issues{/number},https://api.github.com/repos/stczwd/spark/pulls{/number},https://api.github.com/repos/stczwd/spark/milestones{/number},"https://api.github.com/repos/stczwd/spark/notifications{?since,all,participating}",https://api.github.com/repos/stczwd/spark/labels{/name},https://api.github.com/repos/stczwd/spark/releases{/id},https://api.github.com/repos/stczwd/spark/deployments,2018-09-28T00:44:20Z,2020-04-02T16:27:02Z,2020-04-06T01:47:26Z,git://github.com/stczwd/spark.git,git@github.com:stczwd/spark.git,https://github.com/stczwd/spark.git,https://github.com/stczwd/spark,,323667,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9f58f0385758f31179943a681e4353eb9279cb20,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28129,https://github.com/apache/spark/pull/28129,https://api.github.com/repos/apache/spark/issues/28129,https://api.github.com/repos/apache/spark/issues/28129/comments,https://api.github.com/repos/apache/spark/pulls/28129/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28129/commits,https://api.github.com/repos/apache/spark/statuses/2f9dc05e7dbf5f1c6724407741137fcc6153e7d0
28,https://api.github.com/repos/apache/spark/pulls/28128,399111236,MDExOlB1bGxSZXF1ZXN0Mzk5MTExMjM2,https://github.com/apache/spark/pull/28128,https://github.com/apache/spark/pull/28128.diff,https://github.com/apache/spark/pull/28128.patch,https://api.github.com/repos/apache/spark/issues/28128,28128,open,False,[SPARK-31354] SparkSession Lifecycle methods to fix memory leak,"## What changes were proposed in this pull request?

This change was made as a result of the conversation on https://issues.apache.org/jira/browse/SPARK-31354 and is intended to continue work from that ticket here. 

This change introduces the new `terminate()` method on a `SparkSession` instance that marks the session as terminated, cleans up the listener state on the `SparkContext`, and marks the session instance as unusable. The purpose of this PR is 2-fold:
1. Many users have multi-tenant applications which contain multiple `SparkSession` instances. Currently these instances aren't cleaned up and a memory leak exists.
2. This PR also introduces framework to treat the SparkSessions as they were originally intended - lightweight and shortlived ""sessions"" that are easy to create and tear down. 

## How was this patch tested?

* Unit test included as a part of the PR ",2020-04-05T14:41:29Z,2020-04-08T05:47:05Z,,,1e8080ae4b630fb338ca6c332061623bffbb68a8,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28128/commits,https://api.github.com/repos/apache/spark/pulls/28128/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28128/comments,https://api.github.com/repos/apache/spark/statuses/99c5f6428b0322271bc0155ef1c71f37a3ba7ddc,NONE,spark,apache,vinooganesh,2461070,MDQ6VXNlcjI0NjEwNzA=,https://avatars0.githubusercontent.com/u/2461070?v=4,,https://api.github.com/users/vinooganesh,https://github.com/vinooganesh,https://api.github.com/users/vinooganesh/followers,https://api.github.com/users/vinooganesh/following{/other_user},https://api.github.com/users/vinooganesh/gists{/gist_id},https://api.github.com/users/vinooganesh/starred{/owner}{/repo},https://api.github.com/users/vinooganesh/subscriptions,https://api.github.com/users/vinooganesh/orgs,https://api.github.com/users/vinooganesh/repos,https://api.github.com/users/vinooganesh/events{/privacy},https://api.github.com/users/vinooganesh/received_events,User,False,vinooganesh:vinooganesh/SPARK-27958,vinooganesh/SPARK-27958,99c5f6428b0322271bc0155ef1c71f37a3ba7ddc,vinooganesh,2461070,MDQ6VXNlcjI0NjEwNzA=,https://avatars0.githubusercontent.com/u/2461070?v=4,,https://api.github.com/users/vinooganesh,https://github.com/vinooganesh,https://api.github.com/users/vinooganesh/followers,https://api.github.com/users/vinooganesh/following{/other_user},https://api.github.com/users/vinooganesh/gists{/gist_id},https://api.github.com/users/vinooganesh/starred{/owner}{/repo},https://api.github.com/users/vinooganesh/subscriptions,https://api.github.com/users/vinooganesh/orgs,https://api.github.com/users/vinooganesh/repos,https://api.github.com/users/vinooganesh/events{/privacy},https://api.github.com/users/vinooganesh/received_events,User,False,249066616,MDEwOlJlcG9zaXRvcnkyNDkwNjY2MTY=,spark,vinooganesh/spark,False,vinooganesh,2461070,MDQ6VXNlcjI0NjEwNzA=,https://avatars0.githubusercontent.com/u/2461070?v=4,,https://api.github.com/users/vinooganesh,https://github.com/vinooganesh,https://api.github.com/users/vinooganesh/followers,https://api.github.com/users/vinooganesh/following{/other_user},https://api.github.com/users/vinooganesh/gists{/gist_id},https://api.github.com/users/vinooganesh/starred{/owner}{/repo},https://api.github.com/users/vinooganesh/subscriptions,https://api.github.com/users/vinooganesh/orgs,https://api.github.com/users/vinooganesh/repos,https://api.github.com/users/vinooganesh/events{/privacy},https://api.github.com/users/vinooganesh/received_events,User,False,https://github.com/vinooganesh/spark,Apache Spark,True,https://api.github.com/repos/vinooganesh/spark,https://api.github.com/repos/vinooganesh/spark/forks,https://api.github.com/repos/vinooganesh/spark/keys{/key_id},https://api.github.com/repos/vinooganesh/spark/collaborators{/collaborator},https://api.github.com/repos/vinooganesh/spark/teams,https://api.github.com/repos/vinooganesh/spark/hooks,https://api.github.com/repos/vinooganesh/spark/issues/events{/number},https://api.github.com/repos/vinooganesh/spark/events,https://api.github.com/repos/vinooganesh/spark/assignees{/user},https://api.github.com/repos/vinooganesh/spark/branches{/branch},https://api.github.com/repos/vinooganesh/spark/tags,https://api.github.com/repos/vinooganesh/spark/git/blobs{/sha},https://api.github.com/repos/vinooganesh/spark/git/tags{/sha},https://api.github.com/repos/vinooganesh/spark/git/refs{/sha},https://api.github.com/repos/vinooganesh/spark/git/trees{/sha},https://api.github.com/repos/vinooganesh/spark/statuses/{sha},https://api.github.com/repos/vinooganesh/spark/languages,https://api.github.com/repos/vinooganesh/spark/stargazers,https://api.github.com/repos/vinooganesh/spark/contributors,https://api.github.com/repos/vinooganesh/spark/subscribers,https://api.github.com/repos/vinooganesh/spark/subscription,https://api.github.com/repos/vinooganesh/spark/commits{/sha},https://api.github.com/repos/vinooganesh/spark/git/commits{/sha},https://api.github.com/repos/vinooganesh/spark/comments{/number},https://api.github.com/repos/vinooganesh/spark/issues/comments{/number},https://api.github.com/repos/vinooganesh/spark/contents/{+path},https://api.github.com/repos/vinooganesh/spark/compare/{base}...{head},https://api.github.com/repos/vinooganesh/spark/merges,https://api.github.com/repos/vinooganesh/spark/{archive_format}{/ref},https://api.github.com/repos/vinooganesh/spark/downloads,https://api.github.com/repos/vinooganesh/spark/issues{/number},https://api.github.com/repos/vinooganesh/spark/pulls{/number},https://api.github.com/repos/vinooganesh/spark/milestones{/number},"https://api.github.com/repos/vinooganesh/spark/notifications{?since,all,participating}",https://api.github.com/repos/vinooganesh/spark/labels{/name},https://api.github.com/repos/vinooganesh/spark/releases{/id},https://api.github.com/repos/vinooganesh/spark/deployments,2020-03-21T21:47:16Z,2020-03-21T21:47:19Z,2020-04-05T14:50:37Z,git://github.com/vinooganesh/spark.git,git@github.com:vinooganesh/spark.git,https://github.com/vinooganesh/spark.git,https://github.com/vinooganesh/spark,,326053,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9f58f0385758f31179943a681e4353eb9279cb20,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28128,https://github.com/apache/spark/pull/28128,https://api.github.com/repos/apache/spark/issues/28128,https://api.github.com/repos/apache/spark/issues/28128/comments,https://api.github.com/repos/apache/spark/pulls/28128/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28128/commits,https://api.github.com/repos/apache/spark/statuses/99c5f6428b0322271bc0155ef1c71f37a3ba7ddc
29,https://api.github.com/repos/apache/spark/pulls/28123,398820816,MDExOlB1bGxSZXF1ZXN0Mzk4ODIwODE2,https://github.com/apache/spark/pull/28123,https://github.com/apache/spark/pull/28123.diff,https://github.com/apache/spark/pull/28123.patch,https://api.github.com/repos/apache/spark/issues/28123,28123,open,False,[SPARK-31350][SQL] Coalesce bucketed tables for join if applicable,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
When two bucketed tables with different number of buckets are joined, it can introduce a full shuffle:
```
spark.conf.set(""spark.sql.autoBroadcastJoinThreshold"", ""0"")
val df1 = (0 until 20).map(i => (i % 5, i % 13, i.toString)).toDF(""i"", ""j"", ""k"")
val df2 = (0 until 20).map(i => (i % 7, i % 11, i.toString)).toDF(""i"", ""j"", ""k"")
df1.write.format(""parquet"").bucketBy(8, ""i"").saveAsTable(""t1"")
df2.write.format(""parquet"").bucketBy(4, ""i"").saveAsTable(""t2"")
val t1 = spark.table(""t1"")
val t2 = spark.table(""t2"")
val joined = t1.join(t2, t1(""i"") === t2(""i""))
joined.explain


== Physical Plan ==
*(5) SortMergeJoin [i#44], [i#50], Inner
:- *(2) Sort [i#44 ASC NULLS FIRST], false, 0
:  +- Exchange hashpartitioning(i#44, 200), true, [id=#105]
:     +- *(1) Project [i#44, j#45, k#46]
:        +- *(1) Filter isnotnull(i#44)
:           +- *(1) ColumnarToRow
:              +- FileScan parquet default.t1[i#44,j#45,k#46] Batched: true, DataFilters: [isnotnull(i#44)], Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(i)], ReadSchema: struct<i:int,j:int,k:string>, SelectedBucketsCount: 8 out of 8
+- *(4) Sort [i#50 ASC NULLS FIRST], false, 0
   +- Exchange hashpartitioning(i#50, 200), true, [id=#115]
      +- *(3) Project [i#50, j#51, k#52]
         +- *(3) Filter isnotnull(i#50)
            +- *(3) ColumnarToRow
               +- FileScan parquet default.t2[i#50,j#51,k#52] Batched: true, DataFilters: [isnotnull(i#50)], Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(i)], ReadSchema: struct<i:int,j:int,k:string>, SelectedBucketsCount: 4 out of 4
```
This PR proposes to introduce coalescing buckets when the following conditions are met to eliminate the full shuffle:
- Join type is inner join
- The larger bucket number is divisible by the smaller bucket number.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
Eliminating the full shuffle can benefit for scenarios where two large tables are joined. Especially when the tables are already bucketed but differ in the number of buckets, we could take advantage of it.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
If a config `spark.sql.bucketing.coalesce` is set to `true` and the bucket coalescing conditions are met, a full shuffle can be eliminated:
```
spark.conf.set(""spark.sql.autoBroadcastJoinThreshold"", ""0"")
spark.conf.set(""spark.sql.bucketing.coalesce"", ""true"")
val df1 = (0 until 20).map(i => (i % 5, i % 13, i.toString)).toDF(""i"", ""j"", ""k"")
val df2 = (0 until 20).map(i => (i % 7, i % 11, i.toString)).toDF(""i"", ""j"", ""k"")
df1.write.format(""parquet"").bucketBy(8, ""i"").saveAsTable(""t1"")
df2.write.format(""parquet"").bucketBy(4, ""i"").saveAsTable(""t2"")
val t1 = spark.table(""t1"")
val t2 = spark.table(""t2"")
val joined = t1.join(t2, t1(""i"") === t2(""i""))
joined.explain

== Physical Plan ==
*(3) SortMergeJoin [i#44], [i#50], Inner
:- *(1) Sort [i#44 ASC NULLS FIRST], false, 0
:  +- *(1) Project [i#44, j#45, k#46]
:     +- *(1) Filter isnotnull(i#44)
:        +- *(1) ColumnarToRow
:           +- FileScan parquet default.t1[i#44,j#45,k#46] Batched: true, DataFilters: [isnotnull(i#44)], Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(i)], ReadSchema: struct<i:int,j:int,k:string>, SelectedBucketsCount: 8 out of 8
+- *(2) Sort [i#50 ASC NULLS FIRST], false, 0
   +- *(2) Project [i#50, j#51, k#52]
      +- *(2) Filter isnotnull(i#50)
         +- *(2) ColumnarToRow
            +- FileScan parquet default.t2[i#50,j#51,k#52] Batched: true, DataFilters: [isnotnull(i#50)], Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(i)], ReadSchema: struct<i:int,j:int,k:string>, SelectedBucketsCount: 4 out of 4
```

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Added unit tests",2020-04-04T23:48:48Z,2020-04-10T02:53:09Z,,,e132dddbb7e10caa0fc8892a063a5c3b4217c2c1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28123/commits,https://api.github.com/repos/apache/spark/pulls/28123/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28123/comments,https://api.github.com/repos/apache/spark/statuses/a15af6b3c55d76fb30614b03ec2b5c1f093e2ef2,CONTRIBUTOR,spark,apache,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,imback82:coalescing_bucket,coalescing_bucket,a15af6b3c55d76fb30614b03ec2b5c1f093e2ef2,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,190453549,MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=,spark-4,imback82/spark-4,False,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,https://github.com/imback82/spark-4,Apache Spark,True,https://api.github.com/repos/imback82/spark-4,https://api.github.com/repos/imback82/spark-4/forks,https://api.github.com/repos/imback82/spark-4/keys{/key_id},https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator},https://api.github.com/repos/imback82/spark-4/teams,https://api.github.com/repos/imback82/spark-4/hooks,https://api.github.com/repos/imback82/spark-4/issues/events{/number},https://api.github.com/repos/imback82/spark-4/events,https://api.github.com/repos/imback82/spark-4/assignees{/user},https://api.github.com/repos/imback82/spark-4/branches{/branch},https://api.github.com/repos/imback82/spark-4/tags,https://api.github.com/repos/imback82/spark-4/git/blobs{/sha},https://api.github.com/repos/imback82/spark-4/git/tags{/sha},https://api.github.com/repos/imback82/spark-4/git/refs{/sha},https://api.github.com/repos/imback82/spark-4/git/trees{/sha},https://api.github.com/repos/imback82/spark-4/statuses/{sha},https://api.github.com/repos/imback82/spark-4/languages,https://api.github.com/repos/imback82/spark-4/stargazers,https://api.github.com/repos/imback82/spark-4/contributors,https://api.github.com/repos/imback82/spark-4/subscribers,https://api.github.com/repos/imback82/spark-4/subscription,https://api.github.com/repos/imback82/spark-4/commits{/sha},https://api.github.com/repos/imback82/spark-4/git/commits{/sha},https://api.github.com/repos/imback82/spark-4/comments{/number},https://api.github.com/repos/imback82/spark-4/issues/comments{/number},https://api.github.com/repos/imback82/spark-4/contents/{+path},https://api.github.com/repos/imback82/spark-4/compare/{base}...{head},https://api.github.com/repos/imback82/spark-4/merges,https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref},https://api.github.com/repos/imback82/spark-4/downloads,https://api.github.com/repos/imback82/spark-4/issues{/number},https://api.github.com/repos/imback82/spark-4/pulls{/number},https://api.github.com/repos/imback82/spark-4/milestones{/number},"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}",https://api.github.com/repos/imback82/spark-4/labels{/name},https://api.github.com/repos/imback82/spark-4/releases{/id},https://api.github.com/repos/imback82/spark-4/deployments,2019-06-05T19:09:03Z,2020-04-04T00:25:57Z,2020-04-04T23:57:41Z,git://github.com/imback82/spark-4.git,git@github.com:imback82/spark-4.git,https://github.com/imback82/spark-4.git,https://github.com/imback82/spark-4,,325946,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9f58f0385758f31179943a681e4353eb9279cb20,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28123,https://github.com/apache/spark/pull/28123,https://api.github.com/repos/apache/spark/issues/28123,https://api.github.com/repos/apache/spark/issues/28123/comments,https://api.github.com/repos/apache/spark/pulls/28123/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28123/commits,https://api.github.com/repos/apache/spark/statuses/a15af6b3c55d76fb30614b03ec2b5c1f093e2ef2
30,https://api.github.com/repos/apache/spark/pulls/28121,398723210,MDExOlB1bGxSZXF1ZXN0Mzk4NzIzMjEw,https://github.com/apache/spark/pull/28121,https://github.com/apache/spark/pull/28121.diff,https://github.com/apache/spark/pull/28121.patch,https://api.github.com/repos/apache/spark/issues/28121,28121,open,False,[SPARK-31348][SQL][DOCS] Document Join in SQL Reference,"
### What changes were proposed in this pull request?
Document join in SQL Reference.

### Why are the changes needed?
To make SQL Reference complete.


### Does this PR introduce any user-facing change?
Yes
<img width=""1050"" alt=""Screen Shot 2020-04-05 at 8 46 47 PM"" src=""https://user-images.githubusercontent.com/13592258/78521722-ab7efe80-777f-11ea-90f5-1fac09282721.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-05 at 8 47 20 PM"" src=""https://user-images.githubusercontent.com/13592258/78521724-ade15880-777f-11ea-9238-183d999ed918.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-05 at 8 47 41 PM"" src=""https://user-images.githubusercontent.com/13592258/78521726-b043b280-777f-11ea-996f-a8e86d453c01.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-05 at 8 48 11 PM"" src=""https://user-images.githubusercontent.com/13592258/78521731-b3d73980-777f-11ea-85c8-c24798ef41ac.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-05 at 8 48 33 PM"" src=""https://user-images.githubusercontent.com/13592258/78521734-b5a0fd00-777f-11ea-8b2c-96af30f3bf49.png"">





### How was this patch tested?
Manually build and check.
",2020-04-04T20:14:02Z,2020-04-10T01:08:06Z,,,5a3babd490431715fa13a7bc920704d97c266cf5,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28121/commits,https://api.github.com/repos/apache/spark/pulls/28121/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28121/comments,https://api.github.com/repos/apache/spark/statuses/5ae2bf7bd453bed1529d41ab39ffca3e02705de6,CONTRIBUTOR,spark,apache,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,huaxingao:join,join,5ae2bf7bd453bed1529d41ab39ffca3e02705de6,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,50813048,MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==,spark,huaxingao/spark,False,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,https://github.com/huaxingao/spark,Mirror of Apache Spark,True,https://api.github.com/repos/huaxingao/spark,https://api.github.com/repos/huaxingao/spark/forks,https://api.github.com/repos/huaxingao/spark/keys{/key_id},https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator},https://api.github.com/repos/huaxingao/spark/teams,https://api.github.com/repos/huaxingao/spark/hooks,https://api.github.com/repos/huaxingao/spark/issues/events{/number},https://api.github.com/repos/huaxingao/spark/events,https://api.github.com/repos/huaxingao/spark/assignees{/user},https://api.github.com/repos/huaxingao/spark/branches{/branch},https://api.github.com/repos/huaxingao/spark/tags,https://api.github.com/repos/huaxingao/spark/git/blobs{/sha},https://api.github.com/repos/huaxingao/spark/git/tags{/sha},https://api.github.com/repos/huaxingao/spark/git/refs{/sha},https://api.github.com/repos/huaxingao/spark/git/trees{/sha},https://api.github.com/repos/huaxingao/spark/statuses/{sha},https://api.github.com/repos/huaxingao/spark/languages,https://api.github.com/repos/huaxingao/spark/stargazers,https://api.github.com/repos/huaxingao/spark/contributors,https://api.github.com/repos/huaxingao/spark/subscribers,https://api.github.com/repos/huaxingao/spark/subscription,https://api.github.com/repos/huaxingao/spark/commits{/sha},https://api.github.com/repos/huaxingao/spark/git/commits{/sha},https://api.github.com/repos/huaxingao/spark/comments{/number},https://api.github.com/repos/huaxingao/spark/issues/comments{/number},https://api.github.com/repos/huaxingao/spark/contents/{+path},https://api.github.com/repos/huaxingao/spark/compare/{base}...{head},https://api.github.com/repos/huaxingao/spark/merges,https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref},https://api.github.com/repos/huaxingao/spark/downloads,https://api.github.com/repos/huaxingao/spark/issues{/number},https://api.github.com/repos/huaxingao/spark/pulls{/number},https://api.github.com/repos/huaxingao/spark/milestones{/number},"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}",https://api.github.com/repos/huaxingao/spark/labels{/name},https://api.github.com/repos/huaxingao/spark/releases{/id},https://api.github.com/repos/huaxingao/spark/deployments,2016-02-01T04:09:11Z,2020-04-10T00:47:54Z,2020-04-10T22:29:44Z,git://github.com/huaxingao/spark.git,git@github.com:huaxingao/spark.git,https://github.com/huaxingao/spark.git,https://github.com/huaxingao/spark,,312619,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f69b0ef25df744f83c57c50735e8db9f6802e98c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28121,https://github.com/apache/spark/pull/28121,https://api.github.com/repos/apache/spark/issues/28121,https://api.github.com/repos/apache/spark/issues/28121/comments,https://api.github.com/repos/apache/spark/pulls/28121/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28121/commits,https://api.github.com/repos/apache/spark/statuses/5ae2bf7bd453bed1529d41ab39ffca3e02705de6
31,https://api.github.com/repos/apache/spark/pulls/28120,398707319,MDExOlB1bGxSZXF1ZXN0Mzk4NzA3MzE5,https://github.com/apache/spark/pull/28120,https://github.com/apache/spark/pull/28120.diff,https://github.com/apache/spark/pull/28120.patch,https://api.github.com/repos/apache/spark/issues/28120,28120,open,False,[SPARK-31349][SQL][DOCS] Document built-in aggregate functions in SQL Reference,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Document buildin aggregate functions
### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

To make SQL Reference complete
### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes
before:
None
After:
![Screen Shot 2020-04-04 at 12 37 16 PM](https://user-images.githubusercontent.com/7550280/78459974-e6930c00-7671-11ea-9703-2a9d7d4c22c0.png)
![Screen Shot 2020-04-04 at 12 37 41 PM](https://user-images.githubusercontent.com/7550280/78459977-ee52b080-7671-11ea-947b-c25900512763.png)
![Screen Shot 2020-04-04 at 12 37 54 PM](https://user-images.githubusercontent.com/7550280/78459984-fad70900-7671-11ea-8c52-a0775e91d2c9.png)
![Screen Shot 2020-04-04 at 12 38 12 PM](https://user-images.githubusercontent.com/7550280/78459986-fe6a9000-7671-11ea-83c1-ce75431fdeb3.png)
![Screen Shot 2020-04-04 at 12 38 28 PM](https://user-images.githubusercontent.com/7550280/78459992-04f90780-7672-11ea-8a3d-497cdce536d9.png)
![Screen Shot 2020-04-04 at 12 38 42 PM](https://user-images.githubusercontent.com/7550280/78459997-09bdbb80-7672-11ea-8ce1-347619166c2a.png)
![Screen Shot 2020-04-04 at 12 38 52 PM](https://user-images.githubusercontent.com/7550280/78459999-0d514280-7672-11ea-9e0c-5f812944feb3.png)
![Screen Shot 2020-04-04 at 12 39 06 PM](https://user-images.githubusercontent.com/7550280/78460006-180bd780-7672-11ea-9dcd-a08c6ec3e0c6.png)
![Screen Shot 2020-04-04 at 12 39 21 PM](https://user-images.githubusercontent.com/7550280/78460010-1cd08b80-7672-11ea-9cf3-becc1e43f36f.png)
![Screen Shot 2020-04-04 at 12 39 29 PM](https://user-images.githubusercontent.com/7550280/78460012-21953f80-7672-11ea-8ef0-94c47f60a345.png)



### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Manually build and check

Notes:
I list the aggregate function based on the `functionRegistry` aggregate functions session.
Here are the ones I didn't included, let me know if it is needed in this pr.
     - `cube`
     - `rollup` 
     - `grouping`
      - `grouping_id`
     -  `aggregate`",2020-04-04T19:53:45Z,2020-04-10T07:38:30Z,,,b45bb6460286b77fa4b41f239a975af5a88340c1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28120/commits,https://api.github.com/repos/apache/spark/pulls/28120/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28120/comments,https://api.github.com/repos/apache/spark/statuses/9e283b4d7759009b596345b76c5eb0d86dd175d3,CONTRIBUTOR,spark,apache,kevinyu98,7550280,MDQ6VXNlcjc1NTAyODA=,https://avatars3.githubusercontent.com/u/7550280?v=4,,https://api.github.com/users/kevinyu98,https://github.com/kevinyu98,https://api.github.com/users/kevinyu98/followers,https://api.github.com/users/kevinyu98/following{/other_user},https://api.github.com/users/kevinyu98/gists{/gist_id},https://api.github.com/users/kevinyu98/starred{/owner}{/repo},https://api.github.com/users/kevinyu98/subscriptions,https://api.github.com/users/kevinyu98/orgs,https://api.github.com/users/kevinyu98/repos,https://api.github.com/users/kevinyu98/events{/privacy},https://api.github.com/users/kevinyu98/received_events,User,False,kevinyu98:sql-ref-aggregate,sql-ref-aggregate,9e283b4d7759009b596345b76c5eb0d86dd175d3,kevinyu98,7550280,MDQ6VXNlcjc1NTAyODA=,https://avatars3.githubusercontent.com/u/7550280?v=4,,https://api.github.com/users/kevinyu98,https://github.com/kevinyu98,https://api.github.com/users/kevinyu98/followers,https://api.github.com/users/kevinyu98/following{/other_user},https://api.github.com/users/kevinyu98/gists{/gist_id},https://api.github.com/users/kevinyu98/starred{/owner}{/repo},https://api.github.com/users/kevinyu98/subscriptions,https://api.github.com/users/kevinyu98/orgs,https://api.github.com/users/kevinyu98/repos,https://api.github.com/users/kevinyu98/events{/privacy},https://api.github.com/users/kevinyu98/received_events,User,False,38393679,MDEwOlJlcG9zaXRvcnkzODM5MzY3OQ==,spark,kevinyu98/spark,False,kevinyu98,7550280,MDQ6VXNlcjc1NTAyODA=,https://avatars3.githubusercontent.com/u/7550280?v=4,,https://api.github.com/users/kevinyu98,https://github.com/kevinyu98,https://api.github.com/users/kevinyu98/followers,https://api.github.com/users/kevinyu98/following{/other_user},https://api.github.com/users/kevinyu98/gists{/gist_id},https://api.github.com/users/kevinyu98/starred{/owner}{/repo},https://api.github.com/users/kevinyu98/subscriptions,https://api.github.com/users/kevinyu98/orgs,https://api.github.com/users/kevinyu98/repos,https://api.github.com/users/kevinyu98/events{/privacy},https://api.github.com/users/kevinyu98/received_events,User,False,https://github.com/kevinyu98/spark,Mirror of Apache Spark,True,https://api.github.com/repos/kevinyu98/spark,https://api.github.com/repos/kevinyu98/spark/forks,https://api.github.com/repos/kevinyu98/spark/keys{/key_id},https://api.github.com/repos/kevinyu98/spark/collaborators{/collaborator},https://api.github.com/repos/kevinyu98/spark/teams,https://api.github.com/repos/kevinyu98/spark/hooks,https://api.github.com/repos/kevinyu98/spark/issues/events{/number},https://api.github.com/repos/kevinyu98/spark/events,https://api.github.com/repos/kevinyu98/spark/assignees{/user},https://api.github.com/repos/kevinyu98/spark/branches{/branch},https://api.github.com/repos/kevinyu98/spark/tags,https://api.github.com/repos/kevinyu98/spark/git/blobs{/sha},https://api.github.com/repos/kevinyu98/spark/git/tags{/sha},https://api.github.com/repos/kevinyu98/spark/git/refs{/sha},https://api.github.com/repos/kevinyu98/spark/git/trees{/sha},https://api.github.com/repos/kevinyu98/spark/statuses/{sha},https://api.github.com/repos/kevinyu98/spark/languages,https://api.github.com/repos/kevinyu98/spark/stargazers,https://api.github.com/repos/kevinyu98/spark/contributors,https://api.github.com/repos/kevinyu98/spark/subscribers,https://api.github.com/repos/kevinyu98/spark/subscription,https://api.github.com/repos/kevinyu98/spark/commits{/sha},https://api.github.com/repos/kevinyu98/spark/git/commits{/sha},https://api.github.com/repos/kevinyu98/spark/comments{/number},https://api.github.com/repos/kevinyu98/spark/issues/comments{/number},https://api.github.com/repos/kevinyu98/spark/contents/{+path},https://api.github.com/repos/kevinyu98/spark/compare/{base}...{head},https://api.github.com/repos/kevinyu98/spark/merges,https://api.github.com/repos/kevinyu98/spark/{archive_format}{/ref},https://api.github.com/repos/kevinyu98/spark/downloads,https://api.github.com/repos/kevinyu98/spark/issues{/number},https://api.github.com/repos/kevinyu98/spark/pulls{/number},https://api.github.com/repos/kevinyu98/spark/milestones{/number},"https://api.github.com/repos/kevinyu98/spark/notifications{?since,all,participating}",https://api.github.com/repos/kevinyu98/spark/labels{/name},https://api.github.com/repos/kevinyu98/spark/releases{/id},https://api.github.com/repos/kevinyu98/spark/deployments,2015-07-01T20:33:56Z,2020-04-04T01:24:24Z,2020-04-09T20:49:26Z,git://github.com/kevinyu98/spark.git,git@github.com:kevinyu98/spark.git,https://github.com/kevinyu98/spark.git,https://github.com/kevinyu98/spark,,300455,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9f58f0385758f31179943a681e4353eb9279cb20,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28120,https://github.com/apache/spark/pull/28120,https://api.github.com/repos/apache/spark/issues/28120,https://api.github.com/repos/apache/spark/issues/28120/comments,https://api.github.com/repos/apache/spark/pulls/28120/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28120/commits,https://api.github.com/repos/apache/spark/statuses/9e283b4d7759009b596345b76c5eb0d86dd175d3
32,https://api.github.com/repos/apache/spark/pulls/28117,398463899,MDExOlB1bGxSZXF1ZXN0Mzk4NDYzODk5,https://github.com/apache/spark/pull/28117,https://github.com/apache/spark/pull/28117.diff,https://github.com/apache/spark/pull/28117.patch,https://api.github.com/repos/apache/spark/issues/28117,28117,open,False,[SPARK-31344][CORE] Polish implementation of barrier() and allGather(),"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

1. Combine  `BarrierRequestToSync` and `AllGatherRequestToSync` into `RequestToSync`, which is distinguished by `RequestMethod` type.

2. Remove unnecessary Json serialization/deserialization

3. Clean up some codes to make runBarrier() and `BarrierCoordinator` more general

4. Remove unused imports.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

To make codes simpler for better maintain in the future.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

This is pure code refactor, so should be covered by existed tests.
",2020-04-04T03:58:26Z,2020-04-09T18:48:16Z,,,b8313b7230675deadd626cf3e0d8bacbe1822931,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28117/commits,https://api.github.com/repos/apache/spark/pulls/28117/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28117/comments,https://api.github.com/repos/apache/spark/statuses/e8d774b73c60a10cc9a554eca1e18e106366bced,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:refactor_barrier,refactor_barrier,e8d774b73c60a10cc9a554eca1e18e106366bced,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,9f58f0385758f31179943a681e4353eb9279cb20,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28117,https://github.com/apache/spark/pull/28117,https://api.github.com/repos/apache/spark/issues/28117,https://api.github.com/repos/apache/spark/issues/28117/comments,https://api.github.com/repos/apache/spark/pulls/28117/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28117/commits,https://api.github.com/repos/apache/spark/statuses/e8d774b73c60a10cc9a554eca1e18e106366bced
33,https://api.github.com/repos/apache/spark/pulls/28114,398313499,MDExOlB1bGxSZXF1ZXN0Mzk4MzEzNDk5,https://github.com/apache/spark/pull/28114,https://github.com/apache/spark/pull/28114.diff,https://github.com/apache/spark/pull/28114.patch,https://api.github.com/repos/apache/spark/issues/28114,28114,open,False,[SPARK-31330] Automatically label PRs based on the paths they touch,"### What changes were proposed in this pull request?

This PR adds some rules that will be used by Probot Auto Labeler to label PRs based on what paths they modify.

### Why are the changes needed?

This should make it easier for committers to organize PRs, and it could also help drive downstream tooling like the PR dashboard.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

We'll only be able to test it, I believe, after merging it in. Given that [the Avro project is using this same bot already](https://github.com/apache/avro/blob/master/.github/autolabeler.yml), I expect it will be straightforward to get this working.",2020-04-03T18:06:47Z,2020-04-10T22:53:42Z,,,80e82db6f120786008efb05acc6d6f41fb2e301d,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28114/commits,https://api.github.com/repos/apache/spark/pulls/28114/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28114/comments,https://api.github.com/repos/apache/spark/statuses/8228cf412faea0c3f53abe9aaa3e7c6cf0e22c89,CONTRIBUTOR,spark,apache,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,nchammas:SPARK-31330-auto-label-prs,SPARK-31330-auto-label-prs,8228cf412faea0c3f53abe9aaa3e7c6cf0e22c89,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,23797421,MDEwOlJlcG9zaXRvcnkyMzc5NzQyMQ==,spark,nchammas/spark,False,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,https://github.com/nchammas/spark,Mirror of Apache Spark,True,https://api.github.com/repos/nchammas/spark,https://api.github.com/repos/nchammas/spark/forks,https://api.github.com/repos/nchammas/spark/keys{/key_id},https://api.github.com/repos/nchammas/spark/collaborators{/collaborator},https://api.github.com/repos/nchammas/spark/teams,https://api.github.com/repos/nchammas/spark/hooks,https://api.github.com/repos/nchammas/spark/issues/events{/number},https://api.github.com/repos/nchammas/spark/events,https://api.github.com/repos/nchammas/spark/assignees{/user},https://api.github.com/repos/nchammas/spark/branches{/branch},https://api.github.com/repos/nchammas/spark/tags,https://api.github.com/repos/nchammas/spark/git/blobs{/sha},https://api.github.com/repos/nchammas/spark/git/tags{/sha},https://api.github.com/repos/nchammas/spark/git/refs{/sha},https://api.github.com/repos/nchammas/spark/git/trees{/sha},https://api.github.com/repos/nchammas/spark/statuses/{sha},https://api.github.com/repos/nchammas/spark/languages,https://api.github.com/repos/nchammas/spark/stargazers,https://api.github.com/repos/nchammas/spark/contributors,https://api.github.com/repos/nchammas/spark/subscribers,https://api.github.com/repos/nchammas/spark/subscription,https://api.github.com/repos/nchammas/spark/commits{/sha},https://api.github.com/repos/nchammas/spark/git/commits{/sha},https://api.github.com/repos/nchammas/spark/comments{/number},https://api.github.com/repos/nchammas/spark/issues/comments{/number},https://api.github.com/repos/nchammas/spark/contents/{+path},https://api.github.com/repos/nchammas/spark/compare/{base}...{head},https://api.github.com/repos/nchammas/spark/merges,https://api.github.com/repos/nchammas/spark/{archive_format}{/ref},https://api.github.com/repos/nchammas/spark/downloads,https://api.github.com/repos/nchammas/spark/issues{/number},https://api.github.com/repos/nchammas/spark/pulls{/number},https://api.github.com/repos/nchammas/spark/milestones{/number},"https://api.github.com/repos/nchammas/spark/notifications{?since,all,participating}",https://api.github.com/repos/nchammas/spark/labels{/name},https://api.github.com/repos/nchammas/spark/releases{/id},https://api.github.com/repos/nchammas/spark/deployments,2014-09-08T15:54:13Z,2020-03-16T15:41:14Z,2020-04-10T11:01:40Z,git://github.com/nchammas/spark.git,git@github.com:nchammas/spark.git,https://github.com/nchammas/spark.git,https://github.com/nchammas/spark,,295417,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,5d76b12e9b2ca0eb090c3c5145eee4cf78caba13,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28114,https://github.com/apache/spark/pull/28114,https://api.github.com/repos/apache/spark/issues/28114,https://api.github.com/repos/apache/spark/issues/28114/comments,https://api.github.com/repos/apache/spark/pulls/28114/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28114/commits,https://api.github.com/repos/apache/spark/statuses/8228cf412faea0c3f53abe9aaa3e7c6cf0e22c89
34,https://api.github.com/repos/apache/spark/pulls/28110,398096826,MDExOlB1bGxSZXF1ZXN0Mzk4MDk2ODI2,https://github.com/apache/spark/pull/28110,https://github.com/apache/spark/pull/28110.diff,https://github.com/apache/spark/pull/28110.patch,https://api.github.com/repos/apache/spark/issues/28110,28110,open,False,[SPARK-31339][WIP] L245: Changed PipelineModel(...) to self.cls(...),"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
L245: Changed PipelineModel(...) to self.cls(...)

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
This change fixes the loading of class (which inherits from PipelineModel class) from file.
E.g. Current issue:
```
CustomPipelineModel(PipelineModel):
    def _transform(self, df):
        ...
CustomPipelineModel.save('path/to/file')  # works
CustomPipelineModel.load('path/to/file')  # wrong: results in PipelineModel() instead of CustomPipelineModel()
CustomPipelineModel.transform() # wrong: results in calling PipelineModel.transform() instead of CustomPipelineModel.transform()
```

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
This is my first time contributing to Spark library. Still figuring out where and how to test this change. If someone can help, much appreciated.",2020-04-03T10:38:57Z,2020-04-06T09:52:29Z,,,6e1cd7d87da51709b923817e9155a1da1d54f69d,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28110/commits,https://api.github.com/repos/apache/spark/pulls/28110/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28110/comments,https://api.github.com/repos/apache/spark/statuses/e75213cc6b0df85fa099c3d96a85736dfc1911ba,NONE,spark,apache,surajiyer,9696966,MDQ6VXNlcjk2OTY5NjY=,https://avatars3.githubusercontent.com/u/9696966?v=4,,https://api.github.com/users/surajiyer,https://github.com/surajiyer,https://api.github.com/users/surajiyer/followers,https://api.github.com/users/surajiyer/following{/other_user},https://api.github.com/users/surajiyer/gists{/gist_id},https://api.github.com/users/surajiyer/starred{/owner}{/repo},https://api.github.com/users/surajiyer/subscriptions,https://api.github.com/users/surajiyer/orgs,https://api.github.com/users/surajiyer/repos,https://api.github.com/users/surajiyer/events{/privacy},https://api.github.com/users/surajiyer/received_events,User,False,surajiyer:surajiyer-fix_loading_PipelineModel_subclass_from_file,surajiyer-fix_loading_PipelineModel_subclass_from_file,e75213cc6b0df85fa099c3d96a85736dfc1911ba,surajiyer,9696966,MDQ6VXNlcjk2OTY5NjY=,https://avatars3.githubusercontent.com/u/9696966?v=4,,https://api.github.com/users/surajiyer,https://github.com/surajiyer,https://api.github.com/users/surajiyer/followers,https://api.github.com/users/surajiyer/following{/other_user},https://api.github.com/users/surajiyer/gists{/gist_id},https://api.github.com/users/surajiyer/starred{/owner}{/repo},https://api.github.com/users/surajiyer/subscriptions,https://api.github.com/users/surajiyer/orgs,https://api.github.com/users/surajiyer/repos,https://api.github.com/users/surajiyer/events{/privacy},https://api.github.com/users/surajiyer/received_events,User,False,252691184,MDEwOlJlcG9zaXRvcnkyNTI2OTExODQ=,spark,surajiyer/spark,False,surajiyer,9696966,MDQ6VXNlcjk2OTY5NjY=,https://avatars3.githubusercontent.com/u/9696966?v=4,,https://api.github.com/users/surajiyer,https://github.com/surajiyer,https://api.github.com/users/surajiyer/followers,https://api.github.com/users/surajiyer/following{/other_user},https://api.github.com/users/surajiyer/gists{/gist_id},https://api.github.com/users/surajiyer/starred{/owner}{/repo},https://api.github.com/users/surajiyer/subscriptions,https://api.github.com/users/surajiyer/orgs,https://api.github.com/users/surajiyer/repos,https://api.github.com/users/surajiyer/events{/privacy},https://api.github.com/users/surajiyer/received_events,User,False,https://github.com/surajiyer/spark,Apache Spark,True,https://api.github.com/repos/surajiyer/spark,https://api.github.com/repos/surajiyer/spark/forks,https://api.github.com/repos/surajiyer/spark/keys{/key_id},https://api.github.com/repos/surajiyer/spark/collaborators{/collaborator},https://api.github.com/repos/surajiyer/spark/teams,https://api.github.com/repos/surajiyer/spark/hooks,https://api.github.com/repos/surajiyer/spark/issues/events{/number},https://api.github.com/repos/surajiyer/spark/events,https://api.github.com/repos/surajiyer/spark/assignees{/user},https://api.github.com/repos/surajiyer/spark/branches{/branch},https://api.github.com/repos/surajiyer/spark/tags,https://api.github.com/repos/surajiyer/spark/git/blobs{/sha},https://api.github.com/repos/surajiyer/spark/git/tags{/sha},https://api.github.com/repos/surajiyer/spark/git/refs{/sha},https://api.github.com/repos/surajiyer/spark/git/trees{/sha},https://api.github.com/repos/surajiyer/spark/statuses/{sha},https://api.github.com/repos/surajiyer/spark/languages,https://api.github.com/repos/surajiyer/spark/stargazers,https://api.github.com/repos/surajiyer/spark/contributors,https://api.github.com/repos/surajiyer/spark/subscribers,https://api.github.com/repos/surajiyer/spark/subscription,https://api.github.com/repos/surajiyer/spark/commits{/sha},https://api.github.com/repos/surajiyer/spark/git/commits{/sha},https://api.github.com/repos/surajiyer/spark/comments{/number},https://api.github.com/repos/surajiyer/spark/issues/comments{/number},https://api.github.com/repos/surajiyer/spark/contents/{+path},https://api.github.com/repos/surajiyer/spark/compare/{base}...{head},https://api.github.com/repos/surajiyer/spark/merges,https://api.github.com/repos/surajiyer/spark/{archive_format}{/ref},https://api.github.com/repos/surajiyer/spark/downloads,https://api.github.com/repos/surajiyer/spark/issues{/number},https://api.github.com/repos/surajiyer/spark/pulls{/number},https://api.github.com/repos/surajiyer/spark/milestones{/number},"https://api.github.com/repos/surajiyer/spark/notifications{?since,all,participating}",https://api.github.com/repos/surajiyer/spark/labels{/name},https://api.github.com/repos/surajiyer/spark/releases{/id},https://api.github.com/repos/surajiyer/spark/deployments,2020-04-03T09:43:27Z,2020-04-03T09:43:29Z,2020-04-03T10:31:20Z,git://github.com/surajiyer/spark.git,git@github.com:surajiyer/spark.git,https://github.com/surajiyer/spark.git,https://github.com/surajiyer/spark,,326456,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a4fc6a6e98fcd7ea5ec7a006864ade855c4b5a59,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28110,https://github.com/apache/spark/pull/28110,https://api.github.com/repos/apache/spark/issues/28110,https://api.github.com/repos/apache/spark/issues/28110/comments,https://api.github.com/repos/apache/spark/pulls/28110/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28110/commits,https://api.github.com/repos/apache/spark/statuses/e75213cc6b0df85fa099c3d96a85736dfc1911ba
35,https://api.github.com/repos/apache/spark/pulls/28109,398041074,MDExOlB1bGxSZXF1ZXN0Mzk4MDQxMDc0,https://github.com/apache/spark/pull/28109,https://github.com/apache/spark/pull/28109.diff,https://github.com/apache/spark/pull/28109.patch,https://api.github.com/repos/apache/spark/issues/28109,28109,open,False,[SPARK-31253][SQL][followup]  Add metric to the split task number for skew optimization,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
This is a followup of [#28022](https://github.com/apache/spark/pull/28022), to add the metric info of split task number for skewed optimization.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
make UI more friendly
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
existing ut
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-04-03T08:41:20Z,2020-04-09T04:02:34Z,,,1cc3b54340d5df26cb063b03975edaafed1ab906,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28109/commits,https://api.github.com/repos/apache/spark/pulls/28109/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28109/comments,https://api.github.com/repos/apache/spark/statuses/e7de94cb98b429e29e9af95cd987a805c04dec70,CONTRIBUTOR,spark,apache,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,JkSelf:addSplitNumer,addSplitNumer,e7de94cb98b429e29e9af95cd987a805c04dec70,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,159634260,MDEwOlJlcG9zaXRvcnkxNTk2MzQyNjA=,spark,JkSelf/spark,False,JkSelf,11972570,MDQ6VXNlcjExOTcyNTcw,https://avatars2.githubusercontent.com/u/11972570?v=4,,https://api.github.com/users/JkSelf,https://github.com/JkSelf,https://api.github.com/users/JkSelf/followers,https://api.github.com/users/JkSelf/following{/other_user},https://api.github.com/users/JkSelf/gists{/gist_id},https://api.github.com/users/JkSelf/starred{/owner}{/repo},https://api.github.com/users/JkSelf/subscriptions,https://api.github.com/users/JkSelf/orgs,https://api.github.com/users/JkSelf/repos,https://api.github.com/users/JkSelf/events{/privacy},https://api.github.com/users/JkSelf/received_events,User,False,https://github.com/JkSelf/spark,Mirror of Apache Spark,True,https://api.github.com/repos/JkSelf/spark,https://api.github.com/repos/JkSelf/spark/forks,https://api.github.com/repos/JkSelf/spark/keys{/key_id},https://api.github.com/repos/JkSelf/spark/collaborators{/collaborator},https://api.github.com/repos/JkSelf/spark/teams,https://api.github.com/repos/JkSelf/spark/hooks,https://api.github.com/repos/JkSelf/spark/issues/events{/number},https://api.github.com/repos/JkSelf/spark/events,https://api.github.com/repos/JkSelf/spark/assignees{/user},https://api.github.com/repos/JkSelf/spark/branches{/branch},https://api.github.com/repos/JkSelf/spark/tags,https://api.github.com/repos/JkSelf/spark/git/blobs{/sha},https://api.github.com/repos/JkSelf/spark/git/tags{/sha},https://api.github.com/repos/JkSelf/spark/git/refs{/sha},https://api.github.com/repos/JkSelf/spark/git/trees{/sha},https://api.github.com/repos/JkSelf/spark/statuses/{sha},https://api.github.com/repos/JkSelf/spark/languages,https://api.github.com/repos/JkSelf/spark/stargazers,https://api.github.com/repos/JkSelf/spark/contributors,https://api.github.com/repos/JkSelf/spark/subscribers,https://api.github.com/repos/JkSelf/spark/subscription,https://api.github.com/repos/JkSelf/spark/commits{/sha},https://api.github.com/repos/JkSelf/spark/git/commits{/sha},https://api.github.com/repos/JkSelf/spark/comments{/number},https://api.github.com/repos/JkSelf/spark/issues/comments{/number},https://api.github.com/repos/JkSelf/spark/contents/{+path},https://api.github.com/repos/JkSelf/spark/compare/{base}...{head},https://api.github.com/repos/JkSelf/spark/merges,https://api.github.com/repos/JkSelf/spark/{archive_format}{/ref},https://api.github.com/repos/JkSelf/spark/downloads,https://api.github.com/repos/JkSelf/spark/issues{/number},https://api.github.com/repos/JkSelf/spark/pulls{/number},https://api.github.com/repos/JkSelf/spark/milestones{/number},"https://api.github.com/repos/JkSelf/spark/notifications{?since,all,participating}",https://api.github.com/repos/JkSelf/spark/labels{/name},https://api.github.com/repos/JkSelf/spark/releases{/id},https://api.github.com/repos/JkSelf/spark/deployments,2018-11-29T08:40:39Z,2020-02-18T05:52:18Z,2020-04-10T09:27:16Z,git://github.com/JkSelf/spark.git,git@github.com:JkSelf/spark.git,https://github.com/JkSelf/spark.git,https://github.com/JkSelf/spark,,322143,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a4fc6a6e98fcd7ea5ec7a006864ade855c4b5a59,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28109,https://github.com/apache/spark/pull/28109,https://api.github.com/repos/apache/spark/issues/28109,https://api.github.com/repos/apache/spark/issues/28109/comments,https://api.github.com/repos/apache/spark/pulls/28109/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28109/commits,https://api.github.com/repos/apache/spark/statuses/e7de94cb98b429e29e9af95cd987a805c04dec70
36,https://api.github.com/repos/apache/spark/pulls/28107,398037114,MDExOlB1bGxSZXF1ZXN0Mzk4MDM3MTE0,https://github.com/apache/spark/pull/28107,https://github.com/apache/spark/pull/28107.diff,https://github.com/apache/spark/pull/28107.patch,https://api.github.com/repos/apache/spark/issues/28107,28107,open,False,[SPARK-31334][SQL] Don't ResolveReference/ResolveMissingReference when Filter condition with aggregate expression,"### What changes were proposed in this pull request?
As I have show in https://issues.apache.org/jira/browse/SPARK-31334 's description,  same type of sql,  when one column type is different as string, catalyst can't analyze it right. 


For test sql 
```
test(""xxxxxxxx"") {
    Seq(
      (""1"", ""3""),
      (""2"", ""3""),
      (""3"", ""6""),
      (""4"", ""7""),
      (""5"", ""9""),
      (""6"", ""9"")
    ).toDF(""a"", ""b"").createOrReplaceTempView(""testData"")

    val x = sql(
      """"""
        | SELECT b, sum(a) as a
        | FROM testData
        | GROUP BY b
        | HAVING sum(a) > 3
      """""".stripMargin)

    x.explain()
    x.show()
  }
```
When analyze having clause's condition  by ResolveAggregateFunctions 
```
'Filter ('sum('a) > 3)
+- Aggregate [b#181], [b#181, sum(a#180) AS a#184L]
   +- SubqueryAlias `testdata`
      +- Project [_1#177 AS a#180, _2#178 AS b#181]
         +- LocalRelation [_1#177, _2#178]
```
Since `a` is StringType type and then aggregation's `agg` expression is unresolved (Because Sum. checkInputDataTypes() need NumericType, but `a` is StringType),  so  ResolveAggregateFunctions won't make a change on above LogicalPlan, then `sum(a)` in Filter condition will be resolved in ResolveReference and this a will be resolved as aggregation's output column a#184 , then error happened .

### Why are the changes needed?
Fix bug in analyzer

### Does this PR introduce any user-facing change?
NO


### How was this patch tested?
Added UT
",2020-04-03T08:32:49Z,2020-04-06T14:21:06Z,,,e574273aab41ad18b36cd399228b42758d6f84c1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28107/commits,https://api.github.com/repos/apache/spark/pulls/28107/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28107/comments,https://api.github.com/repos/apache/spark/statuses/20febcefcf88f02c6188a119722be70085a0a17c,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:agg-column-same-as-col-and-having-use-it,agg-column-same-as-col-and-having-use-it,20febcefcf88f02c6188a119722be70085a0a17c,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,a4fc6a6e98fcd7ea5ec7a006864ade855c4b5a59,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28107,https://github.com/apache/spark/pull/28107,https://api.github.com/repos/apache/spark/issues/28107,https://api.github.com/repos/apache/spark/issues/28107/comments,https://api.github.com/repos/apache/spark/pulls/28107/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28107/commits,https://api.github.com/repos/apache/spark/statuses/20febcefcf88f02c6188a119722be70085a0a17c
37,https://api.github.com/repos/apache/spark/pulls/28106,398014018,MDExOlB1bGxSZXF1ZXN0Mzk4MDE0MDE4,https://github.com/apache/spark/pull/28106,https://github.com/apache/spark/pull/28106.diff,https://github.com/apache/spark/pull/28106.patch,https://api.github.com/repos/apache/spark/issues/28106,28106,open,False,[SPARK-31335][SQL] Add try function support,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?

Add a TRY function that evaluates an expression and handles certain types of execution errors by returning NULL.
In cases where it is preferable that queries produce NULL instead of failing when corrupt or invalid data is encountered, the TRY function may be useful especially when ANSI mode is on and the users need null-tolerant on certain columns or outputs.

AnalysisExceptions will not be handled by this, typically errors handled by TRY function are: 

      * Division by zero,
      * Invalid casting,
      * Numeric value out of range,
      * e.t.c


### Why are the changes needed?

In most cases of ANSI mode and few scenarios of non-ANSI mode, we will fail when an expression meets invalid or corrupt data. This behavior covers the whole SQL lifecycle and outputs. This is not very flexible for users when there  are not ALL columns need to be that much strict, e.g.
e.g. 
```sql
select
 cast(str1 as timestamp) as start,
 cast(str2 as timestamp) as end, 
cast(str3 as timestamp) as comment
from ....
```
the `cast(str3 as timestamp) as comment` may not be that important to fail the entire query, then we can use `try(cast(str3 as timestamp)) as comment` to make it nullable.

TRY function offers a much more fine-grained way than `spark.sql.ansi.enabled`, which controls output with null or error per attribute. 

Also, this function could make expression conjunctions much safer. e.g. COALESCE 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

yes, add a new try function support.
### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
add uts",2020-04-03T07:44:43Z,2020-04-10T22:01:06Z,,,3941e968f317632384282c09a5f7eb797eced7a2,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28106/commits,https://api.github.com/repos/apache/spark/pulls/28106/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28106/comments,https://api.github.com/repos/apache/spark/statuses/3feb200a91a566caaada3c375e4dc3f233651965,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:SPARK-31335,SPARK-31335,3feb200a91a566caaada3c375e4dc3f233651965,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,a4fc6a6e98fcd7ea5ec7a006864ade855c4b5a59,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28106,https://github.com/apache/spark/pull/28106,https://api.github.com/repos/apache/spark/issues/28106,https://api.github.com/repos/apache/spark/issues/28106/comments,https://api.github.com/repos/apache/spark/pulls/28106/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28106/commits,https://api.github.com/repos/apache/spark/statuses/3feb200a91a566caaada3c375e4dc3f233651965
38,https://api.github.com/repos/apache/spark/pulls/28098,397364365,MDExOlB1bGxSZXF1ZXN0Mzk3MzY0MzY1,https://github.com/apache/spark/pull/28098,https://github.com/apache/spark/pull/28098.diff,https://github.com/apache/spark/pull/28098.patch,https://api.github.com/repos/apache/spark/issues/28098,28098,open,False,[SPARK-30973][SQL]ScriptTransformationExec should wait for the termination,"### What changes were proposed in this pull request?
In  `org.apache.spark.sql.hive.execution.ScriptTransformationExec`, when check error, sometimes we can't catch write error in subproc, when call `checkFailureAndPropagate` we should always wait for subproc stop

For UT I added, when without code change in ScriptTransformExec will always got error like below
![image](https://user-images.githubusercontent.com/46485123/78213693-f7af1200-74e5-11ea-9e14-9b11c51c451b.png)

### Why are the changes needed?
Catch error in script transform


### Does this PR introduce any user-facing change?
NO

### How was this patch tested?
Added UT",2020-04-02T05:28:36Z,2020-04-02T13:52:25Z,,,911ea78d636ad84d9017697b9c34022fade856d3,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28098/commits,https://api.github.com/repos/apache/spark/pulls/28098/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28098/comments,https://api.github.com/repos/apache/spark/statuses/31db9689917daac8bfd134de7361b5f0d70ee334,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-30973,SPARK-30973,31db9689917daac8bfd134de7361b5f0d70ee334,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,34abbb677dd3867e23279ff45d411ef3010adbe7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28098,https://github.com/apache/spark/pull/28098,https://api.github.com/repos/apache/spark/issues/28098,https://api.github.com/repos/apache/spark/issues/28098/comments,https://api.github.com/repos/apache/spark/pulls/28098/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28098/commits,https://api.github.com/repos/apache/spark/statuses/31db9689917daac8bfd134de7361b5f0d70ee334
39,https://api.github.com/repos/apache/spark/pulls/28094,397227798,MDExOlB1bGxSZXF1ZXN0Mzk3MjI3Nzk4,https://github.com/apache/spark/pull/28094,https://github.com/apache/spark/pull/28094.diff,https://github.com/apache/spark/pull/28094.patch,https://api.github.com/repos/apache/spark/issues/28094,28094,open,False,[SPARK-29303][Web UI] Add UI support for stage level scheduling,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This adds UI updates to support stage level scheduling and ResourceProfiles. 3 main things have been added. ResourceProfile id added to the Stage page, the Executors page now has an optional selectable column to show the ResourceProfile Id of each executor, and the Environment page now has a section with the ResourceProfile ids.  Along with this the rest api for environment page was updated to include the Resource profile information.

I debating on splitting the resource profile information into its own page but I wasn't sure it called for a completely separate page. Open to peoples thoughts on this.

Screen shots:
![Screen Shot 2020-04-01 at 3 07 46 PM](https://user-images.githubusercontent.com/4563792/78185169-469a7000-7430-11ea-8b0c-d9ede2d41df8.png)
![Screen Shot 2020-04-01 at 3 08 14 PM](https://user-images.githubusercontent.com/4563792/78185175-48fcca00-7430-11ea-8d1d-6b9333700f32.png)
![Screen Shot 2020-04-01 at 3 09 03 PM](https://user-images.githubusercontent.com/4563792/78185176-4a2df700-7430-11ea-92d9-73c382bb0f32.png)
![Screen Shot 2020-04-01 at 11 05 48 AM](https://user-images.githubusercontent.com/4563792/78185186-4dc17e00-7430-11ea-8962-f749dd47ea60.png)





### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

For user to be able to know what resource profile was used with which stage and executors. The resource profile information is also available so user debugging can see exactly what resources were requested with that profile.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

Yes, UI updates.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Unit tests and tested on yarn both active applications and with the history server.",2020-04-01T20:55:13Z,2020-04-02T22:14:06Z,,,bb30c1ad70d9c797cee58951e6138a6bf379e865,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28094/commits,https://api.github.com/repos/apache/spark/pulls/28094/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28094/comments,https://api.github.com/repos/apache/spark/statuses/0dee43939839c13e55fdf456b0088a8d12aca931,CONTRIBUTOR,spark,apache,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,tgravescs:SPARK-29303-pr,SPARK-29303-pr,0dee43939839c13e55fdf456b0088a8d12aca931,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,17249522,MDEwOlJlcG9zaXRvcnkxNzI0OTUyMg==,spark,tgravescs/spark,False,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,https://github.com/tgravescs/spark,Mirror of Apache Spark,True,https://api.github.com/repos/tgravescs/spark,https://api.github.com/repos/tgravescs/spark/forks,https://api.github.com/repos/tgravescs/spark/keys{/key_id},https://api.github.com/repos/tgravescs/spark/collaborators{/collaborator},https://api.github.com/repos/tgravescs/spark/teams,https://api.github.com/repos/tgravescs/spark/hooks,https://api.github.com/repos/tgravescs/spark/issues/events{/number},https://api.github.com/repos/tgravescs/spark/events,https://api.github.com/repos/tgravescs/spark/assignees{/user},https://api.github.com/repos/tgravescs/spark/branches{/branch},https://api.github.com/repos/tgravescs/spark/tags,https://api.github.com/repos/tgravescs/spark/git/blobs{/sha},https://api.github.com/repos/tgravescs/spark/git/tags{/sha},https://api.github.com/repos/tgravescs/spark/git/refs{/sha},https://api.github.com/repos/tgravescs/spark/git/trees{/sha},https://api.github.com/repos/tgravescs/spark/statuses/{sha},https://api.github.com/repos/tgravescs/spark/languages,https://api.github.com/repos/tgravescs/spark/stargazers,https://api.github.com/repos/tgravescs/spark/contributors,https://api.github.com/repos/tgravescs/spark/subscribers,https://api.github.com/repos/tgravescs/spark/subscription,https://api.github.com/repos/tgravescs/spark/commits{/sha},https://api.github.com/repos/tgravescs/spark/git/commits{/sha},https://api.github.com/repos/tgravescs/spark/comments{/number},https://api.github.com/repos/tgravescs/spark/issues/comments{/number},https://api.github.com/repos/tgravescs/spark/contents/{+path},https://api.github.com/repos/tgravescs/spark/compare/{base}...{head},https://api.github.com/repos/tgravescs/spark/merges,https://api.github.com/repos/tgravescs/spark/{archive_format}{/ref},https://api.github.com/repos/tgravescs/spark/downloads,https://api.github.com/repos/tgravescs/spark/issues{/number},https://api.github.com/repos/tgravescs/spark/pulls{/number},https://api.github.com/repos/tgravescs/spark/milestones{/number},"https://api.github.com/repos/tgravescs/spark/notifications{?since,all,participating}",https://api.github.com/repos/tgravescs/spark/labels{/name},https://api.github.com/repos/tgravescs/spark/releases{/id},https://api.github.com/repos/tgravescs/spark/deployments,2014-02-27T13:26:24Z,2019-12-12T03:01:23Z,2020-04-08T20:50:58Z,git://github.com/tgravescs/spark.git,git@github.com:tgravescs/spark.git,https://github.com/tgravescs/spark.git,https://github.com/tgravescs/spark,,302656,1,1,Scala,False,True,True,False,False,0,,False,False,2,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,2,1,master,apache:master,master,55dea9be62019d64d5d76619e1551956c8bb64d0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28094,https://github.com/apache/spark/pull/28094,https://api.github.com/repos/apache/spark/issues/28094,https://api.github.com/repos/apache/spark/issues/28094/comments,https://api.github.com/repos/apache/spark/pulls/28094/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28094/commits,https://api.github.com/repos/apache/spark/statuses/0dee43939839c13e55fdf456b0088a8d12aca931
40,https://api.github.com/repos/apache/spark/pulls/28091,396877785,MDExOlB1bGxSZXF1ZXN0Mzk2ODc3Nzg1,https://github.com/apache/spark/pull/28091,https://github.com/apache/spark/pull/28091.diff,https://github.com/apache/spark/pull/28091.patch,https://api.github.com/repos/apache/spark/issues/28091,28091,open,False,[WIP][SQL] Optimize fromJavaDate() and toJavaDate(),"### What changes were proposed in this pull request?


### Why are the changes needed?
Before:
```
Save dates to ORC:                        Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, noop                                   8410           8410           0         11.9          84.1       1.0X
before 1582, noop                                  8408           8408           0         11.9          84.1       1.0X
after 1582                                        15507          15507           0          6.4         155.1       0.5X
before 1582                                       15099          15099           0          6.6         151.0       0.6X

Load dates from ORC:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, vec off                               26858          27479         727          3.7         268.6       1.0X
```

After:
```
Save dates to ORC:                        Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, noop                                   7518           7518           0         13.3          75.2       1.0X
before 1582, noop                                  7292           7292           0         13.7          72.9       1.0X
after 1582                                        13286          13286           0          7.5         132.9       0.6X
before 1582                                       16213          16213           0          6.2         162.1       0.5X

Java HotSpot(TM) 64-Bit Server VM 1.8.0_231-b11 on Mac OS X 10.15.3
Intel(R) Core(TM) i7-4850HQ CPU @ 2.30GHz
Load dates from ORC:                      Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
after 1582, vec off                               17867          17918          65          5.6         178.7       1.0X
```

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-04-01T09:36:19Z,2020-04-09T12:10:07Z,,,cebde97dc2d1115c51faee65cdf5addd1773225c,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28091/commits,https://api.github.com/repos/apache/spark/pulls/28091/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28091/comments,https://api.github.com/repos/apache/spark/statuses/586517fd8219704b47a79f534a0e575ccf66d6e4,CONTRIBUTOR,spark,apache,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,MaxGekk:optimize-from-to-java-date,optimize-from-to-java-date,586517fd8219704b47a79f534a0e575ccf66d6e4,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,123690489,MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=,spark,MaxGekk/spark,False,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,https://github.com/MaxGekk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/MaxGekk/spark,https://api.github.com/repos/MaxGekk/spark/forks,https://api.github.com/repos/MaxGekk/spark/keys{/key_id},https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator},https://api.github.com/repos/MaxGekk/spark/teams,https://api.github.com/repos/MaxGekk/spark/hooks,https://api.github.com/repos/MaxGekk/spark/issues/events{/number},https://api.github.com/repos/MaxGekk/spark/events,https://api.github.com/repos/MaxGekk/spark/assignees{/user},https://api.github.com/repos/MaxGekk/spark/branches{/branch},https://api.github.com/repos/MaxGekk/spark/tags,https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha},https://api.github.com/repos/MaxGekk/spark/git/tags{/sha},https://api.github.com/repos/MaxGekk/spark/git/refs{/sha},https://api.github.com/repos/MaxGekk/spark/git/trees{/sha},https://api.github.com/repos/MaxGekk/spark/statuses/{sha},https://api.github.com/repos/MaxGekk/spark/languages,https://api.github.com/repos/MaxGekk/spark/stargazers,https://api.github.com/repos/MaxGekk/spark/contributors,https://api.github.com/repos/MaxGekk/spark/subscribers,https://api.github.com/repos/MaxGekk/spark/subscription,https://api.github.com/repos/MaxGekk/spark/commits{/sha},https://api.github.com/repos/MaxGekk/spark/git/commits{/sha},https://api.github.com/repos/MaxGekk/spark/comments{/number},https://api.github.com/repos/MaxGekk/spark/issues/comments{/number},https://api.github.com/repos/MaxGekk/spark/contents/{+path},https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head},https://api.github.com/repos/MaxGekk/spark/merges,https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref},https://api.github.com/repos/MaxGekk/spark/downloads,https://api.github.com/repos/MaxGekk/spark/issues{/number},https://api.github.com/repos/MaxGekk/spark/pulls{/number},https://api.github.com/repos/MaxGekk/spark/milestones{/number},"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}",https://api.github.com/repos/MaxGekk/spark/labels{/name},https://api.github.com/repos/MaxGekk/spark/releases{/id},https://api.github.com/repos/MaxGekk/spark/deployments,2018-03-03T12:37:00Z,2020-04-10T19:15:57Z,2020-04-10T20:37:52Z,git://github.com/MaxGekk/spark.git,git@github.com:MaxGekk/spark.git,https://github.com/MaxGekk/spark.git,https://github.com/MaxGekk/spark,,325420,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,d89fcc64dbe422fe8695d92d90b3448bad24c0fa,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28091,https://github.com/apache/spark/pull/28091,https://api.github.com/repos/apache/spark/issues/28091,https://api.github.com/repos/apache/spark/issues/28091/comments,https://api.github.com/repos/apache/spark/pulls/28091/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28091/commits,https://api.github.com/repos/apache/spark/statuses/586517fd8219704b47a79f534a0e575ccf66d6e4
41,https://api.github.com/repos/apache/spark/pulls/28087,396710876,MDExOlB1bGxSZXF1ZXN0Mzk2NzEwODc2,https://github.com/apache/spark/pull/28087,https://github.com/apache/spark/pull/28087.diff,https://github.com/apache/spark/pull/28087.patch,https://api.github.com/repos/apache/spark/issues/28087,28087,open,False,[SPARK-31319][SQL][DOCS] Document UDFs/UDAFs in SQL Reference,"### What changes were proposed in this pull request?
Document UDF in SQL Reference

### Why are the changes needed?
To make SQL Reference complete.


### Does this PR introduce any user-facing change?
Yes. Here are the new pages:
<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 06 42 PM"" src=""https://user-images.githubusercontent.com/13592258/78950977-585dc200-7a85-11ea-875c-ce14c3795e0f.png"">


<img width=""1049"" alt=""Screen Shot 2020-04-09 at 5 07 06 PM"" src=""https://user-images.githubusercontent.com/13592258/78950979-5b58b280-7a85-11ea-81f3-bd5d91bd07e3.png"">


<img width=""1049"" alt=""Screen Shot 2020-04-09 at 5 07 26 PM"" src=""https://user-images.githubusercontent.com/13592258/78950985-5e53a300-7a85-11ea-86be-f63152c1501b.png"">


<img width=""1051"" alt=""Screen Shot 2020-04-09 at 5 07 54 PM"" src=""https://user-images.githubusercontent.com/13592258/78950991-63185700-7a85-11ea-9379-8da46cfc434c.png"">


<img width=""1060"" alt=""Screen Shot 2020-04-09 at 5 08 17 PM"" src=""https://user-images.githubusercontent.com/13592258/78950994-657ab100-7a85-11ea-8b34-d2c87f94b03b.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 09 27 PM"" src=""https://user-images.githubusercontent.com/13592258/78951001-6875a180-7a85-11ea-874e-8abd14a3d3d3.png"">


<img width=""1060"" alt=""Screen Shot 2020-04-09 at 5 10 00 PM"" src=""https://user-images.githubusercontent.com/13592258/78951005-6f041900-7a85-11ea-9e57-520eb8db59ec.png"">


<img width=""1049"" alt=""Screen Shot 2020-04-09 at 5 11 10 PM"" src=""https://user-images.githubusercontent.com/13592258/78951014-73303680-7a85-11ea-93ab-32d68d2e2d59.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 11 41 PM"" src=""https://user-images.githubusercontent.com/13592258/78951019-75929080-7a85-11ea-9d3b-600e8e157c05.png"">


<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 16 22 PM"" src=""https://user-images.githubusercontent.com/13592258/78951137-dfab3580-7a85-11ea-8512-c6b660aa271e.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 22 15 PM"" src=""https://user-images.githubusercontent.com/13592258/78951466-22214200-7a87-11ea-93dd-6e36492421f1.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-09 at 5 22 46 PM"" src=""https://user-images.githubusercontent.com/13592258/78951469-24839c00-7a87-11ea-93a9-fe30d689adbd.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 23 08 PM"" src=""https://user-images.githubusercontent.com/13592258/78951472-26e5f600-7a87-11ea-84db-087a3528aa53.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 23 34 PM"" src=""https://user-images.githubusercontent.com/13592258/78951474-29e0e680-7a87-11ea-8be4-2a5be1bc3788.png"">

<img width=""1049"" alt=""Screen Shot 2020-04-09 at 5 23 57 PM"" src=""https://user-images.githubusercontent.com/13592258/78951481-2cdbd700-7a87-11ea-8894-0a39abf54a3b.png"">

<img width=""1050"" alt=""Screen Shot 2020-04-09 at 5 24 15 PM"" src=""https://user-images.githubusercontent.com/13592258/78951483-2f3e3100-7a87-11ea-8845-ffebf89d7898.png"">









### How was this patch tested?
Manually build and check
",2020-04-01T01:43:35Z,2020-04-10T07:59:57Z,,,ff5c52065148d66683a033e83421181c932c9882,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28087/commits,https://api.github.com/repos/apache/spark/pulls/28087/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28087/comments,https://api.github.com/repos/apache/spark/statuses/adee9194abe4951d16dc1f231b67ba2408fd67b2,CONTRIBUTOR,spark,apache,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,huaxingao:udf,udf,adee9194abe4951d16dc1f231b67ba2408fd67b2,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,50813048,MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==,spark,huaxingao/spark,False,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,https://github.com/huaxingao/spark,Mirror of Apache Spark,True,https://api.github.com/repos/huaxingao/spark,https://api.github.com/repos/huaxingao/spark/forks,https://api.github.com/repos/huaxingao/spark/keys{/key_id},https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator},https://api.github.com/repos/huaxingao/spark/teams,https://api.github.com/repos/huaxingao/spark/hooks,https://api.github.com/repos/huaxingao/spark/issues/events{/number},https://api.github.com/repos/huaxingao/spark/events,https://api.github.com/repos/huaxingao/spark/assignees{/user},https://api.github.com/repos/huaxingao/spark/branches{/branch},https://api.github.com/repos/huaxingao/spark/tags,https://api.github.com/repos/huaxingao/spark/git/blobs{/sha},https://api.github.com/repos/huaxingao/spark/git/tags{/sha},https://api.github.com/repos/huaxingao/spark/git/refs{/sha},https://api.github.com/repos/huaxingao/spark/git/trees{/sha},https://api.github.com/repos/huaxingao/spark/statuses/{sha},https://api.github.com/repos/huaxingao/spark/languages,https://api.github.com/repos/huaxingao/spark/stargazers,https://api.github.com/repos/huaxingao/spark/contributors,https://api.github.com/repos/huaxingao/spark/subscribers,https://api.github.com/repos/huaxingao/spark/subscription,https://api.github.com/repos/huaxingao/spark/commits{/sha},https://api.github.com/repos/huaxingao/spark/git/commits{/sha},https://api.github.com/repos/huaxingao/spark/comments{/number},https://api.github.com/repos/huaxingao/spark/issues/comments{/number},https://api.github.com/repos/huaxingao/spark/contents/{+path},https://api.github.com/repos/huaxingao/spark/compare/{base}...{head},https://api.github.com/repos/huaxingao/spark/merges,https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref},https://api.github.com/repos/huaxingao/spark/downloads,https://api.github.com/repos/huaxingao/spark/issues{/number},https://api.github.com/repos/huaxingao/spark/pulls{/number},https://api.github.com/repos/huaxingao/spark/milestones{/number},"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}",https://api.github.com/repos/huaxingao/spark/labels{/name},https://api.github.com/repos/huaxingao/spark/releases{/id},https://api.github.com/repos/huaxingao/spark/deployments,2016-02-01T04:09:11Z,2020-04-10T00:47:54Z,2020-04-10T22:29:44Z,git://github.com/huaxingao/spark.git,git@github.com:huaxingao/spark.git,https://github.com/huaxingao/spark.git,https://github.com/huaxingao/spark,,312619,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,4e45c07f5dbc4b178c41449320b7405b20aa05e9,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28087,https://github.com/apache/spark/pull/28087,https://api.github.com/repos/apache/spark/issues/28087,https://api.github.com/repos/apache/spark/issues/28087/comments,https://api.github.com/repos/apache/spark/pulls/28087/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28087/commits,https://api.github.com/repos/apache/spark/statuses/adee9194abe4951d16dc1f231b67ba2408fd67b2
42,https://api.github.com/repos/apache/spark/pulls/28085,396569715,MDExOlB1bGxSZXF1ZXN0Mzk2NTY5NzE1,https://github.com/apache/spark/pull/28085,https://github.com/apache/spark/pull/28085.diff,https://github.com/apache/spark/pull/28085.patch,https://api.github.com/repos/apache/spark/issues/28085,28085,open,False,[SPARK-29641][PYTHON][CORE] Stage Level Sched: Add python api's and tests,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
As part of the Stage level scheduling features, add the Python api's to set resource profiles.
This also adds the functionality to properly apply the pyspark memory configuration when specified in the ResourceProfile. The pyspark memory configuration is being passed in the task local properties. This was an easy way to get it to the PythonRunner that needs it. I modeled this off how the barrier task scheduling is passing the addresses. As part of this I added in the JavaRDD api's because those are needed by python.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
python api for this feature

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes adds the java and python apis for user to specify a ResourceProfile to use stage level scheduling.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
unit tests and manually tested on yarn. Tests also run to verify it errors properly on standalone and local mode where its not yet supported.",2020-03-31T20:05:29Z,2020-04-08T23:49:05Z,,,e5138ddb2898503161afbd9e0cb8ab6e15675edc,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28085/commits,https://api.github.com/repos/apache/spark/pulls/28085/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28085/comments,https://api.github.com/repos/apache/spark/statuses/3562539f6c8c668eae230971ca268672bb4787bb,CONTRIBUTOR,spark,apache,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,tgravescs:SPARK-29641-pr-base,SPARK-29641-pr-base,3562539f6c8c668eae230971ca268672bb4787bb,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,17249522,MDEwOlJlcG9zaXRvcnkxNzI0OTUyMg==,spark,tgravescs/spark,False,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,https://github.com/tgravescs/spark,Mirror of Apache Spark,True,https://api.github.com/repos/tgravescs/spark,https://api.github.com/repos/tgravescs/spark/forks,https://api.github.com/repos/tgravescs/spark/keys{/key_id},https://api.github.com/repos/tgravescs/spark/collaborators{/collaborator},https://api.github.com/repos/tgravescs/spark/teams,https://api.github.com/repos/tgravescs/spark/hooks,https://api.github.com/repos/tgravescs/spark/issues/events{/number},https://api.github.com/repos/tgravescs/spark/events,https://api.github.com/repos/tgravescs/spark/assignees{/user},https://api.github.com/repos/tgravescs/spark/branches{/branch},https://api.github.com/repos/tgravescs/spark/tags,https://api.github.com/repos/tgravescs/spark/git/blobs{/sha},https://api.github.com/repos/tgravescs/spark/git/tags{/sha},https://api.github.com/repos/tgravescs/spark/git/refs{/sha},https://api.github.com/repos/tgravescs/spark/git/trees{/sha},https://api.github.com/repos/tgravescs/spark/statuses/{sha},https://api.github.com/repos/tgravescs/spark/languages,https://api.github.com/repos/tgravescs/spark/stargazers,https://api.github.com/repos/tgravescs/spark/contributors,https://api.github.com/repos/tgravescs/spark/subscribers,https://api.github.com/repos/tgravescs/spark/subscription,https://api.github.com/repos/tgravescs/spark/commits{/sha},https://api.github.com/repos/tgravescs/spark/git/commits{/sha},https://api.github.com/repos/tgravescs/spark/comments{/number},https://api.github.com/repos/tgravescs/spark/issues/comments{/number},https://api.github.com/repos/tgravescs/spark/contents/{+path},https://api.github.com/repos/tgravescs/spark/compare/{base}...{head},https://api.github.com/repos/tgravescs/spark/merges,https://api.github.com/repos/tgravescs/spark/{archive_format}{/ref},https://api.github.com/repos/tgravescs/spark/downloads,https://api.github.com/repos/tgravescs/spark/issues{/number},https://api.github.com/repos/tgravescs/spark/pulls{/number},https://api.github.com/repos/tgravescs/spark/milestones{/number},"https://api.github.com/repos/tgravescs/spark/notifications{?since,all,participating}",https://api.github.com/repos/tgravescs/spark/labels{/name},https://api.github.com/repos/tgravescs/spark/releases{/id},https://api.github.com/repos/tgravescs/spark/deployments,2014-02-27T13:26:24Z,2019-12-12T03:01:23Z,2020-04-08T20:50:58Z,git://github.com/tgravescs/spark.git,git@github.com:tgravescs/spark.git,https://github.com/tgravescs/spark.git,https://github.com/tgravescs/spark,,302656,1,1,Scala,False,True,True,False,False,0,,False,False,2,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,2,1,master,apache:master,master,34c7ec8e0cb395da50e5cbeee67463414dacd776,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28085,https://github.com/apache/spark/pull/28085,https://api.github.com/repos/apache/spark/issues/28085,https://api.github.com/repos/apache/spark/issues/28085/comments,https://api.github.com/repos/apache/spark/pulls/28085/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28085/commits,https://api.github.com/repos/apache/spark/statuses/3562539f6c8c668eae230971ca268672bb4787bb
43,https://api.github.com/repos/apache/spark/pulls/28083,396312228,MDExOlB1bGxSZXF1ZXN0Mzk2MzEyMjI4,https://github.com/apache/spark/pull/28083,https://github.com/apache/spark/pull/28083.diff,https://github.com/apache/spark/pull/28083.patch,https://api.github.com/repos/apache/spark/issues/28083,28083,open,False,[WIP][SPARK-30564][SQL] Use comment placeholders in HashAggregateExec,"### What changes were proposed in this pull request?
SPARK-21870 (cb0cddf#diff-06dc5de6163687b7810aa76e7e152a76R146-R149) caused significant performance regression in cases where the source code size is fairly large as `HashAggregateExec` uses `Block.length` to decide on splitting the code. The change in `length` makes sense as the comment and extra new lines shouldn't be taken into account when deciding on splitting, but the regular expression based approach is very slow and adds a big relative overhead to cases where the execution is quick (small number of rows).
This PR:
- places comments in `HashAggragateExec` with `CodegenContext.registerComment` so as to appear only when comments are enabled (`spark.sql.codegen.comments=true`) and 
- restores `Block.length` to it's original form

### Why are the changes needed?
To fix performance regression.

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Existing UTs.
",2020-03-31T12:49:32Z,2020-04-09T08:25:35Z,,,0299e0915580831e26f28b4d7de9cb9c26ccc971,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28083/commits,https://api.github.com/repos/apache/spark/pulls/28083/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28083/comments,https://api.github.com/repos/apache/spark/statuses/e67f80dca6f3230a27bdc8dee83604476bc5037f,CONTRIBUTOR,spark,apache,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,peter-toth:SPARK-30564-use-comment-placeholders,SPARK-30564-use-comment-placeholders,e67f80dca6f3230a27bdc8dee83604476bc5037f,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,130546049,MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=,spark,peter-toth/spark,False,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,https://github.com/peter-toth/spark,Mirror of Apache Spark,True,https://api.github.com/repos/peter-toth/spark,https://api.github.com/repos/peter-toth/spark/forks,https://api.github.com/repos/peter-toth/spark/keys{/key_id},https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator},https://api.github.com/repos/peter-toth/spark/teams,https://api.github.com/repos/peter-toth/spark/hooks,https://api.github.com/repos/peter-toth/spark/issues/events{/number},https://api.github.com/repos/peter-toth/spark/events,https://api.github.com/repos/peter-toth/spark/assignees{/user},https://api.github.com/repos/peter-toth/spark/branches{/branch},https://api.github.com/repos/peter-toth/spark/tags,https://api.github.com/repos/peter-toth/spark/git/blobs{/sha},https://api.github.com/repos/peter-toth/spark/git/tags{/sha},https://api.github.com/repos/peter-toth/spark/git/refs{/sha},https://api.github.com/repos/peter-toth/spark/git/trees{/sha},https://api.github.com/repos/peter-toth/spark/statuses/{sha},https://api.github.com/repos/peter-toth/spark/languages,https://api.github.com/repos/peter-toth/spark/stargazers,https://api.github.com/repos/peter-toth/spark/contributors,https://api.github.com/repos/peter-toth/spark/subscribers,https://api.github.com/repos/peter-toth/spark/subscription,https://api.github.com/repos/peter-toth/spark/commits{/sha},https://api.github.com/repos/peter-toth/spark/git/commits{/sha},https://api.github.com/repos/peter-toth/spark/comments{/number},https://api.github.com/repos/peter-toth/spark/issues/comments{/number},https://api.github.com/repos/peter-toth/spark/contents/{+path},https://api.github.com/repos/peter-toth/spark/compare/{base}...{head},https://api.github.com/repos/peter-toth/spark/merges,https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref},https://api.github.com/repos/peter-toth/spark/downloads,https://api.github.com/repos/peter-toth/spark/issues{/number},https://api.github.com/repos/peter-toth/spark/pulls{/number},https://api.github.com/repos/peter-toth/spark/milestones{/number},"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}",https://api.github.com/repos/peter-toth/spark/labels{/name},https://api.github.com/repos/peter-toth/spark/releases{/id},https://api.github.com/repos/peter-toth/spark/deployments,2018-04-22T07:43:37Z,2018-04-22T07:44:03Z,2020-03-31T12:39:44Z,git://github.com/peter-toth/spark.git,git@github.com:peter-toth/spark.git,https://github.com/peter-toth/spark.git,https://github.com/peter-toth/spark,,330225,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,07c50784d34e10bbfafac7498c0b70c4ec08048a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28083,https://github.com/apache/spark/pull/28083,https://api.github.com/repos/apache/spark/issues/28083,https://api.github.com/repos/apache/spark/issues/28083/comments,https://api.github.com/repos/apache/spark/pulls/28083/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28083/commits,https://api.github.com/repos/apache/spark/statuses/e67f80dca6f3230a27bdc8dee83604476bc5037f
44,https://api.github.com/repos/apache/spark/pulls/28056,394843431,MDExOlB1bGxSZXF1ZXN0Mzk0ODQzNDMx,https://github.com/apache/spark/pull/28056,https://github.com/apache/spark/pull/28056.diff,https://github.com/apache/spark/pull/28056.patch,https://api.github.com/repos/apache/spark/issues/28056,28056,open,False,[SPARK-31288][SQL] Remove `getRawTable` in `alterPartitions`,"### What changes were proposed in this pull request?

This PR (SPARK-31288) removes `getRawTable` from `alterPartitions`.

### Why are the changes needed?
Reduce calls to Hive Metastore.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Exist test.
",2020-03-27T16:11:59Z,2020-03-31T06:51:06Z,,,f0ffe9b9af164951caf759cf9bb5249e269f2595,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28056/commits,https://api.github.com/repos/apache/spark/pulls/28056/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28056/comments,https://api.github.com/repos/apache/spark/statuses/c0f1305ed8abf571e226d211a74d6dbd98b55e33,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-31288,SPARK-31288,c0f1305ed8abf571e226d211a74d6dbd98b55e33,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,fc2a974e030c82bf500a81c3908f853c3eeb761d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28056,https://github.com/apache/spark/pull/28056,https://api.github.com/repos/apache/spark/issues/28056,https://api.github.com/repos/apache/spark/issues/28056/comments,https://api.github.com/repos/apache/spark/pulls/28056/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28056/commits,https://api.github.com/repos/apache/spark/statuses/c0f1305ed8abf571e226d211a74d6dbd98b55e33
45,https://api.github.com/repos/apache/spark/pulls/28055,394806063,MDExOlB1bGxSZXF1ZXN0Mzk0ODA2MDYz,https://github.com/apache/spark/pull/28055,https://github.com/apache/spark/pull/28055.diff,https://github.com/apache/spark/pull/28055.patch,https://api.github.com/repos/apache/spark/issues/28055,28055,open,False,[SPARK-31289][TEST][test-hive1.2] Eliminate org.apache.spark.sql.hive.thriftserver.CliSuite flakiness,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
CliSuite seems to be flaky while using metastoreDir per test.
https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/120470/testReport/org.apache.spark.sql.hive.thriftserver/CliSuite/

https://amplab.cs.berkeley.edu/jenkins/job/SparkPullRequestBuilder/120470/testReport/junit/org.apache.spark.sql.hive.thriftserver/CliSuite/history/

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Eliminate test flakiness
### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

no
### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
modified test",2020-03-27T15:03:52Z,2020-03-29T21:38:36Z,,,c6fcf9118e5918a6e1707ec6243e9242c98f9da5,,[],[],[],"[{'id': 1406606402, 'node_id': 'MDU6TGFiZWwxNDA2NjA2NDAy', 'url': 'https://api.github.com/repos/apache/spark/labels/TESTS', 'name': 'TESTS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28055/commits,https://api.github.com/repos/apache/spark/pulls/28055/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28055/comments,https://api.github.com/repos/apache/spark/statuses/09ea8f16e7ccbbdbdef0372156c5711daaf65231,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:clisuite,clisuite,09ea8f16e7ccbbdbdef0372156c5711daaf65231,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,9f0c010a5c9b5c10401f8e16fa7a151714b6dbb0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28055,https://github.com/apache/spark/pull/28055,https://api.github.com/repos/apache/spark/issues/28055,https://api.github.com/repos/apache/spark/issues/28055/comments,https://api.github.com/repos/apache/spark/pulls/28055/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28055/commits,https://api.github.com/repos/apache/spark/statuses/09ea8f16e7ccbbdbdef0372156c5711daaf65231
46,https://api.github.com/repos/apache/spark/pulls/28041,394411016,MDExOlB1bGxSZXF1ZXN0Mzk0NDExMDE2,https://github.com/apache/spark/pull/28041,https://github.com/apache/spark/pull/28041.diff,https://github.com/apache/spark/pull/28041.patch,https://api.github.com/repos/apache/spark/issues/28041,28041,open,False,[SPARK-30564][SQL] Improved extra new line and comment remove,"### What changes were proposed in this pull request?

SPARK-21870 (https://github.com/apache/spark/commit/cb0cddffe9452937033e0e6b1fc0e600d2c787ad#diff-06dc5de6163687b7810aa76e7e152a76R146-R149) caused significant performance regression in cases where the source code size is fairly large as `HashAggregateExec` uses `Block.length` to decide on splitting the code. The change in `def length` makes sense as the comment and extra new lines shouldn't be taken into account when deciding on splitting, but the regular expression based approach is very slow and adds a big relative overhead to cases where the execution is quick (small number of rows).
This PR replaces the slow regular expression based comment and extra new line removal to a much faster custom code.

### Why are the changes needed?
To fix performance regression.

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Extended existing UT.",2020-03-26T20:41:30Z,2020-04-02T06:15:07Z,,,0be588d839566563767b7d76d87b572528bbb992,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28041/commits,https://api.github.com/repos/apache/spark/pulls/28041/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28041/comments,https://api.github.com/repos/apache/spark/statuses/2ca1354b980f280e408e6a27f5f947a6f8b7039b,CONTRIBUTOR,spark,apache,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,peter-toth:SPARK-30564-improved-comment-remove,SPARK-30564-improved-comment-remove,2ca1354b980f280e408e6a27f5f947a6f8b7039b,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,130546049,MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=,spark,peter-toth/spark,False,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,https://github.com/peter-toth/spark,Mirror of Apache Spark,True,https://api.github.com/repos/peter-toth/spark,https://api.github.com/repos/peter-toth/spark/forks,https://api.github.com/repos/peter-toth/spark/keys{/key_id},https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator},https://api.github.com/repos/peter-toth/spark/teams,https://api.github.com/repos/peter-toth/spark/hooks,https://api.github.com/repos/peter-toth/spark/issues/events{/number},https://api.github.com/repos/peter-toth/spark/events,https://api.github.com/repos/peter-toth/spark/assignees{/user},https://api.github.com/repos/peter-toth/spark/branches{/branch},https://api.github.com/repos/peter-toth/spark/tags,https://api.github.com/repos/peter-toth/spark/git/blobs{/sha},https://api.github.com/repos/peter-toth/spark/git/tags{/sha},https://api.github.com/repos/peter-toth/spark/git/refs{/sha},https://api.github.com/repos/peter-toth/spark/git/trees{/sha},https://api.github.com/repos/peter-toth/spark/statuses/{sha},https://api.github.com/repos/peter-toth/spark/languages,https://api.github.com/repos/peter-toth/spark/stargazers,https://api.github.com/repos/peter-toth/spark/contributors,https://api.github.com/repos/peter-toth/spark/subscribers,https://api.github.com/repos/peter-toth/spark/subscription,https://api.github.com/repos/peter-toth/spark/commits{/sha},https://api.github.com/repos/peter-toth/spark/git/commits{/sha},https://api.github.com/repos/peter-toth/spark/comments{/number},https://api.github.com/repos/peter-toth/spark/issues/comments{/number},https://api.github.com/repos/peter-toth/spark/contents/{+path},https://api.github.com/repos/peter-toth/spark/compare/{base}...{head},https://api.github.com/repos/peter-toth/spark/merges,https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref},https://api.github.com/repos/peter-toth/spark/downloads,https://api.github.com/repos/peter-toth/spark/issues{/number},https://api.github.com/repos/peter-toth/spark/pulls{/number},https://api.github.com/repos/peter-toth/spark/milestones{/number},"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}",https://api.github.com/repos/peter-toth/spark/labels{/name},https://api.github.com/repos/peter-toth/spark/releases{/id},https://api.github.com/repos/peter-toth/spark/deployments,2018-04-22T07:43:37Z,2018-04-22T07:44:03Z,2020-03-31T12:39:44Z,git://github.com/peter-toth/spark.git,git@github.com:peter-toth/spark.git,https://github.com/peter-toth/spark.git,https://github.com/peter-toth/spark,,330225,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,d72ec8574113f9a7e87f3d7ec56c8447267b0506,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28041,https://github.com/apache/spark/pull/28041,https://api.github.com/repos/apache/spark/issues/28041,https://api.github.com/repos/apache/spark/issues/28041/comments,https://api.github.com/repos/apache/spark/pulls/28041/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28041/commits,https://api.github.com/repos/apache/spark/statuses/2ca1354b980f280e408e6a27f5f947a6f8b7039b
47,https://api.github.com/repos/apache/spark/pulls/28036,394149886,MDExOlB1bGxSZXF1ZXN0Mzk0MTQ5ODg2,https://github.com/apache/spark/pull/28036,https://github.com/apache/spark/pull/28036.diff,https://github.com/apache/spark/pull/28036.patch,https://api.github.com/repos/apache/spark/issues/28036,28036,open,False,"[SPARK-26341][CORE]Expose executor memory metrics at the stage level, in the Stages tab","### What changes were proposed in this pull request?
Expose executor memory metrics at the stage level, in the Stages tab,
Current like below, and I am not sure which column we will truly need.

![image](https://user-images.githubusercontent.com/46485123/77648456-220f4580-6fa3-11ea-82fe-50fe69edef4e.png)


### Why are the changes needed?
User can know executor jvm usage more directly in SparkUI


### Does this PR introduce any user-facing change?
User can know executor jvm usage more directly in SparkUI


### How was this patch tested?
Manual Tested
",2020-03-26T12:49:12Z,2020-04-08T09:37:07Z,,,9345d2dc60718e80dfcfd7284c83cc2c0e69c820,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28036/commits,https://api.github.com/repos/apache/spark/pulls/28036/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28036/comments,https://api.github.com/repos/apache/spark/statuses/803921ab7c94cb239469e4aad6f408e854eae03f,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-26341,SPARK-26341,803921ab7c94cb239469e4aad6f408e854eae03f,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,35d286bafb248a47a1125908c0208cd759dd0416,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28036,https://github.com/apache/spark/pull/28036,https://api.github.com/repos/apache/spark/issues/28036,https://api.github.com/repos/apache/spark/issues/28036/comments,https://api.github.com/repos/apache/spark/pulls/28036/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28036/commits,https://api.github.com/repos/apache/spark/statuses/803921ab7c94cb239469e4aad6f408e854eae03f
48,https://api.github.com/repos/apache/spark/pulls/28034,394138629,MDExOlB1bGxSZXF1ZXN0Mzk0MTM4NjI5,https://github.com/apache/spark/pull/28034,https://github.com/apache/spark/pull/28034.diff,https://github.com/apache/spark/pull/28034.patch,https://api.github.com/repos/apache/spark/issues/28034,28034,open,False,[SPARK-31268][CORE]Initial Task Executor Metrics with latestMetrics,"### What changes were proposed in this pull request?
I found that TaskEnd event with zero Executor Metrics when task duration less then poll interval when I add some info to SparkWebUI in task detail table

![image](https://user-images.githubusercontent.com/46485123/77646742-15d5b900-6fa0-11ea-9d60-e600d270e4d3.png)

so initial taskExecutorMetrics with latestMetrics

### Why are the changes needed?
Fix zero value


### Does this PR introduce any user-facing change?
NO

### How was this patch tested?
NO",2020-03-26T12:25:31Z,2020-04-09T23:13:31Z,,,9ad6948a6159ddb09c66d3a7ef515327f2fca965,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28034/commits,https://api.github.com/repos/apache/spark/pulls/28034/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28034/comments,https://api.github.com/repos/apache/spark/statuses/dcf223538461af6257a21ec186701ad56e8787c3,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-31268,SPARK-31268,dcf223538461af6257a21ec186701ad56e8787c3,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,35d286bafb248a47a1125908c0208cd759dd0416,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28034,https://github.com/apache/spark/pull/28034,https://api.github.com/repos/apache/spark/issues/28034,https://api.github.com/repos/apache/spark/issues/28034/comments,https://api.github.com/repos/apache/spark/pulls/28034/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28034/commits,https://api.github.com/repos/apache/spark/statuses/dcf223538461af6257a21ec186701ad56e8787c3
49,https://api.github.com/repos/apache/spark/pulls/28032,393977239,MDExOlB1bGxSZXF1ZXN0MzkzOTc3MjM5,https://github.com/apache/spark/pull/28032,https://github.com/apache/spark/pull/28032.diff,https://github.com/apache/spark/pull/28032.patch,https://api.github.com/repos/apache/spark/issues/28032,28032,open,False,[SPARK-31264][SQL] Repartition by dynamic partition columns before insert partition table,"### What changes were proposed in this pull request?
This PR add two rule `RepartitionBeforeInsertDataSourceTable` and `RepartitionBeforeInsertHiveTable` to support add repartition by dynamic partition columns before insert partition table.



### Why are the changes needed?
To ease pressure on the NameNode and improve insert performance.

Before this PR. The task will throw exception and create many blocks on HDFS:
![image](https://user-images.githubusercontent.com/5399861/77612149-62020880-6f62-11ea-8b2f-dfd46d0fc5a6.png)
![image](https://user-images.githubusercontent.com/5399861/77612239-9bd30f00-6f62-11ea-9178-3bcd65aa4034.png)



### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit test and benchmark test:
Query | Before this PR | After this PR
-- | -- | --
CREATE TABLE t1 USING parquet   PARTITIONED BY (p1, p2) AS (SELECT id, id % 1000 AS p1, id % 10000 AS p2 FROM   range(5000000)) | 15 min | 1.1 min

",2020-03-26T06:12:14Z,2020-03-28T07:09:57Z,,,d8288d893545de61eded5367c5043110ff352bcf,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/28032/commits,https://api.github.com/repos/apache/spark/pulls/28032/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28032/comments,https://api.github.com/repos/apache/spark/statuses/f094e4a6db8c07e98a07224f54e2bdfadb3b8996,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-31264,SPARK-31264,f094e4a6db8c07e98a07224f54e2bdfadb3b8996,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,d81df56f2dbd9757c87101fa32c28cf0cd96f278,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28032,https://github.com/apache/spark/pull/28032,https://api.github.com/repos/apache/spark/issues/28032,https://api.github.com/repos/apache/spark/issues/28032/comments,https://api.github.com/repos/apache/spark/pulls/28032/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28032/commits,https://api.github.com/repos/apache/spark/statuses/f094e4a6db8c07e98a07224f54e2bdfadb3b8996
50,https://api.github.com/repos/apache/spark/pulls/28027,393862664,MDExOlB1bGxSZXF1ZXN0MzkzODYyNjY0,https://github.com/apache/spark/pull/28027,https://github.com/apache/spark/pull/28027.diff,https://github.com/apache/spark/pull/28027.patch,https://api.github.com/repos/apache/spark/issues/28027,28027,open,False,[SPARK-31255][SQL] Add SupportsMetadataColumns to DSv2 (WIP),"### What changes were proposed in this pull request?

This adds support for metadata columns to DataSourceV2. If a source implements `SupportsMetadataColumns` it must also implement `SupportsPushDownRequiredColumns` to support projecting those columns.

The analyzer is updated to resolve metadata columns from `LogicalPlan.metadataOutput`, and this adds a rule that will add metadata columns to the output of `DataSourceV2Relation` if one is used.

### Why are the changes needed?

This is the solution discussed for exposing additional data in the Kafka source. It is also needed for a generic `MERGE INTO` plan.

### Does this PR introduce any user-facing change?

Yes. Users can project additional columns from sources that implement the new API. This also updates `DescribeTableExec` to show metadata columns.

### How was this patch tested?

Will include new unit tests.",2020-03-25T22:37:10Z,2020-03-27T21:24:27Z,,,2d0577509b081173082b9324f4027b329cbb5348,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28027/commits,https://api.github.com/repos/apache/spark/pulls/28027/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28027/comments,https://api.github.com/repos/apache/spark/statuses/0a5c7caebb807f2d256ce696ba8112acc24292b7,CONTRIBUTOR,spark,apache,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,rdblue:add-dsv2-metadata-columns,add-dsv2-metadata-columns,0a5c7caebb807f2d256ce696ba8112acc24292b7,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,26284539,MDEwOlJlcG9zaXRvcnkyNjI4NDUzOQ==,spark,rdblue/spark,False,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,https://github.com/rdblue/spark,Mirror of Apache Spark,True,https://api.github.com/repos/rdblue/spark,https://api.github.com/repos/rdblue/spark/forks,https://api.github.com/repos/rdblue/spark/keys{/key_id},https://api.github.com/repos/rdblue/spark/collaborators{/collaborator},https://api.github.com/repos/rdblue/spark/teams,https://api.github.com/repos/rdblue/spark/hooks,https://api.github.com/repos/rdblue/spark/issues/events{/number},https://api.github.com/repos/rdblue/spark/events,https://api.github.com/repos/rdblue/spark/assignees{/user},https://api.github.com/repos/rdblue/spark/branches{/branch},https://api.github.com/repos/rdblue/spark/tags,https://api.github.com/repos/rdblue/spark/git/blobs{/sha},https://api.github.com/repos/rdblue/spark/git/tags{/sha},https://api.github.com/repos/rdblue/spark/git/refs{/sha},https://api.github.com/repos/rdblue/spark/git/trees{/sha},https://api.github.com/repos/rdblue/spark/statuses/{sha},https://api.github.com/repos/rdblue/spark/languages,https://api.github.com/repos/rdblue/spark/stargazers,https://api.github.com/repos/rdblue/spark/contributors,https://api.github.com/repos/rdblue/spark/subscribers,https://api.github.com/repos/rdblue/spark/subscription,https://api.github.com/repos/rdblue/spark/commits{/sha},https://api.github.com/repos/rdblue/spark/git/commits{/sha},https://api.github.com/repos/rdblue/spark/comments{/number},https://api.github.com/repos/rdblue/spark/issues/comments{/number},https://api.github.com/repos/rdblue/spark/contents/{+path},https://api.github.com/repos/rdblue/spark/compare/{base}...{head},https://api.github.com/repos/rdblue/spark/merges,https://api.github.com/repos/rdblue/spark/{archive_format}{/ref},https://api.github.com/repos/rdblue/spark/downloads,https://api.github.com/repos/rdblue/spark/issues{/number},https://api.github.com/repos/rdblue/spark/pulls{/number},https://api.github.com/repos/rdblue/spark/milestones{/number},"https://api.github.com/repos/rdblue/spark/notifications{?since,all,participating}",https://api.github.com/repos/rdblue/spark/labels{/name},https://api.github.com/repos/rdblue/spark/releases{/id},https://api.github.com/repos/rdblue/spark/deployments,2014-11-06T18:50:45Z,2019-05-30T21:42:21Z,2020-04-02T23:43:47Z,git://github.com/rdblue/spark.git,git@github.com:rdblue/spark.git,https://github.com/rdblue/spark.git,https://github.com/rdblue/spark,,298310,1,1,Scala,False,True,True,False,False,0,,False,False,2,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,2,1,master,apache:master,master,f206bbde3a8f64650236013d61680faba492d7a4,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28027,https://github.com/apache/spark/pull/28027,https://api.github.com/repos/apache/spark/issues/28027,https://api.github.com/repos/apache/spark/issues/28027/comments,https://api.github.com/repos/apache/spark/pulls/28027/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28027/commits,https://api.github.com/repos/apache/spark/statuses/0a5c7caebb807f2d256ce696ba8112acc24292b7
51,https://api.github.com/repos/apache/spark/pulls/28026,393855449,MDExOlB1bGxSZXF1ZXN0MzkzODU1NDQ5,https://github.com/apache/spark/pull/28026,https://github.com/apache/spark/pull/28026.diff,https://github.com/apache/spark/pull/28026.patch,https://api.github.com/repos/apache/spark/issues/28026,28026,open,False,[SPARK-31257][SQL] Unify create table syntax,"### What changes were proposed in this pull request?

* Unify the create table syntax in the parser by merging Hive and DataSource clauses
* Add `SerdeInfo` and `external` boolean to statement plans and update AstBuilder to produce them
* Add conversion from create statement plan to v1 create plans in ResolveSessionCatalog
* Support new statement clauses in ResolveCatalogs conversion to v2 create plans
* Remove SparkSqlParser rules for Hive syntax
* Add ""option."" namespace to distinguish SERDEPROPERTIES and OPTIONS in table properties

### Why are the changes needed?

* Current behavior is confusing.
* A way to pass the Hive create options to DSv2 is needed for a Hive source.

### Does this PR introduce any user-facing change?

Not by default, but v2 sources will be able to handle STORED AS and other Hive clauses.

### How was this patch tested?

Existing tests validate there are no behavior changes.

Update unit tests for using a statement plan for Hive create syntax:
* Move create tests from spark-sql DDLParserSuite into PlanResolutionSuite
* Add parser tests to spark-catalyst DDLParserSuite",2020-03-25T22:17:56Z,2020-04-09T16:04:16Z,,,5c86cd9bfd0122ccd8b25fd16b0ed00a2e3850a2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28026/commits,https://api.github.com/repos/apache/spark/pulls/28026/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28026/comments,https://api.github.com/repos/apache/spark/statuses/7204dd40f1e0de1fa99241e538b62dfcc7fd3058,CONTRIBUTOR,spark,apache,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,rdblue:unify-create-table,unify-create-table,7204dd40f1e0de1fa99241e538b62dfcc7fd3058,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,26284539,MDEwOlJlcG9zaXRvcnkyNjI4NDUzOQ==,spark,rdblue/spark,False,rdblue,87915,MDQ6VXNlcjg3OTE1,https://avatars1.githubusercontent.com/u/87915?v=4,,https://api.github.com/users/rdblue,https://github.com/rdblue,https://api.github.com/users/rdblue/followers,https://api.github.com/users/rdblue/following{/other_user},https://api.github.com/users/rdblue/gists{/gist_id},https://api.github.com/users/rdblue/starred{/owner}{/repo},https://api.github.com/users/rdblue/subscriptions,https://api.github.com/users/rdblue/orgs,https://api.github.com/users/rdblue/repos,https://api.github.com/users/rdblue/events{/privacy},https://api.github.com/users/rdblue/received_events,User,False,https://github.com/rdblue/spark,Mirror of Apache Spark,True,https://api.github.com/repos/rdblue/spark,https://api.github.com/repos/rdblue/spark/forks,https://api.github.com/repos/rdblue/spark/keys{/key_id},https://api.github.com/repos/rdblue/spark/collaborators{/collaborator},https://api.github.com/repos/rdblue/spark/teams,https://api.github.com/repos/rdblue/spark/hooks,https://api.github.com/repos/rdblue/spark/issues/events{/number},https://api.github.com/repos/rdblue/spark/events,https://api.github.com/repos/rdblue/spark/assignees{/user},https://api.github.com/repos/rdblue/spark/branches{/branch},https://api.github.com/repos/rdblue/spark/tags,https://api.github.com/repos/rdblue/spark/git/blobs{/sha},https://api.github.com/repos/rdblue/spark/git/tags{/sha},https://api.github.com/repos/rdblue/spark/git/refs{/sha},https://api.github.com/repos/rdblue/spark/git/trees{/sha},https://api.github.com/repos/rdblue/spark/statuses/{sha},https://api.github.com/repos/rdblue/spark/languages,https://api.github.com/repos/rdblue/spark/stargazers,https://api.github.com/repos/rdblue/spark/contributors,https://api.github.com/repos/rdblue/spark/subscribers,https://api.github.com/repos/rdblue/spark/subscription,https://api.github.com/repos/rdblue/spark/commits{/sha},https://api.github.com/repos/rdblue/spark/git/commits{/sha},https://api.github.com/repos/rdblue/spark/comments{/number},https://api.github.com/repos/rdblue/spark/issues/comments{/number},https://api.github.com/repos/rdblue/spark/contents/{+path},https://api.github.com/repos/rdblue/spark/compare/{base}...{head},https://api.github.com/repos/rdblue/spark/merges,https://api.github.com/repos/rdblue/spark/{archive_format}{/ref},https://api.github.com/repos/rdblue/spark/downloads,https://api.github.com/repos/rdblue/spark/issues{/number},https://api.github.com/repos/rdblue/spark/pulls{/number},https://api.github.com/repos/rdblue/spark/milestones{/number},"https://api.github.com/repos/rdblue/spark/notifications{?since,all,participating}",https://api.github.com/repos/rdblue/spark/labels{/name},https://api.github.com/repos/rdblue/spark/releases{/id},https://api.github.com/repos/rdblue/spark/deployments,2014-11-06T18:50:45Z,2019-05-30T21:42:21Z,2020-04-02T23:43:47Z,git://github.com/rdblue/spark.git,git@github.com:rdblue/spark.git,https://github.com/rdblue/spark.git,https://github.com/rdblue/spark,,298310,1,1,Scala,False,True,True,False,False,0,,False,False,2,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,2,1,master,apache:master,master,2c39502e841b344b431473a0a4f79591b9b1fe38,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28026,https://github.com/apache/spark/pull/28026,https://api.github.com/repos/apache/spark/issues/28026,https://api.github.com/repos/apache/spark/issues/28026/comments,https://api.github.com/repos/apache/spark/pulls/28026/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28026/commits,https://api.github.com/repos/apache/spark/statuses/7204dd40f1e0de1fa99241e538b62dfcc7fd3058
52,https://api.github.com/repos/apache/spark/pulls/28009,393338161,MDExOlB1bGxSZXF1ZXN0MzkzMzM4MTYx,https://github.com/apache/spark/pull/28009,https://github.com/apache/spark/pull/28009.diff,https://github.com/apache/spark/pull/28009.patch,https://api.github.com/repos/apache/spark/issues/28009,28009,open,False,[SPARK-31235][YARN] Separates different categories of applications,"### What changes were proposed in this pull request?
This PR adds `spark.yarn.applicationType` to identify the application type


### Why are the changes needed?
The current application defaults to the SPARK type. 
In fact, different types of applications have different characteristics and are suitable for different scenarios.For example: SPAKR-SQL, SPARK-STREAMING.
I recommend distinguishing them by the parameter `spark.yarn.applicationType` so that we can more easily manage and maintain different types of applications.


### How was this patch tested?
1.add UT
2.Tested by verifying Yarn-UI `ApplicationType` in the following cases:
- client and cluster mode

Need additional explanation:
limit cannot exceed 20 characters, can be empty or space
The reasons are as follows:
```    
// org.apache.hadoop.yarn.server.resourcemanager.submitApplication.
 if (submissionContext.getApplicationType() == null) {
      submissionContext
        .setApplicationType(YarnConfiguration.DEFAULT_APPLICATION_TYPE);
} else {
      // APPLICATION_TYPE_LENGTH = 20
      if (submissionContext.getApplicationType().length() > YarnConfiguration.APPLICATION_TYPE_LENGTH) {
        submissionContext.setApplicationType(submissionContext
          .getApplicationType().substring(0,
            YarnConfiguration.APPLICATION_TYPE_LENGTH));
      }
    }
```",2020-03-25T01:40:57Z,2020-04-07T17:39:07Z,,,c9dd1e5667fd32eb9ae0823ff19103663e109fd4,,[],"[{'login': 'tgravescs', 'id': 4563792, 'node_id': 'MDQ6VXNlcjQ1NjM3OTI=', 'avatar_url': 'https://avatars2.githubusercontent.com/u/4563792?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/tgravescs', 'html_url': 'https://github.com/tgravescs', 'followers_url': 'https://api.github.com/users/tgravescs/followers', 'following_url': 'https://api.github.com/users/tgravescs/following{/other_user}', 'gists_url': 'https://api.github.com/users/tgravescs/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/tgravescs/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/tgravescs/subscriptions', 'organizations_url': 'https://api.github.com/users/tgravescs/orgs', 'repos_url': 'https://api.github.com/users/tgravescs/repos', 'events_url': 'https://api.github.com/users/tgravescs/events{/privacy}', 'received_events_url': 'https://api.github.com/users/tgravescs/received_events', 'type': 'User', 'site_admin': False}]",[],[],,False,https://api.github.com/repos/apache/spark/pulls/28009/commits,https://api.github.com/repos/apache/spark/pulls/28009/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28009/comments,https://api.github.com/repos/apache/spark/statuses/76e9a2a215c1699bb3a79d6ed2372aebb8104278,NONE,spark,apache,wang-zhun,61445191,MDQ6VXNlcjYxNDQ1MTkx,https://avatars2.githubusercontent.com/u/61445191?v=4,,https://api.github.com/users/wang-zhun,https://github.com/wang-zhun,https://api.github.com/users/wang-zhun/followers,https://api.github.com/users/wang-zhun/following{/other_user},https://api.github.com/users/wang-zhun/gists{/gist_id},https://api.github.com/users/wang-zhun/starred{/owner}{/repo},https://api.github.com/users/wang-zhun/subscriptions,https://api.github.com/users/wang-zhun/orgs,https://api.github.com/users/wang-zhun/repos,https://api.github.com/users/wang-zhun/events{/privacy},https://api.github.com/users/wang-zhun/received_events,User,False,wang-zhun:SPARK-31235,SPARK-31235,76e9a2a215c1699bb3a79d6ed2372aebb8104278,wang-zhun,61445191,MDQ6VXNlcjYxNDQ1MTkx,https://avatars2.githubusercontent.com/u/61445191?v=4,,https://api.github.com/users/wang-zhun,https://github.com/wang-zhun,https://api.github.com/users/wang-zhun/followers,https://api.github.com/users/wang-zhun/following{/other_user},https://api.github.com/users/wang-zhun/gists{/gist_id},https://api.github.com/users/wang-zhun/starred{/owner}{/repo},https://api.github.com/users/wang-zhun/subscriptions,https://api.github.com/users/wang-zhun/orgs,https://api.github.com/users/wang-zhun/repos,https://api.github.com/users/wang-zhun/events{/privacy},https://api.github.com/users/wang-zhun/received_events,User,False,242920021,MDEwOlJlcG9zaXRvcnkyNDI5MjAwMjE=,spark,wang-zhun/spark,False,wang-zhun,61445191,MDQ6VXNlcjYxNDQ1MTkx,https://avatars2.githubusercontent.com/u/61445191?v=4,,https://api.github.com/users/wang-zhun,https://github.com/wang-zhun,https://api.github.com/users/wang-zhun/followers,https://api.github.com/users/wang-zhun/following{/other_user},https://api.github.com/users/wang-zhun/gists{/gist_id},https://api.github.com/users/wang-zhun/starred{/owner}{/repo},https://api.github.com/users/wang-zhun/subscriptions,https://api.github.com/users/wang-zhun/orgs,https://api.github.com/users/wang-zhun/repos,https://api.github.com/users/wang-zhun/events{/privacy},https://api.github.com/users/wang-zhun/received_events,User,False,https://github.com/wang-zhun/spark,Apache Spark,True,https://api.github.com/repos/wang-zhun/spark,https://api.github.com/repos/wang-zhun/spark/forks,https://api.github.com/repos/wang-zhun/spark/keys{/key_id},https://api.github.com/repos/wang-zhun/spark/collaborators{/collaborator},https://api.github.com/repos/wang-zhun/spark/teams,https://api.github.com/repos/wang-zhun/spark/hooks,https://api.github.com/repos/wang-zhun/spark/issues/events{/number},https://api.github.com/repos/wang-zhun/spark/events,https://api.github.com/repos/wang-zhun/spark/assignees{/user},https://api.github.com/repos/wang-zhun/spark/branches{/branch},https://api.github.com/repos/wang-zhun/spark/tags,https://api.github.com/repos/wang-zhun/spark/git/blobs{/sha},https://api.github.com/repos/wang-zhun/spark/git/tags{/sha},https://api.github.com/repos/wang-zhun/spark/git/refs{/sha},https://api.github.com/repos/wang-zhun/spark/git/trees{/sha},https://api.github.com/repos/wang-zhun/spark/statuses/{sha},https://api.github.com/repos/wang-zhun/spark/languages,https://api.github.com/repos/wang-zhun/spark/stargazers,https://api.github.com/repos/wang-zhun/spark/contributors,https://api.github.com/repos/wang-zhun/spark/subscribers,https://api.github.com/repos/wang-zhun/spark/subscription,https://api.github.com/repos/wang-zhun/spark/commits{/sha},https://api.github.com/repos/wang-zhun/spark/git/commits{/sha},https://api.github.com/repos/wang-zhun/spark/comments{/number},https://api.github.com/repos/wang-zhun/spark/issues/comments{/number},https://api.github.com/repos/wang-zhun/spark/contents/{+path},https://api.github.com/repos/wang-zhun/spark/compare/{base}...{head},https://api.github.com/repos/wang-zhun/spark/merges,https://api.github.com/repos/wang-zhun/spark/{archive_format}{/ref},https://api.github.com/repos/wang-zhun/spark/downloads,https://api.github.com/repos/wang-zhun/spark/issues{/number},https://api.github.com/repos/wang-zhun/spark/pulls{/number},https://api.github.com/repos/wang-zhun/spark/milestones{/number},"https://api.github.com/repos/wang-zhun/spark/notifications{?since,all,participating}",https://api.github.com/repos/wang-zhun/spark/labels{/name},https://api.github.com/repos/wang-zhun/spark/releases{/id},https://api.github.com/repos/wang-zhun/spark/deployments,2020-02-25T05:42:03Z,2020-02-25T12:50:00Z,2020-04-07T17:01:31Z,git://github.com/wang-zhun/spark.git,git@github.com:wang-zhun/spark.git,https://github.com/wang-zhun/spark.git,https://github.com/wang-zhun/spark,,322231,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,999c9ed10c2362d89afd3bbb48e35f3c7ac3cf89,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28009,https://github.com/apache/spark/pull/28009,https://api.github.com/repos/apache/spark/issues/28009,https://api.github.com/repos/apache/spark/issues/28009/comments,https://api.github.com/repos/apache/spark/pulls/28009/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28009/commits,https://api.github.com/repos/apache/spark/statuses/76e9a2a215c1699bb3a79d6ed2372aebb8104278
53,https://api.github.com/repos/apache/spark/pulls/28002,392992163,MDExOlB1bGxSZXF1ZXN0MzkyOTkyMTYz,https://github.com/apache/spark/pull/28002,https://github.com/apache/spark/pull/28002.diff,https://github.com/apache/spark/pull/28002.patch,https://api.github.com/repos/apache/spark/issues/28002,28002,open,False,[SPARK-31233][Core] Enhance RpcTimeoutException Log Message,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
askAbortable method throw TimeoutException while it does no complete in time. Currently, the error message contains null as remoteAddr when receiver is in client mode. 
This change is to print out correct rpcAddress instead of null in the error message.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
It provides the address of an endpoint which does not reply in time. It helps users to find slow executors when timeout happens. 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Add a unit test.",2020-03-24T13:30:38Z,2020-04-03T00:47:07Z,,,80c08d45e17f82e03b8400245d3f2258012b03fb,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/28002/commits,https://api.github.com/repos/apache/spark/pulls/28002/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/28002/comments,https://api.github.com/repos/apache/spark/statuses/524fe5a084c22db9ee0f19cc3db76c5f87ed7cf5,NONE,spark,apache,Huang-yi-3456,9216029,MDQ6VXNlcjkyMTYwMjk=,https://avatars1.githubusercontent.com/u/9216029?v=4,,https://api.github.com/users/Huang-yi-3456,https://github.com/Huang-yi-3456,https://api.github.com/users/Huang-yi-3456/followers,https://api.github.com/users/Huang-yi-3456/following{/other_user},https://api.github.com/users/Huang-yi-3456/gists{/gist_id},https://api.github.com/users/Huang-yi-3456/starred{/owner}{/repo},https://api.github.com/users/Huang-yi-3456/subscriptions,https://api.github.com/users/Huang-yi-3456/orgs,https://api.github.com/users/Huang-yi-3456/repos,https://api.github.com/users/Huang-yi-3456/events{/privacy},https://api.github.com/users/Huang-yi-3456/received_events,User,False,Huang-yi-3456:SPARK-31233-enhance-rpctimeoutexception-log,SPARK-31233-enhance-rpctimeoutexception-log,524fe5a084c22db9ee0f19cc3db76c5f87ed7cf5,Huang-yi-3456,9216029,MDQ6VXNlcjkyMTYwMjk=,https://avatars1.githubusercontent.com/u/9216029?v=4,,https://api.github.com/users/Huang-yi-3456,https://github.com/Huang-yi-3456,https://api.github.com/users/Huang-yi-3456/followers,https://api.github.com/users/Huang-yi-3456/following{/other_user},https://api.github.com/users/Huang-yi-3456/gists{/gist_id},https://api.github.com/users/Huang-yi-3456/starred{/owner}{/repo},https://api.github.com/users/Huang-yi-3456/subscriptions,https://api.github.com/users/Huang-yi-3456/orgs,https://api.github.com/users/Huang-yi-3456/repos,https://api.github.com/users/Huang-yi-3456/events{/privacy},https://api.github.com/users/Huang-yi-3456/received_events,User,False,196118798,MDEwOlJlcG9zaXRvcnkxOTYxMTg3OTg=,spark,Huang-yi-3456/spark,False,Huang-yi-3456,9216029,MDQ6VXNlcjkyMTYwMjk=,https://avatars1.githubusercontent.com/u/9216029?v=4,,https://api.github.com/users/Huang-yi-3456,https://github.com/Huang-yi-3456,https://api.github.com/users/Huang-yi-3456/followers,https://api.github.com/users/Huang-yi-3456/following{/other_user},https://api.github.com/users/Huang-yi-3456/gists{/gist_id},https://api.github.com/users/Huang-yi-3456/starred{/owner}{/repo},https://api.github.com/users/Huang-yi-3456/subscriptions,https://api.github.com/users/Huang-yi-3456/orgs,https://api.github.com/users/Huang-yi-3456/repos,https://api.github.com/users/Huang-yi-3456/events{/privacy},https://api.github.com/users/Huang-yi-3456/received_events,User,False,https://github.com/Huang-yi-3456/spark,Apache Spark,True,https://api.github.com/repos/Huang-yi-3456/spark,https://api.github.com/repos/Huang-yi-3456/spark/forks,https://api.github.com/repos/Huang-yi-3456/spark/keys{/key_id},https://api.github.com/repos/Huang-yi-3456/spark/collaborators{/collaborator},https://api.github.com/repos/Huang-yi-3456/spark/teams,https://api.github.com/repos/Huang-yi-3456/spark/hooks,https://api.github.com/repos/Huang-yi-3456/spark/issues/events{/number},https://api.github.com/repos/Huang-yi-3456/spark/events,https://api.github.com/repos/Huang-yi-3456/spark/assignees{/user},https://api.github.com/repos/Huang-yi-3456/spark/branches{/branch},https://api.github.com/repos/Huang-yi-3456/spark/tags,https://api.github.com/repos/Huang-yi-3456/spark/git/blobs{/sha},https://api.github.com/repos/Huang-yi-3456/spark/git/tags{/sha},https://api.github.com/repos/Huang-yi-3456/spark/git/refs{/sha},https://api.github.com/repos/Huang-yi-3456/spark/git/trees{/sha},https://api.github.com/repos/Huang-yi-3456/spark/statuses/{sha},https://api.github.com/repos/Huang-yi-3456/spark/languages,https://api.github.com/repos/Huang-yi-3456/spark/stargazers,https://api.github.com/repos/Huang-yi-3456/spark/contributors,https://api.github.com/repos/Huang-yi-3456/spark/subscribers,https://api.github.com/repos/Huang-yi-3456/spark/subscription,https://api.github.com/repos/Huang-yi-3456/spark/commits{/sha},https://api.github.com/repos/Huang-yi-3456/spark/git/commits{/sha},https://api.github.com/repos/Huang-yi-3456/spark/comments{/number},https://api.github.com/repos/Huang-yi-3456/spark/issues/comments{/number},https://api.github.com/repos/Huang-yi-3456/spark/contents/{+path},https://api.github.com/repos/Huang-yi-3456/spark/compare/{base}...{head},https://api.github.com/repos/Huang-yi-3456/spark/merges,https://api.github.com/repos/Huang-yi-3456/spark/{archive_format}{/ref},https://api.github.com/repos/Huang-yi-3456/spark/downloads,https://api.github.com/repos/Huang-yi-3456/spark/issues{/number},https://api.github.com/repos/Huang-yi-3456/spark/pulls{/number},https://api.github.com/repos/Huang-yi-3456/spark/milestones{/number},"https://api.github.com/repos/Huang-yi-3456/spark/notifications{?since,all,participating}",https://api.github.com/repos/Huang-yi-3456/spark/labels{/name},https://api.github.com/repos/Huang-yi-3456/spark/releases{/id},https://api.github.com/repos/Huang-yi-3456/spark/deployments,2019-07-10T02:48:10Z,2019-07-10T02:48:41Z,2020-04-02T22:08:49Z,git://github.com/Huang-yi-3456/spark.git,git@github.com:Huang-yi-3456/spark.git,https://github.com/Huang-yi-3456/spark.git,https://github.com/Huang-yi-3456/spark,,312017,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1fd4607d844905f10fe1edbfd6282c25b95b233d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/28002,https://github.com/apache/spark/pull/28002,https://api.github.com/repos/apache/spark/issues/28002,https://api.github.com/repos/apache/spark/issues/28002/comments,https://api.github.com/repos/apache/spark/pulls/28002/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/28002/commits,https://api.github.com/repos/apache/spark/statuses/524fe5a084c22db9ee0f19cc3db76c5f87ed7cf5
54,https://api.github.com/repos/apache/spark/pulls/27993,392427959,MDExOlB1bGxSZXF1ZXN0MzkyNDI3OTU5,https://github.com/apache/spark/pull/27993,https://github.com/apache/spark/pull/27993.diff,https://github.com/apache/spark/pull/27993.patch,https://api.github.com/repos/apache/spark/issues/27993,27993,open,False,[SPARK-30996][SQL] invaild parquet map key type,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
add parquet Map Key type verification 


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
Illegal parquet data type should not be written

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
no

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
add tests",2020-03-23T14:41:44Z,2020-04-07T23:57:29Z,,,c99de01552870baf6b7607e2de39c9d3df3b6aa8,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27993/commits,https://api.github.com/repos/apache/spark/pulls/27993/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27993/comments,https://api.github.com/repos/apache/spark/statuses/6e3e1a0cc6a82652baba6c26451a95f495eb42f9,NONE,spark,apache,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,MrDLontheway:SPARK-30996,SPARK-30996,6e3e1a0cc6a82652baba6c26451a95f495eb42f9,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,170981390,MDEwOlJlcG9zaXRvcnkxNzA5ODEzOTA=,spark,MrDLontheway/spark,False,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,https://github.com/MrDLontheway/spark,Apache Spark,True,https://api.github.com/repos/MrDLontheway/spark,https://api.github.com/repos/MrDLontheway/spark/forks,https://api.github.com/repos/MrDLontheway/spark/keys{/key_id},https://api.github.com/repos/MrDLontheway/spark/collaborators{/collaborator},https://api.github.com/repos/MrDLontheway/spark/teams,https://api.github.com/repos/MrDLontheway/spark/hooks,https://api.github.com/repos/MrDLontheway/spark/issues/events{/number},https://api.github.com/repos/MrDLontheway/spark/events,https://api.github.com/repos/MrDLontheway/spark/assignees{/user},https://api.github.com/repos/MrDLontheway/spark/branches{/branch},https://api.github.com/repos/MrDLontheway/spark/tags,https://api.github.com/repos/MrDLontheway/spark/git/blobs{/sha},https://api.github.com/repos/MrDLontheway/spark/git/tags{/sha},https://api.github.com/repos/MrDLontheway/spark/git/refs{/sha},https://api.github.com/repos/MrDLontheway/spark/git/trees{/sha},https://api.github.com/repos/MrDLontheway/spark/statuses/{sha},https://api.github.com/repos/MrDLontheway/spark/languages,https://api.github.com/repos/MrDLontheway/spark/stargazers,https://api.github.com/repos/MrDLontheway/spark/contributors,https://api.github.com/repos/MrDLontheway/spark/subscribers,https://api.github.com/repos/MrDLontheway/spark/subscription,https://api.github.com/repos/MrDLontheway/spark/commits{/sha},https://api.github.com/repos/MrDLontheway/spark/git/commits{/sha},https://api.github.com/repos/MrDLontheway/spark/comments{/number},https://api.github.com/repos/MrDLontheway/spark/issues/comments{/number},https://api.github.com/repos/MrDLontheway/spark/contents/{+path},https://api.github.com/repos/MrDLontheway/spark/compare/{base}...{head},https://api.github.com/repos/MrDLontheway/spark/merges,https://api.github.com/repos/MrDLontheway/spark/{archive_format}{/ref},https://api.github.com/repos/MrDLontheway/spark/downloads,https://api.github.com/repos/MrDLontheway/spark/issues{/number},https://api.github.com/repos/MrDLontheway/spark/pulls{/number},https://api.github.com/repos/MrDLontheway/spark/milestones{/number},"https://api.github.com/repos/MrDLontheway/spark/notifications{?since,all,participating}",https://api.github.com/repos/MrDLontheway/spark/labels{/name},https://api.github.com/repos/MrDLontheway/spark/releases{/id},https://api.github.com/repos/MrDLontheway/spark/deployments,2019-02-16T08:37:47Z,2019-09-03T02:50:23Z,2020-04-06T09:26:14Z,git://github.com/MrDLontheway/spark.git,git@github.com:MrDLontheway/spark.git,https://github.com/MrDLontheway/spark.git,https://github.com/MrDLontheway/spark,,324323,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,112caea214ac354b771be11bbfd41cac2bf12a28,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27993,https://github.com/apache/spark/pull/27993,https://api.github.com/repos/apache/spark/issues/27993,https://api.github.com/repos/apache/spark/issues/27993/comments,https://api.github.com/repos/apache/spark/pulls/27993/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27993/commits,https://api.github.com/repos/apache/spark/statuses/6e3e1a0cc6a82652baba6c26451a95f495eb42f9
55,https://api.github.com/repos/apache/spark/pulls/27988,392254652,MDExOlB1bGxSZXF1ZXN0MzkyMjU0NjUy,https://github.com/apache/spark/pull/27988,https://github.com/apache/spark/pull/27988.diff,https://github.com/apache/spark/pull/27988.patch,https://api.github.com/repos/apache/spark/issues/27988,27988,open,False,[SPARK-31226][CORE][TEST] SizeBasedCoalesce logic will lose partition,"### What changes were proposed in this pull request?

When last partition's splitFile's split size is larger then  maxSize, this partition will be lost

Origin logic error like below
```

  // 3. since index = partition.size now,  jump out of the loop , then the last partition is lost since we won't call updatePartition() again.
while (index < partitions.size) {
     //  we assume that when index = partitions.length -1  and 
      //  splitSize > maxSize
      val partition = partitions(index)
      val fileSplit =
        partition.asInstanceOf[HadoopPartition].inputSplit.value.asInstanceOf[FileSplit]
      val splitSize = fileSplit.getLength
      if (currentSum + splitSize < maxSize) {
        addPartition(partition, splitSize)
        index += 1
        if (index == partitions.size) {
          updateGroups
        }
      } else {
       //  2.then  will addPartition() to currentGroup and index updated , index = partition.size now
        if (currentGroup.partitions.size == 0) {
          addPartition(partition, splitSize)
          index += 1
        } else {
        //   1. will call updateGroups() here first, and index won't update
          updateGroups
        }
      }
    }
    groups.toArray
  }
}
```
### Why are the changes needed?
Fix bug


### Does this PR introduce any user-facing change?
NO

### How was this patch tested?
NO
",2020-03-23T09:13:47Z,2020-04-06T13:24:23Z,,,cc48e924add3b7369851999dbe85bf671bb77a1b,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406606402, 'node_id': 'MDU6TGFiZWwxNDA2NjA2NDAy', 'url': 'https://api.github.com/repos/apache/spark/labels/TESTS', 'name': 'TESTS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27988/commits,https://api.github.com/repos/apache/spark/pulls/27988/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27988/comments,https://api.github.com/repos/apache/spark/statuses/2c4ef1431cec3b82da3b40fb7fb4a92f4a10e9d4,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-31226,SPARK-31226,2c4ef1431cec3b82da3b40fb7fb4a92f4a10e9d4,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,5c4d44bb83aafc296265524ec1ee09bcd11365ae,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27988,https://github.com/apache/spark/pull/27988,https://api.github.com/repos/apache/spark/issues/27988,https://api.github.com/repos/apache/spark/issues/27988/comments,https://api.github.com/repos/apache/spark/pulls/27988/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27988/commits,https://api.github.com/repos/apache/spark/statuses/2c4ef1431cec3b82da3b40fb7fb4a92f4a10e9d4
56,https://api.github.com/repos/apache/spark/pulls/27987,392251256,MDExOlB1bGxSZXF1ZXN0MzkyMjUxMjU2,https://github.com/apache/spark/pull/27987,https://github.com/apache/spark/pull/27987.diff,https://github.com/apache/spark/pull/27987.patch,https://api.github.com/repos/apache/spark/issues/27987,27987,open,False,[SPARK-31165] Correcting wrong paths in Dockerfile,"### What changes were proposed in this pull request?
I have changed a few paths in the Dockerfile that do not seem to reflect the structure of the project anymore. I have described this in detail in SPARK-31165.

### Why are the changes needed?
I think this is clear from above and the commit itself. If this is not 

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Manual testing since the Dockerfile build command was not successful, so this mostly involved trial and error.
",2020-03-23T09:07:11Z,2020-04-01T13:08:49Z,,,76eb7f959ea26ab9bbd27391daffbe1a26dd26de,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27987/commits,https://api.github.com/repos/apache/spark/pulls/27987/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27987/comments,https://api.github.com/repos/apache/spark/statuses/944b4bc04f19f650aa58f3bb3a2ba143948716d3,NONE,spark,apache,tech4242,5933291,MDQ6VXNlcjU5MzMyOTE=,https://avatars0.githubusercontent.com/u/5933291?v=4,,https://api.github.com/users/tech4242,https://github.com/tech4242,https://api.github.com/users/tech4242/followers,https://api.github.com/users/tech4242/following{/other_user},https://api.github.com/users/tech4242/gists{/gist_id},https://api.github.com/users/tech4242/starred{/owner}{/repo},https://api.github.com/users/tech4242/subscriptions,https://api.github.com/users/tech4242/orgs,https://api.github.com/users/tech4242/repos,https://api.github.com/users/tech4242/events{/privacy},https://api.github.com/users/tech4242/received_events,User,False,tech4242:master,master,944b4bc04f19f650aa58f3bb3a2ba143948716d3,tech4242,5933291,MDQ6VXNlcjU5MzMyOTE=,https://avatars0.githubusercontent.com/u/5933291?v=4,,https://api.github.com/users/tech4242,https://github.com/tech4242,https://api.github.com/users/tech4242/followers,https://api.github.com/users/tech4242/following{/other_user},https://api.github.com/users/tech4242/gists{/gist_id},https://api.github.com/users/tech4242/starred{/owner}{/repo},https://api.github.com/users/tech4242/subscriptions,https://api.github.com/users/tech4242/orgs,https://api.github.com/users/tech4242/repos,https://api.github.com/users/tech4242/events{/privacy},https://api.github.com/users/tech4242/received_events,User,False,248754745,MDEwOlJlcG9zaXRvcnkyNDg3NTQ3NDU=,spark,tech4242/spark,False,tech4242,5933291,MDQ6VXNlcjU5MzMyOTE=,https://avatars0.githubusercontent.com/u/5933291?v=4,,https://api.github.com/users/tech4242,https://github.com/tech4242,https://api.github.com/users/tech4242/followers,https://api.github.com/users/tech4242/following{/other_user},https://api.github.com/users/tech4242/gists{/gist_id},https://api.github.com/users/tech4242/starred{/owner}{/repo},https://api.github.com/users/tech4242/subscriptions,https://api.github.com/users/tech4242/orgs,https://api.github.com/users/tech4242/repos,https://api.github.com/users/tech4242/events{/privacy},https://api.github.com/users/tech4242/received_events,User,False,https://github.com/tech4242/spark,Apache Spark,True,https://api.github.com/repos/tech4242/spark,https://api.github.com/repos/tech4242/spark/forks,https://api.github.com/repos/tech4242/spark/keys{/key_id},https://api.github.com/repos/tech4242/spark/collaborators{/collaborator},https://api.github.com/repos/tech4242/spark/teams,https://api.github.com/repos/tech4242/spark/hooks,https://api.github.com/repos/tech4242/spark/issues/events{/number},https://api.github.com/repos/tech4242/spark/events,https://api.github.com/repos/tech4242/spark/assignees{/user},https://api.github.com/repos/tech4242/spark/branches{/branch},https://api.github.com/repos/tech4242/spark/tags,https://api.github.com/repos/tech4242/spark/git/blobs{/sha},https://api.github.com/repos/tech4242/spark/git/tags{/sha},https://api.github.com/repos/tech4242/spark/git/refs{/sha},https://api.github.com/repos/tech4242/spark/git/trees{/sha},https://api.github.com/repos/tech4242/spark/statuses/{sha},https://api.github.com/repos/tech4242/spark/languages,https://api.github.com/repos/tech4242/spark/stargazers,https://api.github.com/repos/tech4242/spark/contributors,https://api.github.com/repos/tech4242/spark/subscribers,https://api.github.com/repos/tech4242/spark/subscription,https://api.github.com/repos/tech4242/spark/commits{/sha},https://api.github.com/repos/tech4242/spark/git/commits{/sha},https://api.github.com/repos/tech4242/spark/comments{/number},https://api.github.com/repos/tech4242/spark/issues/comments{/number},https://api.github.com/repos/tech4242/spark/contents/{+path},https://api.github.com/repos/tech4242/spark/compare/{base}...{head},https://api.github.com/repos/tech4242/spark/merges,https://api.github.com/repos/tech4242/spark/{archive_format}{/ref},https://api.github.com/repos/tech4242/spark/downloads,https://api.github.com/repos/tech4242/spark/issues{/number},https://api.github.com/repos/tech4242/spark/pulls{/number},https://api.github.com/repos/tech4242/spark/milestones{/number},"https://api.github.com/repos/tech4242/spark/notifications{?since,all,participating}",https://api.github.com/repos/tech4242/spark/labels{/name},https://api.github.com/repos/tech4242/spark/releases{/id},https://api.github.com/repos/tech4242/spark/deployments,2020-03-20T12:52:49Z,2020-03-20T14:19:22Z,2020-03-20T14:18:51Z,git://github.com/tech4242/spark.git,git@github.com:tech4242/spark.git,https://github.com/tech4242/spark.git,https://github.com/tech4242/spark,,324711,0,0,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,0,master,apache:master,master,5c4d44bb83aafc296265524ec1ee09bcd11365ae,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27987,https://github.com/apache/spark/pull/27987,https://api.github.com/repos/apache/spark/issues/27987,https://api.github.com/repos/apache/spark/issues/27987/comments,https://api.github.com/repos/apache/spark/pulls/27987/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27987/commits,https://api.github.com/repos/apache/spark/statuses/944b4bc04f19f650aa58f3bb3a2ba143948716d3
57,https://api.github.com/repos/apache/spark/pulls/27986,392244438,MDExOlB1bGxSZXF1ZXN0MzkyMjQ0NDM4,https://github.com/apache/spark/pull/27986,https://github.com/apache/spark/pull/27986.diff,https://github.com/apache/spark/pull/27986.patch,https://api.github.com/repos/apache/spark/issues/27986,27986,open,False,[SPARK-31220][SQL] repartition obeys initialPartitionNum when adaptiveExecutionEnabled,"### What changes were proposed in this pull request?
This PR makes `repartition`/`DISTRIBUTE BY` obeys [initialPartitionNum](https://github.com/apache/spark/blob/af4248b2d661d04fec89b37857a47713246d9465/sql/catalyst/src/main/scala/org/apache/spark/sql/internal/SQLConf.scala#L446-L455) when adaptive execution enabled.


### Why are the changes needed?
To make `DISTRIBUTE BY`/`GROUP BY` partitioned by same partition number.
How to reproduce:
```scala
spark.sql(""CREATE TABLE spark_31220(id int)"")
spark.sql(""set spark.sql.adaptive.enabled=true"")
spark.sql(""set spark.sql.adaptive.coalescePartitions.initialPartitionNum=1000"")
```

Before this PR:
```
scala> spark.sql(""SELECT id from spark_31220 GROUP BY id"").explain
== Physical Plan ==
AdaptiveSparkPlan(isFinalPlan=false)
+- HashAggregate(keys=[id#5], functions=[])
   +- Exchange hashpartitioning(id#5, 1000), true, [id=#171]
      +- HashAggregate(keys=[id#5], functions=[])
         +- FileScan parquet default.spark_31220[id#5]

scala> spark.sql(""SELECT id from spark_31220 DISTRIBUTE BY id"").explain
== Physical Plan ==
AdaptiveSparkPlan(isFinalPlan=false)
+- Exchange hashpartitioning(id#5, 200), false, [id=#179]
   +- FileScan parquet default.spark_31220[id#5]
```
After this PR:
```
scala> spark.sql(""SELECT id from spark_31220 GROUP BY id"").explain
== Physical Plan ==
AdaptiveSparkPlan(isFinalPlan=false)
+- HashAggregate(keys=[id#5], functions=[])
   +- Exchange hashpartitioning(id#5, 1000), true, [id=#171]
      +- HashAggregate(keys=[id#5], functions=[])
         +- FileScan parquet default.spark_31220[id#5]

scala> spark.sql(""SELECT id from spark_31220 DISTRIBUTE BY id"").explain
== Physical Plan ==
AdaptiveSparkPlan(isFinalPlan=false)
+- Exchange hashpartitioning(id#5, 1000), false, [id=#179]
   +- FileScan parquet default.spark_31220[id#5]
```

### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit test.
",2020-03-23T08:54:18Z,2020-04-07T13:23:31Z,,,4ab978a09318e43db0406c37c2cc5a37c851e601,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27986/commits,https://api.github.com/repos/apache/spark/pulls/27986/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27986/comments,https://api.github.com/repos/apache/spark/statuses/abf3ef1e256fa50f3935dac233fda06af18bd2c4,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-31220,SPARK-31220,abf3ef1e256fa50f3935dac233fda06af18bd2c4,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,5c4d44bb83aafc296265524ec1ee09bcd11365ae,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27986,https://github.com/apache/spark/pull/27986,https://api.github.com/repos/apache/spark/issues/27986,https://api.github.com/repos/apache/spark/issues/27986/comments,https://api.github.com/repos/apache/spark/pulls/27986/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27986/commits,https://api.github.com/repos/apache/spark/statuses/abf3ef1e256fa50f3935dac233fda06af18bd2c4
58,https://api.github.com/repos/apache/spark/pulls/27983,392178592,MDExOlB1bGxSZXF1ZXN0MzkyMTc4NTky,https://github.com/apache/spark/pull/27983,https://github.com/apache/spark/pull/27983.diff,https://github.com/apache/spark/pull/27983.patch,https://api.github.com/repos/apache/spark/issues/27983,27983,open,False,[SPARK-15694][SQL]Implement ScriptTransformation in sql/core,"### What changes were proposed in this pull request?

 * Renamed `hive/execution/ScriptTransformationExec` to `hive/execution/script/HiveScriptTransformationExec`
 * Added ScriptTransformationExec which would run script operator in SQL mode (without Hive).
The output of script would be read as a string and column values are extracted by using a delimiter (default : tab character)
 * `ScriptTransformBase` has common code used across `ScriptTransformationExec` and `HiveScriptTransformationExec`
 * For thread writing data to script, ScriptTransformationWriterThread has the core logic. HiveScriptTransformationWriterThread extends that for Hive specific stuff.
 * `ScriptTransformationWriterThread` will be used for Spark SQL. It only supports writing data to script process by serializing column values as tab delimited string
 * `HiveScriptTransformationWriterThread` additionally supports Hive serde
 * Added a Strategy named Scripts which would emit ScriptTransformationExec in physical plans. This would be used in non-Hive mode.

Todo List;

- For Hive, by default only serde's must be used, and for without hive can't use serde
- Cleanup past hacks that are observed (and people suggest / report)， such as
       -  support use transform with aggregation [SPARK-28227](https://issues.apache.org/jira/browse/SPARK-28227)
       - support array/map as transform's input [SPARK-22435](https://issues.apache.org/jira/browse/SPARK-22435)
- Use code-gen projection to serialize rows to output stream()

### Why are the changes needed?
Support run transform in SQL mode without hive


### Does this PR introduce any user-facing change?
Yes


### How was this patch tested?
Added UT
",2020-03-23T06:06:33Z,2020-04-02T03:23:41Z,,,c8e456817d8e5c82be61e8a6f81055abda9c7b48,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27983/commits,https://api.github.com/repos/apache/spark/pulls/27983/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27983/comments,https://api.github.com/repos/apache/spark/statuses/0d9c43788b0dfd33a9e37fe7c0dc6d1e1d238f86,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:follow_spark_15694,follow_spark_15694,0d9c43788b0dfd33a9e37fe7c0dc6d1e1d238f86,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,929b794e25ff5454dadde7da304e6df25526d60e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27983,https://github.com/apache/spark/pull/27983,https://api.github.com/repos/apache/spark/issues/27983,https://api.github.com/repos/apache/spark/issues/27983/comments,https://api.github.com/repos/apache/spark/pulls/27983/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27983/commits,https://api.github.com/repos/apache/spark/statuses/0d9c43788b0dfd33a9e37fe7c0dc6d1e1d238f86
59,https://api.github.com/repos/apache/spark/pulls/27978,391964419,MDExOlB1bGxSZXF1ZXN0MzkxOTY0NDE5,https://github.com/apache/spark/pull/27978,https://github.com/apache/spark/pull/27978.diff,https://github.com/apache/spark/pull/27978.patch,https://api.github.com/repos/apache/spark/issues/27978,27978,open,False,[SPARK-31127][ML] Implement abstract Selector,"
### What changes were proposed in this pull request?
Implement abstract Selector. Put the common code among ```ANOVASelector```, ```ChiSqSelector```, ```FValueSelector``` and ```VarianceThresholdSelector``` to Selector.


### Why are the changes needed?
code reuse


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Existing tests
",2020-03-22T06:45:21Z,2020-03-27T07:51:05Z,,,0e85284b98e959904f1bb1fad4b82a347608ab96,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27978/commits,https://api.github.com/repos/apache/spark/pulls/27978/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27978/comments,https://api.github.com/repos/apache/spark/statuses/ba297085d165648896854d06921cd7ee3bb4896b,CONTRIBUTOR,spark,apache,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,huaxingao:spark-31127,spark-31127,ba297085d165648896854d06921cd7ee3bb4896b,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,50813048,MDEwOlJlcG9zaXRvcnk1MDgxMzA0OA==,spark,huaxingao/spark,False,huaxingao,13592258,MDQ6VXNlcjEzNTkyMjU4,https://avatars3.githubusercontent.com/u/13592258?v=4,,https://api.github.com/users/huaxingao,https://github.com/huaxingao,https://api.github.com/users/huaxingao/followers,https://api.github.com/users/huaxingao/following{/other_user},https://api.github.com/users/huaxingao/gists{/gist_id},https://api.github.com/users/huaxingao/starred{/owner}{/repo},https://api.github.com/users/huaxingao/subscriptions,https://api.github.com/users/huaxingao/orgs,https://api.github.com/users/huaxingao/repos,https://api.github.com/users/huaxingao/events{/privacy},https://api.github.com/users/huaxingao/received_events,User,False,https://github.com/huaxingao/spark,Mirror of Apache Spark,True,https://api.github.com/repos/huaxingao/spark,https://api.github.com/repos/huaxingao/spark/forks,https://api.github.com/repos/huaxingao/spark/keys{/key_id},https://api.github.com/repos/huaxingao/spark/collaborators{/collaborator},https://api.github.com/repos/huaxingao/spark/teams,https://api.github.com/repos/huaxingao/spark/hooks,https://api.github.com/repos/huaxingao/spark/issues/events{/number},https://api.github.com/repos/huaxingao/spark/events,https://api.github.com/repos/huaxingao/spark/assignees{/user},https://api.github.com/repos/huaxingao/spark/branches{/branch},https://api.github.com/repos/huaxingao/spark/tags,https://api.github.com/repos/huaxingao/spark/git/blobs{/sha},https://api.github.com/repos/huaxingao/spark/git/tags{/sha},https://api.github.com/repos/huaxingao/spark/git/refs{/sha},https://api.github.com/repos/huaxingao/spark/git/trees{/sha},https://api.github.com/repos/huaxingao/spark/statuses/{sha},https://api.github.com/repos/huaxingao/spark/languages,https://api.github.com/repos/huaxingao/spark/stargazers,https://api.github.com/repos/huaxingao/spark/contributors,https://api.github.com/repos/huaxingao/spark/subscribers,https://api.github.com/repos/huaxingao/spark/subscription,https://api.github.com/repos/huaxingao/spark/commits{/sha},https://api.github.com/repos/huaxingao/spark/git/commits{/sha},https://api.github.com/repos/huaxingao/spark/comments{/number},https://api.github.com/repos/huaxingao/spark/issues/comments{/number},https://api.github.com/repos/huaxingao/spark/contents/{+path},https://api.github.com/repos/huaxingao/spark/compare/{base}...{head},https://api.github.com/repos/huaxingao/spark/merges,https://api.github.com/repos/huaxingao/spark/{archive_format}{/ref},https://api.github.com/repos/huaxingao/spark/downloads,https://api.github.com/repos/huaxingao/spark/issues{/number},https://api.github.com/repos/huaxingao/spark/pulls{/number},https://api.github.com/repos/huaxingao/spark/milestones{/number},"https://api.github.com/repos/huaxingao/spark/notifications{?since,all,participating}",https://api.github.com/repos/huaxingao/spark/labels{/name},https://api.github.com/repos/huaxingao/spark/releases{/id},https://api.github.com/repos/huaxingao/spark/deployments,2016-02-01T04:09:11Z,2020-04-10T00:47:54Z,2020-04-10T22:29:44Z,git://github.com/huaxingao/spark.git,git@github.com:huaxingao/spark.git,https://github.com/huaxingao/spark.git,https://github.com/huaxingao/spark,,312619,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f81f11822cbba060d9010ff39c185c45e7e013a2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27978,https://github.com/apache/spark/pull/27978,https://api.github.com/repos/apache/spark/issues/27978,https://api.github.com/repos/apache/spark/issues/27978/comments,https://api.github.com/repos/apache/spark/pulls/27978/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27978/commits,https://api.github.com/repos/apache/spark/statuses/ba297085d165648896854d06921cd7ee3bb4896b
60,https://api.github.com/repos/apache/spark/pulls/27976,391940279,MDExOlB1bGxSZXF1ZXN0MzkxOTQwMjc5,https://github.com/apache/spark/pull/27976,https://github.com/apache/spark/pull/27976.diff,https://github.com/apache/spark/pull/27976.patch,https://api.github.com/repos/apache/spark/issues/27976,27976,open,False,[SPARK-31213][SQL] Arrange the sequence of the config of Spark SQL.,"### What changes were proposed in this pull request?
The configuration of Spark SQL is a bit messy. Sorting them out can improve readability.
The configuration of sequence looks like below:
```
spark.sql.sources.A
spark.sql.sources.B
spark.sql.parquet.C
...
spark.sql.sources.D
spark.sql.optimizer.E
...
spark.sql.sources.F
spark.sql.parquet.G
...
```

### Why are the changes needed?
Improve readability.


### Does this PR introduce any user-facing change?
'No'.


### How was this patch tested?
Jenkins test.
",2020-03-22T01:11:39Z,2020-03-24T10:01:29Z,,,90afc4551004216ddab03b4b93a295eb39170ae8,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27976/commits,https://api.github.com/repos/apache/spark/pulls/27976/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27976/comments,https://api.github.com/repos/apache/spark/statuses/8dced10d135f3b09c0e13d37cf3e37b3c65f88ad,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:arrange-sql-config,arrange-sql-config,8dced10d135f3b09c0e13d37cf3e37b3c65f88ad,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3a48ea1fe0fb85253f12d86caea01ffcb7e678d0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27976,https://github.com/apache/spark/pull/27976,https://api.github.com/repos/apache/spark/issues/27976,https://api.github.com/repos/apache/spark/issues/27976/comments,https://api.github.com/repos/apache/spark/pulls/27976/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27976/commits,https://api.github.com/repos/apache/spark/statuses/8dced10d135f3b09c0e13d37cf3e37b3c65f88ad
61,https://api.github.com/repos/apache/spark/pulls/27971,391582367,MDExOlB1bGxSZXF1ZXN0MzkxNTgyMzY3,https://github.com/apache/spark/pull/27971,https://github.com/apache/spark/pull/27971.diff,https://github.com/apache/spark/pull/27971.patch,https://api.github.com/repos/apache/spark/issues/27971,27971,open,False,[SPARK-31206][SQL] AQE should not use the same SubqueryExec when reuse is off,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Make it always compile a Subquery(even with the same `exprId`) in `InsertAdaptiveSparkPlan. buildSubqueryMap` when reuse subquery is off.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Currently, in `InsertAdaptiveSparkPlan. buildSubqueryMap`, it will skip compiling a subquery when it has same `exprId` with a compiled subquery. And this leads to use the same `SubqueryExec` for the `SubqueryExpression` with the same `exprId`. Thus, the behavior here is not consistent compare to `PlanSubqueries` without AQE.

Here's an example for the issue(please note the difference of subquery plan #id):

```
spark.sql(""set spark.sql.adaptive.enabled=true"")
spark.sql(""set spark.sql.execution.reuseSubquery=false"")
spark.sql( ""select b as b1, b as b2 from (select a, (select b from t2 where b = 51) b from t1)"").queryExecution.executedPlan

/** Before **/
AdaptiveSparkPlan(isFinalPlan=false)
+- Project [Subquery subquery34, [id=#57] AS b1#36L, Subquery subquery34, [id=#57] AS b2#37L]
   :  :- Subquery subquery34, [id=#57]
   :  :  +- AdaptiveSparkPlan(isFinalPlan=false)
   :  :     +- Project [id#4L AS b#6L]
   :  :        +- Filter (id#4L = 51)
   :  :           +- Range (0, 10, step=1, splits=16)
   :  +- Subquery subquery34, [id=#57]
   :     +- AdaptiveSparkPlan(isFinalPlan=false)
   :        +- Project [id#4L AS b#6L]
   :           +- Filter (id#4L = 51)
   :              +- Range (0, 10, step=1, splits=16)
   +- Range (0, 10, step=1, splits=16)

/** After **/
AdaptiveSparkPlan(isFinalPlan=false)
+- Project [Subquery subquery28, [id=#28] AS b1#30L, Subquery subquery28, [id=#38] AS b2#31L]
   :  :- Subquery subquery28, [id=#28]
   :  :  +- AdaptiveSparkPlan(isFinalPlan=false)
   :  :     +- Project [id#20L AS b#22L]
   :  :        +- Filter (id#20L = 51)
   :  :           +- Range (0, 10, step=1, splits=16)
   :  +- Subquery subquery28, [id=#38]
   :     +- AdaptiveSparkPlan(isFinalPlan=false)
   :        +- Project [id#20L AS b#22L]
   :           +- Filter (id#20L = 51)
   :              +- Range (0, 10, step=1, splits=16)
   +- Range (0, 10, step=1, splits=16)
```





### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Added a test.
",2020-03-20T15:06:41Z,2020-03-20T20:00:07Z,,,209fab5be3abfac212fb6bce87a5ed8013736c0f,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27971/commits,https://api.github.com/repos/apache/spark/pulls/27971/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27971/comments,https://api.github.com/repos/apache/spark/statuses/294b62adbb6804404712a799ec096c94967984ce,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:fix_aqe_incorrect_reuse_subquery,fix_aqe_incorrect_reuse_subquery,294b62adbb6804404712a799ec096c94967984ce,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,88ae6c44816bf6882ec3cc69dc12713a1ed6f89b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27971,https://github.com/apache/spark/pull/27971,https://api.github.com/repos/apache/spark/issues/27971,https://api.github.com/repos/apache/spark/issues/27971/comments,https://api.github.com/repos/apache/spark/pulls/27971/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27971/commits,https://api.github.com/repos/apache/spark/statuses/294b62adbb6804404712a799ec096c94967984ce
62,https://api.github.com/repos/apache/spark/pulls/27968,391444083,MDExOlB1bGxSZXF1ZXN0MzkxNDQ0MDgz,https://github.com/apache/spark/pull/27968,https://github.com/apache/spark/pull/27968.diff,https://github.com/apache/spark/pull/27968.patch,https://api.github.com/repos/apache/spark/issues/27968,27968,open,False,[SPARK-31202][CORE]Improve SizeEstimator for AppendOnlyMap,"### What changes were proposed in this pull request?

Currently, spark's memory management depends on the size estimation for execution and storage.
In our real cluster, users always meet the issue OOM due to the inaccurate size estimation for ` AppendOnlyMap`, that's because spark stores `KV` in an `Array[AnyRef]` in `AppendOnlyMap` for memory locality, and this value can be `CompactBuffer[_]` or `Array[CompactBuffer[_]]` for transformation like cogroup/join/groupBy, but current `SizeEstimator` will still treat this special array as an normal array, so in many cases, we noticed a great bias between the estimated size and the acutal memory consuption.

In this PR, I propose to improve the estimation for `AppendOnlyMap` when the value type is `CompactBuffer`/`Array[CompactBuffer]`.


### Why are the changes needed?
Improvements and can avoid OOM for many cases.


### Does this PR introduce any user-facing change?

No.


### How was this patch tested?

Existing UT & Added UT
",2020-03-20T10:01:03Z,2020-04-01T21:05:52Z,,,64439688689bcd92964dcc7a3fc54ca4db604363,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27968/commits,https://api.github.com/repos/apache/spark/pulls/27968/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27968/comments,https://api.github.com/repos/apache/spark/statuses/5f751614760d3897c9c5d3c0bd6371930a68d84f,NONE,spark,apache,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,liupc:SPARK-31202,SPARK-31202,5f751614760d3897c9c5d3c0bd6371930a68d84f,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,75380071,MDEwOlJlcG9zaXRvcnk3NTM4MDA3MQ==,spark,liupc/spark,False,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,https://github.com/liupc/spark,Mirror of Apache Spark,True,https://api.github.com/repos/liupc/spark,https://api.github.com/repos/liupc/spark/forks,https://api.github.com/repos/liupc/spark/keys{/key_id},https://api.github.com/repos/liupc/spark/collaborators{/collaborator},https://api.github.com/repos/liupc/spark/teams,https://api.github.com/repos/liupc/spark/hooks,https://api.github.com/repos/liupc/spark/issues/events{/number},https://api.github.com/repos/liupc/spark/events,https://api.github.com/repos/liupc/spark/assignees{/user},https://api.github.com/repos/liupc/spark/branches{/branch},https://api.github.com/repos/liupc/spark/tags,https://api.github.com/repos/liupc/spark/git/blobs{/sha},https://api.github.com/repos/liupc/spark/git/tags{/sha},https://api.github.com/repos/liupc/spark/git/refs{/sha},https://api.github.com/repos/liupc/spark/git/trees{/sha},https://api.github.com/repos/liupc/spark/statuses/{sha},https://api.github.com/repos/liupc/spark/languages,https://api.github.com/repos/liupc/spark/stargazers,https://api.github.com/repos/liupc/spark/contributors,https://api.github.com/repos/liupc/spark/subscribers,https://api.github.com/repos/liupc/spark/subscription,https://api.github.com/repos/liupc/spark/commits{/sha},https://api.github.com/repos/liupc/spark/git/commits{/sha},https://api.github.com/repos/liupc/spark/comments{/number},https://api.github.com/repos/liupc/spark/issues/comments{/number},https://api.github.com/repos/liupc/spark/contents/{+path},https://api.github.com/repos/liupc/spark/compare/{base}...{head},https://api.github.com/repos/liupc/spark/merges,https://api.github.com/repos/liupc/spark/{archive_format}{/ref},https://api.github.com/repos/liupc/spark/downloads,https://api.github.com/repos/liupc/spark/issues{/number},https://api.github.com/repos/liupc/spark/pulls{/number},https://api.github.com/repos/liupc/spark/milestones{/number},"https://api.github.com/repos/liupc/spark/notifications{?since,all,participating}",https://api.github.com/repos/liupc/spark/labels{/name},https://api.github.com/repos/liupc/spark/releases{/id},https://api.github.com/repos/liupc/spark/deployments,2016-12-02T09:14:58Z,2019-07-01T03:12:23Z,2020-03-22T08:20:48Z,git://github.com/liupc/spark.git,git@github.com:liupc/spark.git,https://github.com/liupc/spark.git,https://github.com/liupc/spark,,311628,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,6a668763b81cce4b4e50d5b34f8e79c493031f86,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27968,https://github.com/apache/spark/pull/27968,https://api.github.com/repos/apache/spark/issues/27968,https://api.github.com/repos/apache/spark/issues/27968/comments,https://api.github.com/repos/apache/spark/pulls/27968/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27968/commits,https://api.github.com/repos/apache/spark/statuses/5f751614760d3897c9c5d3c0bd6371930a68d84f
63,https://api.github.com/repos/apache/spark/pulls/27963,391338280,MDExOlB1bGxSZXF1ZXN0MzkxMzM4Mjgw,https://github.com/apache/spark/pull/27963,https://github.com/apache/spark/pull/27963.diff,https://github.com/apache/spark/pull/27963.patch,https://api.github.com/repos/apache/spark/issues/27963,27963,open,False,[SPARK-31199]separate shuffle io connect timeout from idle timeout,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
io.connecttimeout now controls both the connection timeout and idle timeout in netty. 
In https://github.com/apache/spark/pull/5584, the connection will be killed if exceed idle timeout.

I think these 2 timeout should be separated since they are for different purpose and their timeout maybe dramatically different.   Since connect timeout maybe controlled to fast fail and ignore some high load node/unstable node in the cluster while idle timeout may also related to some specific business handling logic which should be larger


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
To save time for some cases. 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes, we have one more parameter that user may need to be aware of.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Existing UTs.",2020-03-20T03:56:00Z,2020-03-21T14:24:05Z,,,1385d9e09a15360c28c8bd4e910bbe8308f5cbf9,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27963/commits,https://api.github.com/repos/apache/spark/pulls/27963/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27963/comments,https://api.github.com/repos/apache/spark/statuses/9e94af911d685f28239e0720b0900ac879d67982,NONE,spark,apache,running2,5144679,MDQ6VXNlcjUxNDQ2Nzk=,https://avatars2.githubusercontent.com/u/5144679?v=4,,https://api.github.com/users/running2,https://github.com/running2,https://api.github.com/users/running2/followers,https://api.github.com/users/running2/following{/other_user},https://api.github.com/users/running2/gists{/gist_id},https://api.github.com/users/running2/starred{/owner}{/repo},https://api.github.com/users/running2/subscriptions,https://api.github.com/users/running2/orgs,https://api.github.com/users/running2/repos,https://api.github.com/users/running2/events{/privacy},https://api.github.com/users/running2/received_events,User,False,running2:master,master,9e94af911d685f28239e0720b0900ac879d67982,running2,5144679,MDQ6VXNlcjUxNDQ2Nzk=,https://avatars2.githubusercontent.com/u/5144679?v=4,,https://api.github.com/users/running2,https://github.com/running2,https://api.github.com/users/running2/followers,https://api.github.com/users/running2/following{/other_user},https://api.github.com/users/running2/gists{/gist_id},https://api.github.com/users/running2/starred{/owner}{/repo},https://api.github.com/users/running2/subscriptions,https://api.github.com/users/running2/orgs,https://api.github.com/users/running2/repos,https://api.github.com/users/running2/events{/privacy},https://api.github.com/users/running2/received_events,User,False,248525784,MDEwOlJlcG9zaXRvcnkyNDg1MjU3ODQ=,spark,running2/spark,False,running2,5144679,MDQ6VXNlcjUxNDQ2Nzk=,https://avatars2.githubusercontent.com/u/5144679?v=4,,https://api.github.com/users/running2,https://github.com/running2,https://api.github.com/users/running2/followers,https://api.github.com/users/running2/following{/other_user},https://api.github.com/users/running2/gists{/gist_id},https://api.github.com/users/running2/starred{/owner}{/repo},https://api.github.com/users/running2/subscriptions,https://api.github.com/users/running2/orgs,https://api.github.com/users/running2/repos,https://api.github.com/users/running2/events{/privacy},https://api.github.com/users/running2/received_events,User,False,https://github.com/running2/spark,Apache Spark,True,https://api.github.com/repos/running2/spark,https://api.github.com/repos/running2/spark/forks,https://api.github.com/repos/running2/spark/keys{/key_id},https://api.github.com/repos/running2/spark/collaborators{/collaborator},https://api.github.com/repos/running2/spark/teams,https://api.github.com/repos/running2/spark/hooks,https://api.github.com/repos/running2/spark/issues/events{/number},https://api.github.com/repos/running2/spark/events,https://api.github.com/repos/running2/spark/assignees{/user},https://api.github.com/repos/running2/spark/branches{/branch},https://api.github.com/repos/running2/spark/tags,https://api.github.com/repos/running2/spark/git/blobs{/sha},https://api.github.com/repos/running2/spark/git/tags{/sha},https://api.github.com/repos/running2/spark/git/refs{/sha},https://api.github.com/repos/running2/spark/git/trees{/sha},https://api.github.com/repos/running2/spark/statuses/{sha},https://api.github.com/repos/running2/spark/languages,https://api.github.com/repos/running2/spark/stargazers,https://api.github.com/repos/running2/spark/contributors,https://api.github.com/repos/running2/spark/subscribers,https://api.github.com/repos/running2/spark/subscription,https://api.github.com/repos/running2/spark/commits{/sha},https://api.github.com/repos/running2/spark/git/commits{/sha},https://api.github.com/repos/running2/spark/comments{/number},https://api.github.com/repos/running2/spark/issues/comments{/number},https://api.github.com/repos/running2/spark/contents/{+path},https://api.github.com/repos/running2/spark/compare/{base}...{head},https://api.github.com/repos/running2/spark/merges,https://api.github.com/repos/running2/spark/{archive_format}{/ref},https://api.github.com/repos/running2/spark/downloads,https://api.github.com/repos/running2/spark/issues{/number},https://api.github.com/repos/running2/spark/pulls{/number},https://api.github.com/repos/running2/spark/milestones{/number},"https://api.github.com/repos/running2/spark/notifications{?since,all,participating}",https://api.github.com/repos/running2/spark/labels{/name},https://api.github.com/repos/running2/spark/releases{/id},https://api.github.com/repos/running2/spark/deployments,2020-03-19T14:35:19Z,2020-03-20T03:40:03Z,2020-03-20T03:39:34Z,git://github.com/running2/spark.git,git@github.com:running2/spark.git,https://github.com/running2/spark.git,https://github.com/running2/spark,,324642,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ca499e94091ae62a6ee76ea779d7b2b4cf2dbc5c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27963,https://github.com/apache/spark/pull/27963,https://api.github.com/repos/apache/spark/issues/27963,https://api.github.com/repos/apache/spark/issues/27963/comments,https://api.github.com/repos/apache/spark/pulls/27963/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27963/commits,https://api.github.com/repos/apache/spark/statuses/9e94af911d685f28239e0720b0900ac879d67982
64,https://api.github.com/repos/apache/spark/pulls/27947,390314029,MDExOlB1bGxSZXF1ZXN0MzkwMzE0MDI5,https://github.com/apache/spark/pull/27947,https://github.com/apache/spark/pull/27947.diff,https://github.com/apache/spark/pull/27947.patch,https://api.github.com/repos/apache/spark/issues/27947,27947,open,False,[SPARK-31182][CORE][ML] PairRDD support aggregateByKeyWithinPartitions,"### What changes were proposed in this pull request?
1, impl `aggregateByKeyWithinPartitions` and `reduceByKeyWithinPartitions`
2, use `aggregateByKeyWithinPartitions` in `RobustScaler`

### Why are the changes needed?
When implementing `RobustScaler`, I was looking for a way to guarantee that the `QuantileSummaries` in `aggregateByKey` are compressed at the _map_ side.

(before `merge` and `qurey`, the `QuantileSummaries` must be compressed)

Then I only found a tricky method to work around (yet not applied), and there was no method for this.
previous discussions were [here](https://github.com/apache/spark/pull/26803)


### Does this PR introduce any user-facing change?
Yes, add new methods for PairRDD

### How was this patch tested?
added testsuites and existing ones
",2020-03-18T09:17:23Z,2020-03-20T12:51:40Z,,,1febd22eb1ac9bc021361182f109a491d9fc839f,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27947/commits,https://api.github.com/repos/apache/spark/pulls/27947/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27947/comments,https://api.github.com/repos/apache/spark/statuses/964b9f8c57eb11eac6326e49a1b42fe8e66dcab4,CONTRIBUTOR,spark,apache,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,zhengruifeng:aggByKeyWithinPartitions,aggByKeyWithinPartitions,964b9f8c57eb11eac6326e49a1b42fe8e66dcab4,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,51584791,MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==,spark,zhengruifeng/spark,False,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,https://github.com/zhengruifeng/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zhengruifeng/spark,https://api.github.com/repos/zhengruifeng/spark/forks,https://api.github.com/repos/zhengruifeng/spark/keys{/key_id},https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator},https://api.github.com/repos/zhengruifeng/spark/teams,https://api.github.com/repos/zhengruifeng/spark/hooks,https://api.github.com/repos/zhengruifeng/spark/issues/events{/number},https://api.github.com/repos/zhengruifeng/spark/events,https://api.github.com/repos/zhengruifeng/spark/assignees{/user},https://api.github.com/repos/zhengruifeng/spark/branches{/branch},https://api.github.com/repos/zhengruifeng/spark/tags,https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha},https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha},https://api.github.com/repos/zhengruifeng/spark/statuses/{sha},https://api.github.com/repos/zhengruifeng/spark/languages,https://api.github.com/repos/zhengruifeng/spark/stargazers,https://api.github.com/repos/zhengruifeng/spark/contributors,https://api.github.com/repos/zhengruifeng/spark/subscribers,https://api.github.com/repos/zhengruifeng/spark/subscription,https://api.github.com/repos/zhengruifeng/spark/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/comments{/number},https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number},https://api.github.com/repos/zhengruifeng/spark/contents/{+path},https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head},https://api.github.com/repos/zhengruifeng/spark/merges,https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref},https://api.github.com/repos/zhengruifeng/spark/downloads,https://api.github.com/repos/zhengruifeng/spark/issues{/number},https://api.github.com/repos/zhengruifeng/spark/pulls{/number},https://api.github.com/repos/zhengruifeng/spark/milestones{/number},"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}",https://api.github.com/repos/zhengruifeng/spark/labels{/name},https://api.github.com/repos/zhengruifeng/spark/releases{/id},https://api.github.com/repos/zhengruifeng/spark/deployments,2016-02-12T11:58:00Z,2020-02-07T03:38:20Z,2020-04-10T12:55:52Z,git://github.com/zhengruifeng/spark.git,git@github.com:zhengruifeng/spark.git,https://github.com/zhengruifeng/spark.git,https://github.com/zhengruifeng/spark,,305206,1,1,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,f1d27cdd91d0d5d107add662f7c35fc4a5dd278c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27947,https://github.com/apache/spark/pull/27947,https://api.github.com/repos/apache/spark/issues/27947,https://api.github.com/repos/apache/spark/issues/27947/comments,https://api.github.com/repos/apache/spark/pulls/27947/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27947/commits,https://api.github.com/repos/apache/spark/statuses/964b9f8c57eb11eac6326e49a1b42fe8e66dcab4
65,https://api.github.com/repos/apache/spark/pulls/27944,390262563,MDExOlB1bGxSZXF1ZXN0MzkwMjYyNTYz,https://github.com/apache/spark/pull/27944,https://github.com/apache/spark/pull/27944.diff,https://github.com/apache/spark/pull/27944.patch,https://api.github.com/repos/apache/spark/issues/27944,27944,open,False,[SPARK-31180][ML] Implement PowerTransform,"### What changes were proposed in this pull request?
Power transforms are a family of parametric, monotonic transformationsthat are applied to make data more Gaussian-like. This is useful formodeling issues related to heteroscedasticity (non-constant variance),or other situations where normality is desired.


### Why are the changes needed?
It is widely used and suitable to be implemented atop spark

### Does this PR introduce any user-facing change?
Yes


### How was this patch tested?
added testsuites
",2020-03-18T07:20:25Z,2020-04-01T11:59:08Z,,,07fab2ff274e679270712a19e7a85285b2298ecb,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27944/commits,https://api.github.com/repos/apache/spark/pulls/27944/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27944/comments,https://api.github.com/repos/apache/spark/statuses/b19c19706aad1db60e30a2e5d18021eecc382175,CONTRIBUTOR,spark,apache,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,zhengruifeng:PowerTransformer,PowerTransformer,b19c19706aad1db60e30a2e5d18021eecc382175,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,51584791,MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==,spark,zhengruifeng/spark,False,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,https://github.com/zhengruifeng/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zhengruifeng/spark,https://api.github.com/repos/zhengruifeng/spark/forks,https://api.github.com/repos/zhengruifeng/spark/keys{/key_id},https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator},https://api.github.com/repos/zhengruifeng/spark/teams,https://api.github.com/repos/zhengruifeng/spark/hooks,https://api.github.com/repos/zhengruifeng/spark/issues/events{/number},https://api.github.com/repos/zhengruifeng/spark/events,https://api.github.com/repos/zhengruifeng/spark/assignees{/user},https://api.github.com/repos/zhengruifeng/spark/branches{/branch},https://api.github.com/repos/zhengruifeng/spark/tags,https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha},https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha},https://api.github.com/repos/zhengruifeng/spark/statuses/{sha},https://api.github.com/repos/zhengruifeng/spark/languages,https://api.github.com/repos/zhengruifeng/spark/stargazers,https://api.github.com/repos/zhengruifeng/spark/contributors,https://api.github.com/repos/zhengruifeng/spark/subscribers,https://api.github.com/repos/zhengruifeng/spark/subscription,https://api.github.com/repos/zhengruifeng/spark/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/comments{/number},https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number},https://api.github.com/repos/zhengruifeng/spark/contents/{+path},https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head},https://api.github.com/repos/zhengruifeng/spark/merges,https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref},https://api.github.com/repos/zhengruifeng/spark/downloads,https://api.github.com/repos/zhengruifeng/spark/issues{/number},https://api.github.com/repos/zhengruifeng/spark/pulls{/number},https://api.github.com/repos/zhengruifeng/spark/milestones{/number},"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}",https://api.github.com/repos/zhengruifeng/spark/labels{/name},https://api.github.com/repos/zhengruifeng/spark/releases{/id},https://api.github.com/repos/zhengruifeng/spark/deployments,2016-02-12T11:58:00Z,2020-02-07T03:38:20Z,2020-04-10T12:55:52Z,git://github.com/zhengruifeng/spark.git,git@github.com:zhengruifeng/spark.git,https://github.com/zhengruifeng/spark.git,https://github.com/zhengruifeng/spark,,305206,1,1,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,783852cc2e664b43793f5b1dd4c5e28a9bbe971f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27944,https://github.com/apache/spark/pull/27944,https://api.github.com/repos/apache/spark/issues/27944,https://api.github.com/repos/apache/spark/issues/27944/comments,https://api.github.com/repos/apache/spark/pulls/27944/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27944/commits,https://api.github.com/repos/apache/spark/statuses/b19c19706aad1db60e30a2e5d18021eecc382175
66,https://api.github.com/repos/apache/spark/pulls/27928,389396726,MDExOlB1bGxSZXF1ZXN0Mzg5Mzk2NzI2,https://github.com/apache/spark/pull/27928,https://github.com/apache/spark/pull/27928.diff,https://github.com/apache/spark/pull/27928.patch,https://api.github.com/repos/apache/spark/issues/27928,27928,open,False,[SPARK-31167][BUILD] Refactor how we track Python test/build dependencies,"### What changes were proposed in this pull request?

This PR (SPARK-31167) refactors how we track various Python test and build dependencies so they are pinned and internally consistent.

### Why are the changes needed?

This should make it easier to bump dependencies (since they are specified in fewer places) and promote more consistent build behavior across Docker, Jenkins, GitHub, and local development environments.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

I built the Docker image just far enough to confirm that the dependencies are installed correctly:

```
Step 16/31 : RUN pip install -r docs-requirements.txt
 ---> Running in b0c66cb2a543
Collecting sphinx==2.3.1
  Downloading Sphinx-2.3.1-py3-none-any.whl (2.7 MB)
Collecting mkdocs==1.0.4
  Downloading mkdocs-1.0.4-py2.py3-none-any.whl (1.2 MB)
Collecting numpy==1.18.1
  Downloading numpy-1.18.1-cp37-cp37m-manylinux1_x86_64.whl (20.1 MB)
...
```

The GitHub workflow will be tested as part of this PR.",2020-03-16T17:38:13Z,2020-04-09T15:04:30Z,,,005dde8cd47a82fbc6b151bb501e6beb16be0d56,,[],[],[],"[{'id': 1406627200, 'node_id': 'MDU6TGFiZWwxNDA2NjI3MjAw', 'url': 'https://api.github.com/repos/apache/spark/labels/BUILD', 'name': 'BUILD', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27928/commits,https://api.github.com/repos/apache/spark/pulls/27928/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27928/comments,https://api.github.com/repos/apache/spark/statuses/b088d151c6102e13f124318d8b14e9279da3287a,CONTRIBUTOR,spark,apache,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,nchammas:SPARK-31167-missing-test-deps,SPARK-31167-missing-test-deps,b088d151c6102e13f124318d8b14e9279da3287a,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,23797421,MDEwOlJlcG9zaXRvcnkyMzc5NzQyMQ==,spark,nchammas/spark,False,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,https://github.com/nchammas/spark,Mirror of Apache Spark,True,https://api.github.com/repos/nchammas/spark,https://api.github.com/repos/nchammas/spark/forks,https://api.github.com/repos/nchammas/spark/keys{/key_id},https://api.github.com/repos/nchammas/spark/collaborators{/collaborator},https://api.github.com/repos/nchammas/spark/teams,https://api.github.com/repos/nchammas/spark/hooks,https://api.github.com/repos/nchammas/spark/issues/events{/number},https://api.github.com/repos/nchammas/spark/events,https://api.github.com/repos/nchammas/spark/assignees{/user},https://api.github.com/repos/nchammas/spark/branches{/branch},https://api.github.com/repos/nchammas/spark/tags,https://api.github.com/repos/nchammas/spark/git/blobs{/sha},https://api.github.com/repos/nchammas/spark/git/tags{/sha},https://api.github.com/repos/nchammas/spark/git/refs{/sha},https://api.github.com/repos/nchammas/spark/git/trees{/sha},https://api.github.com/repos/nchammas/spark/statuses/{sha},https://api.github.com/repos/nchammas/spark/languages,https://api.github.com/repos/nchammas/spark/stargazers,https://api.github.com/repos/nchammas/spark/contributors,https://api.github.com/repos/nchammas/spark/subscribers,https://api.github.com/repos/nchammas/spark/subscription,https://api.github.com/repos/nchammas/spark/commits{/sha},https://api.github.com/repos/nchammas/spark/git/commits{/sha},https://api.github.com/repos/nchammas/spark/comments{/number},https://api.github.com/repos/nchammas/spark/issues/comments{/number},https://api.github.com/repos/nchammas/spark/contents/{+path},https://api.github.com/repos/nchammas/spark/compare/{base}...{head},https://api.github.com/repos/nchammas/spark/merges,https://api.github.com/repos/nchammas/spark/{archive_format}{/ref},https://api.github.com/repos/nchammas/spark/downloads,https://api.github.com/repos/nchammas/spark/issues{/number},https://api.github.com/repos/nchammas/spark/pulls{/number},https://api.github.com/repos/nchammas/spark/milestones{/number},"https://api.github.com/repos/nchammas/spark/notifications{?since,all,participating}",https://api.github.com/repos/nchammas/spark/labels{/name},https://api.github.com/repos/nchammas/spark/releases{/id},https://api.github.com/repos/nchammas/spark/deployments,2014-09-08T15:54:13Z,2020-03-16T15:41:14Z,2020-04-10T11:01:40Z,git://github.com/nchammas/spark.git,git@github.com:nchammas/spark.git,https://github.com/nchammas/spark.git,https://github.com/nchammas/spark,,295417,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,783852cc2e664b43793f5b1dd4c5e28a9bbe971f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27928,https://github.com/apache/spark/pull/27928,https://api.github.com/repos/apache/spark/issues/27928,https://api.github.com/repos/apache/spark/issues/27928/comments,https://api.github.com/repos/apache/spark/pulls/27928/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27928/commits,https://api.github.com/repos/apache/spark/statuses/b088d151c6102e13f124318d8b14e9279da3287a
67,https://api.github.com/repos/apache/spark/pulls/27920,388929199,MDExOlB1bGxSZXF1ZXN0Mzg4OTI5MTk5,https://github.com/apache/spark/pull/27920,https://github.com/apache/spark/pull/27920.diff,https://github.com/apache/spark/pull/27920.patch,https://api.github.com/repos/apache/spark/issues/27920,27920,open,False,[SPARK-31102][SQL] Spark-sql fails to parse when contains comment.,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR introduces a change to false for the insideComment flag on a newline. Fixing the issue introduced by SPARK-30049.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
Previously on SPARK-30049 a comment containing an unclosed quote produced the following issue:
```
spark-sql> SELECT 1 -- someone's comment here
         > ;
Error in query: 
extraneous input ';' expecting <EOF>(line 2, pos 0)

== SQL ==
SELECT 1 -- someone's comment here
;
^^^
```

This was caused because there was no flag for comment sections inside the splitSemiColon method to ignore quotes. SPARK-30049 added that flag and fixed the issue, but introduced the follwoing problem:
```
spark-sql> select
         >   1,
         >   -- two
         >   2;
Error in query:
mismatched input '<EOF>' expecting {'(', 'ADD', 'AFTER', 'ALL', 'ALTER', ...}(line 3, pos 2)
== SQL ==
select
  1,
--^^^
```
This issue is generated by a missing turn-off for the insideComment flag with a newline.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Previous tests using line-continuity(`\`) were removed and a test for inline comments within a query was added.",2020-03-16T02:11:43Z,2020-04-09T14:26:04Z,,,cdc6c60ea43b9ff90c3769044fbd74408bba35a1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27920/commits,https://api.github.com/repos/apache/spark/pulls/27920/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27920/comments,https://api.github.com/repos/apache/spark/statuses/d69d27126c06ea9782c5422a5435809a062b8ed7,CONTRIBUTOR,spark,apache,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,javierivanov:SPARK-31102,SPARK-31102,d69d27126c06ea9782c5422a5435809a062b8ed7,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,224188155,MDEwOlJlcG9zaXRvcnkyMjQxODgxNTU=,spark,javierivanov/spark,False,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,https://github.com/javierivanov/spark,Apache Spark,True,https://api.github.com/repos/javierivanov/spark,https://api.github.com/repos/javierivanov/spark/forks,https://api.github.com/repos/javierivanov/spark/keys{/key_id},https://api.github.com/repos/javierivanov/spark/collaborators{/collaborator},https://api.github.com/repos/javierivanov/spark/teams,https://api.github.com/repos/javierivanov/spark/hooks,https://api.github.com/repos/javierivanov/spark/issues/events{/number},https://api.github.com/repos/javierivanov/spark/events,https://api.github.com/repos/javierivanov/spark/assignees{/user},https://api.github.com/repos/javierivanov/spark/branches{/branch},https://api.github.com/repos/javierivanov/spark/tags,https://api.github.com/repos/javierivanov/spark/git/blobs{/sha},https://api.github.com/repos/javierivanov/spark/git/tags{/sha},https://api.github.com/repos/javierivanov/spark/git/refs{/sha},https://api.github.com/repos/javierivanov/spark/git/trees{/sha},https://api.github.com/repos/javierivanov/spark/statuses/{sha},https://api.github.com/repos/javierivanov/spark/languages,https://api.github.com/repos/javierivanov/spark/stargazers,https://api.github.com/repos/javierivanov/spark/contributors,https://api.github.com/repos/javierivanov/spark/subscribers,https://api.github.com/repos/javierivanov/spark/subscription,https://api.github.com/repos/javierivanov/spark/commits{/sha},https://api.github.com/repos/javierivanov/spark/git/commits{/sha},https://api.github.com/repos/javierivanov/spark/comments{/number},https://api.github.com/repos/javierivanov/spark/issues/comments{/number},https://api.github.com/repos/javierivanov/spark/contents/{+path},https://api.github.com/repos/javierivanov/spark/compare/{base}...{head},https://api.github.com/repos/javierivanov/spark/merges,https://api.github.com/repos/javierivanov/spark/{archive_format}{/ref},https://api.github.com/repos/javierivanov/spark/downloads,https://api.github.com/repos/javierivanov/spark/issues{/number},https://api.github.com/repos/javierivanov/spark/pulls{/number},https://api.github.com/repos/javierivanov/spark/milestones{/number},"https://api.github.com/repos/javierivanov/spark/notifications{?since,all,participating}",https://api.github.com/repos/javierivanov/spark/labels{/name},https://api.github.com/repos/javierivanov/spark/releases{/id},https://api.github.com/repos/javierivanov/spark/deployments,2019-11-26T12:32:40Z,2020-03-15T23:11:43Z,2020-03-17T21:33:14Z,git://github.com/javierivanov/spark.git,git@github.com:javierivanov/spark.git,https://github.com/javierivanov/spark.git,https://github.com/javierivanov/spark,,323580,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,08bdc9c9b2e44e066e44d35733e0f3b450d24052,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27920,https://github.com/apache/spark/pull/27920,https://api.github.com/repos/apache/spark/issues/27920,https://api.github.com/repos/apache/spark/issues/27920/comments,https://api.github.com/repos/apache/spark/pulls/27920/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27920/commits,https://api.github.com/repos/apache/spark/statuses/d69d27126c06ea9782c5422a5435809a062b8ed7
68,https://api.github.com/repos/apache/spark/pulls/27911,388203798,MDExOlB1bGxSZXF1ZXN0Mzg4MjAzNzk4,https://github.com/apache/spark/pull/27911,https://github.com/apache/spark/pull/27911.diff,https://github.com/apache/spark/pull/27911.patch,https://api.github.com/repos/apache/spark/issues/27911,27911,open,False,[SPARK-31154][SQL] Expose basic write metrics for InsertIntoDataSourceCommand,"### What changes were proposed in this pull request?
Spark provides interface `InsertableRelation` and the `InsertIntoDataSourceCommand` to delegate the inserting processing to a data source. Unlike `DataWritingCommand`, the metrics in InsertIntoDataSourceCommand is empty and has no chance to update. So we cannot get ""number of written files"" or ""number of output rows"" from its metrics.

For example, if a table is a Spark parquet table. We can get the writing metrics by:
```scala
val df = sql(""INSERT INTO TABLE test_table SELECT 1, 'a'"")
val numFiles = df.queryExecution.sparkPlan.metrics(""numFiles"").value
```
But if it is a Delta table, we cannot.

If this PR accepted, we can easily to expose the metrics from Delta to Spark.
Such as modifying method `writeFiles` in `TransactionalWrite.scala`:
```scala
      // after written, expose the metrics
      basicWriteJobStatsTracker.metrics.foreach { kv =>
        metricsToExpose.get(kv._1).foreach(s => s.merge(kv._2))
      }
```

### Does this PR introduce any user-facing change?
Add a method in `InsertableRelation`:
```scala
def insert(data: DataFrame, overwrite: Boolean, metrics: Map[String, SQLMetric]): Unit
```
But still keep the old one.


### How was this patch tested?
Add a unit suite.",2020-03-14T07:41:36Z,2020-03-19T13:05:48Z,,,665cfb5e51da216dcd8e69449827d18f89ff56b5,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27911/commits,https://api.github.com/repos/apache/spark/pulls/27911/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27911/comments,https://api.github.com/repos/apache/spark/statuses/bb6738fe9fc5f80836e64d6c44cd1508882ab20a,CONTRIBUTOR,spark,apache,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,LantaoJin:SPARK-31154,SPARK-31154,bb6738fe9fc5f80836e64d6c44cd1508882ab20a,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,90969496,MDEwOlJlcG9zaXRvcnk5MDk2OTQ5Ng==,spark,LantaoJin/spark,False,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,https://github.com/LantaoJin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LantaoJin/spark,https://api.github.com/repos/LantaoJin/spark/forks,https://api.github.com/repos/LantaoJin/spark/keys{/key_id},https://api.github.com/repos/LantaoJin/spark/collaborators{/collaborator},https://api.github.com/repos/LantaoJin/spark/teams,https://api.github.com/repos/LantaoJin/spark/hooks,https://api.github.com/repos/LantaoJin/spark/issues/events{/number},https://api.github.com/repos/LantaoJin/spark/events,https://api.github.com/repos/LantaoJin/spark/assignees{/user},https://api.github.com/repos/LantaoJin/spark/branches{/branch},https://api.github.com/repos/LantaoJin/spark/tags,https://api.github.com/repos/LantaoJin/spark/git/blobs{/sha},https://api.github.com/repos/LantaoJin/spark/git/tags{/sha},https://api.github.com/repos/LantaoJin/spark/git/refs{/sha},https://api.github.com/repos/LantaoJin/spark/git/trees{/sha},https://api.github.com/repos/LantaoJin/spark/statuses/{sha},https://api.github.com/repos/LantaoJin/spark/languages,https://api.github.com/repos/LantaoJin/spark/stargazers,https://api.github.com/repos/LantaoJin/spark/contributors,https://api.github.com/repos/LantaoJin/spark/subscribers,https://api.github.com/repos/LantaoJin/spark/subscription,https://api.github.com/repos/LantaoJin/spark/commits{/sha},https://api.github.com/repos/LantaoJin/spark/git/commits{/sha},https://api.github.com/repos/LantaoJin/spark/comments{/number},https://api.github.com/repos/LantaoJin/spark/issues/comments{/number},https://api.github.com/repos/LantaoJin/spark/contents/{+path},https://api.github.com/repos/LantaoJin/spark/compare/{base}...{head},https://api.github.com/repos/LantaoJin/spark/merges,https://api.github.com/repos/LantaoJin/spark/{archive_format}{/ref},https://api.github.com/repos/LantaoJin/spark/downloads,https://api.github.com/repos/LantaoJin/spark/issues{/number},https://api.github.com/repos/LantaoJin/spark/pulls{/number},https://api.github.com/repos/LantaoJin/spark/milestones{/number},"https://api.github.com/repos/LantaoJin/spark/notifications{?since,all,participating}",https://api.github.com/repos/LantaoJin/spark/labels{/name},https://api.github.com/repos/LantaoJin/spark/releases{/id},https://api.github.com/repos/LantaoJin/spark/deployments,2017-05-11T10:58:27Z,2019-06-03T02:33:56Z,2020-03-24T09:02:44Z,git://github.com/LantaoJin/spark.git,git@github.com:LantaoJin/spark.git,https://github.com/LantaoJin/spark.git,https://github.com/LantaoJin/spark,,323789,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9628aca68ba0821b8f3fa934ed4872cabb2a5d7d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27911,https://github.com/apache/spark/pull/27911,https://api.github.com/repos/apache/spark/issues/27911,https://api.github.com/repos/apache/spark/issues/27911/comments,https://api.github.com/repos/apache/spark/pulls/27911/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27911/commits,https://api.github.com/repos/apache/spark/statuses/bb6738fe9fc5f80836e64d6c44cd1508882ab20a
69,https://api.github.com/repos/apache/spark/pulls/27908,388115112,MDExOlB1bGxSZXF1ZXN0Mzg4MTE1MTEy,https://github.com/apache/spark/pull/27908,https://github.com/apache/spark/pull/27908.diff,https://github.com/apache/spark/pull/27908.patch,https://api.github.com/repos/apache/spark/issues/27908,27908,open,False,[SPARK-31000] Add ability to set table description via Catalog.createTable(),"### What changes were proposed in this pull request?

This PR enhances `Catalog.createTable()` to allow users to set the table's description. This corresponds to the following SQL syntax:

```sql
CREATE TABLE ...
COMMENT 'this is a fancy table';
```

### Why are the changes needed?

This brings the Scala/Python catalog APIs a bit closer to what's already possible via SQL.

### Does this PR introduce any user-facing change?

Yes, it adds a new parameter to `Catalog.createTable()`.

### How was this patch tested?

Existing unit tests:

```sh
./python/run-tests \
  --python-executables python3.7 \
  --testnames 'pyspark.sql.tests.test_catalog,pyspark.sql.tests.test_context'
```

```
$ ./buid/sbt
testOnly org.apache.spark.sql.internal.CatalogSuite org.apache.spark.sql.CachedTableSuite org.apache.spark.sql.hive.MetastoreDataSourcesSuite org.apache.spark.sql.hive.execution.HiveDDLSuite
```",2020-03-14T02:21:42Z,2020-04-09T15:04:39Z,,,a86444ed3a23ad60956269ed11bad2be8ba89b4f,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27908/commits,https://api.github.com/repos/apache/spark/pulls/27908/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27908/comments,https://api.github.com/repos/apache/spark/statuses/8c90a9319ebfb7235da514fede96dc74ae2906c2,CONTRIBUTOR,spark,apache,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,nchammas:SPARK-31000-table-description,SPARK-31000-table-description,8c90a9319ebfb7235da514fede96dc74ae2906c2,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,23797421,MDEwOlJlcG9zaXRvcnkyMzc5NzQyMQ==,spark,nchammas/spark,False,nchammas,1039369,MDQ6VXNlcjEwMzkzNjk=,https://avatars0.githubusercontent.com/u/1039369?v=4,,https://api.github.com/users/nchammas,https://github.com/nchammas,https://api.github.com/users/nchammas/followers,https://api.github.com/users/nchammas/following{/other_user},https://api.github.com/users/nchammas/gists{/gist_id},https://api.github.com/users/nchammas/starred{/owner}{/repo},https://api.github.com/users/nchammas/subscriptions,https://api.github.com/users/nchammas/orgs,https://api.github.com/users/nchammas/repos,https://api.github.com/users/nchammas/events{/privacy},https://api.github.com/users/nchammas/received_events,User,False,https://github.com/nchammas/spark,Mirror of Apache Spark,True,https://api.github.com/repos/nchammas/spark,https://api.github.com/repos/nchammas/spark/forks,https://api.github.com/repos/nchammas/spark/keys{/key_id},https://api.github.com/repos/nchammas/spark/collaborators{/collaborator},https://api.github.com/repos/nchammas/spark/teams,https://api.github.com/repos/nchammas/spark/hooks,https://api.github.com/repos/nchammas/spark/issues/events{/number},https://api.github.com/repos/nchammas/spark/events,https://api.github.com/repos/nchammas/spark/assignees{/user},https://api.github.com/repos/nchammas/spark/branches{/branch},https://api.github.com/repos/nchammas/spark/tags,https://api.github.com/repos/nchammas/spark/git/blobs{/sha},https://api.github.com/repos/nchammas/spark/git/tags{/sha},https://api.github.com/repos/nchammas/spark/git/refs{/sha},https://api.github.com/repos/nchammas/spark/git/trees{/sha},https://api.github.com/repos/nchammas/spark/statuses/{sha},https://api.github.com/repos/nchammas/spark/languages,https://api.github.com/repos/nchammas/spark/stargazers,https://api.github.com/repos/nchammas/spark/contributors,https://api.github.com/repos/nchammas/spark/subscribers,https://api.github.com/repos/nchammas/spark/subscription,https://api.github.com/repos/nchammas/spark/commits{/sha},https://api.github.com/repos/nchammas/spark/git/commits{/sha},https://api.github.com/repos/nchammas/spark/comments{/number},https://api.github.com/repos/nchammas/spark/issues/comments{/number},https://api.github.com/repos/nchammas/spark/contents/{+path},https://api.github.com/repos/nchammas/spark/compare/{base}...{head},https://api.github.com/repos/nchammas/spark/merges,https://api.github.com/repos/nchammas/spark/{archive_format}{/ref},https://api.github.com/repos/nchammas/spark/downloads,https://api.github.com/repos/nchammas/spark/issues{/number},https://api.github.com/repos/nchammas/spark/pulls{/number},https://api.github.com/repos/nchammas/spark/milestones{/number},"https://api.github.com/repos/nchammas/spark/notifications{?since,all,participating}",https://api.github.com/repos/nchammas/spark/labels{/name},https://api.github.com/repos/nchammas/spark/releases{/id},https://api.github.com/repos/nchammas/spark/deployments,2014-09-08T15:54:13Z,2020-03-16T15:41:14Z,2020-04-10T11:01:40Z,git://github.com/nchammas/spark.git,git@github.com:nchammas/spark.git,https://github.com/nchammas/spark.git,https://github.com/nchammas/spark,,295417,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9f0c010a5c9b5c10401f8e16fa7a151714b6dbb0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27908,https://github.com/apache/spark/pull/27908,https://api.github.com/repos/apache/spark/issues/27908,https://api.github.com/repos/apache/spark/issues/27908/comments,https://api.github.com/repos/apache/spark/pulls/27908/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27908/commits,https://api.github.com/repos/apache/spark/statuses/8c90a9319ebfb7235da514fede96dc74ae2906c2
70,https://api.github.com/repos/apache/spark/pulls/27903,387842645,MDExOlB1bGxSZXF1ZXN0Mzg3ODQyNjQ1,https://github.com/apache/spark/pull/27903,https://github.com/apache/spark/pull/27903.diff,https://github.com/apache/spark/pull/27903.patch,https://api.github.com/repos/apache/spark/issues/27903,27903,open,False,[SPARK-31149][PySpark] PySpark job not killing Spark Daemon processes…,"### What changes were proposed in this pull request?
Changes made to daemon.py under /python/pyspark:
def shutdown(code):
        signal.signal(SIGTERM, SIG_DFL)
        # Send SIGHUP to notify workers of shutdown
        os.kill(0, SIGTERM) #Line104
        exit(code)

Solution to SPARK-31149. SIGHUP does not kill all pyspark daemon in all cases, so more strict SIGKILL is required
### Why are the changes needed?
Pyspark was running Spark Daemon processes even after killing the Spark job on Yarn. After making below changes to daemon.py the job killed the Spark Daemon processes.

### Does this PR introduce any user-facing change?
No
### How was this patch tested?

Before the fix:
ps -ef|grep -i pyspark.daemon
/apps/anaconda3-5.3.0/bin/python -m pyspark.daemon
/apps/anaconda3-5.3.0/bin/python -m pyspark.daemon
/apps/anaconda3-5.3.0/bin/python -m pyspark.daemon

After the fix:
ps -ef|grep -i pyspark.daemon
",2020-03-13T15:35:00Z,2020-03-19T08:21:47Z,,,7f7e37a5b800f1eea5bdd188fc94cb1b967a05b3,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27903/commits,https://api.github.com/repos/apache/spark/pulls/27903/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27903/comments,https://api.github.com/repos/apache/spark/statuses/86ca496f89e4ea2dc3fc281b83cd88b63c0e02cf,NONE,spark,apache,avenherak,57108150,MDQ6VXNlcjU3MTA4MTUw,https://avatars3.githubusercontent.com/u/57108150?v=4,,https://api.github.com/users/avenherak,https://github.com/avenherak,https://api.github.com/users/avenherak/followers,https://api.github.com/users/avenherak/following{/other_user},https://api.github.com/users/avenherak/gists{/gist_id},https://api.github.com/users/avenherak/starred{/owner}{/repo},https://api.github.com/users/avenherak/subscriptions,https://api.github.com/users/avenherak/orgs,https://api.github.com/users/avenherak/repos,https://api.github.com/users/avenherak/events{/privacy},https://api.github.com/users/avenherak/received_events,User,False,avenherak:SPARK-31149,SPARK-31149,86ca496f89e4ea2dc3fc281b83cd88b63c0e02cf,avenherak,57108150,MDQ6VXNlcjU3MTA4MTUw,https://avatars3.githubusercontent.com/u/57108150?v=4,,https://api.github.com/users/avenherak,https://github.com/avenherak,https://api.github.com/users/avenherak/followers,https://api.github.com/users/avenherak/following{/other_user},https://api.github.com/users/avenherak/gists{/gist_id},https://api.github.com/users/avenherak/starred{/owner}{/repo},https://api.github.com/users/avenherak/subscriptions,https://api.github.com/users/avenherak/orgs,https://api.github.com/users/avenherak/repos,https://api.github.com/users/avenherak/events{/privacy},https://api.github.com/users/avenherak/received_events,User,False,247100884,MDEwOlJlcG9zaXRvcnkyNDcxMDA4ODQ=,spark,avenherak/spark,False,avenherak,57108150,MDQ6VXNlcjU3MTA4MTUw,https://avatars3.githubusercontent.com/u/57108150?v=4,,https://api.github.com/users/avenherak,https://github.com/avenherak,https://api.github.com/users/avenherak/followers,https://api.github.com/users/avenherak/following{/other_user},https://api.github.com/users/avenherak/gists{/gist_id},https://api.github.com/users/avenherak/starred{/owner}{/repo},https://api.github.com/users/avenherak/subscriptions,https://api.github.com/users/avenherak/orgs,https://api.github.com/users/avenherak/repos,https://api.github.com/users/avenherak/events{/privacy},https://api.github.com/users/avenherak/received_events,User,False,https://github.com/avenherak/spark,Apache Spark,True,https://api.github.com/repos/avenherak/spark,https://api.github.com/repos/avenherak/spark/forks,https://api.github.com/repos/avenherak/spark/keys{/key_id},https://api.github.com/repos/avenherak/spark/collaborators{/collaborator},https://api.github.com/repos/avenherak/spark/teams,https://api.github.com/repos/avenherak/spark/hooks,https://api.github.com/repos/avenherak/spark/issues/events{/number},https://api.github.com/repos/avenherak/spark/events,https://api.github.com/repos/avenherak/spark/assignees{/user},https://api.github.com/repos/avenherak/spark/branches{/branch},https://api.github.com/repos/avenherak/spark/tags,https://api.github.com/repos/avenherak/spark/git/blobs{/sha},https://api.github.com/repos/avenherak/spark/git/tags{/sha},https://api.github.com/repos/avenherak/spark/git/refs{/sha},https://api.github.com/repos/avenherak/spark/git/trees{/sha},https://api.github.com/repos/avenherak/spark/statuses/{sha},https://api.github.com/repos/avenherak/spark/languages,https://api.github.com/repos/avenherak/spark/stargazers,https://api.github.com/repos/avenherak/spark/contributors,https://api.github.com/repos/avenherak/spark/subscribers,https://api.github.com/repos/avenherak/spark/subscription,https://api.github.com/repos/avenherak/spark/commits{/sha},https://api.github.com/repos/avenherak/spark/git/commits{/sha},https://api.github.com/repos/avenherak/spark/comments{/number},https://api.github.com/repos/avenherak/spark/issues/comments{/number},https://api.github.com/repos/avenherak/spark/contents/{+path},https://api.github.com/repos/avenherak/spark/compare/{base}...{head},https://api.github.com/repos/avenherak/spark/merges,https://api.github.com/repos/avenherak/spark/{archive_format}{/ref},https://api.github.com/repos/avenherak/spark/downloads,https://api.github.com/repos/avenherak/spark/issues{/number},https://api.github.com/repos/avenherak/spark/pulls{/number},https://api.github.com/repos/avenherak/spark/milestones{/number},"https://api.github.com/repos/avenherak/spark/notifications{?since,all,participating}",https://api.github.com/repos/avenherak/spark/labels{/name},https://api.github.com/repos/avenherak/spark/releases{/id},https://api.github.com/repos/avenherak/spark/deployments,2020-03-13T15:16:14Z,2020-03-13T15:16:19Z,2020-03-13T15:31:46Z,git://github.com/avenherak/spark.git,git@github.com:avenherak/spark.git,https://github.com/avenherak/spark.git,https://github.com/avenherak/spark,,323866,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:branch-2.4,branch-2.4,e6bcaaa8a78f6c88b5c5276e90cd049e2cffc658,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27903,https://github.com/apache/spark/pull/27903,https://api.github.com/repos/apache/spark/issues/27903,https://api.github.com/repos/apache/spark/issues/27903/comments,https://api.github.com/repos/apache/spark/pulls/27903/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27903/commits,https://api.github.com/repos/apache/spark/statuses/86ca496f89e4ea2dc3fc281b83cd88b63c0e02cf
71,https://api.github.com/repos/apache/spark/pulls/27900,387631123,MDExOlB1bGxSZXF1ZXN0Mzg3NjMxMTIz,https://github.com/apache/spark/pull/27900,https://github.com/apache/spark/pull/27900.diff,https://github.com/apache/spark/pull/27900.patch,https://api.github.com/repos/apache/spark/issues/27900,27900,open,False,[SPARK-31100][SQL] Check namespace existens when setting namespace,"## What changes were proposed in this pull request?
Check the namespace existence while calling ""use namespace"", and throw NoSuchNamespaceException if namespace not exists.

### Why are the changes needed?
Users need to know that the namespace does not exist when they try to set a wrong namespace.

### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Run all suites and add a test for this
",2020-03-13T07:26:52Z,2020-03-22T03:34:05Z,,,16f996a8f019bfe135f3493ae7f6eb8708e33852,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27900/commits,https://api.github.com/repos/apache/spark/pulls/27900/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27900/comments,https://api.github.com/repos/apache/spark/statuses/37017b73939466249422bb68998190d1ee9c3750,CONTRIBUTOR,spark,apache,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,stczwd:SPARK-31100,SPARK-31100,37017b73939466249422bb68998190d1ee9c3750,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,150664479,MDEwOlJlcG9zaXRvcnkxNTA2NjQ0Nzk=,spark,stczwd/spark,False,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,https://github.com/stczwd/spark,Mirror of Apache Spark,True,https://api.github.com/repos/stczwd/spark,https://api.github.com/repos/stczwd/spark/forks,https://api.github.com/repos/stczwd/spark/keys{/key_id},https://api.github.com/repos/stczwd/spark/collaborators{/collaborator},https://api.github.com/repos/stczwd/spark/teams,https://api.github.com/repos/stczwd/spark/hooks,https://api.github.com/repos/stczwd/spark/issues/events{/number},https://api.github.com/repos/stczwd/spark/events,https://api.github.com/repos/stczwd/spark/assignees{/user},https://api.github.com/repos/stczwd/spark/branches{/branch},https://api.github.com/repos/stczwd/spark/tags,https://api.github.com/repos/stczwd/spark/git/blobs{/sha},https://api.github.com/repos/stczwd/spark/git/tags{/sha},https://api.github.com/repos/stczwd/spark/git/refs{/sha},https://api.github.com/repos/stczwd/spark/git/trees{/sha},https://api.github.com/repos/stczwd/spark/statuses/{sha},https://api.github.com/repos/stczwd/spark/languages,https://api.github.com/repos/stczwd/spark/stargazers,https://api.github.com/repos/stczwd/spark/contributors,https://api.github.com/repos/stczwd/spark/subscribers,https://api.github.com/repos/stczwd/spark/subscription,https://api.github.com/repos/stczwd/spark/commits{/sha},https://api.github.com/repos/stczwd/spark/git/commits{/sha},https://api.github.com/repos/stczwd/spark/comments{/number},https://api.github.com/repos/stczwd/spark/issues/comments{/number},https://api.github.com/repos/stczwd/spark/contents/{+path},https://api.github.com/repos/stczwd/spark/compare/{base}...{head},https://api.github.com/repos/stczwd/spark/merges,https://api.github.com/repos/stczwd/spark/{archive_format}{/ref},https://api.github.com/repos/stczwd/spark/downloads,https://api.github.com/repos/stczwd/spark/issues{/number},https://api.github.com/repos/stczwd/spark/pulls{/number},https://api.github.com/repos/stczwd/spark/milestones{/number},"https://api.github.com/repos/stczwd/spark/notifications{?since,all,participating}",https://api.github.com/repos/stczwd/spark/labels{/name},https://api.github.com/repos/stczwd/spark/releases{/id},https://api.github.com/repos/stczwd/spark/deployments,2018-09-28T00:44:20Z,2020-04-02T16:27:02Z,2020-04-06T01:47:26Z,git://github.com/stczwd/spark.git,git@github.com:stczwd/spark.git,https://github.com/stczwd/spark.git,https://github.com/stczwd/spark,,323667,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,0f463258c214c67360f2b46a4e2292d992b3bf23,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27900,https://github.com/apache/spark/pull/27900,https://api.github.com/repos/apache/spark/issues/27900,https://api.github.com/repos/apache/spark/issues/27900/comments,https://api.github.com/repos/apache/spark/pulls/27900/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27900/commits,https://api.github.com/repos/apache/spark/statuses/37017b73939466249422bb68998190d1ee9c3750
72,https://api.github.com/repos/apache/spark/pulls/27864,386128905,MDExOlB1bGxSZXF1ZXN0Mzg2MTI4OTA1,https://github.com/apache/spark/pull/27864,https://github.com/apache/spark/pull/27864.diff,https://github.com/apache/spark/pull/27864.patch,https://api.github.com/repos/apache/spark/issues/27864,27864,open,False,[SPARK-20732][CORE] Decommission cache blocks to other executors when an executor is decommissioned,"### What changes were proposed in this pull request?
After changes in SPARK-20628, CoarseGrainedSchedulerBackend can decommission an executor and stop assigning new tasks on it. We should also decommission the corresponding blockmanagers in the same way. i.e. Move the cached RDD blocks from those executors to other active executors.

### Why are the changes needed?
We need to gracefully decommission the block managers so that the underlying RDD cache blocks are not lost in case the executors are taken away forcefully after some timeout (because of spotloss/pre-emptible VM etc). Its good to save as much cache data as possible. 

Also In future once the decommissioning signal comes from Cluster Manager (say YARN/Mesos etc), dynamic allocation + this change gives us opportunity to downscale the executors faster by making the executors free of cache data.

Note that this is a best effort approach. We try to move cache blocks from decommissioning executors to active executors. If the active executors don't have free resources available on them for caching, then the decommissioning executors will keep the cache block which it was not able to move and it will still be able to serve them.

Current overall Flow:

1. CoarseGrainedSchedulerBackend receives a signal to decommissionExecutor. On receiving the signal, it do 2 things - Stop assigning new tasks (SPARK-20628), Send another message to BlockManagerMasterEndpoint (via BlockManagerMaster) to decommission the corresponding BlockManager.

2. BlockManagerMasterEndpoint receives ""DecommissionBlockManagers"" message. On receiving this, it moves the corresponding block managers to ""decommissioning"" state. All decommissioning BMs are excluded from the getPeers RPC call which is used for replication. All these decommissioning BMs are also sent message from BlockManagerMasterEndpoint to start decommissioning process on themselves.

3. BlockManager on worker (say BM-x) receives the ""DecommissionBlockManager"" message. Now it will start BlockManagerDecommissionManager thread to offload all the RDD cached blocks. This thread can make multiple reattempts to decommission the existing cache blocks (multiple reattempts might be needed as there might not be sufficient space in other active BMs initially).

### Does this PR introduce any user-facing change?
NO

### How was this patch tested?
Added UTs.",2020-03-10T13:20:51Z,2020-04-09T18:34:06Z,,,d40db1e4f7e5b06879d4ad86f50ca437e80b961b,,[],"[{'login': 'dongjoon-hyun', 'id': 9700541, 'node_id': 'MDQ6VXNlcjk3MDA1NDE=', 'avatar_url': 'https://avatars2.githubusercontent.com/u/9700541?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/dongjoon-hyun', 'html_url': 'https://github.com/dongjoon-hyun', 'followers_url': 'https://api.github.com/users/dongjoon-hyun/followers', 'following_url': 'https://api.github.com/users/dongjoon-hyun/following{/other_user}', 'gists_url': 'https://api.github.com/users/dongjoon-hyun/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/dongjoon-hyun/subscriptions', 'organizations_url': 'https://api.github.com/users/dongjoon-hyun/orgs', 'repos_url': 'https://api.github.com/users/dongjoon-hyun/repos', 'events_url': 'https://api.github.com/users/dongjoon-hyun/events{/privacy}', 'received_events_url': 'https://api.github.com/users/dongjoon-hyun/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27864/commits,https://api.github.com/repos/apache/spark/pulls/27864/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27864/comments,https://api.github.com/repos/apache/spark/statuses/9c6bdb626d228eb2ebf0d0c82e0a0aa8d0e9ec21,CONTRIBUTOR,spark,apache,prakharjain09,2551496,MDQ6VXNlcjI1NTE0OTY=,https://avatars0.githubusercontent.com/u/2551496?v=4,,https://api.github.com/users/prakharjain09,https://github.com/prakharjain09,https://api.github.com/users/prakharjain09/followers,https://api.github.com/users/prakharjain09/following{/other_user},https://api.github.com/users/prakharjain09/gists{/gist_id},https://api.github.com/users/prakharjain09/starred{/owner}{/repo},https://api.github.com/users/prakharjain09/subscriptions,https://api.github.com/users/prakharjain09/orgs,https://api.github.com/users/prakharjain09/repos,https://api.github.com/users/prakharjain09/events{/privacy},https://api.github.com/users/prakharjain09/received_events,User,False,prakharjain09:SPARK-20732-rddcache-1,SPARK-20732-rddcache-1,9c6bdb626d228eb2ebf0d0c82e0a0aa8d0e9ec21,prakharjain09,2551496,MDQ6VXNlcjI1NTE0OTY=,https://avatars0.githubusercontent.com/u/2551496?v=4,,https://api.github.com/users/prakharjain09,https://github.com/prakharjain09,https://api.github.com/users/prakharjain09/followers,https://api.github.com/users/prakharjain09/following{/other_user},https://api.github.com/users/prakharjain09/gists{/gist_id},https://api.github.com/users/prakharjain09/starred{/owner}{/repo},https://api.github.com/users/prakharjain09/subscriptions,https://api.github.com/users/prakharjain09/orgs,https://api.github.com/users/prakharjain09/repos,https://api.github.com/users/prakharjain09/events{/privacy},https://api.github.com/users/prakharjain09/received_events,User,False,140744137,MDEwOlJlcG9zaXRvcnkxNDA3NDQxMzc=,spark,prakharjain09/spark,False,prakharjain09,2551496,MDQ6VXNlcjI1NTE0OTY=,https://avatars0.githubusercontent.com/u/2551496?v=4,,https://api.github.com/users/prakharjain09,https://github.com/prakharjain09,https://api.github.com/users/prakharjain09/followers,https://api.github.com/users/prakharjain09/following{/other_user},https://api.github.com/users/prakharjain09/gists{/gist_id},https://api.github.com/users/prakharjain09/starred{/owner}{/repo},https://api.github.com/users/prakharjain09/subscriptions,https://api.github.com/users/prakharjain09/orgs,https://api.github.com/users/prakharjain09/repos,https://api.github.com/users/prakharjain09/events{/privacy},https://api.github.com/users/prakharjain09/received_events,User,False,https://github.com/prakharjain09/spark,Mirror of Apache Spark,True,https://api.github.com/repos/prakharjain09/spark,https://api.github.com/repos/prakharjain09/spark/forks,https://api.github.com/repos/prakharjain09/spark/keys{/key_id},https://api.github.com/repos/prakharjain09/spark/collaborators{/collaborator},https://api.github.com/repos/prakharjain09/spark/teams,https://api.github.com/repos/prakharjain09/spark/hooks,https://api.github.com/repos/prakharjain09/spark/issues/events{/number},https://api.github.com/repos/prakharjain09/spark/events,https://api.github.com/repos/prakharjain09/spark/assignees{/user},https://api.github.com/repos/prakharjain09/spark/branches{/branch},https://api.github.com/repos/prakharjain09/spark/tags,https://api.github.com/repos/prakharjain09/spark/git/blobs{/sha},https://api.github.com/repos/prakharjain09/spark/git/tags{/sha},https://api.github.com/repos/prakharjain09/spark/git/refs{/sha},https://api.github.com/repos/prakharjain09/spark/git/trees{/sha},https://api.github.com/repos/prakharjain09/spark/statuses/{sha},https://api.github.com/repos/prakharjain09/spark/languages,https://api.github.com/repos/prakharjain09/spark/stargazers,https://api.github.com/repos/prakharjain09/spark/contributors,https://api.github.com/repos/prakharjain09/spark/subscribers,https://api.github.com/repos/prakharjain09/spark/subscription,https://api.github.com/repos/prakharjain09/spark/commits{/sha},https://api.github.com/repos/prakharjain09/spark/git/commits{/sha},https://api.github.com/repos/prakharjain09/spark/comments{/number},https://api.github.com/repos/prakharjain09/spark/issues/comments{/number},https://api.github.com/repos/prakharjain09/spark/contents/{+path},https://api.github.com/repos/prakharjain09/spark/compare/{base}...{head},https://api.github.com/repos/prakharjain09/spark/merges,https://api.github.com/repos/prakharjain09/spark/{archive_format}{/ref},https://api.github.com/repos/prakharjain09/spark/downloads,https://api.github.com/repos/prakharjain09/spark/issues{/number},https://api.github.com/repos/prakharjain09/spark/pulls{/number},https://api.github.com/repos/prakharjain09/spark/milestones{/number},"https://api.github.com/repos/prakharjain09/spark/notifications{?since,all,participating}",https://api.github.com/repos/prakharjain09/spark/labels{/name},https://api.github.com/repos/prakharjain09/spark/releases{/id},https://api.github.com/repos/prakharjain09/spark/deployments,2018-07-12T17:21:48Z,2020-02-10T11:25:42Z,2020-04-08T14:13:43Z,git://github.com/prakharjain09/spark.git,git@github.com:prakharjain09/spark.git,https://github.com/prakharjain09/spark.git,https://github.com/prakharjain09/spark,,323236,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3c94a7c8f548d7023c363720fbdd122980905ba8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27864,https://github.com/apache/spark/pull/27864,https://api.github.com/repos/apache/spark/issues/27864,https://api.github.com/repos/apache/spark/issues/27864/comments,https://api.github.com/repos/apache/spark/pulls/27864/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27864/commits,https://api.github.com/repos/apache/spark/statuses/9c6bdb626d228eb2ebf0d0c82e0a0aa8d0e9ec21
73,https://api.github.com/repos/apache/spark/pulls/27862,386052530,MDExOlB1bGxSZXF1ZXN0Mzg2MDUyNTMw,https://github.com/apache/spark/pull/27862,https://github.com/apache/spark/pull/27862.diff,https://github.com/apache/spark/pull/27862.patch,https://api.github.com/repos/apache/spark/issues/27862,27862,open,False,[SPARK-31107][CORE]Extend FairScheduler to support pool level resource isolation,"

### What changes were proposed in this pull request?
Currently, spark only provided two types of scheduler: FIFO & FAIR, but in sql high-concurrency scenarios, a few of drawbacks are exposed.

FIFO: it can easily causing congestion when large sql query occupies all the resources

FAIR: the taskSets of one pool may occupies all the resource due to there are no hard limit on the maximum usage for each pool. this case may be frequently met under high workloads.

So we propose to add a maxShare argument for FairScheduler to control the maximum running tasks for each pool.


### Why are the changes needed?
Improvements


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
existing UT
",2020-03-10T10:31:14Z,2020-03-10T11:09:20Z,,,1dd4378167eb7ee3251253f600982a7bf4a42584,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27862/commits,https://api.github.com/repos/apache/spark/pulls/27862/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27862/comments,https://api.github.com/repos/apache/spark/statuses/d6339b1488668f7a4f6b3815c998ccf36de6aef8,NONE,spark,apache,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,liupc:SPARK-31107,SPARK-31107,d6339b1488668f7a4f6b3815c998ccf36de6aef8,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,75380071,MDEwOlJlcG9zaXRvcnk3NTM4MDA3MQ==,spark,liupc/spark,False,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,https://github.com/liupc/spark,Mirror of Apache Spark,True,https://api.github.com/repos/liupc/spark,https://api.github.com/repos/liupc/spark/forks,https://api.github.com/repos/liupc/spark/keys{/key_id},https://api.github.com/repos/liupc/spark/collaborators{/collaborator},https://api.github.com/repos/liupc/spark/teams,https://api.github.com/repos/liupc/spark/hooks,https://api.github.com/repos/liupc/spark/issues/events{/number},https://api.github.com/repos/liupc/spark/events,https://api.github.com/repos/liupc/spark/assignees{/user},https://api.github.com/repos/liupc/spark/branches{/branch},https://api.github.com/repos/liupc/spark/tags,https://api.github.com/repos/liupc/spark/git/blobs{/sha},https://api.github.com/repos/liupc/spark/git/tags{/sha},https://api.github.com/repos/liupc/spark/git/refs{/sha},https://api.github.com/repos/liupc/spark/git/trees{/sha},https://api.github.com/repos/liupc/spark/statuses/{sha},https://api.github.com/repos/liupc/spark/languages,https://api.github.com/repos/liupc/spark/stargazers,https://api.github.com/repos/liupc/spark/contributors,https://api.github.com/repos/liupc/spark/subscribers,https://api.github.com/repos/liupc/spark/subscription,https://api.github.com/repos/liupc/spark/commits{/sha},https://api.github.com/repos/liupc/spark/git/commits{/sha},https://api.github.com/repos/liupc/spark/comments{/number},https://api.github.com/repos/liupc/spark/issues/comments{/number},https://api.github.com/repos/liupc/spark/contents/{+path},https://api.github.com/repos/liupc/spark/compare/{base}...{head},https://api.github.com/repos/liupc/spark/merges,https://api.github.com/repos/liupc/spark/{archive_format}{/ref},https://api.github.com/repos/liupc/spark/downloads,https://api.github.com/repos/liupc/spark/issues{/number},https://api.github.com/repos/liupc/spark/pulls{/number},https://api.github.com/repos/liupc/spark/milestones{/number},"https://api.github.com/repos/liupc/spark/notifications{?since,all,participating}",https://api.github.com/repos/liupc/spark/labels{/name},https://api.github.com/repos/liupc/spark/releases{/id},https://api.github.com/repos/liupc/spark/deployments,2016-12-02T09:14:58Z,2019-07-01T03:12:23Z,2020-03-22T08:20:48Z,git://github.com/liupc/spark.git,git@github.com:liupc/spark.git,https://github.com/liupc/spark.git,https://github.com/liupc/spark,,311628,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8ee41f3576689f3d164131d1e6041bd347394364,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27862,https://github.com/apache/spark/pull/27862,https://api.github.com/repos/apache/spark/issues/27862,https://api.github.com/repos/apache/spark/issues/27862/comments,https://api.github.com/repos/apache/spark/pulls/27862/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27862/commits,https://api.github.com/repos/apache/spark/statuses/d6339b1488668f7a4f6b3815c998ccf36de6aef8
74,https://api.github.com/repos/apache/spark/pulls/27861,385963281,MDExOlB1bGxSZXF1ZXN0Mzg1OTYzMjgx,https://github.com/apache/spark/pull/27861,https://github.com/apache/spark/pull/27861.diff,https://github.com/apache/spark/pull/27861.patch,https://api.github.com/repos/apache/spark/issues/27861,27861,open,False,[SPARK-30707][SQL]Window function set partitionSpec as order spec when orderSpec is empty,"### What changes were proposed in this pull request?
In hive, when we use window function, if order spec is empty, it will set partition expression as 
order spec, but in spark, we won't do this. 
And when check window expression throw exception
```
SELECT lead(ten, four + 1) OVER (PARTITION BY four), ten, four
FROM (SELECT * FROM tenk1 WHERE unique2 < 10 ORDER BY four, ten)s
org.apache.spark.sql.AnalysisException
Window function lead(ten#x, (four#x + 1), null) requires window to be ordered, please add ORDER BY clause. For example SELECT lead(ten#x, (four#x + 1), null)(value_expr) OVER (PARTITION BY window_partition ORDER BY window_ordering) from table;
```

Do same thing like hive in this pr.

And test in postgres SQL
```
angerszhu=#  create table s4(id int, num int) ;
CREATE TABLE
angerszhu=#  insert into s4(id, num) values (1, 3), (2, 3), (3, 6), (4,7), (5,9), (6,9);
INSERT 0 6
angerszhu=# select * from s4;
 id | num 
----+-----
  1 |   3
  2 |   3
  3 |   6
  4 |   7
  5 |   9
  6 |   9
(6 rows)

angerszhu=# select id, num, lead(id) over (partition by num) from s4;
 id | num | lead 
----+-----+------
  1 |   3 |    2
  2 |   3 |     
  3 |   6 |     
  4 |   7 |     
  5 |   9 |    6
  6 |   9 |     
(6 rows)

angerszhu=# 
```
### Why are the changes needed?
Improve syntax compatibility


### Does this PR introduce any user-facing change?

Yes, we can write window function like 
```
SELECT lead(ten, four + 1) OVER (PARTITION BY four), ten, four
FROM (SELECT * FROM tenk1 WHERE unique2 < 10 ORDER BY four, ten)s
```


### How was this patch tested?
Added UT
",2020-03-10T06:43:39Z,2020-04-07T02:35:40Z,,,6f07800318daffb27e95c7b217c6e6d4eb58bbe7,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27861/commits,https://api.github.com/repos/apache/spark/pulls/27861/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27861/comments,https://api.github.com/repos/apache/spark/statuses/d369cbc61811f4334f511fcda9e191a89c040e3c,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-30707,SPARK-30707,d369cbc61811f4334f511fcda9e191a89c040e3c,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,d5f5720efa7232f1339976462d462a7360978ab5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27861,https://github.com/apache/spark/pull/27861,https://api.github.com/repos/apache/spark/issues/27861,https://api.github.com/repos/apache/spark/issues/27861/comments,https://api.github.com/repos/apache/spark/pulls/27861/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27861/commits,https://api.github.com/repos/apache/spark/statuses/d369cbc61811f4334f511fcda9e191a89c040e3c
75,https://api.github.com/repos/apache/spark/pulls/27860,385900495,MDExOlB1bGxSZXF1ZXN0Mzg1OTAwNDk1,https://github.com/apache/spark/pull/27860,https://github.com/apache/spark/pull/27860.diff,https://github.com/apache/spark/pull/27860.patch,https://api.github.com/repos/apache/spark/issues/27860,27860,open,False,[SPARK-31214][BUILD] Upgrade Janino to 3.1.2,"### What changes were proposed in this pull request?

This PR proposes to upgrade Janino to 3.1.2 which is released recently.

Major changes were done for refactoring, as well as there're lots of ""no commit message"". Belows are the pairs of (commit title, commit) which seem to deal with some bugs or specific improvements (not purposed to refactor) after 3.0.15.

* Issue #119: Guarantee executing popOperand() in popUninitializedVariableOperand() via moving popOperand() out of ""assert""
* Issue #116: replace operand to final target type if boxing conversion and widening reference conversion happen together
* Merged pull request `#114` ""Grow the code for relocatables, and do fixup, and relocate"".
  * https://github.com/janino-compiler/janino/commit/367c58e73e32014e5e1a5fc8225b7e5c17de00ad
* issue `#107`: Janino requires ""org.codehaus.commons.compiler.io"", but commons-compiler does not export this package
  * https://github.com/janino-compiler/janino/commit/f7d99596d43c56ab7b65cc8117db93f0fe4c6b6b
* Throw an NYI CompileException when a static interface method is invoked.
  * https://github.com/janino-compiler/janino/commit/efd3884983479f6e97adc2a270d02550276b7d3c
* Fixed the promotion of the array access index expression (see JLS7 15.13 Array Access Expressions)
  * https://github.com/janino-compiler/janino/commit/32fdb5f5f199c819394cae769e47d6fdcfa06b8f
* Issue `#104`: ClassLoaderIClassLoader 's ClassNotFoundException handle mechanism enhancement
  * https://github.com/janino-compiler/janino/commit/6e8a97d60908ecfa08b1d2d7c428a2631300516b

You can see the changelog from the link: http://janino-compiler.github.io/janino/changelog.html

### Why are the changes needed?

We got some report on failure on user's query which Janino throws error on compiling generated code. The issue is here: https://github.com/janino-compiler/janino/issues/113 It contains the information of generated code, symptom (error), and analysis of the bug, so please refer the link for more details.
Janino 3.1.1 contains the PR https://github.com/janino-compiler/janino/pull/114 which would enable Janino to succeed to compile user's query properly. I've also fixed a couple of more bugs as 3.1.1 made Spark UTs fail - hence we need to upgrade to 3.1.2.

Furthermore, from my testing, https://github.com/janino-compiler/janino/issues/90 (which Josh Rosen filed before) seems to be also resolved in 3.1.2 as well.

Looks like Janino is maintained by one person and there's no even version branches and releases/tags so we can't expect Janino maintainer to release a new bugfix version - hence have to try out new minor version.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

Existing UTs.",2020-03-10T02:12:03Z,2020-03-24T06:50:16Z,,,4f1115e250aaf4f52fb2ba5f1070226deca58740,,[],[],[],"[{'id': 1406627200, 'node_id': 'MDU6TGFiZWwxNDA2NjI3MjAw', 'url': 'https://api.github.com/repos/apache/spark/labels/BUILD', 'name': 'BUILD', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27860/commits,https://api.github.com/repos/apache/spark/pulls/27860/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27860/comments,https://api.github.com/repos/apache/spark/statuses/5965446f16fc0ba512bd2eeb03c6ed2c3e3faa56,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-31101,SPARK-31101,5965446f16fc0ba512bd2eeb03c6ed2c3e3faa56,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,bb295d80e37440e6ee67a00bc09df2e9ff6e4e46,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27860,https://github.com/apache/spark/pull/27860,https://api.github.com/repos/apache/spark/issues/27860,https://api.github.com/repos/apache/spark/issues/27860/comments,https://api.github.com/repos/apache/spark/pulls/27860/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27860/commits,https://api.github.com/repos/apache/spark/statuses/5965446f16fc0ba512bd2eeb03c6ed2c3e3faa56
76,https://api.github.com/repos/apache/spark/pulls/27855,385572849,MDExOlB1bGxSZXF1ZXN0Mzg1NTcyODQ5,https://github.com/apache/spark/pull/27855,https://github.com/apache/spark/pull/27855.diff,https://github.com/apache/spark/pull/27855.patch,https://api.github.com/repos/apache/spark/issues/27855,27855,open,False,[SPARK-31093][SHUFFLE] Fast fail while fetching shuffle data unsuccessfully,"### What changes were proposed in this pull request?
When fetching shuffle data unsuccessfully, we put a FailureFetchResult into results(a linkedBlockingQueue) and wait it to be taken.
Then method throwFetchFailedException() would be invoked.

In fact, we can fast fail the task once fetching shuffle data unsuccessfully.
In this PR, we invoke throwFetchFailedException once fetching shuffle data unsuccessfully.


### Why are the changes needed?
It can save the time when fetching shuffle data unsuccessfully.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Existing UT.",2020-03-09T12:55:58Z,2020-03-10T03:26:43Z,,,d7c4790dce5d6d6315dc0b80be2819b1b7836467,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27855/commits,https://api.github.com/repos/apache/spark/pulls/27855/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27855/comments,https://api.github.com/repos/apache/spark/statuses/00741c1831cb488a09d09f62d8b1b51be5d2264a,CONTRIBUTOR,spark,apache,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,turboFei:SPARK-31093-fast-fail-fetch,SPARK-31093-fast-fail-fetch,00741c1831cb488a09d09f62d8b1b51be5d2264a,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,77131854,MDEwOlJlcG9zaXRvcnk3NzEzMTg1NA==,spark,turboFei/spark,False,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,https://github.com/turboFei/spark,Mirror of Apache Spark,True,https://api.github.com/repos/turboFei/spark,https://api.github.com/repos/turboFei/spark/forks,https://api.github.com/repos/turboFei/spark/keys{/key_id},https://api.github.com/repos/turboFei/spark/collaborators{/collaborator},https://api.github.com/repos/turboFei/spark/teams,https://api.github.com/repos/turboFei/spark/hooks,https://api.github.com/repos/turboFei/spark/issues/events{/number},https://api.github.com/repos/turboFei/spark/events,https://api.github.com/repos/turboFei/spark/assignees{/user},https://api.github.com/repos/turboFei/spark/branches{/branch},https://api.github.com/repos/turboFei/spark/tags,https://api.github.com/repos/turboFei/spark/git/blobs{/sha},https://api.github.com/repos/turboFei/spark/git/tags{/sha},https://api.github.com/repos/turboFei/spark/git/refs{/sha},https://api.github.com/repos/turboFei/spark/git/trees{/sha},https://api.github.com/repos/turboFei/spark/statuses/{sha},https://api.github.com/repos/turboFei/spark/languages,https://api.github.com/repos/turboFei/spark/stargazers,https://api.github.com/repos/turboFei/spark/contributors,https://api.github.com/repos/turboFei/spark/subscribers,https://api.github.com/repos/turboFei/spark/subscription,https://api.github.com/repos/turboFei/spark/commits{/sha},https://api.github.com/repos/turboFei/spark/git/commits{/sha},https://api.github.com/repos/turboFei/spark/comments{/number},https://api.github.com/repos/turboFei/spark/issues/comments{/number},https://api.github.com/repos/turboFei/spark/contents/{+path},https://api.github.com/repos/turboFei/spark/compare/{base}...{head},https://api.github.com/repos/turboFei/spark/merges,https://api.github.com/repos/turboFei/spark/{archive_format}{/ref},https://api.github.com/repos/turboFei/spark/downloads,https://api.github.com/repos/turboFei/spark/issues{/number},https://api.github.com/repos/turboFei/spark/pulls{/number},https://api.github.com/repos/turboFei/spark/milestones{/number},"https://api.github.com/repos/turboFei/spark/notifications{?since,all,participating}",https://api.github.com/repos/turboFei/spark/labels{/name},https://api.github.com/repos/turboFei/spark/releases{/id},https://api.github.com/repos/turboFei/spark/deployments,2016-12-22T09:34:08Z,2019-10-25T09:06:55Z,2020-04-08T10:08:56Z,git://github.com/turboFei/spark.git,git@github.com:turboFei/spark.git,https://github.com/turboFei/spark.git,https://github.com/turboFei/spark,,322115,0,0,Scala,False,True,True,False,False,0,,False,False,4,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,4,0,master,apache:master,master,ef51ff9dc8c220fcbed76cdd1783f58f400df48c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27855,https://github.com/apache/spark/pull/27855,https://api.github.com/repos/apache/spark/issues/27855,https://api.github.com/repos/apache/spark/issues/27855/comments,https://api.github.com/repos/apache/spark/pulls/27855/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27855/commits,https://api.github.com/repos/apache/spark/statuses/00741c1831cb488a09d09f62d8b1b51be5d2264a
77,https://api.github.com/repos/apache/spark/pulls/27849,385248763,MDExOlB1bGxSZXF1ZXN0Mzg1MjQ4NzYz,https://github.com/apache/spark/pull/27849,https://github.com/apache/spark/pull/27849.diff,https://github.com/apache/spark/pull/27849.patch,https://api.github.com/repos/apache/spark/issues/27849,27849,open,False,[SPARK-31081][UI][SQL] Make the display of stageId/stageAttemptId/taskId of sql metrics configurable in UI,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This PR adds a conf to make the display of `stageId/StageAttemptId/taskId` of SQL metrics configurable in UI. And also propose to not display them by default.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

It makes metrics harder to read after #26843 and user may not interest in extra info(`stageId/StageAttemptId/taskId `) when they do not need debug. So, I think we need to a way to make the display configurable.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

Yes.

Before this PR:

<img width=""948"" alt=""before"" src=""https://user-images.githubusercontent.com/16397174/76429078-7fbf6180-63e9-11ea-909e-07a9073af32c.png"">


After this PR without `stageId/StageAttemptId/taskId`:
<img width=""655"" alt=""wihoutId"" src=""https://user-images.githubusercontent.com/16397174/76428948-50105980-63e9-11ea-8051-e39b65f2b955.png"">







### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Updated `SQLMetricsSuite` and tested manually.
",2020-03-08T10:06:43Z,2020-03-16T01:58:50Z,,,d614c089f3903bc252115acf659e87e53ff4ffc6,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27849/commits,https://api.github.com/repos/apache/spark/pulls/27849/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27849/comments,https://api.github.com/repos/apache/spark/statuses/a41d9c4e710539025b003e2c2f5c672f3ffb715b,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:format_metrics,format_metrics,a41d9c4e710539025b003e2c2f5c672f3ffb715b,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,f8a3730fd7d1f05a4cbd5b36752662d88e06c56e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27849,https://github.com/apache/spark/pull/27849,https://api.github.com/repos/apache/spark/issues/27849,https://api.github.com/repos/apache/spark/issues/27849/comments,https://api.github.com/repos/apache/spark/pulls/27849/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27849/commits,https://api.github.com/repos/apache/spark/statuses/a41d9c4e710539025b003e2c2f5c672f3ffb715b
78,https://api.github.com/repos/apache/spark/pulls/27845,385098396,MDExOlB1bGxSZXF1ZXN0Mzg1MDk4Mzk2,https://github.com/apache/spark/pull/27845,https://github.com/apache/spark/pull/27845.diff,https://github.com/apache/spark/pull/27845.patch,https://api.github.com/repos/apache/spark/issues/27845,27845,open,False,[GRAPHX][MINOR] Shortest paths on weighted edges,"This adds a new `ShortestPaths#run` function that takes a `weight` argument, a function mapping edges in the graph to their respective weights.",2020-03-07T03:34:55Z,2020-03-07T03:43:04Z,,,9015dee889df8846d039ad3fe8f4d6906b26b570,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27845/commits,https://api.github.com/repos/apache/spark/pulls/27845/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27845/comments,https://api.github.com/repos/apache/spark/statuses/3539311608d77a0056858df4a4e253be0ee8ecba,NONE,spark,apache,earldouglas,424946,MDQ6VXNlcjQyNDk0Ng==,https://avatars0.githubusercontent.com/u/424946?v=4,,https://api.github.com/users/earldouglas,https://github.com/earldouglas,https://api.github.com/users/earldouglas/followers,https://api.github.com/users/earldouglas/following{/other_user},https://api.github.com/users/earldouglas/gists{/gist_id},https://api.github.com/users/earldouglas/starred{/owner}{/repo},https://api.github.com/users/earldouglas/subscriptions,https://api.github.com/users/earldouglas/orgs,https://api.github.com/users/earldouglas/repos,https://api.github.com/users/earldouglas/events{/privacy},https://api.github.com/users/earldouglas/received_events,User,False,earldouglas:weighted-shortest-paths,weighted-shortest-paths,3539311608d77a0056858df4a4e253be0ee8ecba,earldouglas,424946,MDQ6VXNlcjQyNDk0Ng==,https://avatars0.githubusercontent.com/u/424946?v=4,,https://api.github.com/users/earldouglas,https://github.com/earldouglas,https://api.github.com/users/earldouglas/followers,https://api.github.com/users/earldouglas/following{/other_user},https://api.github.com/users/earldouglas/gists{/gist_id},https://api.github.com/users/earldouglas/starred{/owner}{/repo},https://api.github.com/users/earldouglas/subscriptions,https://api.github.com/users/earldouglas/orgs,https://api.github.com/users/earldouglas/repos,https://api.github.com/users/earldouglas/events{/privacy},https://api.github.com/users/earldouglas/received_events,User,False,245561324,MDEwOlJlcG9zaXRvcnkyNDU1NjEzMjQ=,spark,earldouglas/spark,False,earldouglas,424946,MDQ6VXNlcjQyNDk0Ng==,https://avatars0.githubusercontent.com/u/424946?v=4,,https://api.github.com/users/earldouglas,https://github.com/earldouglas,https://api.github.com/users/earldouglas/followers,https://api.github.com/users/earldouglas/following{/other_user},https://api.github.com/users/earldouglas/gists{/gist_id},https://api.github.com/users/earldouglas/starred{/owner}{/repo},https://api.github.com/users/earldouglas/subscriptions,https://api.github.com/users/earldouglas/orgs,https://api.github.com/users/earldouglas/repos,https://api.github.com/users/earldouglas/events{/privacy},https://api.github.com/users/earldouglas/received_events,User,False,https://github.com/earldouglas/spark,Apache Spark,True,https://api.github.com/repos/earldouglas/spark,https://api.github.com/repos/earldouglas/spark/forks,https://api.github.com/repos/earldouglas/spark/keys{/key_id},https://api.github.com/repos/earldouglas/spark/collaborators{/collaborator},https://api.github.com/repos/earldouglas/spark/teams,https://api.github.com/repos/earldouglas/spark/hooks,https://api.github.com/repos/earldouglas/spark/issues/events{/number},https://api.github.com/repos/earldouglas/spark/events,https://api.github.com/repos/earldouglas/spark/assignees{/user},https://api.github.com/repos/earldouglas/spark/branches{/branch},https://api.github.com/repos/earldouglas/spark/tags,https://api.github.com/repos/earldouglas/spark/git/blobs{/sha},https://api.github.com/repos/earldouglas/spark/git/tags{/sha},https://api.github.com/repos/earldouglas/spark/git/refs{/sha},https://api.github.com/repos/earldouglas/spark/git/trees{/sha},https://api.github.com/repos/earldouglas/spark/statuses/{sha},https://api.github.com/repos/earldouglas/spark/languages,https://api.github.com/repos/earldouglas/spark/stargazers,https://api.github.com/repos/earldouglas/spark/contributors,https://api.github.com/repos/earldouglas/spark/subscribers,https://api.github.com/repos/earldouglas/spark/subscription,https://api.github.com/repos/earldouglas/spark/commits{/sha},https://api.github.com/repos/earldouglas/spark/git/commits{/sha},https://api.github.com/repos/earldouglas/spark/comments{/number},https://api.github.com/repos/earldouglas/spark/issues/comments{/number},https://api.github.com/repos/earldouglas/spark/contents/{+path},https://api.github.com/repos/earldouglas/spark/compare/{base}...{head},https://api.github.com/repos/earldouglas/spark/merges,https://api.github.com/repos/earldouglas/spark/{archive_format}{/ref},https://api.github.com/repos/earldouglas/spark/downloads,https://api.github.com/repos/earldouglas/spark/issues{/number},https://api.github.com/repos/earldouglas/spark/pulls{/number},https://api.github.com/repos/earldouglas/spark/milestones{/number},"https://api.github.com/repos/earldouglas/spark/notifications{?since,all,participating}",https://api.github.com/repos/earldouglas/spark/labels{/name},https://api.github.com/repos/earldouglas/spark/releases{/id},https://api.github.com/repos/earldouglas/spark/deployments,2020-03-07T03:29:02Z,2020-03-07T03:29:04Z,2020-03-07T03:32:03Z,git://github.com/earldouglas/spark.git,git@github.com:earldouglas/spark.git,https://github.com/earldouglas/spark.git,https://github.com/earldouglas/spark,,323439,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,7911f952029682e12fd1f90665f2869e1461c365,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27845,https://github.com/apache/spark/pull/27845,https://api.github.com/repos/apache/spark/issues/27845,https://api.github.com/repos/apache/spark/issues/27845/comments,https://api.github.com/repos/apache/spark/pulls/27845/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27845/commits,https://api.github.com/repos/apache/spark/statuses/3539311608d77a0056858df4a4e253be0ee8ecba
79,https://api.github.com/repos/apache/spark/pulls/27843,385091648,MDExOlB1bGxSZXF1ZXN0Mzg1MDkxNjQ4,https://github.com/apache/spark/pull/27843,https://github.com/apache/spark/pull/27843.diff,https://github.com/apache/spark/pull/27843.patch,https://api.github.com/repos/apache/spark/issues/27843,27843,open,False,[SPARK-31029] Avoid using global execution context in driver main thread for YarnSchedulerBackend,"#31029 # What changes were proposed in this pull request?
In YarnSchedulerBackend, we should avoid using the global execution context for its Future. Otherwise if user's Spark application also uses global execution context for its Future, the user is facing indeterministic behavior in terms of the thread's context class loader.

### Why are the changes needed?
Spark driver starts ApplicationMaster in the main thread, which starts a user thread and set MutableURLClassLoader to that thread's ContextClassLoader.
userClassThread = startUserApplication()

The main thread then setup YarnSchedulerBackend RPC endpoints, which handles these calls using scala Future with the default global ExecutionContext:

doRequestTotalExecutors
doKillExecutors
If main thread starts a future to handle doKillExecutors() before user thread does then the default thread pool thread's ContextClassLoader would be the default (AppClassLoader).
If user thread starts a future first then the thread pool thread will have MutableURLClassLoader.

So if user's code uses a future which references a user provided class (only MutableURLClassLoader can load), and before the future if there are executor lost, you will see errors related to class not found.


### Does this PR introduce any user-facing change?
No

### How was this patch tested?
Existing unit tests and manual tests",2020-03-07T02:25:45Z,2020-03-07T20:30:12Z,,,bec3b571a63ae4d56bc4aa8aa447f761b0888420,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27843/commits,https://api.github.com/repos/apache/spark/pulls/27843/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27843/comments,https://api.github.com/repos/apache/spark/statuses/a91b0cfe3d8cacb3e005ef0d0023956fbf70e572,CONTRIBUTOR,spark,apache,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,shanyu:shanyu-31029,shanyu-31029,a91b0cfe3d8cacb3e005ef0d0023956fbf70e572,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,40154439,MDEwOlJlcG9zaXRvcnk0MDE1NDQzOQ==,spark,shanyu/spark,False,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,https://github.com/shanyu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/shanyu/spark,https://api.github.com/repos/shanyu/spark/forks,https://api.github.com/repos/shanyu/spark/keys{/key_id},https://api.github.com/repos/shanyu/spark/collaborators{/collaborator},https://api.github.com/repos/shanyu/spark/teams,https://api.github.com/repos/shanyu/spark/hooks,https://api.github.com/repos/shanyu/spark/issues/events{/number},https://api.github.com/repos/shanyu/spark/events,https://api.github.com/repos/shanyu/spark/assignees{/user},https://api.github.com/repos/shanyu/spark/branches{/branch},https://api.github.com/repos/shanyu/spark/tags,https://api.github.com/repos/shanyu/spark/git/blobs{/sha},https://api.github.com/repos/shanyu/spark/git/tags{/sha},https://api.github.com/repos/shanyu/spark/git/refs{/sha},https://api.github.com/repos/shanyu/spark/git/trees{/sha},https://api.github.com/repos/shanyu/spark/statuses/{sha},https://api.github.com/repos/shanyu/spark/languages,https://api.github.com/repos/shanyu/spark/stargazers,https://api.github.com/repos/shanyu/spark/contributors,https://api.github.com/repos/shanyu/spark/subscribers,https://api.github.com/repos/shanyu/spark/subscription,https://api.github.com/repos/shanyu/spark/commits{/sha},https://api.github.com/repos/shanyu/spark/git/commits{/sha},https://api.github.com/repos/shanyu/spark/comments{/number},https://api.github.com/repos/shanyu/spark/issues/comments{/number},https://api.github.com/repos/shanyu/spark/contents/{+path},https://api.github.com/repos/shanyu/spark/compare/{base}...{head},https://api.github.com/repos/shanyu/spark/merges,https://api.github.com/repos/shanyu/spark/{archive_format}{/ref},https://api.github.com/repos/shanyu/spark/downloads,https://api.github.com/repos/shanyu/spark/issues{/number},https://api.github.com/repos/shanyu/spark/pulls{/number},https://api.github.com/repos/shanyu/spark/milestones{/number},"https://api.github.com/repos/shanyu/spark/notifications{?since,all,participating}",https://api.github.com/repos/shanyu/spark/labels{/name},https://api.github.com/repos/shanyu/spark/releases{/id},https://api.github.com/repos/shanyu/spark/deployments,2015-08-04T00:23:30Z,2020-03-04T01:26:37Z,2020-03-07T21:12:11Z,git://github.com/shanyu/spark.git,git@github.com:shanyu/spark.git,https://github.com/shanyu/spark.git,https://github.com/shanyu/spark,,297505,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,7911f952029682e12fd1f90665f2869e1461c365,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27843,https://github.com/apache/spark/pull/27843,https://api.github.com/repos/apache/spark/issues/27843,https://api.github.com/repos/apache/spark/issues/27843/comments,https://api.github.com/repos/apache/spark/pulls/27843/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27843/commits,https://api.github.com/repos/apache/spark/statuses/a91b0cfe3d8cacb3e005ef0d0023956fbf70e572
80,https://api.github.com/repos/apache/spark/pulls/27831,384708576,MDExOlB1bGxSZXF1ZXN0Mzg0NzA4NTc2,https://github.com/apache/spark/pull/27831,https://github.com/apache/spark/pull/27831.diff,https://github.com/apache/spark/pull/27831.patch,https://api.github.com/repos/apache/spark/issues/27831,27831,open,False,[SPARK-31069][CORE] high cpu caused by chunksBeingTransferred in external shuffle service,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
This change is targeted to speed up the calculation of chunksBeingTransferred to avoid high cpu when there are many stream requests.


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-03-06T09:05:18Z,2020-03-27T13:02:28Z,,,3846c89ceee9dfce8bb8baa0276129c8e2f50cee,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27831/commits,https://api.github.com/repos/apache/spark/pulls/27831/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27831/comments,https://api.github.com/repos/apache/spark/statuses/d6af3f5754417f4ca2e20d9e169d187b7dc72ac1,NONE,spark,apache,chrysan,5151781,MDQ6VXNlcjUxNTE3ODE=,https://avatars1.githubusercontent.com/u/5151781?v=4,,https://api.github.com/users/chrysan,https://github.com/chrysan,https://api.github.com/users/chrysan/followers,https://api.github.com/users/chrysan/following{/other_user},https://api.github.com/users/chrysan/gists{/gist_id},https://api.github.com/users/chrysan/starred{/owner}{/repo},https://api.github.com/users/chrysan/subscriptions,https://api.github.com/users/chrysan/orgs,https://api.github.com/users/chrysan/repos,https://api.github.com/users/chrysan/events{/privacy},https://api.github.com/users/chrysan/received_events,User,False,chrysan:high-cpu,high-cpu,d6af3f5754417f4ca2e20d9e169d187b7dc72ac1,chrysan,5151781,MDQ6VXNlcjUxNTE3ODE=,https://avatars1.githubusercontent.com/u/5151781?v=4,,https://api.github.com/users/chrysan,https://github.com/chrysan,https://api.github.com/users/chrysan/followers,https://api.github.com/users/chrysan/following{/other_user},https://api.github.com/users/chrysan/gists{/gist_id},https://api.github.com/users/chrysan/starred{/owner}{/repo},https://api.github.com/users/chrysan/subscriptions,https://api.github.com/users/chrysan/orgs,https://api.github.com/users/chrysan/repos,https://api.github.com/users/chrysan/events{/privacy},https://api.github.com/users/chrysan/received_events,User,False,226863260,MDEwOlJlcG9zaXRvcnkyMjY4NjMyNjA=,spark,chrysan/spark,False,chrysan,5151781,MDQ6VXNlcjUxNTE3ODE=,https://avatars1.githubusercontent.com/u/5151781?v=4,,https://api.github.com/users/chrysan,https://github.com/chrysan,https://api.github.com/users/chrysan/followers,https://api.github.com/users/chrysan/following{/other_user},https://api.github.com/users/chrysan/gists{/gist_id},https://api.github.com/users/chrysan/starred{/owner}{/repo},https://api.github.com/users/chrysan/subscriptions,https://api.github.com/users/chrysan/orgs,https://api.github.com/users/chrysan/repos,https://api.github.com/users/chrysan/events{/privacy},https://api.github.com/users/chrysan/received_events,User,False,https://github.com/chrysan/spark,Apache Spark,True,https://api.github.com/repos/chrysan/spark,https://api.github.com/repos/chrysan/spark/forks,https://api.github.com/repos/chrysan/spark/keys{/key_id},https://api.github.com/repos/chrysan/spark/collaborators{/collaborator},https://api.github.com/repos/chrysan/spark/teams,https://api.github.com/repos/chrysan/spark/hooks,https://api.github.com/repos/chrysan/spark/issues/events{/number},https://api.github.com/repos/chrysan/spark/events,https://api.github.com/repos/chrysan/spark/assignees{/user},https://api.github.com/repos/chrysan/spark/branches{/branch},https://api.github.com/repos/chrysan/spark/tags,https://api.github.com/repos/chrysan/spark/git/blobs{/sha},https://api.github.com/repos/chrysan/spark/git/tags{/sha},https://api.github.com/repos/chrysan/spark/git/refs{/sha},https://api.github.com/repos/chrysan/spark/git/trees{/sha},https://api.github.com/repos/chrysan/spark/statuses/{sha},https://api.github.com/repos/chrysan/spark/languages,https://api.github.com/repos/chrysan/spark/stargazers,https://api.github.com/repos/chrysan/spark/contributors,https://api.github.com/repos/chrysan/spark/subscribers,https://api.github.com/repos/chrysan/spark/subscription,https://api.github.com/repos/chrysan/spark/commits{/sha},https://api.github.com/repos/chrysan/spark/git/commits{/sha},https://api.github.com/repos/chrysan/spark/comments{/number},https://api.github.com/repos/chrysan/spark/issues/comments{/number},https://api.github.com/repos/chrysan/spark/contents/{+path},https://api.github.com/repos/chrysan/spark/compare/{base}...{head},https://api.github.com/repos/chrysan/spark/merges,https://api.github.com/repos/chrysan/spark/{archive_format}{/ref},https://api.github.com/repos/chrysan/spark/downloads,https://api.github.com/repos/chrysan/spark/issues{/number},https://api.github.com/repos/chrysan/spark/pulls{/number},https://api.github.com/repos/chrysan/spark/milestones{/number},"https://api.github.com/repos/chrysan/spark/notifications{?since,all,participating}",https://api.github.com/repos/chrysan/spark/labels{/name},https://api.github.com/repos/chrysan/spark/releases{/id},https://api.github.com/repos/chrysan/spark/deployments,2019-12-09T12:13:49Z,2020-03-06T08:35:51Z,2020-03-06T08:53:15Z,git://github.com/chrysan/spark.git,git@github.com:chrysan/spark.git,https://github.com/chrysan/spark.git,https://github.com/chrysan/spark,,322573,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,cba17e07e9f15673f274de1728f6137d600026e1,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27831,https://github.com/apache/spark/pull/27831,https://api.github.com/repos/apache/spark/issues/27831,https://api.github.com/repos/apache/spark/issues/27831/comments,https://api.github.com/repos/apache/spark/pulls/27831/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27831/commits,https://api.github.com/repos/apache/spark/statuses/d6af3f5754417f4ca2e20d9e169d187b7dc72ac1
81,https://api.github.com/repos/apache/spark/pulls/27805,384190353,MDExOlB1bGxSZXF1ZXN0Mzg0MTkwMzUz,https://github.com/apache/spark/pull/27805,https://github.com/apache/spark/pull/27805.diff,https://github.com/apache/spark/pull/27805.patch,https://api.github.com/repos/apache/spark/issues/27805,27805,open,False,[SPARK-31056][SQL] Add CalendarIntervals division,"### What changes were proposed in this pull request?
This defines the devision of two `CalendarInterval`s as the ratio between the time duration of both. The `CalendarInterval` consists of three time components: `months`, `days` and `microseconds`. The division is only defined between intervals that have a single non-zero time component, while both intervals have the same non-zero time component. Otherwise the division expression would be ambiguous.

### Why are the changes needed?
Putting interval into relation is a natural expression: 1 day / 1 hour = number of hours per day.

This allows to evaluate the magnitude of `CalendarInterval`s in SQL expressions:

```
Seq((Timestamp.valueOf(""2020-02-01 12:00:00""), Timestamp.valueOf(""2020-02-01 13:30:25"")))
  .toDF(""start"", ""end"")
  .withColumn(""interval"", $""end"" - $""start"")
  .withColumn(""interval [h]"", $""interval"" / lit(""1 hour"").cast(CalendarIntervalType))
  .withColumn(""rate [€/h]"", lit(1.45))
  .withColumn(""price [€]"", $""interval [h]"" * $""rate [€/h]"")
  .show(false)
+-------------------+-------------------+-----------------------------+------------------+----------+------------------+
|start              |end                |interval                     |interval [h]      |rate [€/h]|price [€]         |
+-------------------+-------------------+-----------------------------+------------------+----------+------------------+
|2020-02-01 12:00:00|2020-02-01 13:30:25|1 hours 30 minutes 25 seconds|1.5069444444444444|1.45      |2.1850694444444443|
+-------------------+-------------------+-----------------------------+------------------+----------+------------------+
```

The currently available approach is

```
Seq((Timestamp.valueOf(""2020-02-01 12:00:00""), Timestamp.valueOf(""2020-02-01 13:30:25"")))
  .toDF(""start"", ""end"")
  .withColumn(""interval [s]"", unix_timestamp($""end"") - unix_timestamp($""start""))
  .withColumn(""interval [h]"", $""interval [s]"" / 3600)
  .withColumn(""rate [€/h]"", lit(1.45))
  .withColumn(""price [€]"", $""interval [h]"" * $""rate [€/h]"")
  .show(false)
```

Going through `unix_timestamp` is a hack and it pollutes the SQL query with unrelated semantics (unix timestamp is completely irrelevant for this computation). It is merely there because there is currently no way to access the length of an `CalendarInterval`. Dividing an interval by another interval provides means to measure the length in an arbitrary unit (minutes, hours, quarter hours).

### Does this PR introduce any user-facing change?
It allows interval division in SQL expressions and adds the `DivideIntervals` catalyst expression.

### How was this patch tested?
Unit tests in `IntervalExpressionsSuite`.",2020-03-05T10:27:22Z,2020-03-05T15:48:23Z,,,2a3cebd280b0a6f75d1c3da1c0936244ac7417a1,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27805/commits,https://api.github.com/repos/apache/spark/pulls/27805/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27805/comments,https://api.github.com/repos/apache/spark/statuses/e5c79a672b1e526a65263286a59128ce911da4fc,CONTRIBUTOR,spark,apache,EnricoMi,44700269,MDQ6VXNlcjQ0NzAwMjY5,https://avatars1.githubusercontent.com/u/44700269?v=4,,https://api.github.com/users/EnricoMi,https://github.com/EnricoMi,https://api.github.com/users/EnricoMi/followers,https://api.github.com/users/EnricoMi/following{/other_user},https://api.github.com/users/EnricoMi/gists{/gist_id},https://api.github.com/users/EnricoMi/starred{/owner}{/repo},https://api.github.com/users/EnricoMi/subscriptions,https://api.github.com/users/EnricoMi/orgs,https://api.github.com/users/EnricoMi/repos,https://api.github.com/users/EnricoMi/events{/privacy},https://api.github.com/users/EnricoMi/received_events,User,False,G-Research:branch-calendar-intervals-division,branch-calendar-intervals-division,e5c79a672b1e526a65263286a59128ce911da4fc,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,214350064,MDEwOlJlcG9zaXRvcnkyMTQzNTAwNjQ=,spark,G-Research/spark,False,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,https://github.com/G-Research/spark,Apache Spark,True,https://api.github.com/repos/G-Research/spark,https://api.github.com/repos/G-Research/spark/forks,https://api.github.com/repos/G-Research/spark/keys{/key_id},https://api.github.com/repos/G-Research/spark/collaborators{/collaborator},https://api.github.com/repos/G-Research/spark/teams,https://api.github.com/repos/G-Research/spark/hooks,https://api.github.com/repos/G-Research/spark/issues/events{/number},https://api.github.com/repos/G-Research/spark/events,https://api.github.com/repos/G-Research/spark/assignees{/user},https://api.github.com/repos/G-Research/spark/branches{/branch},https://api.github.com/repos/G-Research/spark/tags,https://api.github.com/repos/G-Research/spark/git/blobs{/sha},https://api.github.com/repos/G-Research/spark/git/tags{/sha},https://api.github.com/repos/G-Research/spark/git/refs{/sha},https://api.github.com/repos/G-Research/spark/git/trees{/sha},https://api.github.com/repos/G-Research/spark/statuses/{sha},https://api.github.com/repos/G-Research/spark/languages,https://api.github.com/repos/G-Research/spark/stargazers,https://api.github.com/repos/G-Research/spark/contributors,https://api.github.com/repos/G-Research/spark/subscribers,https://api.github.com/repos/G-Research/spark/subscription,https://api.github.com/repos/G-Research/spark/commits{/sha},https://api.github.com/repos/G-Research/spark/git/commits{/sha},https://api.github.com/repos/G-Research/spark/comments{/number},https://api.github.com/repos/G-Research/spark/issues/comments{/number},https://api.github.com/repos/G-Research/spark/contents/{+path},https://api.github.com/repos/G-Research/spark/compare/{base}...{head},https://api.github.com/repos/G-Research/spark/merges,https://api.github.com/repos/G-Research/spark/{archive_format}{/ref},https://api.github.com/repos/G-Research/spark/downloads,https://api.github.com/repos/G-Research/spark/issues{/number},https://api.github.com/repos/G-Research/spark/pulls{/number},https://api.github.com/repos/G-Research/spark/milestones{/number},"https://api.github.com/repos/G-Research/spark/notifications{?since,all,participating}",https://api.github.com/repos/G-Research/spark/labels{/name},https://api.github.com/repos/G-Research/spark/releases{/id},https://api.github.com/repos/G-Research/spark/deployments,2019-10-11T05:23:46Z,2020-02-11T16:12:31Z,2020-03-05T09:46:15Z,git://github.com/G-Research/spark.git,git@github.com:G-Research/spark.git,https://github.com/G-Research/spark.git,https://github.com/G-Research/spark,,322153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,0a22f1966466629cb745d000a0608d521fece093,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27805,https://github.com/apache/spark/pull/27805,https://api.github.com/repos/apache/spark/issues/27805,https://api.github.com/repos/apache/spark/issues/27805/comments,https://api.github.com/repos/apache/spark/pulls/27805/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27805/commits,https://api.github.com/repos/apache/spark/statuses/e5c79a672b1e526a65263286a59128ce911da4fc
82,https://api.github.com/repos/apache/spark/pulls/27803,384112882,MDExOlB1bGxSZXF1ZXN0Mzg0MTEyODgy,https://github.com/apache/spark/pull/27803,https://github.com/apache/spark/pull/27803.diff,https://github.com/apache/spark/pull/27803.patch,https://api.github.com/repos/apache/spark/issues/27803,27803,open,False,"[SPARK-31049][SQL] Support nested adjacent generators, e.g., explode(explode(v))","### What changes were proposed in this pull request?

In the master, we currently don't support any nested generators, but I think supporting limited nested cases is somewhat useful for users, e.g., explode(explode(v)). This PR intends to add some logics in `ExtractGenerator` for supporting the nested generators as follows;

```scala
// before this PR
scala> sql(""select explode(explode(array(array(1, 2), array(3))))"").show()
org.apache.spark.sql.AnalysisException: Generators are not supported when it's nested in expressions, but got: explode(explode(array(array(1, 2), array(3))));

// after this PR
scala> sql(""select explode(explode(array(array(1, 2), array(3))))"").show()
+---+
|col|
+---+
|  1|
|  2|
|  3|
+---+
```

### Why are the changes needed?

I saw some usecases on the web where users expand nested arrays by a `unnest` function in potgresql and google big query;
```
postgres=# select unnest(ARRAY[ARRAY[1,2],ARRAY[3,4]]);
 unnest 
--------
      1
      2
      3
      4
(4 rows)
```
Based on this, IMO extending the existing `explode` for nested arrays seems helpful for users.
FYI: we already have the [jira](https://issues.apache.org/jira/browse/SPARK-28382) for implementing the unnest function, but we've closed the jira because of our policy as you know.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

Added tests.
",2020-03-05T07:33:40Z,2020-04-03T12:23:06Z,,,6a2bfab8620eafcaaedb28ffcb14fe199f46c394,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27803/commits,https://api.github.com/repos/apache/spark/pulls/27803/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27803/comments,https://api.github.com/repos/apache/spark/statuses/ce4e9a2a437ac085910e529887a35723a733ba10,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:SupportNestedGenerator,SupportNestedGenerator,ce4e9a2a437ac085910e529887a35723a733ba10,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2c39502e841b344b431473a0a4f79591b9b1fe38,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27803,https://github.com/apache/spark/pull/27803,https://api.github.com/repos/apache/spark/issues/27803,https://api.github.com/repos/apache/spark/issues/27803/comments,https://api.github.com/repos/apache/spark/pulls/27803/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27803/commits,https://api.github.com/repos/apache/spark/statuses/ce4e9a2a437ac085910e529887a35723a733ba10
83,https://api.github.com/repos/apache/spark/pulls/27768,382823595,MDExOlB1bGxSZXF1ZXN0MzgyODIzNTk1,https://github.com/apache/spark/pull/27768,https://github.com/apache/spark/pull/27768.diff,https://github.com/apache/spark/pull/27768.patch,https://api.github.com/repos/apache/spark/issues/27768,27768,open,False,[SPARK-31018][CORE] Deprecate support of multiple workers on the same host in Standalone,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Update the document and shell script to warn user about the deprecation of multiple workers on the same host support.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

This is a sub-task of [SPARK-30978](https://issues.apache.org/jira/browse/SPARK-30978), which plans to totally remove support of multiple workers in Spark 3.1. This PR makes the first step to deprecate it firstly in Spark 3.0. 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

Yeah, user see warning when they run start worker script.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Tested manually.
",2020-03-03T09:01:43Z,2020-04-09T10:56:06Z,,,88b9c8831abd001054b365a177645df89ba8b64a,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27768/commits,https://api.github.com/repos/apache/spark/pulls/27768/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27768/comments,https://api.github.com/repos/apache/spark/statuses/0ed01a41c002ab9d3d5707b166f7d3c525527314,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:deprecate_spark_worker_instances,deprecate_spark_worker_instances,0ed01a41c002ab9d3d5707b166f7d3c525527314,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,c279e6b0914014a99b84076420240dceaf3b895d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27768,https://github.com/apache/spark/pull/27768,https://api.github.com/repos/apache/spark/issues/27768,https://api.github.com/repos/apache/spark/issues/27768/comments,https://api.github.com/repos/apache/spark/pulls/27768/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27768/commits,https://api.github.com/repos/apache/spark/statuses/0ed01a41c002ab9d3d5707b166f7d3c525527314
84,https://api.github.com/repos/apache/spark/pulls/27758,382289537,MDExOlB1bGxSZXF1ZXN0MzgyMjg5NTM3,https://github.com/apache/spark/pull/27758,https://github.com/apache/spark/pull/27758.diff,https://github.com/apache/spark/pull/27758.patch,https://api.github.com/repos/apache/spark/issues/27758,27758,open,False,[SPARK-31007][ML][WIP] KMeans optimization based on triangle-inequality,"### What changes were proposed in this pull request?
apply Lemma 1 in [Using the Triangle Inequality to Accelerate K-Means](https://www.aaai.org/Papers/ICML/2003/ICML03-022.pdf):
 
> Let x be a point, and let b and c be centers. If d(b,c)>=2d(x,b) then d(x,c) >= d(x,b);

It can be directly applied in EuclideanDistance, but not in CosineDistance.
However,  for CosineDistance we can luckily get a variant in the space of radian/angle.


### Why are the changes needed?
It help improving the performance of prediction and training (mostly)


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
existing testsuites",2020-03-02T10:05:39Z,2020-03-22T15:35:43Z,,,0ca1e3182c5a0174d9cf73988fdcb276174b311f,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27758/commits,https://api.github.com/repos/apache/spark/pulls/27758/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27758/comments,https://api.github.com/repos/apache/spark/statuses/dd2aff729a8ff4ffea34691486337f0bc3b5f16b,CONTRIBUTOR,spark,apache,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,zhengruifeng:km_triangle,km_triangle,dd2aff729a8ff4ffea34691486337f0bc3b5f16b,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,51584791,MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==,spark,zhengruifeng/spark,False,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,https://github.com/zhengruifeng/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zhengruifeng/spark,https://api.github.com/repos/zhengruifeng/spark/forks,https://api.github.com/repos/zhengruifeng/spark/keys{/key_id},https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator},https://api.github.com/repos/zhengruifeng/spark/teams,https://api.github.com/repos/zhengruifeng/spark/hooks,https://api.github.com/repos/zhengruifeng/spark/issues/events{/number},https://api.github.com/repos/zhengruifeng/spark/events,https://api.github.com/repos/zhengruifeng/spark/assignees{/user},https://api.github.com/repos/zhengruifeng/spark/branches{/branch},https://api.github.com/repos/zhengruifeng/spark/tags,https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha},https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha},https://api.github.com/repos/zhengruifeng/spark/statuses/{sha},https://api.github.com/repos/zhengruifeng/spark/languages,https://api.github.com/repos/zhengruifeng/spark/stargazers,https://api.github.com/repos/zhengruifeng/spark/contributors,https://api.github.com/repos/zhengruifeng/spark/subscribers,https://api.github.com/repos/zhengruifeng/spark/subscription,https://api.github.com/repos/zhengruifeng/spark/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/comments{/number},https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number},https://api.github.com/repos/zhengruifeng/spark/contents/{+path},https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head},https://api.github.com/repos/zhengruifeng/spark/merges,https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref},https://api.github.com/repos/zhengruifeng/spark/downloads,https://api.github.com/repos/zhengruifeng/spark/issues{/number},https://api.github.com/repos/zhengruifeng/spark/pulls{/number},https://api.github.com/repos/zhengruifeng/spark/milestones{/number},"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}",https://api.github.com/repos/zhengruifeng/spark/labels{/name},https://api.github.com/repos/zhengruifeng/spark/releases{/id},https://api.github.com/repos/zhengruifeng/spark/deployments,2016-02-12T11:58:00Z,2020-02-07T03:38:20Z,2020-04-10T12:55:52Z,git://github.com/zhengruifeng/spark.git,git@github.com:zhengruifeng/spark.git,https://github.com/zhengruifeng/spark.git,https://github.com/zhengruifeng/spark,,305206,1,1,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,1fac06c4307c8c7a5a48a50952d48ee5b9ebccb2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27758,https://github.com/apache/spark/pull/27758,https://api.github.com/repos/apache/spark/issues/27758,https://api.github.com/repos/apache/spark/issues/27758/comments,https://api.github.com/repos/apache/spark/pulls/27758/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27758/commits,https://api.github.com/repos/apache/spark/statuses/dd2aff729a8ff4ffea34691486337f0bc3b5f16b
85,https://api.github.com/repos/apache/spark/pulls/27735,381337324,MDExOlB1bGxSZXF1ZXN0MzgxMzM3MzI0,https://github.com/apache/spark/pull/27735,https://github.com/apache/spark/pull/27735.diff,https://github.com/apache/spark/pull/27735.patch,https://api.github.com/repos/apache/spark/issues/27735,27735,open,False,[SPARK-30985][SPARK-25065][k8s] Support propagating SPARK_CONF_DIR files to driver and executor pods.,"### What changes were proposed in this pull request?
This is an improvement, we mount all the user specific configuration files(except the templates and spark properties files) from `SPARK_CONF_DIR` to executor and driver pods' `SPARK_CONF_DIR`. Also introducing a configuration property, `spark.kubernetes.propagateConf` to disable this behaviour. 

### Why are the changes needed?
[verbatim paste from the JIRA.]
`SPARK_CONF_DIR` hosts configuration files like, 
1) `spark-defaults.conf` - containing all the spark properties.
2) `log4j.properties` - Logger configuration.
3) `spark-env.sh` - Environment variables to be setup at driver and executor.
4) `core-site.xml` - Hadoop related configuration.
5) `fairscheduler.xml` - Spark's fair scheduling policy at the job level.
6) `metrics.properties` - Spark metrics.
7) Any user specific - library or framework specific configuration file.

Traditionally, `SPARK_CONF_DIR` has been the home to all user specific configuration files and the default behaviour in the Yarn or standalone mode is that these configuration files are copied to the worker nodes as required by the users themselves. In other words, they are not auto-copied.
But, in the case of spark on kubernetes, we use spark images and generally these images are approved or undergoe some kind of standardisation. These files cannot be simply copied to the SPARK_CONF_DIR of the running executor and driver pods by the user.

So, at the moment we have special casing for providing each configuration and for any other user specific configuration files, the process is more complex, i.e. - e.g. one can start with their own custom image of spark with configuration files pre installed etc..
Examples of special casing are:
1. Hadoop configuration in spark.kubernetes.hadoop.configMapName
2. Spark-env.sh as in spark.kubernetes.driverEnv.[EnvironmentVariableName]
3. Log4j.properties as in https://github.com/apache/spark/pull/26193
... And for those such special casing does not exist, they are simply out of luck.
---
So, this feature, will let the user specific configuration files, be mounted on a directory pointed by environment variable `SPARK_CONF_DIR`, on both the driver and executor pods. Kubernetes let's us mount a [config map as a volume on a pod](https://kubernetes.io/docs/concepts/storage/volumes/#configmap). So to achieve this, each configuration file is loaded in the configMap, with its key as the file name, and data as the value. When this configMap is mounted/referred to from within a container via a volume mount, spark can load these configuration files as pointed by the env variable `SPARK_CONF_DIR`.

### Further scope
At the moment it is not clear, if there is a need to, let user specify which config files to propagate - to driver and or executor. But, if there is a case that feature will be helpful, we can increase the scope of this work or create another JIRA issue to track that work.

### Does this PR introduce any user-facing change?
Yes, previously these configuration files were not propagated by default, now after this patch it is propagated. There is also a configuration `spark.kubernetes.propagateConf` to turn off this feature and return to default behaviour.

### How was this patch tested?
Added tests.

Also manually tested, by deploying it to a minikube cluster and observing the additional configs were mounted in the logs.

",2020-02-28T11:15:59Z,2020-03-04T10:58:07Z,,,3398e667a9843084ed49bdb5aee60fb59a04e489,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27735/commits,https://api.github.com/repos/apache/spark/pulls/27735/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27735/comments,https://api.github.com/repos/apache/spark/statuses/fe10c378df1ea38e8e2290dafb5886bce85b7ab1,MEMBER,spark,apache,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,ScrapCodes:SPARK-30985/spark-conf-k8s-propagate,SPARK-30985/spark-conf-k8s-propagate,fe10c378df1ea38e8e2290dafb5886bce85b7ab1,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,17210717,MDEwOlJlcG9zaXRvcnkxNzIxMDcxNw==,spark,ScrapCodes/spark,False,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,https://github.com/ScrapCodes/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ScrapCodes/spark,https://api.github.com/repos/ScrapCodes/spark/forks,https://api.github.com/repos/ScrapCodes/spark/keys{/key_id},https://api.github.com/repos/ScrapCodes/spark/collaborators{/collaborator},https://api.github.com/repos/ScrapCodes/spark/teams,https://api.github.com/repos/ScrapCodes/spark/hooks,https://api.github.com/repos/ScrapCodes/spark/issues/events{/number},https://api.github.com/repos/ScrapCodes/spark/events,https://api.github.com/repos/ScrapCodes/spark/assignees{/user},https://api.github.com/repos/ScrapCodes/spark/branches{/branch},https://api.github.com/repos/ScrapCodes/spark/tags,https://api.github.com/repos/ScrapCodes/spark/git/blobs{/sha},https://api.github.com/repos/ScrapCodes/spark/git/tags{/sha},https://api.github.com/repos/ScrapCodes/spark/git/refs{/sha},https://api.github.com/repos/ScrapCodes/spark/git/trees{/sha},https://api.github.com/repos/ScrapCodes/spark/statuses/{sha},https://api.github.com/repos/ScrapCodes/spark/languages,https://api.github.com/repos/ScrapCodes/spark/stargazers,https://api.github.com/repos/ScrapCodes/spark/contributors,https://api.github.com/repos/ScrapCodes/spark/subscribers,https://api.github.com/repos/ScrapCodes/spark/subscription,https://api.github.com/repos/ScrapCodes/spark/commits{/sha},https://api.github.com/repos/ScrapCodes/spark/git/commits{/sha},https://api.github.com/repos/ScrapCodes/spark/comments{/number},https://api.github.com/repos/ScrapCodes/spark/issues/comments{/number},https://api.github.com/repos/ScrapCodes/spark/contents/{+path},https://api.github.com/repos/ScrapCodes/spark/compare/{base}...{head},https://api.github.com/repos/ScrapCodes/spark/merges,https://api.github.com/repos/ScrapCodes/spark/{archive_format}{/ref},https://api.github.com/repos/ScrapCodes/spark/downloads,https://api.github.com/repos/ScrapCodes/spark/issues{/number},https://api.github.com/repos/ScrapCodes/spark/pulls{/number},https://api.github.com/repos/ScrapCodes/spark/milestones{/number},"https://api.github.com/repos/ScrapCodes/spark/notifications{?since,all,participating}",https://api.github.com/repos/ScrapCodes/spark/labels{/name},https://api.github.com/repos/ScrapCodes/spark/releases{/id},https://api.github.com/repos/ScrapCodes/spark/deployments,2014-02-26T13:00:32Z,2019-09-13T08:17:31Z,2020-03-31T07:45:48Z,git://github.com/ScrapCodes/spark.git,git@github.com:ScrapCodes/spark.git,https://github.com/ScrapCodes/spark.git,https://github.com/ScrapCodes/spark,,296150,0,0,Scala,False,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,0,master,apache:master,master,6b641430c37e0115bee781fed7360187b988313d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27735,https://github.com/apache/spark/pull/27735,https://api.github.com/repos/apache/spark/issues/27735,https://api.github.com/repos/apache/spark/issues/27735/comments,https://api.github.com/repos/apache/spark/pulls/27735/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27735/commits,https://api.github.com/repos/apache/spark/statuses/fe10c378df1ea38e8e2290dafb5886bce85b7ab1
86,https://api.github.com/repos/apache/spark/pulls/27724,380881112,MDExOlB1bGxSZXF1ZXN0MzgwODgxMTEy,https://github.com/apache/spark/pull/27724,https://github.com/apache/spark/pull/27724.diff,https://github.com/apache/spark/pull/27724.patch,https://api.github.com/repos/apache/spark/issues/27724,27724,open,False,[SPARK-30973][SQL] ScriptTransformationExec should wait for the termination …,"
<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR try to fix a bug in `org.apache.spark.sql.hive.execution.ScriptTransformationExec`. This bug appears in our online cluster.  `ScriptTransformationExec` should throw an exception, when user uses a python script which contains parse error.  But current implementation may miss this case of failure.




### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

When user uses a python script which contains a parse error, there will be no output. So  `scriptOutputReader.next(scriptOutputWritable) <= 0` matches, then we use `checkFailureAndPropagate()` to check the `proc`.  But the `proc` may still be alive and `writerThread.exception` is not defined,  `checkFailureAndPropagate` cannot check this case of failure.  In the end, the Spark SQL job runs successfully and returns no result. In fact, the SparK SQL job should fails and shows the exception properly.

For example, the error python script is blow.
``` python
# encoding: utf8
import unknow_module
import sys

for line in sys.stdin:
    print line
``` 
The bug can be reproduced by running the following code in our cluter.
```
spark.range(100*100).toDF(""index"").createOrReplaceTempView(""test"")
spark.sql(""select TRANSFORM(index) USING 'python error_python.py' as new_index from test"").collect.foreach(println)
```


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Existing UT",2020-02-27T14:22:54Z,2020-04-10T16:53:56Z,,,de70033145e64f8eef708edb531df1d4b41e662a,,[],"[{'login': 'cloud-fan', 'id': 3182036, 'node_id': 'MDQ6VXNlcjMxODIwMzY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/3182036?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/cloud-fan', 'html_url': 'https://github.com/cloud-fan', 'followers_url': 'https://api.github.com/users/cloud-fan/followers', 'following_url': 'https://api.github.com/users/cloud-fan/following{/other_user}', 'gists_url': 'https://api.github.com/users/cloud-fan/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/cloud-fan/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/cloud-fan/subscriptions', 'organizations_url': 'https://api.github.com/users/cloud-fan/orgs', 'repos_url': 'https://api.github.com/users/cloud-fan/repos', 'events_url': 'https://api.github.com/users/cloud-fan/events{/privacy}', 'received_events_url': 'https://api.github.com/users/cloud-fan/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27724/commits,https://api.github.com/repos/apache/spark/pulls/27724/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27724/comments,https://api.github.com/repos/apache/spark/statuses/10e7de8f491dbc637108853e34a2e2cc39200954,NONE,spark,apache,slamke,3784957,MDQ6VXNlcjM3ODQ5NTc=,https://avatars1.githubusercontent.com/u/3784957?v=4,,https://api.github.com/users/slamke,https://github.com/slamke,https://api.github.com/users/slamke/followers,https://api.github.com/users/slamke/following{/other_user},https://api.github.com/users/slamke/gists{/gist_id},https://api.github.com/users/slamke/starred{/owner}{/repo},https://api.github.com/users/slamke/subscriptions,https://api.github.com/users/slamke/orgs,https://api.github.com/users/slamke/repos,https://api.github.com/users/slamke/events{/privacy},https://api.github.com/users/slamke/received_events,User,False,slamke:transformation,transformation,10e7de8f491dbc637108853e34a2e2cc39200954,slamke,3784957,MDQ6VXNlcjM3ODQ5NTc=,https://avatars1.githubusercontent.com/u/3784957?v=4,,https://api.github.com/users/slamke,https://github.com/slamke,https://api.github.com/users/slamke/followers,https://api.github.com/users/slamke/following{/other_user},https://api.github.com/users/slamke/gists{/gist_id},https://api.github.com/users/slamke/starred{/owner}{/repo},https://api.github.com/users/slamke/subscriptions,https://api.github.com/users/slamke/orgs,https://api.github.com/users/slamke/repos,https://api.github.com/users/slamke/events{/privacy},https://api.github.com/users/slamke/received_events,User,False,243522927,MDEwOlJlcG9zaXRvcnkyNDM1MjI5Mjc=,spark,slamke/spark,False,slamke,3784957,MDQ6VXNlcjM3ODQ5NTc=,https://avatars1.githubusercontent.com/u/3784957?v=4,,https://api.github.com/users/slamke,https://github.com/slamke,https://api.github.com/users/slamke/followers,https://api.github.com/users/slamke/following{/other_user},https://api.github.com/users/slamke/gists{/gist_id},https://api.github.com/users/slamke/starred{/owner}{/repo},https://api.github.com/users/slamke/subscriptions,https://api.github.com/users/slamke/orgs,https://api.github.com/users/slamke/repos,https://api.github.com/users/slamke/events{/privacy},https://api.github.com/users/slamke/received_events,User,False,https://github.com/slamke/spark,Apache Spark,True,https://api.github.com/repos/slamke/spark,https://api.github.com/repos/slamke/spark/forks,https://api.github.com/repos/slamke/spark/keys{/key_id},https://api.github.com/repos/slamke/spark/collaborators{/collaborator},https://api.github.com/repos/slamke/spark/teams,https://api.github.com/repos/slamke/spark/hooks,https://api.github.com/repos/slamke/spark/issues/events{/number},https://api.github.com/repos/slamke/spark/events,https://api.github.com/repos/slamke/spark/assignees{/user},https://api.github.com/repos/slamke/spark/branches{/branch},https://api.github.com/repos/slamke/spark/tags,https://api.github.com/repos/slamke/spark/git/blobs{/sha},https://api.github.com/repos/slamke/spark/git/tags{/sha},https://api.github.com/repos/slamke/spark/git/refs{/sha},https://api.github.com/repos/slamke/spark/git/trees{/sha},https://api.github.com/repos/slamke/spark/statuses/{sha},https://api.github.com/repos/slamke/spark/languages,https://api.github.com/repos/slamke/spark/stargazers,https://api.github.com/repos/slamke/spark/contributors,https://api.github.com/repos/slamke/spark/subscribers,https://api.github.com/repos/slamke/spark/subscription,https://api.github.com/repos/slamke/spark/commits{/sha},https://api.github.com/repos/slamke/spark/git/commits{/sha},https://api.github.com/repos/slamke/spark/comments{/number},https://api.github.com/repos/slamke/spark/issues/comments{/number},https://api.github.com/repos/slamke/spark/contents/{+path},https://api.github.com/repos/slamke/spark/compare/{base}...{head},https://api.github.com/repos/slamke/spark/merges,https://api.github.com/repos/slamke/spark/{archive_format}{/ref},https://api.github.com/repos/slamke/spark/downloads,https://api.github.com/repos/slamke/spark/issues{/number},https://api.github.com/repos/slamke/spark/pulls{/number},https://api.github.com/repos/slamke/spark/milestones{/number},"https://api.github.com/repos/slamke/spark/notifications{?since,all,participating}",https://api.github.com/repos/slamke/spark/labels{/name},https://api.github.com/repos/slamke/spark/releases{/id},https://api.github.com/repos/slamke/spark/deployments,2020-02-27T13:13:47Z,2020-02-27T13:13:50Z,2020-04-10T12:00:44Z,git://github.com/slamke/spark.git,git@github.com:slamke/spark.git,https://github.com/slamke/spark.git,https://github.com/slamke/spark,,322438,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,6cddda7847ceabd257008986ede7ec844f1f3607,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27724,https://github.com/apache/spark/pull/27724,https://api.github.com/repos/apache/spark/issues/27724,https://api.github.com/repos/apache/spark/issues/27724/comments,https://api.github.com/repos/apache/spark/pulls/27724/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27724/commits,https://api.github.com/repos/apache/spark/statuses/10e7de8f491dbc637108853e34a2e2cc39200954
87,https://api.github.com/repos/apache/spark/pulls/27711,380343414,MDExOlB1bGxSZXF1ZXN0MzgwMzQzNDE0,https://github.com/apache/spark/pull/27711,https://github.com/apache/spark/pull/27711.diff,https://github.com/apache/spark/pull/27711.patch,https://api.github.com/repos/apache/spark/issues/27711,27711,open,False,[SPARK-30815][SQL] Add function to format timestamp with time zone,"### What changes were proposed in this pull request?
Whenever timestamps are turned into strings (`Column.cast(StringType)`, `date_format(timestamp, format)`, `Dataset.show()`) the default time zone is used to format the string. This default time zone is either the java default zone `user.timezone`, the Spark default zone `spark.sql.session.timeZone` or the default DataFrameWriter zone `timeZone`. Currently there is no way to format a single column in a different timezone.

```
scala> spark.conf.set(""spark.sql.session.timeZone"", ""Europe/London"")
scala> spark.range(10). \
         select(concat(lit(""2020-02-01 0""), $""id"", lit("":00:00"")).cast(TimestampType).as(""time"")). \
         select(
           $""time"",
           date_format($""time"", ""uuuu-MM-dd HH:mm:ss ZZZZZ"").as(""local""),
           date_format_tz($""time"", ""uuuu-MM-dd HH:mm:ss ZZZZZ"", ""Europe/Berlin"").as(""Berlin"")
         ). \
         show(false)
+-------------------+---------------------+--------------------------+
|time               |local                |Berlin                    |
+-------------------+---------------------+--------------------------+
|2020-02-01 00:00:00|2020-02-01 00:00:00 Z|2020-02-01 01:00:00 +01:00|
|2020-02-01 01:00:00|2020-02-01 01:00:00 Z|2020-02-01 02:00:00 +01:00|
|2020-02-01 02:00:00|2020-02-01 02:00:00 Z|2020-02-01 03:00:00 +01:00|
|2020-02-01 03:00:00|2020-02-01 03:00:00 Z|2020-02-01 04:00:00 +01:00|
|2020-02-01 04:00:00|2020-02-01 04:00:00 Z|2020-02-01 05:00:00 +01:00|
|2020-02-01 05:00:00|2020-02-01 05:00:00 Z|2020-02-01 06:00:00 +01:00|
|2020-02-01 06:00:00|2020-02-01 06:00:00 Z|2020-02-01 07:00:00 +01:00|
|2020-02-01 07:00:00|2020-02-01 07:00:00 Z|2020-02-01 08:00:00 +01:00|
|2020-02-01 08:00:00|2020-02-01 08:00:00 Z|2020-02-01 09:00:00 +01:00|
|2020-02-01 09:00:00|2020-02-01 09:00:00 Z|2020-02-01 10:00:00 +01:00|
+-------------------+---------------------+--------------------------+
```

### Why are the changes needed?
Formatting timestamps in timezones other than the default one requires a laborious UDF while a very similar operation `date_format` with all the code exists already.

### Does this PR introduce any user-facing change?
Yes, it introduces a new SQL operation `date_format_tz`. I could not get the existing `date_format` take an optional third `tz` argument.

### How was this patch tested?
Unit tests.",2020-02-26T15:19:52Z,2020-02-28T07:18:44Z,,,6834d87e1a40176de70f9adbb4a68c9061a36c9c,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27711/commits,https://api.github.com/repos/apache/spark/pulls/27711/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27711/comments,https://api.github.com/repos/apache/spark/statuses/c290082c37e9cd18c28074c551ec703899806762,CONTRIBUTOR,spark,apache,EnricoMi,44700269,MDQ6VXNlcjQ0NzAwMjY5,https://avatars1.githubusercontent.com/u/44700269?v=4,,https://api.github.com/users/EnricoMi,https://github.com/EnricoMi,https://api.github.com/users/EnricoMi/followers,https://api.github.com/users/EnricoMi/following{/other_user},https://api.github.com/users/EnricoMi/gists{/gist_id},https://api.github.com/users/EnricoMi/starred{/owner}{/repo},https://api.github.com/users/EnricoMi/subscriptions,https://api.github.com/users/EnricoMi/orgs,https://api.github.com/users/EnricoMi/repos,https://api.github.com/users/EnricoMi/events{/privacy},https://api.github.com/users/EnricoMi/received_events,User,False,G-Research:branch-date-format-with-tz,branch-date-format-with-tz,c290082c37e9cd18c28074c551ec703899806762,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,214350064,MDEwOlJlcG9zaXRvcnkyMTQzNTAwNjQ=,spark,G-Research/spark,False,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,https://github.com/G-Research/spark,Apache Spark,True,https://api.github.com/repos/G-Research/spark,https://api.github.com/repos/G-Research/spark/forks,https://api.github.com/repos/G-Research/spark/keys{/key_id},https://api.github.com/repos/G-Research/spark/collaborators{/collaborator},https://api.github.com/repos/G-Research/spark/teams,https://api.github.com/repos/G-Research/spark/hooks,https://api.github.com/repos/G-Research/spark/issues/events{/number},https://api.github.com/repos/G-Research/spark/events,https://api.github.com/repos/G-Research/spark/assignees{/user},https://api.github.com/repos/G-Research/spark/branches{/branch},https://api.github.com/repos/G-Research/spark/tags,https://api.github.com/repos/G-Research/spark/git/blobs{/sha},https://api.github.com/repos/G-Research/spark/git/tags{/sha},https://api.github.com/repos/G-Research/spark/git/refs{/sha},https://api.github.com/repos/G-Research/spark/git/trees{/sha},https://api.github.com/repos/G-Research/spark/statuses/{sha},https://api.github.com/repos/G-Research/spark/languages,https://api.github.com/repos/G-Research/spark/stargazers,https://api.github.com/repos/G-Research/spark/contributors,https://api.github.com/repos/G-Research/spark/subscribers,https://api.github.com/repos/G-Research/spark/subscription,https://api.github.com/repos/G-Research/spark/commits{/sha},https://api.github.com/repos/G-Research/spark/git/commits{/sha},https://api.github.com/repos/G-Research/spark/comments{/number},https://api.github.com/repos/G-Research/spark/issues/comments{/number},https://api.github.com/repos/G-Research/spark/contents/{+path},https://api.github.com/repos/G-Research/spark/compare/{base}...{head},https://api.github.com/repos/G-Research/spark/merges,https://api.github.com/repos/G-Research/spark/{archive_format}{/ref},https://api.github.com/repos/G-Research/spark/downloads,https://api.github.com/repos/G-Research/spark/issues{/number},https://api.github.com/repos/G-Research/spark/pulls{/number},https://api.github.com/repos/G-Research/spark/milestones{/number},"https://api.github.com/repos/G-Research/spark/notifications{?since,all,participating}",https://api.github.com/repos/G-Research/spark/labels{/name},https://api.github.com/repos/G-Research/spark/releases{/id},https://api.github.com/repos/G-Research/spark/deployments,2019-10-11T05:23:46Z,2020-02-11T16:12:31Z,2020-03-05T09:46:15Z,git://github.com/G-Research/spark.git,git@github.com:G-Research/spark.git,https://github.com/G-Research/spark.git,https://github.com/G-Research/spark,,322153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,020b2622e597458b925d7227ed5f9fa269f2d391,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27711,https://github.com/apache/spark/pull/27711,https://api.github.com/repos/apache/spark/issues/27711,https://api.github.com/repos/apache/spark/issues/27711/comments,https://api.github.com/repos/apache/spark/pulls/27711/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27711/commits,https://api.github.com/repos/apache/spark/statuses/c290082c37e9cd18c28074c551ec703899806762
88,https://api.github.com/repos/apache/spark/pulls/27701,380003135,MDExOlB1bGxSZXF1ZXN0MzgwMDAzMTM1,https://github.com/apache/spark/pull/27701,https://github.com/apache/spark/pull/27701.diff,https://github.com/apache/spark/pull/27701.patch,https://api.github.com/repos/apache/spark/issues/27701,27701,open,False,[SPARK-30953][SQL] InsertAdaptiveSparkPlan should apply AQE on child plan of write commands,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This PR changes `InsertAdaptiveSparkPlan` to apply AQE on the child plan of V1/V2 write commands rather than the command itself.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Apply AQE on write commands with child plan will expose `LogicalQueryStage` to `Analyzer` while it should hider under `AdaptiveSparkPlanExec` only to avoid unexpected broken. 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Pass Jenkins.",2020-02-26T04:37:03Z,2020-04-10T18:18:06Z,,,ad306b0706b8507d020e7cbad422e84fc18b8e86,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27701/commits,https://api.github.com/repos/apache/spark/pulls/27701/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27701/comments,https://api.github.com/repos/apache/spark/statuses/8745c37863a2d5f4b3c45e2562e78e63674a8036,CONTRIBUTOR,spark,apache,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,Ngone51:skip_v2_commands,skip_v2_commands,8745c37863a2d5f4b3c45e2562e78e63674a8036,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,114185286,MDEwOlJlcG9zaXRvcnkxMTQxODUyODY=,spark,Ngone51/spark,False,Ngone51,16397174,MDQ6VXNlcjE2Mzk3MTc0,https://avatars1.githubusercontent.com/u/16397174?v=4,,https://api.github.com/users/Ngone51,https://github.com/Ngone51,https://api.github.com/users/Ngone51/followers,https://api.github.com/users/Ngone51/following{/other_user},https://api.github.com/users/Ngone51/gists{/gist_id},https://api.github.com/users/Ngone51/starred{/owner}{/repo},https://api.github.com/users/Ngone51/subscriptions,https://api.github.com/users/Ngone51/orgs,https://api.github.com/users/Ngone51/repos,https://api.github.com/users/Ngone51/events{/privacy},https://api.github.com/users/Ngone51/received_events,User,False,https://github.com/Ngone51/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Ngone51/spark,https://api.github.com/repos/Ngone51/spark/forks,https://api.github.com/repos/Ngone51/spark/keys{/key_id},https://api.github.com/repos/Ngone51/spark/collaborators{/collaborator},https://api.github.com/repos/Ngone51/spark/teams,https://api.github.com/repos/Ngone51/spark/hooks,https://api.github.com/repos/Ngone51/spark/issues/events{/number},https://api.github.com/repos/Ngone51/spark/events,https://api.github.com/repos/Ngone51/spark/assignees{/user},https://api.github.com/repos/Ngone51/spark/branches{/branch},https://api.github.com/repos/Ngone51/spark/tags,https://api.github.com/repos/Ngone51/spark/git/blobs{/sha},https://api.github.com/repos/Ngone51/spark/git/tags{/sha},https://api.github.com/repos/Ngone51/spark/git/refs{/sha},https://api.github.com/repos/Ngone51/spark/git/trees{/sha},https://api.github.com/repos/Ngone51/spark/statuses/{sha},https://api.github.com/repos/Ngone51/spark/languages,https://api.github.com/repos/Ngone51/spark/stargazers,https://api.github.com/repos/Ngone51/spark/contributors,https://api.github.com/repos/Ngone51/spark/subscribers,https://api.github.com/repos/Ngone51/spark/subscription,https://api.github.com/repos/Ngone51/spark/commits{/sha},https://api.github.com/repos/Ngone51/spark/git/commits{/sha},https://api.github.com/repos/Ngone51/spark/comments{/number},https://api.github.com/repos/Ngone51/spark/issues/comments{/number},https://api.github.com/repos/Ngone51/spark/contents/{+path},https://api.github.com/repos/Ngone51/spark/compare/{base}...{head},https://api.github.com/repos/Ngone51/spark/merges,https://api.github.com/repos/Ngone51/spark/{archive_format}{/ref},https://api.github.com/repos/Ngone51/spark/downloads,https://api.github.com/repos/Ngone51/spark/issues{/number},https://api.github.com/repos/Ngone51/spark/pulls{/number},https://api.github.com/repos/Ngone51/spark/milestones{/number},"https://api.github.com/repos/Ngone51/spark/notifications{?since,all,participating}",https://api.github.com/repos/Ngone51/spark/labels{/name},https://api.github.com/repos/Ngone51/spark/releases{/id},https://api.github.com/repos/Ngone51/spark/deployments,2017-12-14T01:05:22Z,2020-02-14T14:29:53Z,2020-04-10T13:58:11Z,git://github.com/Ngone51/spark.git,git@github.com:Ngone51/spark.git,https://github.com/Ngone51/spark.git,https://github.com/Ngone51/spark,,323742,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27701,https://github.com/apache/spark/pull/27701,https://api.github.com/repos/apache/spark/issues/27701,https://api.github.com/repos/apache/spark/issues/27701/comments,https://api.github.com/repos/apache/spark/pulls/27701/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27701/commits,https://api.github.com/repos/apache/spark/statuses/8745c37863a2d5f4b3c45e2562e78e63674a8036
89,https://api.github.com/repos/apache/spark/pulls/27695,379691927,MDExOlB1bGxSZXF1ZXN0Mzc5NjkxOTI3,https://github.com/apache/spark/pull/27695,https://github.com/apache/spark/pull/27695.diff,https://github.com/apache/spark/pull/27695.patch,https://api.github.com/repos/apache/spark/issues/27695,27695,open,False,[SPARK-30949][K8S][CORE] decouple requests and parallelism on kubernetes drivers,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
`spark.driver.cores` configuration is used to set the amount of parallelism in kubernetes cluster mode drivers. Previously the amount of parallelism in the drivers were the number of cores in the host when running on JDK 8u120 or older, or the maximum of driver containers resource requests and limits when running on [JDK 8u121 or newer](https://bugs.openjdk.java.net/browse/JDK-8173345). This will enable users to specify `spark.driver.cores` to set parallelism, and specify `spark.kubernetes.driver.requests.cores` to limit the resource requests of the driver container, effectively decoupling the two


### Why are the changes needed?
Drivers submitted in kubernetes cluster mode set the parallelism of various components like `RpcEnv`, `MemoryManager`, `BlockManager` from inferring the number of available cores by calling `Runtime.getRuntime().availableProcessors()`. By using this, spark applications running on JDK 8u120 or older incorrectly get the total number of cores in the host, [ignoring the cgroup limits set by kubernetes](https://bugs.openjdk.java.net/browse/JDK-6515172). JDK 8u121 and newer runtimes do not have this problem.

Orthogonal to this, it is currently not possible to decouple resource limits on the driver container with the amount of parallelism of the various network and memory components listed above.


### Does this PR introduce any user-facing change?
Yes. Previously the amount of parallelism in kubernetes cluster mode submitted drivers were the number of cores in the host when running on JDK 8u120 or older, or the maximum of driver containers resource requests and limits when running on JDK 8u121 or newer. Now the value of `spark.driver.cores` is used.


### How was this patch tested?
happy to add tests if my proposal looks reasonable
",2020-02-25T16:51:24Z,2020-03-26T20:25:07Z,,,71525d2d1b7e9121f2811eb83932d98a442768ac,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27695/commits,https://api.github.com/repos/apache/spark/pulls/27695/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27695/comments,https://api.github.com/repos/apache/spark/statuses/2b3ad5bff2db4aa1f0c49503c3bffb1111b230cb,CONTRIBUTOR,spark,apache,onursatici,5051569,MDQ6VXNlcjUwNTE1Njk=,https://avatars3.githubusercontent.com/u/5051569?v=4,,https://api.github.com/users/onursatici,https://github.com/onursatici,https://api.github.com/users/onursatici/followers,https://api.github.com/users/onursatici/following{/other_user},https://api.github.com/users/onursatici/gists{/gist_id},https://api.github.com/users/onursatici/starred{/owner}{/repo},https://api.github.com/users/onursatici/subscriptions,https://api.github.com/users/onursatici/orgs,https://api.github.com/users/onursatici/repos,https://api.github.com/users/onursatici/events{/privacy},https://api.github.com/users/onursatici/received_events,User,False,onursatici:os/decouple-requests-and-parallelism,os/decouple-requests-and-parallelism,2b3ad5bff2db4aa1f0c49503c3bffb1111b230cb,onursatici,5051569,MDQ6VXNlcjUwNTE1Njk=,https://avatars3.githubusercontent.com/u/5051569?v=4,,https://api.github.com/users/onursatici,https://github.com/onursatici,https://api.github.com/users/onursatici/followers,https://api.github.com/users/onursatici/following{/other_user},https://api.github.com/users/onursatici/gists{/gist_id},https://api.github.com/users/onursatici/starred{/owner}{/repo},https://api.github.com/users/onursatici/subscriptions,https://api.github.com/users/onursatici/orgs,https://api.github.com/users/onursatici/repos,https://api.github.com/users/onursatici/events{/privacy},https://api.github.com/users/onursatici/received_events,User,False,110121704,MDEwOlJlcG9zaXRvcnkxMTAxMjE3MDQ=,spark,onursatici/spark,False,onursatici,5051569,MDQ6VXNlcjUwNTE1Njk=,https://avatars3.githubusercontent.com/u/5051569?v=4,,https://api.github.com/users/onursatici,https://github.com/onursatici,https://api.github.com/users/onursatici/followers,https://api.github.com/users/onursatici/following{/other_user},https://api.github.com/users/onursatici/gists{/gist_id},https://api.github.com/users/onursatici/starred{/owner}{/repo},https://api.github.com/users/onursatici/subscriptions,https://api.github.com/users/onursatici/orgs,https://api.github.com/users/onursatici/repos,https://api.github.com/users/onursatici/events{/privacy},https://api.github.com/users/onursatici/received_events,User,False,https://github.com/onursatici/spark,Mirror of Apache Spark,True,https://api.github.com/repos/onursatici/spark,https://api.github.com/repos/onursatici/spark/forks,https://api.github.com/repos/onursatici/spark/keys{/key_id},https://api.github.com/repos/onursatici/spark/collaborators{/collaborator},https://api.github.com/repos/onursatici/spark/teams,https://api.github.com/repos/onursatici/spark/hooks,https://api.github.com/repos/onursatici/spark/issues/events{/number},https://api.github.com/repos/onursatici/spark/events,https://api.github.com/repos/onursatici/spark/assignees{/user},https://api.github.com/repos/onursatici/spark/branches{/branch},https://api.github.com/repos/onursatici/spark/tags,https://api.github.com/repos/onursatici/spark/git/blobs{/sha},https://api.github.com/repos/onursatici/spark/git/tags{/sha},https://api.github.com/repos/onursatici/spark/git/refs{/sha},https://api.github.com/repos/onursatici/spark/git/trees{/sha},https://api.github.com/repos/onursatici/spark/statuses/{sha},https://api.github.com/repos/onursatici/spark/languages,https://api.github.com/repos/onursatici/spark/stargazers,https://api.github.com/repos/onursatici/spark/contributors,https://api.github.com/repos/onursatici/spark/subscribers,https://api.github.com/repos/onursatici/spark/subscription,https://api.github.com/repos/onursatici/spark/commits{/sha},https://api.github.com/repos/onursatici/spark/git/commits{/sha},https://api.github.com/repos/onursatici/spark/comments{/number},https://api.github.com/repos/onursatici/spark/issues/comments{/number},https://api.github.com/repos/onursatici/spark/contents/{+path},https://api.github.com/repos/onursatici/spark/compare/{base}...{head},https://api.github.com/repos/onursatici/spark/merges,https://api.github.com/repos/onursatici/spark/{archive_format}{/ref},https://api.github.com/repos/onursatici/spark/downloads,https://api.github.com/repos/onursatici/spark/issues{/number},https://api.github.com/repos/onursatici/spark/pulls{/number},https://api.github.com/repos/onursatici/spark/milestones{/number},"https://api.github.com/repos/onursatici/spark/notifications{?since,all,participating}",https://api.github.com/repos/onursatici/spark/labels{/name},https://api.github.com/repos/onursatici/spark/releases{/id},https://api.github.com/repos/onursatici/spark/deployments,2017-11-09T13:54:45Z,2017-11-09T13:55:15Z,2020-02-25T16:41:59Z,git://github.com/onursatici/spark.git,git@github.com:onursatici/spark.git,https://github.com/onursatici/spark.git,https://github.com/onursatici/spark,,313722,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ffc0935e64ddd56c40db1c1c7f3afb7e5e306861,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27695,https://github.com/apache/spark/pull/27695,https://api.github.com/repos/apache/spark/issues/27695,https://api.github.com/repos/apache/spark/issues/27695/comments,https://api.github.com/repos/apache/spark/pulls/27695/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27695/commits,https://api.github.com/repos/apache/spark/statuses/2b3ad5bff2db4aa1f0c49503c3bffb1111b230cb
90,https://api.github.com/repos/apache/spark/pulls/27694,379617543,MDExOlB1bGxSZXF1ZXN0Mzc5NjE3NTQz,https://github.com/apache/spark/pull/27694,https://github.com/apache/spark/pull/27694.diff,https://github.com/apache/spark/pull/27694.patch,https://api.github.com/repos/apache/spark/issues/27694,27694,open,False,[SPARK-30946][SS] Serde entry with UnsafeRow on FileStream(Source/Sink)Log with LZ4 compression,"### What changes were proposed in this pull request?

This patch uses UnsafeRow to serialize/deserialize entry on FileStream(Source/Sink)Log, as well as applying LZ4 compression on serde.

The ground idea is that both FileEntry and SinkFileStatus haven't been changed for 3 years but we have been simply taking JSON serde to prepare with possible change and spending bunch of overhead on JSON format. CompactibleFileStreamLog has the metadata version information but it has been just version 1.

This patch introduces metadata version 2 of CompactibleFileStreamLog as leveraging UnsafeRow & LZ4 compression. While we introduce version 2 for CompactibleFileStreamLog, CompactibleFileStreamLog is still compatible with version 1 for both serialization and deserialization, so we can read from version 2 and write to version 2 in normal, and also we can read from version 1 and write to version 2 for smooth migration.
(Even we can stay with version 1 - read from version 1 and write to version 1 - whereas we won't do it actually.)

The approach how to load and store UnsafeRow with file is borrowed from HDFSBackedStateStoreProvider, as it has been running for 2.x version lines and no critical issue has been reported so far.

### Why are the changes needed?

Multiple JIRA issues have been filed to report that huge metadata logs make their queries very slow. While this patch won't make their metadata log stop growing, this patch may heavily reduce down their metadata log and time to process compaction.

* [SPARK-24295](https://issues.apache.org/jira/browse/SPARK-24295)
* [SPARK-29995](https://issues.apache.org/jira/browse/SPARK-29995)

Please find the numbers in the section ""How was this patch tested?"".

As this also reduces the latency to read all files from file stream sink metadata, it also helps to speed up the query for both batch and streaming if the input path is pointing to the output of file stream sink.

### Does this PR introduce any user-facing change?

No. It will read both v1 and v2 metadata log files, and writes v2 metadata log files. So once end users run their query long enough, cleanup would remove old metadata log files and eventually only v2 metadata log files will be left. (Say, smooth migration)

### How was this patch tested?

* Existing UTs (UTs for checking with 2.1.0 compatibility is basically the checking with V1 compatibility, as I don't find any change)
* Manually done simple perf. test

> Test environment

* target metadata: FileStreamSinkLog
* compact interval = 10
* prepared 1 compact file and 8 normal files, try to write the next batch which is compact batch
* the number of total entries (in compact batch): 1,707,950
* memory usage of total entries (in compact batch): 606,97 MB

> V1

* total size of metadata log file (compact): 391.12 MB (410,116,683 bytes)
* total elapsed time to compact (avg. of 10 times, excluding min and max): 26,199 ms
* total elapsed time to load all entities to compact (avg. of 10 times, excluding min and max): 13,558 ms
* total elapsed time to write all entities to compact batch file (avg. of 10 times, excluding min and max): 12,666 ms

> V2

To run the test in same environment, I converted input metadata files to V2 before running tests. (1 compact file, 8 normal files)

* total size of metadata log file (compact): 76.36 MB (80,073,732 bytes) (19.52%)
* total elapsed time to compact(avg. of 10 times, excluding min and max): 2,948 ms (11.25%)
* total elapsed time to load all entities to compact (avg. of 10 times, excluding min and max): 1,023 ms (7.54%)
* total elapsed time to write all entities to compact batch file (avg. of 10 times, excluding min and max): 1,956 ms (15.44%)",2020-02-25T14:33:28Z,2020-03-03T17:24:08Z,,,1c0d46d35634082e18efb4e1b00252548e9f3c97,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27694/commits,https://api.github.com/repos/apache/spark/pulls/27694/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27694/comments,https://api.github.com/repos/apache/spark/statuses/55d238feb599287c8f45480991d777b28f3d0144,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30946,SPARK-30946,55d238feb599287c8f45480991d777b28f3d0144,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,761209c1f2af513a9db2e08c5937531cff7aeeed,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27694,https://github.com/apache/spark/pull/27694,https://api.github.com/repos/apache/spark/issues/27694,https://api.github.com/repos/apache/spark/issues/27694/comments,https://api.github.com/repos/apache/spark/pulls/27694/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27694/commits,https://api.github.com/repos/apache/spark/statuses/55d238feb599287c8f45480991d777b28f3d0144
91,https://api.github.com/repos/apache/spark/pulls/27690,379338560,MDExOlB1bGxSZXF1ZXN0Mzc5MzM4NTYw,https://github.com/apache/spark/pull/27690,https://github.com/apache/spark/pull/27690.diff,https://github.com/apache/spark/pull/27690.patch,https://api.github.com/repos/apache/spark/issues/27690,27690,open,False,[SPARK-21514][SQL] Added a new option to use non-blobstore storage when writing into blobstore storage,"### What changes were proposed in this pull request?

I added config parameters; (the same parameter names used in Hive)

    spark.hadoop.hive.blobstore.supported.schemes (= s3a, s3, s3n)
    spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir (= true)

If the target table's scheme is included in hive.blobstore.supported.schemes AND hive.blobstore.use.blobstore.as.scratchdir = false, then HDFS (MRTempDir) is used.

Major benefits of this patch are;

- Increase performance to write data to blob storage
- Reduce costs for blob storage I/O
- Reduce the effect of eventual consistency

### Why are the changes needed?

Currently Spark writes temporary data into blob storage such as S3, and it affects performance and costs for customers. This pull request is raised to enhance a feature to change temporary data location from blob storage to HDFS.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes

- When `spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir=true`, there is no change.
- When `spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir=false`, HDFS is used for temporal storage instead of blob storage.

### How was this patch tested?

#### Unit test
I added two new unit tests; 
- SaveAsHiveFileSuite: Test the temp path for both blob storage and non-blob storage
```
$ build/sbt
> project hive
> testOnly *SaveAsHiveFileSuite
...
[info] ScalaTest
[info] Run completed in 14 seconds, 779 milliseconds.
[info] Total number of tests run: 2
[info] Suites: completed 1, aborted 0
[info] Tests: succeeded 2, failed 0, canceled 0, ignored 0, pending 0
[info] All tests passed.
[info] Passed: Total 2, Failed 0, Errors 0, Passed 2
[success] Total time: 310 s, completed Feb 19, 2020 2:09:58 AM
```

- BlobStorageUtilsSuite: Test utility functions for managing configurations

```
> testOnly *BlobStorageUtilsSuite
[info] ScalaTest
[info] Run completed in 12 seconds, 922 milliseconds.
[info] Total number of tests run: 6
[info] Suites: completed 1, aborted 0
[info] Tests: succeeded 6, failed 0, canceled 0, ignored 0, pending 0
[info] All tests passed.
[info] Passed: Total 6, Failed 0, Errors 0, Passed 6
[success] Total time: 18 s, completed Feb 19, 2020 2:11:46 AM
```

#### Integration test
In this integration test, I used the same data, the same EMR cluster with different configurations in `spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir`.

##### Data Tables
```
CREATE EXTERNAL TABLE plain_cf (
  Date DATE,
  Time STRING,
  Location STRING,
  Bytes INT,
  RequestIP STRING,
  Method STRING,
  Host STRING,
  Uri STRING,
  Status INT,
  Referrer STRING,
  os STRING,
  Browser STRING,
  BrowserVersion STRING
      ) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
      WITH SERDEPROPERTIES (
      ""input.regex"" = ""^(?!#)([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+([^ ]+)\\s+[^\(]+[\(]([^\;]+).*\%20([^\/]+)[\/](.*)$""
      ) LOCATION 's3a://athena-examples/cloudfront/plaintext/';

CREATE TABLE spark_cf_txt1 (
  Date DATE,
  Time STRING,
  Location STRING)
STORED AS TEXTFILE
LOCATION
  's3a://sekiyama-bucket/spark/dev/SPARK21514/spark_cf_txt1';

CREATE TABLE spark_cf_txt2 (
  Date DATE,
  Time STRING,
  Location STRING)
STORED AS TEXTFILE
LOCATION
  's3a://sekiyama-bucket/spark/dev/SPARK21514/spark_cf_txt2';
```

##### Scenario 1 (spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir=true)

```
spark-sql> INSERT OVERWRITE TABLE spark_cf_txt1 SELECT Date,Time,Location FROM plain_cf;
```

Here's the duration per trial (10 trials in total)
- Time taken: 21.197 seconds
- Time taken: 27.524 seconds
- Time taken: 21.385 seconds
- Time taken: 19.313 seconds
- Time taken: 20.545 seconds
- Time taken: 22.509 seconds
- Time taken: 21.377 seconds
- Time taken: 20.134 seconds
- Time taken: 20.632 seconds
- Time taken: 20.242 seconds

**Average duration: 21.4858 seconds**

##### Scenario 2 (spark.hadoop.hive.blobstore.use.blobstore.as.scratchdir=false)

```
spark-sql> INSERT OVERWRITE TABLE spark_cf_txt2 SELECT Date,Time,Location FROM plain_cf;
```

Here's the duration per trial (10 trials in total)

- Time taken: 19.624 seconds
- Time taken: 15.178 seconds
- Time taken: 15.645 seconds
- Time taken: 20.185 seconds
- Time taken: 15.821 seconds
- Time taken: 15.545 seconds
- Time taken: 15.612 seconds
- Time taken: 14.925 seconds
- Time taken: 15.691 seconds
- Time taken: 15.747 seconds

**Average duration: 16.3973 seconds**",2020-02-25T03:02:00Z,2020-03-25T05:48:05Z,,,b859249effa2c1d5bfcab766ce24d25c304fbd38,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27690/commits,https://api.github.com/repos/apache/spark/pulls/27690/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27690/comments,https://api.github.com/repos/apache/spark/statuses/073b2e5aa299225dae830542247be0f15488eba9,CONTRIBUTOR,spark,apache,moomindani,1304020,MDQ6VXNlcjEzMDQwMjA=,https://avatars1.githubusercontent.com/u/1304020?v=4,,https://api.github.com/users/moomindani,https://github.com/moomindani,https://api.github.com/users/moomindani/followers,https://api.github.com/users/moomindani/following{/other_user},https://api.github.com/users/moomindani/gists{/gist_id},https://api.github.com/users/moomindani/starred{/owner}{/repo},https://api.github.com/users/moomindani/subscriptions,https://api.github.com/users/moomindani/orgs,https://api.github.com/users/moomindani/repos,https://api.github.com/users/moomindani/events{/privacy},https://api.github.com/users/moomindani/received_events,User,False,moomindani:SPARK-21514,SPARK-21514,073b2e5aa299225dae830542247be0f15488eba9,moomindani,1304020,MDQ6VXNlcjEzMDQwMjA=,https://avatars1.githubusercontent.com/u/1304020?v=4,,https://api.github.com/users/moomindani,https://github.com/moomindani,https://api.github.com/users/moomindani/followers,https://api.github.com/users/moomindani/following{/other_user},https://api.github.com/users/moomindani/gists{/gist_id},https://api.github.com/users/moomindani/starred{/owner}{/repo},https://api.github.com/users/moomindani/subscriptions,https://api.github.com/users/moomindani/orgs,https://api.github.com/users/moomindani/repos,https://api.github.com/users/moomindani/events{/privacy},https://api.github.com/users/moomindani/received_events,User,False,73681173,MDEwOlJlcG9zaXRvcnk3MzY4MTE3Mw==,spark,moomindani/spark,False,moomindani,1304020,MDQ6VXNlcjEzMDQwMjA=,https://avatars1.githubusercontent.com/u/1304020?v=4,,https://api.github.com/users/moomindani,https://github.com/moomindani,https://api.github.com/users/moomindani/followers,https://api.github.com/users/moomindani/following{/other_user},https://api.github.com/users/moomindani/gists{/gist_id},https://api.github.com/users/moomindani/starred{/owner}{/repo},https://api.github.com/users/moomindani/subscriptions,https://api.github.com/users/moomindani/orgs,https://api.github.com/users/moomindani/repos,https://api.github.com/users/moomindani/events{/privacy},https://api.github.com/users/moomindani/received_events,User,False,https://github.com/moomindani/spark,Mirror of Apache Spark,True,https://api.github.com/repos/moomindani/spark,https://api.github.com/repos/moomindani/spark/forks,https://api.github.com/repos/moomindani/spark/keys{/key_id},https://api.github.com/repos/moomindani/spark/collaborators{/collaborator},https://api.github.com/repos/moomindani/spark/teams,https://api.github.com/repos/moomindani/spark/hooks,https://api.github.com/repos/moomindani/spark/issues/events{/number},https://api.github.com/repos/moomindani/spark/events,https://api.github.com/repos/moomindani/spark/assignees{/user},https://api.github.com/repos/moomindani/spark/branches{/branch},https://api.github.com/repos/moomindani/spark/tags,https://api.github.com/repos/moomindani/spark/git/blobs{/sha},https://api.github.com/repos/moomindani/spark/git/tags{/sha},https://api.github.com/repos/moomindani/spark/git/refs{/sha},https://api.github.com/repos/moomindani/spark/git/trees{/sha},https://api.github.com/repos/moomindani/spark/statuses/{sha},https://api.github.com/repos/moomindani/spark/languages,https://api.github.com/repos/moomindani/spark/stargazers,https://api.github.com/repos/moomindani/spark/contributors,https://api.github.com/repos/moomindani/spark/subscribers,https://api.github.com/repos/moomindani/spark/subscription,https://api.github.com/repos/moomindani/spark/commits{/sha},https://api.github.com/repos/moomindani/spark/git/commits{/sha},https://api.github.com/repos/moomindani/spark/comments{/number},https://api.github.com/repos/moomindani/spark/issues/comments{/number},https://api.github.com/repos/moomindani/spark/contents/{+path},https://api.github.com/repos/moomindani/spark/compare/{base}...{head},https://api.github.com/repos/moomindani/spark/merges,https://api.github.com/repos/moomindani/spark/{archive_format}{/ref},https://api.github.com/repos/moomindani/spark/downloads,https://api.github.com/repos/moomindani/spark/issues{/number},https://api.github.com/repos/moomindani/spark/pulls{/number},https://api.github.com/repos/moomindani/spark/milestones{/number},"https://api.github.com/repos/moomindani/spark/notifications{?since,all,participating}",https://api.github.com/repos/moomindani/spark/labels{/name},https://api.github.com/repos/moomindani/spark/releases{/id},https://api.github.com/repos/moomindani/spark/deployments,2016-11-14T08:01:47Z,2020-02-17T04:19:27Z,2020-03-24T00:04:05Z,git://github.com/moomindani/spark.git,git@github.com:moomindani/spark.git,https://github.com/moomindani/spark.git,https://github.com/moomindani/spark,,308059,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,7911de9d10e39960fcdda379815baf7386b8c34e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27690,https://github.com/apache/spark/pull/27690,https://api.github.com/repos/apache/spark/issues/27690,https://api.github.com/repos/apache/spark/issues/27690/comments,https://api.github.com/repos/apache/spark/pulls/27690/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27690/commits,https://api.github.com/repos/apache/spark/statuses/073b2e5aa299225dae830542247be0f15488eba9
92,https://api.github.com/repos/apache/spark/pulls/27685,379069972,MDExOlB1bGxSZXF1ZXN0Mzc5MDY5OTcy,https://github.com/apache/spark/pull/27685,https://github.com/apache/spark/pull/27685.diff,https://github.com/apache/spark/pull/27685.patch,https://api.github.com/repos/apache/spark/issues/27685,27685,open,False,[SPARK-30940][SQL] Remove attributeId in auto-generated arguments when Explain SQL query,"### What changes were proposed in this pull request?
When EXPLAIN sql query, the auto-generated argument alias shouldn't include expr/attribute id. This will provide better readability of Explain results. This is a follow-up to address #27368 (comment). 

**Before**
```
(7) HashAggregate [codegen id : 2]
Input [2]: [key#x, max#x]
Keys [1]: [key#x]
Functions [1]: [max(val#x)]
Aggregate Attributes [1]: [max(val#x)#x]
Results [2]: [key#x, max(val#x)#x AS max(val)#x]
```
**After**
```
(7) HashAggregate [codegen id : 2]
Input [2]: [key#x, max#x]
Keys [1]: [key#x]
Functions [1]: [max(val)]
Aggregate Attributes [1]: [max(val)#x]
Results [2]: [key#x, max(val)#x AS max(val)#x]
```



### Why are the changes needed?
Provide better readability for Explain result


### Does this PR introduce any user-facing change?
Update Explain result to a better format 


### How was this patch tested?
Update existing tests
",2020-02-24T16:00:22Z,2020-04-09T20:07:06Z,,,57c5944c9c2c4e264472e15eb1b29ef79e236f84,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27685/commits,https://api.github.com/repos/apache/spark/pulls/27685/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27685/comments,https://api.github.com/repos/apache/spark/statuses/c7daaa6543a51dbd83d56b56030d0d0b4755cb56,CONTRIBUTOR,spark,apache,Eric5553,10626956,MDQ6VXNlcjEwNjI2OTU2,https://avatars1.githubusercontent.com/u/10626956?v=4,,https://api.github.com/users/Eric5553,https://github.com/Eric5553,https://api.github.com/users/Eric5553/followers,https://api.github.com/users/Eric5553/following{/other_user},https://api.github.com/users/Eric5553/gists{/gist_id},https://api.github.com/users/Eric5553/starred{/owner}{/repo},https://api.github.com/users/Eric5553/subscriptions,https://api.github.com/users/Eric5553/orgs,https://api.github.com/users/Eric5553/repos,https://api.github.com/users/Eric5553/events{/privacy},https://api.github.com/users/Eric5553/received_events,User,False,Eric5553:RefineExprId,RefineExprId,c7daaa6543a51dbd83d56b56030d0d0b4755cb56,Eric5553,10626956,MDQ6VXNlcjEwNjI2OTU2,https://avatars1.githubusercontent.com/u/10626956?v=4,,https://api.github.com/users/Eric5553,https://github.com/Eric5553,https://api.github.com/users/Eric5553/followers,https://api.github.com/users/Eric5553/following{/other_user},https://api.github.com/users/Eric5553/gists{/gist_id},https://api.github.com/users/Eric5553/starred{/owner}{/repo},https://api.github.com/users/Eric5553/subscriptions,https://api.github.com/users/Eric5553/orgs,https://api.github.com/users/Eric5553/repos,https://api.github.com/users/Eric5553/events{/privacy},https://api.github.com/users/Eric5553/received_events,User,False,54733158,MDEwOlJlcG9zaXRvcnk1NDczMzE1OA==,spark,Eric5553/spark,False,Eric5553,10626956,MDQ6VXNlcjEwNjI2OTU2,https://avatars1.githubusercontent.com/u/10626956?v=4,,https://api.github.com/users/Eric5553,https://github.com/Eric5553,https://api.github.com/users/Eric5553/followers,https://api.github.com/users/Eric5553/following{/other_user},https://api.github.com/users/Eric5553/gists{/gist_id},https://api.github.com/users/Eric5553/starred{/owner}{/repo},https://api.github.com/users/Eric5553/subscriptions,https://api.github.com/users/Eric5553/orgs,https://api.github.com/users/Eric5553/repos,https://api.github.com/users/Eric5553/events{/privacy},https://api.github.com/users/Eric5553/received_events,User,False,https://github.com/Eric5553/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Eric5553/spark,https://api.github.com/repos/Eric5553/spark/forks,https://api.github.com/repos/Eric5553/spark/keys{/key_id},https://api.github.com/repos/Eric5553/spark/collaborators{/collaborator},https://api.github.com/repos/Eric5553/spark/teams,https://api.github.com/repos/Eric5553/spark/hooks,https://api.github.com/repos/Eric5553/spark/issues/events{/number},https://api.github.com/repos/Eric5553/spark/events,https://api.github.com/repos/Eric5553/spark/assignees{/user},https://api.github.com/repos/Eric5553/spark/branches{/branch},https://api.github.com/repos/Eric5553/spark/tags,https://api.github.com/repos/Eric5553/spark/git/blobs{/sha},https://api.github.com/repos/Eric5553/spark/git/tags{/sha},https://api.github.com/repos/Eric5553/spark/git/refs{/sha},https://api.github.com/repos/Eric5553/spark/git/trees{/sha},https://api.github.com/repos/Eric5553/spark/statuses/{sha},https://api.github.com/repos/Eric5553/spark/languages,https://api.github.com/repos/Eric5553/spark/stargazers,https://api.github.com/repos/Eric5553/spark/contributors,https://api.github.com/repos/Eric5553/spark/subscribers,https://api.github.com/repos/Eric5553/spark/subscription,https://api.github.com/repos/Eric5553/spark/commits{/sha},https://api.github.com/repos/Eric5553/spark/git/commits{/sha},https://api.github.com/repos/Eric5553/spark/comments{/number},https://api.github.com/repos/Eric5553/spark/issues/comments{/number},https://api.github.com/repos/Eric5553/spark/contents/{+path},https://api.github.com/repos/Eric5553/spark/compare/{base}...{head},https://api.github.com/repos/Eric5553/spark/merges,https://api.github.com/repos/Eric5553/spark/{archive_format}{/ref},https://api.github.com/repos/Eric5553/spark/downloads,https://api.github.com/repos/Eric5553/spark/issues{/number},https://api.github.com/repos/Eric5553/spark/pulls{/number},https://api.github.com/repos/Eric5553/spark/milestones{/number},"https://api.github.com/repos/Eric5553/spark/notifications{?since,all,participating}",https://api.github.com/repos/Eric5553/spark/labels{/name},https://api.github.com/repos/Eric5553/spark/releases{/id},https://api.github.com/repos/Eric5553/spark/deployments,2016-03-25T16:52:36Z,2020-03-21T14:42:23Z,2020-04-09T15:06:26Z,git://github.com/Eric5553/spark.git,git@github.com:Eric5553/spark.git,https://github.com/Eric5553/spark.git,https://github.com/Eric5553/spark,,306660,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,014d33570ba1518529a080a1ab79d33c536a0ee3,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27685,https://github.com/apache/spark/pull/27685,https://api.github.com/repos/apache/spark/issues/27685,https://api.github.com/repos/apache/spark/issues/27685/comments,https://api.github.com/repos/apache/spark/pulls/27685/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27685/commits,https://api.github.com/repos/apache/spark/statuses/c7daaa6543a51dbd83d56b56030d0d0b4755cb56
93,https://api.github.com/repos/apache/spark/pulls/27683,378944403,MDExOlB1bGxSZXF1ZXN0Mzc4OTQ0NDAz,https://github.com/apache/spark/pull/27683,https://github.com/apache/spark/pull/27683.diff,https://github.com/apache/spark/pull/27683.patch,https://api.github.com/repos/apache/spark/issues/27683,27683,open,False,[SPARK-30917][SQL]: The behaviour of UnaryMinus should not depend on SQLConf.get,"
<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
Added new parameter `checkOverflow` to remove dependency on `SQLConf.get`.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
This allows to avoid the issue when the configuration change between different phases of planning, and this can silently break a query plan which can lead to crashes or data corruption.
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
Existing UTs.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-02-24T11:37:35Z,2020-02-28T07:18:52Z,,,9b515137dc7687178801d9c9eba00335c90bae26,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27683/commits,https://api.github.com/repos/apache/spark/pulls/27683/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27683/comments,https://api.github.com/repos/apache/spark/statuses/63d24fd66830c97b027675ddc2f33133c1e0c6b1,CONTRIBUTOR,spark,apache,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,iRakson:unaryMinus,unaryMinus,63d24fd66830c97b027675ddc2f33133c1e0c6b1,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,205127207,MDEwOlJlcG9zaXRvcnkyMDUxMjcyMDc=,spark,iRakson/spark,False,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,https://github.com/iRakson/spark,Apache Spark,True,https://api.github.com/repos/iRakson/spark,https://api.github.com/repos/iRakson/spark/forks,https://api.github.com/repos/iRakson/spark/keys{/key_id},https://api.github.com/repos/iRakson/spark/collaborators{/collaborator},https://api.github.com/repos/iRakson/spark/teams,https://api.github.com/repos/iRakson/spark/hooks,https://api.github.com/repos/iRakson/spark/issues/events{/number},https://api.github.com/repos/iRakson/spark/events,https://api.github.com/repos/iRakson/spark/assignees{/user},https://api.github.com/repos/iRakson/spark/branches{/branch},https://api.github.com/repos/iRakson/spark/tags,https://api.github.com/repos/iRakson/spark/git/blobs{/sha},https://api.github.com/repos/iRakson/spark/git/tags{/sha},https://api.github.com/repos/iRakson/spark/git/refs{/sha},https://api.github.com/repos/iRakson/spark/git/trees{/sha},https://api.github.com/repos/iRakson/spark/statuses/{sha},https://api.github.com/repos/iRakson/spark/languages,https://api.github.com/repos/iRakson/spark/stargazers,https://api.github.com/repos/iRakson/spark/contributors,https://api.github.com/repos/iRakson/spark/subscribers,https://api.github.com/repos/iRakson/spark/subscription,https://api.github.com/repos/iRakson/spark/commits{/sha},https://api.github.com/repos/iRakson/spark/git/commits{/sha},https://api.github.com/repos/iRakson/spark/comments{/number},https://api.github.com/repos/iRakson/spark/issues/comments{/number},https://api.github.com/repos/iRakson/spark/contents/{+path},https://api.github.com/repos/iRakson/spark/compare/{base}...{head},https://api.github.com/repos/iRakson/spark/merges,https://api.github.com/repos/iRakson/spark/{archive_format}{/ref},https://api.github.com/repos/iRakson/spark/downloads,https://api.github.com/repos/iRakson/spark/issues{/number},https://api.github.com/repos/iRakson/spark/pulls{/number},https://api.github.com/repos/iRakson/spark/milestones{/number},"https://api.github.com/repos/iRakson/spark/notifications{?since,all,participating}",https://api.github.com/repos/iRakson/spark/labels{/name},https://api.github.com/repos/iRakson/spark/releases{/id},https://api.github.com/repos/iRakson/spark/deployments,2019-08-29T09:22:50Z,2019-10-23T11:47:43Z,2020-04-10T09:12:57Z,git://github.com/iRakson/spark.git,git@github.com:iRakson/spark.git,https://github.com/iRakson/spark.git,https://github.com/iRakson/spark,,325766,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,293e5364e570e8a6569e47e58918db2f1d45ddff,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27683,https://github.com/apache/spark/pull/27683,https://api.github.com/repos/apache/spark/issues/27683,https://api.github.com/repos/apache/spark/issues/27683/comments,https://api.github.com/repos/apache/spark/pulls/27683/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27683/commits,https://api.github.com/repos/apache/spark/statuses/63d24fd66830c97b027675ddc2f33133c1e0c6b1
94,https://api.github.com/repos/apache/spark/pulls/27664,378162994,MDExOlB1bGxSZXF1ZXN0Mzc4MTYyOTk0,https://github.com/apache/spark/pull/27664,https://github.com/apache/spark/pull/27664.diff,https://github.com/apache/spark/pull/27664.patch,https://api.github.com/repos/apache/spark/issues/27664,27664,open,False,[SPARK-30915][SS] FileStreamSink: Avoid reading the metadata log file when finding the latest batch ID,"### What changes were proposed in this pull request?

This patch adds the new method `getLatestBatchId()` in CompactibleFileStreamLog in complement of getLatest() which doesn't read the content of the latest batch metadata log file, and apply to `FileStreamSink.addBatch()` to avoid unnecessary latency on reading log file.

### Why are the changes needed?

Once compacted metadata log file becomes huge, writing outputs for the compact + 1 batch is also affected due to unnecessarily reading the compacted metadata log file. This unnecessary latency can be simply avoided.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

New UT. Also manually tested under query which has huge metadata log on file stream sink:

> before applying the patch

![Screen Shot 2020-02-21 at 4 20 19 PM](https://user-images.githubusercontent.com/1317309/75016223-d3ffb180-54cd-11ea-9063-49405943049d.png)

> after applying the patch

![Screen Shot 2020-02-21 at 4 06 18 PM](https://user-images.githubusercontent.com/1317309/75016220-d235ee00-54cd-11ea-81a7-7c03a43c4db4.png)

Peaks are compact batches - please compare the next batch after compact batches, especially the area of ""light brown"".",2020-02-21T08:24:00Z,2020-04-03T16:18:13Z,,,2797d78c49b180b0ed19d54ca8fa80508d96e878,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27664/commits,https://api.github.com/repos/apache/spark/pulls/27664/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27664/comments,https://api.github.com/repos/apache/spark/statuses/30338fb49dbe039fc264f4f5a867d5b7bbd7f711,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30915,SPARK-30915,30338fb49dbe039fc264f4f5a867d5b7bbd7f711,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,abe0821ee9414a441461e5a4a6cf5b781b46a2e8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27664,https://github.com/apache/spark/pull/27664,https://api.github.com/repos/apache/spark/issues/27664,https://api.github.com/repos/apache/spark/issues/27664/comments,https://api.github.com/repos/apache/spark/pulls/27664/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27664/commits,https://api.github.com/repos/apache/spark/statuses/30338fb49dbe039fc264f4f5a867d5b7bbd7f711
95,https://api.github.com/repos/apache/spark/pulls/27649,377781449,MDExOlB1bGxSZXF1ZXN0Mzc3NzgxNDQ5,https://github.com/apache/spark/pull/27649,https://github.com/apache/spark/pull/27649.diff,https://github.com/apache/spark/pull/27649.patch,https://api.github.com/repos/apache/spark/issues/27649,27649,open,False,[SPARK-30900][SS] FileStreamSource: Avoid reading compact metadata log twice if the query restarts from compact batch,"### What changes were proposed in this pull request?

This patch addresses the case where compact metadata file is read twice in FileStreamSource during restarting query.

When restarting the query, there is a case which the query starts from compaction batch, and the batch has source metadata file to read. One case is that the previous query succeeded to read from inputs, but not finalized the batch for various reasons.

The patch finds the latest compaction batch when restoring from metadata log, and put entries for the batch into the file entry cache which would avoid reading compact batch file twice.

FileStreamSourceLog doesn't know about offset / commit metadata in checkpoint so doesn't know which exactly batch to start from, but in practice, only couple of latest batches are candidates to
be started from when restarting query. This patch leverages the fact to skip calculation if possible.

### Why are the changes needed?

Spark incurs unnecessary cost on reading the compact metadata file twice on some case, which may not be ignorable when the query has been processed huge number of files so far.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

New UT.",2020-02-20T14:17:24Z,2020-03-27T14:49:08Z,,,67f9bf091c1a8f72a721af8c339f2f11877ea551,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27649/commits,https://api.github.com/repos/apache/spark/pulls/27649/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27649/comments,https://api.github.com/repos/apache/spark/statuses/6406e36eb34377983aaf113495ca16b1553317a3,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30900,SPARK-30900,6406e36eb34377983aaf113495ca16b1553317a3,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,704d249a56325fce4a8179a2a7a242b9469aa6ec,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27649,https://github.com/apache/spark/pull/27649,https://api.github.com/repos/apache/spark/issues/27649,https://api.github.com/repos/apache/spark/issues/27649/comments,https://api.github.com/repos/apache/spark/pulls/27649/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27649/commits,https://api.github.com/repos/apache/spark/statuses/6406e36eb34377983aaf113495ca16b1553317a3
96,https://api.github.com/repos/apache/spark/pulls/27648,377759454,MDExOlB1bGxSZXF1ZXN0Mzc3NzU5NDU0,https://github.com/apache/spark/pull/27648,https://github.com/apache/spark/pull/27648.diff,https://github.com/apache/spark/pull/27648.patch,https://api.github.com/repos/apache/spark/issues/27648,27648,open,False,[SPARK-24994][SQL] : Support filter pushdown for short and byte without explicit casting,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
  7. If you want to add a new configuration, please read the guideline first for naming configurations in
     'core/src/main/scala/org/apache/spark/internal/config/ConfigEntry.scala'.
-->

### What changes were proposed in this pull request?
If we have a shortType column in our table, filter will not be pushed down for the following query:
`select * from t where id = 2;`
pushed filter ->
`PushedFilters: [IsNotNull(id)], ReadSchema: struct<id:smallint>`

2 is within short range still filter is not pushed down. 
But it pushes filter if we cast the literal to smallint: 
`select * from t where id = cast(2 as smallint) ; `
pushed filter ->
` PushedFilters: [IsNotNull(id), EqualTo(id,2)], ReadSchema: struct<id:smallint>`

After these changes, there is no need to explicitly convert literals to short/byte for filter pushdown:

`Select * from t where id = 2;`
pushed filter ->
`PushedFilters: [IsNotNull(id), EqualTo(id,2)], ReadSchema: struct<id:smallint>`

<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
These changes are needed because whenever we want to pushdown filters for short/byte value we have to explicitly cast them to short/byte even if the value is well within short/byte range.

<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
Yes, now users dont need to explicitly cast literals to short/byte for filter pushdown.
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
Manually. UT will be added soon.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-02-20T13:36:58Z,2020-03-03T02:55:22Z,,,04fc593c8bb1ebbe5b27b19a965cf8da20734803,,[],"[{'login': 'cloud-fan', 'id': 3182036, 'node_id': 'MDQ6VXNlcjMxODIwMzY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/3182036?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/cloud-fan', 'html_url': 'https://github.com/cloud-fan', 'followers_url': 'https://api.github.com/users/cloud-fan/followers', 'following_url': 'https://api.github.com/users/cloud-fan/following{/other_user}', 'gists_url': 'https://api.github.com/users/cloud-fan/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/cloud-fan/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/cloud-fan/subscriptions', 'organizations_url': 'https://api.github.com/users/cloud-fan/orgs', 'repos_url': 'https://api.github.com/users/cloud-fan/repos', 'events_url': 'https://api.github.com/users/cloud-fan/events{/privacy}', 'received_events_url': 'https://api.github.com/users/cloud-fan/received_events', 'type': 'User', 'site_admin': False}, {'login': 'wangyum', 'id': 5399861, 'node_id': 'MDQ6VXNlcjUzOTk4NjE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/5399861?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/wangyum', 'html_url': 'https://github.com/wangyum', 'followers_url': 'https://api.github.com/users/wangyum/followers', 'following_url': 'https://api.github.com/users/wangyum/following{/other_user}', 'gists_url': 'https://api.github.com/users/wangyum/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/wangyum/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/wangyum/subscriptions', 'organizations_url': 'https://api.github.com/users/wangyum/orgs', 'repos_url': 'https://api.github.com/users/wangyum/repos', 'events_url': 'https://api.github.com/users/wangyum/events{/privacy}', 'received_events_url': 'https://api.github.com/users/wangyum/received_events', 'type': 'User', 'site_admin': False}, {'login': 'HyukjinKwon', 'id': 6477701, 'node_id': 'MDQ6VXNlcjY0Nzc3MDE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/6477701?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/HyukjinKwon', 'html_url': 'https://github.com/HyukjinKwon', 'followers_url': 'https://api.github.com/users/HyukjinKwon/followers', 'following_url': 'https://api.github.com/users/HyukjinKwon/following{/other_user}', 'gists_url': 'https://api.github.com/users/HyukjinKwon/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/HyukjinKwon/subscriptions', 'organizations_url': 'https://api.github.com/users/HyukjinKwon/orgs', 'repos_url': 'https://api.github.com/users/HyukjinKwon/repos', 'events_url': 'https://api.github.com/users/HyukjinKwon/events{/privacy}', 'received_events_url': 'https://api.github.com/users/HyukjinKwon/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27648/commits,https://api.github.com/repos/apache/spark/pulls/27648/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27648/comments,https://api.github.com/repos/apache/spark/statuses/5ee3d424b2a9270a3cb910ce363d1ab4c7f81655,CONTRIBUTOR,spark,apache,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,iRakson:SPARK-24994,SPARK-24994,5ee3d424b2a9270a3cb910ce363d1ab4c7f81655,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,205127207,MDEwOlJlcG9zaXRvcnkyMDUxMjcyMDc=,spark,iRakson/spark,False,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,https://github.com/iRakson/spark,Apache Spark,True,https://api.github.com/repos/iRakson/spark,https://api.github.com/repos/iRakson/spark/forks,https://api.github.com/repos/iRakson/spark/keys{/key_id},https://api.github.com/repos/iRakson/spark/collaborators{/collaborator},https://api.github.com/repos/iRakson/spark/teams,https://api.github.com/repos/iRakson/spark/hooks,https://api.github.com/repos/iRakson/spark/issues/events{/number},https://api.github.com/repos/iRakson/spark/events,https://api.github.com/repos/iRakson/spark/assignees{/user},https://api.github.com/repos/iRakson/spark/branches{/branch},https://api.github.com/repos/iRakson/spark/tags,https://api.github.com/repos/iRakson/spark/git/blobs{/sha},https://api.github.com/repos/iRakson/spark/git/tags{/sha},https://api.github.com/repos/iRakson/spark/git/refs{/sha},https://api.github.com/repos/iRakson/spark/git/trees{/sha},https://api.github.com/repos/iRakson/spark/statuses/{sha},https://api.github.com/repos/iRakson/spark/languages,https://api.github.com/repos/iRakson/spark/stargazers,https://api.github.com/repos/iRakson/spark/contributors,https://api.github.com/repos/iRakson/spark/subscribers,https://api.github.com/repos/iRakson/spark/subscription,https://api.github.com/repos/iRakson/spark/commits{/sha},https://api.github.com/repos/iRakson/spark/git/commits{/sha},https://api.github.com/repos/iRakson/spark/comments{/number},https://api.github.com/repos/iRakson/spark/issues/comments{/number},https://api.github.com/repos/iRakson/spark/contents/{+path},https://api.github.com/repos/iRakson/spark/compare/{base}...{head},https://api.github.com/repos/iRakson/spark/merges,https://api.github.com/repos/iRakson/spark/{archive_format}{/ref},https://api.github.com/repos/iRakson/spark/downloads,https://api.github.com/repos/iRakson/spark/issues{/number},https://api.github.com/repos/iRakson/spark/pulls{/number},https://api.github.com/repos/iRakson/spark/milestones{/number},"https://api.github.com/repos/iRakson/spark/notifications{?since,all,participating}",https://api.github.com/repos/iRakson/spark/labels{/name},https://api.github.com/repos/iRakson/spark/releases{/id},https://api.github.com/repos/iRakson/spark/deployments,2019-08-29T09:22:50Z,2019-10-23T11:47:43Z,2020-04-10T09:12:57Z,git://github.com/iRakson/spark.git,git@github.com:iRakson/spark.git,https://github.com/iRakson/spark.git,https://github.com/iRakson/spark,,325766,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,4248b7fbb9fd53b5d95bb60fbcec1248052d2879,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27648,https://github.com/apache/spark/pull/27648,https://api.github.com/repos/apache/spark/issues/27648,https://api.github.com/repos/apache/spark/issues/27648/comments,https://api.github.com/repos/apache/spark/pulls/27648/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27648/commits,https://api.github.com/repos/apache/spark/statuses/5ee3d424b2a9270a3cb910ce363d1ab4c7f81655
97,https://api.github.com/repos/apache/spark/pulls/27636,377085357,MDExOlB1bGxSZXF1ZXN0Mzc3MDg1MzU3,https://github.com/apache/spark/pull/27636,https://github.com/apache/spark/pull/27636.diff,https://github.com/apache/spark/pull/27636.patch,https://api.github.com/repos/apache/spark/issues/27636,27636,open,False,[SPARK-30873][CORE][YARN]Handling Node Decommissioning for Yarn cluster manger in Spark,"### What changes were proposed in this pull request?
In many public cloud environments, the node loss (in case of AWS SpotLoss,Spot blocks and GCP preemptible VMs) is a planned and informed activity. 
The cloud provider intimates the cluster manager about the possible loss of node ahead of time. Few examples is listed here:
a) Spot loss in AWS(2 min before event)
b) GCP Pre-emptible VM loss (30 second before event)
c) AWS Spot block loss with info on termination time (generally few tens of minutes before decommission as configured in Yarn)

Design Doc of this PR https://docs.google.com/document/d/1urypkQVZY6oMNZXLuEPifNPxo_gqJng2osKTDRfWi08/edit#heading=h.y1m32a7uhh1z

This PR tries to make spark leverage the knowledge of the node loss in future, and tries to adjust the scheduling of tasks to minimise the impact on the application. 
It is well known that when a host is lost, the executors, its running tasks, their caches and also Shuffle data is lost. This could result in wastage of compute and other resources.

The focus here is to build a framework for YARN, that can be extended for other cluster managers to handle such scenario.

The framework must handle one or more of the following:-
1) Prevent new tasks from starting on any executors on decommissioning Nodes. 
2) Decide to kill the running tasks so that they can be restarted elsewhere (assuming they will not complete within the deadline) OR we can allow them to continue hoping they will  finish within deadline.
3) Clear the shuffle data entry from MapOutputTracker of decommission node hostname to prevent the shuffle fetchfailed exception.The most significant advantage of unregistering shuffle outputs when Spark schedules the first re-attempt to compute the missing blocks, it notices all of the missing blocks from decommissioned nodes and recovers in only one attempt. This speeds up the recovery process significantly over the scheduled Spark implementation, where stages might be rescheduled multiple times to recompute missing shuffles from all nodes, and prevent jobs from being stuck for hours failing and recomputing.
4) Prevent the stage to abort due to the fetchfailed exception in case of decommissioning of node. In Spark there is number of consecutive stage attempts allowed before a stage is aborted.This is controlled by the config spark.stage.maxConsecutiveAttempts. Not accounting fetch fails due decommissioning of nodes towards stage failure improves the reliability of the system.

Main components of change
1) Get the ClusterInfo update from the Resource Manager -> Application Master -> Spark Driver.
2) DecommissionTracker, resides inside driver, tracks all the decommissioned nodes and take necessary action and state transition.
3) Based on the decommission node list add hooks at code to achieve
  a) No new task on executor
  b) Remove shuffle data mapping info for the node to be decommissioned from the mapOutputTracker
  c) Do not count fetchFailure from decommissioned towards stage failure

On the receiving info that node is to be decommissioned, the below action needs to be performed by DecommissionTracker on driver:
 * Add the entry of Nodes in DecommissionTracker with termination time and node state as ""DECOMMISSIONING"".
 * Stop assigning any new tasks on executors on the nodes which are candidate for decommission. This makes sure slowly as the tasks finish the usage of this node would  die down.
 *  Kill all the executors for the decommissioning nodes after configurable period of time, say ""spark.graceful.decommission.executor.leasetimePct"". This killing ensures two things. Firstly, the task failure will be attributed in job failure count. Second, avoid generation on more shuffle data on the node that will eventually be lost.  The node state is set to ""EXECUTOR_DECOMMISSIONED"". 
 * Mark Shuffle data on the node as unavailable after ""spark.graceful.decommission.shuffedata.leasetimePct"" time. This will ensure that recomputation of missing shuffle partition is done early, rather than reducers failing with a time-consuming FetchFailure. The node state is set to ""SHUFFLE_DECOMMISSIONED"". 
 * Mark Node as Terminated after the termination time. Now the state of the node is ""TERMINATED"".
 * Remove the node entry from Decommission Tracker if the same host name is reused.(This is not uncommon in many public cloud environments). 

This is the life cycle of the nodes which is decommissioned
DECOMMISSIONING -> EXECUTOR_DECOMMISSIONED -> SHUFFLEDATA_DECOMMISSIONED -> TERMINATED.

### Why are the changes needed?
Add the support to handle the Node Decommissioning for Yarn cluster manger in Spark

### Does this PR introduce any user-facing change?
NO


### How was this patch tested?
Added the Unit Test and run the manual test for aws spot nodes on the cluster
",2020-02-19T10:27:08Z,2020-03-31T16:40:19Z,,,420c53ef334d94977747f9f3417834804380e53c,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1427970157, 'node_id': 'MDU6TGFiZWwxNDI3OTcwMTU3', 'url': 'https://api.github.com/repos/apache/spark/labels/YARN', 'name': 'YARN', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27636/commits,https://api.github.com/repos/apache/spark/pulls/27636/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27636/comments,https://api.github.com/repos/apache/spark/statuses/4c1eea9bce86321a853a44908e133d838b42031b,NONE,spark,apache,SaurabhChawla100,34540906,MDQ6VXNlcjM0NTQwOTA2,https://avatars1.githubusercontent.com/u/34540906?v=4,,https://api.github.com/users/SaurabhChawla100,https://github.com/SaurabhChawla100,https://api.github.com/users/SaurabhChawla100/followers,https://api.github.com/users/SaurabhChawla100/following{/other_user},https://api.github.com/users/SaurabhChawla100/gists{/gist_id},https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo},https://api.github.com/users/SaurabhChawla100/subscriptions,https://api.github.com/users/SaurabhChawla100/orgs,https://api.github.com/users/SaurabhChawla100/repos,https://api.github.com/users/SaurabhChawla100/events{/privacy},https://api.github.com/users/SaurabhChawla100/received_events,User,False,SaurabhChawla100:SPARK-30873,SPARK-30873,4c1eea9bce86321a853a44908e133d838b42031b,SaurabhChawla100,34540906,MDQ6VXNlcjM0NTQwOTA2,https://avatars1.githubusercontent.com/u/34540906?v=4,,https://api.github.com/users/SaurabhChawla100,https://github.com/SaurabhChawla100,https://api.github.com/users/SaurabhChawla100/followers,https://api.github.com/users/SaurabhChawla100/following{/other_user},https://api.github.com/users/SaurabhChawla100/gists{/gist_id},https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo},https://api.github.com/users/SaurabhChawla100/subscriptions,https://api.github.com/users/SaurabhChawla100/orgs,https://api.github.com/users/SaurabhChawla100/repos,https://api.github.com/users/SaurabhChawla100/events{/privacy},https://api.github.com/users/SaurabhChawla100/received_events,User,False,235058981,MDEwOlJlcG9zaXRvcnkyMzUwNTg5ODE=,spark,SaurabhChawla100/spark,False,SaurabhChawla100,34540906,MDQ6VXNlcjM0NTQwOTA2,https://avatars1.githubusercontent.com/u/34540906?v=4,,https://api.github.com/users/SaurabhChawla100,https://github.com/SaurabhChawla100,https://api.github.com/users/SaurabhChawla100/followers,https://api.github.com/users/SaurabhChawla100/following{/other_user},https://api.github.com/users/SaurabhChawla100/gists{/gist_id},https://api.github.com/users/SaurabhChawla100/starred{/owner}{/repo},https://api.github.com/users/SaurabhChawla100/subscriptions,https://api.github.com/users/SaurabhChawla100/orgs,https://api.github.com/users/SaurabhChawla100/repos,https://api.github.com/users/SaurabhChawla100/events{/privacy},https://api.github.com/users/SaurabhChawla100/received_events,User,False,https://github.com/SaurabhChawla100/spark,Apache Spark,True,https://api.github.com/repos/SaurabhChawla100/spark,https://api.github.com/repos/SaurabhChawla100/spark/forks,https://api.github.com/repos/SaurabhChawla100/spark/keys{/key_id},https://api.github.com/repos/SaurabhChawla100/spark/collaborators{/collaborator},https://api.github.com/repos/SaurabhChawla100/spark/teams,https://api.github.com/repos/SaurabhChawla100/spark/hooks,https://api.github.com/repos/SaurabhChawla100/spark/issues/events{/number},https://api.github.com/repos/SaurabhChawla100/spark/events,https://api.github.com/repos/SaurabhChawla100/spark/assignees{/user},https://api.github.com/repos/SaurabhChawla100/spark/branches{/branch},https://api.github.com/repos/SaurabhChawla100/spark/tags,https://api.github.com/repos/SaurabhChawla100/spark/git/blobs{/sha},https://api.github.com/repos/SaurabhChawla100/spark/git/tags{/sha},https://api.github.com/repos/SaurabhChawla100/spark/git/refs{/sha},https://api.github.com/repos/SaurabhChawla100/spark/git/trees{/sha},https://api.github.com/repos/SaurabhChawla100/spark/statuses/{sha},https://api.github.com/repos/SaurabhChawla100/spark/languages,https://api.github.com/repos/SaurabhChawla100/spark/stargazers,https://api.github.com/repos/SaurabhChawla100/spark/contributors,https://api.github.com/repos/SaurabhChawla100/spark/subscribers,https://api.github.com/repos/SaurabhChawla100/spark/subscription,https://api.github.com/repos/SaurabhChawla100/spark/commits{/sha},https://api.github.com/repos/SaurabhChawla100/spark/git/commits{/sha},https://api.github.com/repos/SaurabhChawla100/spark/comments{/number},https://api.github.com/repos/SaurabhChawla100/spark/issues/comments{/number},https://api.github.com/repos/SaurabhChawla100/spark/contents/{+path},https://api.github.com/repos/SaurabhChawla100/spark/compare/{base}...{head},https://api.github.com/repos/SaurabhChawla100/spark/merges,https://api.github.com/repos/SaurabhChawla100/spark/{archive_format}{/ref},https://api.github.com/repos/SaurabhChawla100/spark/downloads,https://api.github.com/repos/SaurabhChawla100/spark/issues{/number},https://api.github.com/repos/SaurabhChawla100/spark/pulls{/number},https://api.github.com/repos/SaurabhChawla100/spark/milestones{/number},"https://api.github.com/repos/SaurabhChawla100/spark/notifications{?since,all,participating}",https://api.github.com/repos/SaurabhChawla100/spark/labels{/name},https://api.github.com/repos/SaurabhChawla100/spark/releases{/id},https://api.github.com/repos/SaurabhChawla100/spark/deployments,2020-01-20T09:01:55Z,2020-02-19T08:47:14Z,2020-03-31T11:41:30Z,git://github.com/SaurabhChawla100/spark.git,git@github.com:SaurabhChawla100/spark.git,https://github.com/SaurabhChawla100/spark.git,https://github.com/SaurabhChawla100/spark,,322284,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3b6da36cd62e734b12405bf994a228c7f5049e77,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27636,https://github.com/apache/spark/pull/27636,https://api.github.com/repos/apache/spark/issues/27636,https://api.github.com/repos/apache/spark/issues/27636/comments,https://api.github.com/repos/apache/spark/pulls/27636/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27636/commits,https://api.github.com/repos/apache/spark/statuses/4c1eea9bce86321a853a44908e133d838b42031b
98,https://api.github.com/repos/apache/spark/pulls/27632,376987876,MDExOlB1bGxSZXF1ZXN0Mzc2OTg3ODc2,https://github.com/apache/spark/pull/27632,https://github.com/apache/spark/pull/27632.diff,https://github.com/apache/spark/pull/27632.patch,https://api.github.com/repos/apache/spark/issues/27632,27632,open,False,[SPARK-30872][SQL] Constraints inferred from inferred attributes,"### What changes were proposed in this pull request?
This PR fix a special case about infer additional constraints. How to reproduce this issue:
```scala
scala> spark.range(20).selectExpr(""id as a"", ""id as b"", ""id as c"").write.saveAsTable(""t1"")

scala> spark.sql(""select count(*) from t1 where a = b and b = c and (c = 3 or c = 13)"").explain(false)
== Physical Plan ==
*(2) HashAggregate(keys=[], functions=[count(1)])
+- Exchange SinglePartition, true, [id=#76]
   +- *(1) HashAggregate(keys=[], functions=[partial_count(1)])
      +- *(1) Project
         +- *(1) Filter (((((((isnotnull(c#36L) AND ((b#35L = 3) OR (b#35L = 13))) AND isnotnull(b#35L)) AND (a#34L = c#36L)) AND isnotnull(a#34L)) AND (a#34L = b#35L)) AND (b#35L = c#36L)) AND ((c#36L = 3) OR (c#36L = 13)))
            +- *(1) ColumnarToRow
               +- FileScan parquet default.t1[a#34L,b#35L,c#36L] Batched: true, DataFilters: [isnotnull(c#36L), ((b#35L = 3) OR (b#35L = 13)), isnotnull(b#35L), (a#34L = c#36L), isnotnull(a#..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yumwang/Downloads/spark-3.0.0-preview2-bin-hadoop2.7/spark-warehous..., PartitionFilters: [], PushedFilters: [IsNotNull(c), Or(EqualTo(b,3),EqualTo(b,13)), IsNotNull(b), IsNotNull(a), Or(EqualTo(c,3),EqualT..., ReadSchema: struct<a:bigint,b:bigint,c:bigint>
```

We can infer more constraints: `(a#34L = 3) OR (a#34L = 13)`.


### Why are the changes needed?

Improve query performance.

### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit test and benchmark test.
Benchmark code and benchmark result:
```scala
import org.apache.spark.benchmark.Benchmark
import org.apache.spark.sql.SaveMode.Overwrite

spark.conf.set(""spark.sql.constraintPropagation.enabled"", false)

val numRows = 1024 * 1024 * 15
val first = 10000
val mid = numRows / 2
val end = numRows - 10000
spark.range(numRows).selectExpr(""id as a"", ""id as b"", ""id as c"").write.saveAsTable(""t1"")

val title = ""Constraints inferred from inferred constraints""
val benchmark = new Benchmark(title, numRows, minNumIters = 5)
benchmark.addCase(""Infer to b"") { _ =>
  spark.sql(s""select count(*) from t1 where a = b and b = c and a = c and (c = $first or c = $mid or c = $end) and (b = $first or b = $mid or b = $end)"").write.format(""noop"").mode(Overwrite).save()
}

benchmark.addCase(""Infer to b to a"") { _ =>
  spark.sql(s""select count(*) from t1 where a = b and b = c and a = c and (c = $first or c = $mid or c = $end) and (b = $first or b = $mid or b = $end) and (a = $first or a = $mid or a = $end)"").write.format(""noop"").mode(Overwrite).save()
}
benchmark.run()
```

```
Java HotSpot(TM) 64-Bit Server VM 1.8.0_191-b12 on Mac OS X 10.13.6
Intel(R) Core(TM) i7-7820HQ CPU @ 2.90GHz
Constraints inferred from inferred constraints:  Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
Infer to b                                          463            547          65         34.0          29.4       1.0X
Infer to b to a                                     428            452          14         36.8          27.2       1.1X
```
",2020-02-19T06:27:11Z,2020-02-28T07:19:02Z,,,e0ec02cf214ce83fd258fe35fa42a2c474874816,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27632/commits,https://api.github.com/repos/apache/spark/pulls/27632/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27632/comments,https://api.github.com/repos/apache/spark/statuses/bf7b8e561029791daa17ffb90aac9e970f002cf9,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-30872,SPARK-30872,bf7b8e561029791daa17ffb90aac9e970f002cf9,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,28b8713036ff5ced4814d4d16d341f00b11ad3c3,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27632,https://github.com/apache/spark/pull/27632,https://api.github.com/repos/apache/spark/issues/27632,https://api.github.com/repos/apache/spark/issues/27632/comments,https://api.github.com/repos/apache/spark/pulls/27632/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27632/commits,https://api.github.com/repos/apache/spark/statuses/bf7b8e561029791daa17ffb90aac9e970f002cf9
99,https://api.github.com/repos/apache/spark/pulls/27629,376855692,MDExOlB1bGxSZXF1ZXN0Mzc2ODU1Njky,https://github.com/apache/spark/pull/27629,https://github.com/apache/spark/pull/27629.diff,https://github.com/apache/spark/pull/27629.patch,https://api.github.com/repos/apache/spark/issues/27629,27629,open,False,[SPARK-28067][SQL]Fix incorrect results during aggregate sum for decimal overflow by throwing exception,"### What changes were proposed in this pull request?

JIRA SPARK-28067:  Wrong results are returned for aggregate sum with decimals with whole stage codegen enabled

**Repro:** 
WholeStage enabled enabled ->  Wrong results
WholeStage disabled -> Returns exception Decimal precision 39 exceeds max precision 38

**Issues:** 
1. Wrong results are returned which is bad 
2. Inconsistency between whole stage enabled and disabled. 

**Cause:**
Sum does not take care of possibility of overflow for the intermediate steps.  ie the updateExpressions and mergeExpressions.  

**This PR makes the following changes:**
- Throw exception if there is an decimal overflow when computing the sum.
- This will be consistent with how Spark behaves when whole stage codegen is disabled.

**Pros:** 
- No wrong results
- Consistent behavior between wholestage enabled and disabled
- DB’s have similar behavior, there is precedence

**Before Fix:** - WRONG RESULTS
```
scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala> df2.show(40,false)
+---------------------------------------+                                       
|sum(decNum)                            |
+---------------------------------------+
|20000000000000000000.000000000000000000|
+---------------------------------------+
```

**After fix:**
```
scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala> df2.show(40,false)
20/02/18 13:36:19 ERROR Executor: Exception in task 1.0 in stage 1.0 (TID 9)    
java.lang.ArithmeticException: Decimal(expanded,100000000000000000000.000000000000000000,39,18}) cannot be represented as Decimal(38, 18).
```

### Why are the changes needed?
The changes are needed in order to fix the wrong results that are returned for decimal aggregate sum.

### Does this PR introduce any user-facing change?
Prior to this fix, user would see wrong results on aggregate sum that involved decimal overflow, but now the user will see exception. This behavior is consistent as well with how Spark behaves when whole stage code gen is disabled.

### How was this patch tested?
New test has been added and existing tests for sql, catalyst and hive suites were run ok.
",2020-02-18T21:55:39Z,2020-02-28T07:19:03Z,,,5760199a8b3a987f8b40efdfffc8c4879860cfbc,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27629/commits,https://api.github.com/repos/apache/spark/pulls/27629/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27629/comments,https://api.github.com/repos/apache/spark/statuses/7aae81c73873b37494e6f6d393717aad068a4a9f,CONTRIBUTOR,spark,apache,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,skambha:decsumthrowexception,decsumthrowexception,7aae81c73873b37494e6f6d393717aad068a4a9f,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,49237548,MDEwOlJlcG9zaXRvcnk0OTIzNzU0OA==,spark,skambha/spark,False,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,https://github.com/skambha/spark,Mirror of Apache Spark,True,https://api.github.com/repos/skambha/spark,https://api.github.com/repos/skambha/spark/forks,https://api.github.com/repos/skambha/spark/keys{/key_id},https://api.github.com/repos/skambha/spark/collaborators{/collaborator},https://api.github.com/repos/skambha/spark/teams,https://api.github.com/repos/skambha/spark/hooks,https://api.github.com/repos/skambha/spark/issues/events{/number},https://api.github.com/repos/skambha/spark/events,https://api.github.com/repos/skambha/spark/assignees{/user},https://api.github.com/repos/skambha/spark/branches{/branch},https://api.github.com/repos/skambha/spark/tags,https://api.github.com/repos/skambha/spark/git/blobs{/sha},https://api.github.com/repos/skambha/spark/git/tags{/sha},https://api.github.com/repos/skambha/spark/git/refs{/sha},https://api.github.com/repos/skambha/spark/git/trees{/sha},https://api.github.com/repos/skambha/spark/statuses/{sha},https://api.github.com/repos/skambha/spark/languages,https://api.github.com/repos/skambha/spark/stargazers,https://api.github.com/repos/skambha/spark/contributors,https://api.github.com/repos/skambha/spark/subscribers,https://api.github.com/repos/skambha/spark/subscription,https://api.github.com/repos/skambha/spark/commits{/sha},https://api.github.com/repos/skambha/spark/git/commits{/sha},https://api.github.com/repos/skambha/spark/comments{/number},https://api.github.com/repos/skambha/spark/issues/comments{/number},https://api.github.com/repos/skambha/spark/contents/{+path},https://api.github.com/repos/skambha/spark/compare/{base}...{head},https://api.github.com/repos/skambha/spark/merges,https://api.github.com/repos/skambha/spark/{archive_format}{/ref},https://api.github.com/repos/skambha/spark/downloads,https://api.github.com/repos/skambha/spark/issues{/number},https://api.github.com/repos/skambha/spark/pulls{/number},https://api.github.com/repos/skambha/spark/milestones{/number},"https://api.github.com/repos/skambha/spark/notifications{?since,all,participating}",https://api.github.com/repos/skambha/spark/labels{/name},https://api.github.com/repos/skambha/spark/releases{/id},https://api.github.com/repos/skambha/spark/deployments,2016-01-07T23:39:32Z,2019-01-29T18:39:30Z,2020-04-08T20:09:33Z,git://github.com/skambha/spark.git,git@github.com:skambha/spark.git,https://github.com/skambha/spark.git,https://github.com/skambha/spark,,305083,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1b67d546bd96412943de0c7a3b4295cbde887bd2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27629,https://github.com/apache/spark/pull/27629,https://api.github.com/repos/apache/spark/issues/27629,https://api.github.com/repos/apache/spark/issues/27629/comments,https://api.github.com/repos/apache/spark/pulls/27629/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27629/commits,https://api.github.com/repos/apache/spark/statuses/7aae81c73873b37494e6f6d393717aad068a4a9f
100,https://api.github.com/repos/apache/spark/pulls/27627,376824403,MDExOlB1bGxSZXF1ZXN0Mzc2ODI0NDAz,https://github.com/apache/spark/pull/27627,https://github.com/apache/spark/pull/27627.diff,https://github.com/apache/spark/pull/27627.patch,https://api.github.com/repos/apache/spark/issues/27627,27627,open,False,[WIP][SPARK-28067][SQL] Fix incorrect results for decimal aggregate sum by returning null on decimal overflow,"### What changes were proposed in this pull request?

JIRA SPARK-28067:  Wrong results are returned for aggregate sum with decimals with whole stage codegen enabled

**Repro:** 
WholeStage enabled enabled ->  Wrong results
WholeStage disabled -> Returns exception Decimal precision 39 exceeds max precision 38

**Issues:** 
1. Wrong results are returned which is bad 
2. Inconsistency between whole stage enabled and disabled. 

**Cause:**
Sum does not take care of possibility of overflow for the intermediate steps.  ie the updateExpressions and mergeExpressions.  

This PR makes the following changes:
- Add changes to check if overflow occurs for decimal in aggregate Sum and if there is an overflow,  it will return null for the Sum operation when spark.sql.ansi.enabled is false.  
- When spark.sql.ansi.enabled is true, then the sum operation will return an exception if an overflow occurs for the decimal operation in Sum. 
- This is keeping it consistent with the behavior defined in spark.sql.ansi.enabled property

**Before the fix:  Scenario 1:** - WRONG RESULTS
```
scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala> df2.show(40,false)
+---------------------------------------+                                       
|sum(decNum)                            |
+---------------------------------------+
|20000000000000000000.000000000000000000|
+---------------------------------------+
```

--
**Before fix: Scenario2:  Setting spark.sql.ansi.enabled to true** - WRONG RESULTS
```
scala> spark.conf.set(""spark.sql.ansi.enabled"", ""true"")

scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala> df2.show(40,false)
+---------------------------------------+
|sum(decNum)                            |
+---------------------------------------+
|20000000000000000000.000000000000000000|
+---------------------------------------+


```


**After the fix: Scenario1:**  
```
scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala>  df2.show(40,false)
+-----------+                                                                   
|sum(decNum)|
+-----------+
|null       |
+-----------+

```

**After fix:  Scenario2:  Setting the spark.sql.ansi.enabled to true:** 
```
scala> spark.conf.set(""spark.sql.ansi.enabled"", ""true"")

scala> val df = Seq(
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 1),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2),
     |  (BigDecimal(""10000000000000000000""), 2)).toDF(""decNum"", ""intNum"")
df: org.apache.spark.sql.DataFrame = [decNum: decimal(38,18), intNum: int]

scala> val df2 = df.withColumnRenamed(""decNum"", ""decNum2"").join(df, ""intNum"").agg(sum(""decNum""))
df2: org.apache.spark.sql.DataFrame = [sum(decNum): decimal(38,18)]

scala>  df2.show(40,false)
20/02/18 10:57:43 ERROR Executor: Exception in task 5.0 in stage 4.0 (TID 30)
java.lang.ArithmeticException: Decimal(expanded,100000000000000000000.000000000000000000,39,18}) cannot be represented as Decimal(38, 18).

```

### Why are the changes needed?
The changes are needed in order to fix the wrong results that are returned for decimal aggregate sum.

### Does this PR introduce any user-facing change?
User would see wrong results on aggregate sum that involved decimal overflow prior to this change, but now the user will see null.  But if user enables the spark.sql.ansi.enabled flag to true, then the user will see an exception and not incorrect results. 

### How was this patch tested?
New test has been added and existing tests for sql, catalyst and hive suites were run ok.
",2020-02-18T20:40:36Z,2020-04-09T07:51:00Z,,,d51a83b736c3192991063b5e8015e50e1b23c6a5,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27627/commits,https://api.github.com/repos/apache/spark/pulls/27627/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27627/comments,https://api.github.com/repos/apache/spark/statuses/a1fae7ba13e6495c5008d07c4514bc3106b5735a,CONTRIBUTOR,spark,apache,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,skambha:decaggfixwrongresults,decaggfixwrongresults,a1fae7ba13e6495c5008d07c4514bc3106b5735a,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,49237548,MDEwOlJlcG9zaXRvcnk0OTIzNzU0OA==,spark,skambha/spark,False,skambha,16563220,MDQ6VXNlcjE2NTYzMjIw,https://avatars3.githubusercontent.com/u/16563220?v=4,,https://api.github.com/users/skambha,https://github.com/skambha,https://api.github.com/users/skambha/followers,https://api.github.com/users/skambha/following{/other_user},https://api.github.com/users/skambha/gists{/gist_id},https://api.github.com/users/skambha/starred{/owner}{/repo},https://api.github.com/users/skambha/subscriptions,https://api.github.com/users/skambha/orgs,https://api.github.com/users/skambha/repos,https://api.github.com/users/skambha/events{/privacy},https://api.github.com/users/skambha/received_events,User,False,https://github.com/skambha/spark,Mirror of Apache Spark,True,https://api.github.com/repos/skambha/spark,https://api.github.com/repos/skambha/spark/forks,https://api.github.com/repos/skambha/spark/keys{/key_id},https://api.github.com/repos/skambha/spark/collaborators{/collaborator},https://api.github.com/repos/skambha/spark/teams,https://api.github.com/repos/skambha/spark/hooks,https://api.github.com/repos/skambha/spark/issues/events{/number},https://api.github.com/repos/skambha/spark/events,https://api.github.com/repos/skambha/spark/assignees{/user},https://api.github.com/repos/skambha/spark/branches{/branch},https://api.github.com/repos/skambha/spark/tags,https://api.github.com/repos/skambha/spark/git/blobs{/sha},https://api.github.com/repos/skambha/spark/git/tags{/sha},https://api.github.com/repos/skambha/spark/git/refs{/sha},https://api.github.com/repos/skambha/spark/git/trees{/sha},https://api.github.com/repos/skambha/spark/statuses/{sha},https://api.github.com/repos/skambha/spark/languages,https://api.github.com/repos/skambha/spark/stargazers,https://api.github.com/repos/skambha/spark/contributors,https://api.github.com/repos/skambha/spark/subscribers,https://api.github.com/repos/skambha/spark/subscription,https://api.github.com/repos/skambha/spark/commits{/sha},https://api.github.com/repos/skambha/spark/git/commits{/sha},https://api.github.com/repos/skambha/spark/comments{/number},https://api.github.com/repos/skambha/spark/issues/comments{/number},https://api.github.com/repos/skambha/spark/contents/{+path},https://api.github.com/repos/skambha/spark/compare/{base}...{head},https://api.github.com/repos/skambha/spark/merges,https://api.github.com/repos/skambha/spark/{archive_format}{/ref},https://api.github.com/repos/skambha/spark/downloads,https://api.github.com/repos/skambha/spark/issues{/number},https://api.github.com/repos/skambha/spark/pulls{/number},https://api.github.com/repos/skambha/spark/milestones{/number},"https://api.github.com/repos/skambha/spark/notifications{?since,all,participating}",https://api.github.com/repos/skambha/spark/labels{/name},https://api.github.com/repos/skambha/spark/releases{/id},https://api.github.com/repos/skambha/spark/deployments,2016-01-07T23:39:32Z,2019-01-29T18:39:30Z,2020-04-08T20:09:33Z,git://github.com/skambha/spark.git,git@github.com:skambha/spark.git,https://github.com/skambha/spark.git,https://github.com/skambha/spark,,305083,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,b56242332dfa2da5ad0c5c388298abd2d751a542,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27627,https://github.com/apache/spark/pull/27627,https://api.github.com/repos/apache/spark/issues/27627,https://api.github.com/repos/apache/spark/issues/27627/comments,https://api.github.com/repos/apache/spark/pulls/27627/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27627/commits,https://api.github.com/repos/apache/spark/statuses/a1fae7ba13e6495c5008d07c4514bc3106b5735a
101,https://api.github.com/repos/apache/spark/pulls/27620,376626549,MDExOlB1bGxSZXF1ZXN0Mzc2NjI2NTQ5,https://github.com/apache/spark/pull/27620,https://github.com/apache/spark/pull/27620.diff,https://github.com/apache/spark/pull/27620.patch,https://api.github.com/repos/apache/spark/issues/27620,27620,open,False,[SPARK-30866][SS] FileStreamSource: Cache fetched list of files beyond maxFilesPerTrigger as unread files,"### What changes were proposed in this pull request?

This patch caches the fetched list of files in FileStreamSource to avoid re-fetching whenever possible.

This improvement would be effective when the source options are being set to below:
 
* `maxFilesPerTrigger` is set
* `latestFirst` is set to `false` (default)

as 

* if `maxFilesPerTrigger` is unset, Spark will process all the new files within a batch
* if `latestFirst` is set to `true`, it intends to process ""latest"" files which Spark has to refresh for every batch

Fetched list of files are filtered against SeenFilesMap before caching - unnecessary files are filtered in this phase. Once we cached the file, we don't check the file again for `isNewFile`, as Spark processes the files in timestamp order so cached files should have equal or later timestamp than latestTimestamp in SeenFilesMap.

Cache is only persisted in memory to simplify the logic - if we support restore cache when restarting query, we should deal with the changes of source options.

This patch will have synergy with SPARK-20568 - while this patch helps to avoid redundant cost of listing, SPARK-20568 will get rid of the cost of listing for processed files. Once the query processes all files in initial load, the cost of listing for the files in initial load will be gone.

### Why are the changes needed?

Spark spends huge cost to fetch the list of files from input paths, but restricts the usage of list in a batch. If the streaming query starts from huge input data for various reasons (initial load, reprocessing, etc.) the cost to fetch the files will be applied to all batches as it is unusual to let first microbatch to process all of initial load.

SPARK-20568 will help to reduce the cost to fetch as processed files will be either deleted or moved outside of input paths, but it still won't help in early phase.

### Does this PR introduce any user-facing change?

Yes, the driver process would require more memory than before if maxFilesPerTrigger is set and latestFirst is set to ""false"" to cache fetched files. Previously Spark only takes some amount from left side of the list and discards remaining - so technically the peak memory would be same, but they can be freed sooner.

It may not hurt much, as peak memory is still be similar, and it would require similar amount of memory in any way when maxFilesPerTrigger is unset.

### How was this patch tested?

New unit tests. Manually tested under the test environment:

* input files
  * 171,839 files distributed evenly into 24 directories
  * each file contains 200 lines
* query: read from the ""file stream source"" and repartition to 50, and write to the ""file stream sink""
  * maxFilesPerTrigger is set to 100

> before applying the patch

![Screen Shot 2020-02-18 at 11 53 12 PM](https://user-images.githubusercontent.com/1317309/74747932-139a8380-52ab-11ea-8920-26a40070ec32.png)

> after applying the patch

![Screen Shot 2020-02-18 at 11 56 01 PM](https://user-images.githubusercontent.com/1317309/74747860-f5cd1e80-52aa-11ea-89dd-da24e9f6ab00.png)

The area of brown color represents ""latestOffset"" where listing operation is performed for FileStreamSource. After the patch the cost for listing is paid ""only once"", whereas before the patch 
it was for ""every batch"".",2020-02-18T13:46:33Z,2020-02-28T07:19:05Z,,,868706c6869bbc6abac5cfd6b9ad3670ebb9802a,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27620/commits,https://api.github.com/repos/apache/spark/pulls/27620/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27620/comments,https://api.github.com/repos/apache/spark/statuses/b417911356356d35abbad768bf583b55a36d25cf,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30866,SPARK-30866,b417911356356d35abbad768bf583b55a36d25cf,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,68d7edf9497bea2f73707d32ab55dd8e53088e7c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27620,https://github.com/apache/spark/pull/27620,https://api.github.com/repos/apache/spark/issues/27620,https://api.github.com/repos/apache/spark/issues/27620/comments,https://api.github.com/repos/apache/spark/pulls/27620/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27620/commits,https://api.github.com/repos/apache/spark/statuses/b417911356356d35abbad768bf583b55a36d25cf
102,https://api.github.com/repos/apache/spark/pulls/27617,376442939,MDExOlB1bGxSZXF1ZXN0Mzc2NDQyOTM5,https://github.com/apache/spark/pull/27617,https://github.com/apache/spark/pull/27617.diff,https://github.com/apache/spark/pull/27617.patch,https://api.github.com/repos/apache/spark/issues/27617,27617,open,False,[SPARK-30865][SQL] Refactor DateTimeUtils,"### What changes were proposed in this pull request?

1. Move TimeZoneUTC and TimeZoneGMT to DateTimeTestUtils
2. Remove TimeZoneGMT
3. Use ZoneId.systemDefault() instead of defaultTimeZone().toZoneId
4. Alias SQLDate & SQLTimestamp to internal types of DateType and TimestampType

### Why are the changes needed?

This simplifies the common code related to date-time operations, and should improve maintainability. In particular:
 
1. TimeZoneUTC and TimeZoneGMT are moved to DateTimeTestUtils because they are used only in tests
2. TimeZoneGMT can be removed because it is equal to TimeZoneUTC
3. After the PR #27494, Spark expressions and DateTimeUtils functions switched to ZoneId instead of TimeZone completely. `defaultTimeZone()` with `TimeZone` as return type is not needed anymore.
4. SQLDate and SQLTimestamp types can be explicitly aliased to internal types of DateType and and TimestampType instead of declaring this in a comment.

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
By existing test suites
",2020-02-18T06:38:00Z,2020-04-10T22:14:06Z,,,d4f96996f88d1cec14848aed286fbc3d44135357,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27617/commits,https://api.github.com/repos/apache/spark/pulls/27617/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27617/comments,https://api.github.com/repos/apache/spark/statuses/32159484c0a27def8e9b03532047f8d942797743,CONTRIBUTOR,spark,apache,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,MaxGekk:move-time-zone-consts,move-time-zone-consts,32159484c0a27def8e9b03532047f8d942797743,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,123690489,MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=,spark,MaxGekk/spark,False,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,https://github.com/MaxGekk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/MaxGekk/spark,https://api.github.com/repos/MaxGekk/spark/forks,https://api.github.com/repos/MaxGekk/spark/keys{/key_id},https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator},https://api.github.com/repos/MaxGekk/spark/teams,https://api.github.com/repos/MaxGekk/spark/hooks,https://api.github.com/repos/MaxGekk/spark/issues/events{/number},https://api.github.com/repos/MaxGekk/spark/events,https://api.github.com/repos/MaxGekk/spark/assignees{/user},https://api.github.com/repos/MaxGekk/spark/branches{/branch},https://api.github.com/repos/MaxGekk/spark/tags,https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha},https://api.github.com/repos/MaxGekk/spark/git/tags{/sha},https://api.github.com/repos/MaxGekk/spark/git/refs{/sha},https://api.github.com/repos/MaxGekk/spark/git/trees{/sha},https://api.github.com/repos/MaxGekk/spark/statuses/{sha},https://api.github.com/repos/MaxGekk/spark/languages,https://api.github.com/repos/MaxGekk/spark/stargazers,https://api.github.com/repos/MaxGekk/spark/contributors,https://api.github.com/repos/MaxGekk/spark/subscribers,https://api.github.com/repos/MaxGekk/spark/subscription,https://api.github.com/repos/MaxGekk/spark/commits{/sha},https://api.github.com/repos/MaxGekk/spark/git/commits{/sha},https://api.github.com/repos/MaxGekk/spark/comments{/number},https://api.github.com/repos/MaxGekk/spark/issues/comments{/number},https://api.github.com/repos/MaxGekk/spark/contents/{+path},https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head},https://api.github.com/repos/MaxGekk/spark/merges,https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref},https://api.github.com/repos/MaxGekk/spark/downloads,https://api.github.com/repos/MaxGekk/spark/issues{/number},https://api.github.com/repos/MaxGekk/spark/pulls{/number},https://api.github.com/repos/MaxGekk/spark/milestones{/number},"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}",https://api.github.com/repos/MaxGekk/spark/labels{/name},https://api.github.com/repos/MaxGekk/spark/releases{/id},https://api.github.com/repos/MaxGekk/spark/deployments,2018-03-03T12:37:00Z,2020-04-10T19:15:57Z,2020-04-10T20:37:52Z,git://github.com/MaxGekk/spark.git,git@github.com:MaxGekk/spark.git,https://github.com/MaxGekk/spark.git,https://github.com/MaxGekk/spark,,325420,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,2d3692ed45affb4a0583c684b5167fd6bdff5b55,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27617,https://github.com/apache/spark/pull/27617,https://api.github.com/repos/apache/spark/issues/27617,https://api.github.com/repos/apache/spark/issues/27617/comments,https://api.github.com/repos/apache/spark/pulls/27617/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27617/commits,https://api.github.com/repos/apache/spark/statuses/32159484c0a27def8e9b03532047f8d942797743
103,https://api.github.com/repos/apache/spark/pulls/27604,376081184,MDExOlB1bGxSZXF1ZXN0Mzc2MDgxMTg0,https://github.com/apache/spark/pull/27604,https://github.com/apache/spark/pull/27604.diff,https://github.com/apache/spark/pull/27604.patch,https://api.github.com/repos/apache/spark/issues/27604,27604,open,False,[SPARK-30849][CORE][SHUFFLE]Fix application failed due to failed to get MapStatuses broadcast block,"

### What changes were proposed in this pull request?

As described in [SPARK-30849](https://issues.apache.org/jira/browse/SPARK-30849), spark application will sometimes failed due to failed to get mapStatuses broadcast block. 
```
Job aborted due to stage failure: Task 18 in stage 2.0 failed 4 times, most recent failure: Lost task 18.3 in stage 2.0 (TID 13819, xxxx , executor 8): java.io.IOException: org.apache.spark.SparkException: Failed to get broadcast_9_piece1 of broadcast_9
java.io.IOException: org.apache.spark.SparkException: Failed to get broadcast_9_piece1 of broadcast_9
	at org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1287)
	at org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:206)
	at org.apache.spark.broadcast.TorrentBroadcast._value$lzycompute(TorrentBroadcast.scala:66)
	at org.apache.spark.broadcast.TorrentBroadcast._value(TorrentBroadcast.scala:66)
	at org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:96)
	at org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)
	at org.apache.spark.MapOutputTracker$$anonfun$deserializeMapStatuses$1.apply(MapOutputTracker.scala:775)
	at org.apache.spark.MapOutputTracker$$anonfun$deserializeMapStatuses$1.apply(MapOutputTracker.scala:775)
	at org.apache.spark.internal.Logging$class.logInfo(Logging.scala:54)
	at org.apache.spark.MapOutputTracker$.logInfo(MapOutputTracker.scala:712)
	at org.apache.spark.MapOutputTracker$.deserializeMapStatuses(MapOutputTracker.scala:774)
	at org.apache.spark.MapOutputTrackerWorker.getStatuses(MapOutputTracker.scala:665)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:603)
	at org.apache.spark.shuffle.BlockStoreShuffleReader.read(BlockStoreShuffleReader.scala:57)
	at org.apache.spark.rdd.ShuffledRDD.compute(ShuffledRDD.scala:109)
```
This is caused by the mapStatuses broadcast id is sent to executor, but was invalidated immediately by the driver before the real fetching of the broadcast.

This PR will try to fix this issue.


### Why are the changes needed?
Bugfix


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
UT
",2020-02-17T11:15:12Z,2020-03-24T00:33:36Z,,,874dcec5e4a57f47f472dc79e261ed5c94630edb,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27604/commits,https://api.github.com/repos/apache/spark/pulls/27604/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27604/comments,https://api.github.com/repos/apache/spark/statuses/c8826c18006c07145e86bc22fdd7227b9c608515,NONE,spark,apache,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,liupc:SPARK-30849,SPARK-30849,c8826c18006c07145e86bc22fdd7227b9c608515,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,75380071,MDEwOlJlcG9zaXRvcnk3NTM4MDA3MQ==,spark,liupc/spark,False,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,https://github.com/liupc/spark,Mirror of Apache Spark,True,https://api.github.com/repos/liupc/spark,https://api.github.com/repos/liupc/spark/forks,https://api.github.com/repos/liupc/spark/keys{/key_id},https://api.github.com/repos/liupc/spark/collaborators{/collaborator},https://api.github.com/repos/liupc/spark/teams,https://api.github.com/repos/liupc/spark/hooks,https://api.github.com/repos/liupc/spark/issues/events{/number},https://api.github.com/repos/liupc/spark/events,https://api.github.com/repos/liupc/spark/assignees{/user},https://api.github.com/repos/liupc/spark/branches{/branch},https://api.github.com/repos/liupc/spark/tags,https://api.github.com/repos/liupc/spark/git/blobs{/sha},https://api.github.com/repos/liupc/spark/git/tags{/sha},https://api.github.com/repos/liupc/spark/git/refs{/sha},https://api.github.com/repos/liupc/spark/git/trees{/sha},https://api.github.com/repos/liupc/spark/statuses/{sha},https://api.github.com/repos/liupc/spark/languages,https://api.github.com/repos/liupc/spark/stargazers,https://api.github.com/repos/liupc/spark/contributors,https://api.github.com/repos/liupc/spark/subscribers,https://api.github.com/repos/liupc/spark/subscription,https://api.github.com/repos/liupc/spark/commits{/sha},https://api.github.com/repos/liupc/spark/git/commits{/sha},https://api.github.com/repos/liupc/spark/comments{/number},https://api.github.com/repos/liupc/spark/issues/comments{/number},https://api.github.com/repos/liupc/spark/contents/{+path},https://api.github.com/repos/liupc/spark/compare/{base}...{head},https://api.github.com/repos/liupc/spark/merges,https://api.github.com/repos/liupc/spark/{archive_format}{/ref},https://api.github.com/repos/liupc/spark/downloads,https://api.github.com/repos/liupc/spark/issues{/number},https://api.github.com/repos/liupc/spark/pulls{/number},https://api.github.com/repos/liupc/spark/milestones{/number},"https://api.github.com/repos/liupc/spark/notifications{?since,all,participating}",https://api.github.com/repos/liupc/spark/labels{/name},https://api.github.com/repos/liupc/spark/releases{/id},https://api.github.com/repos/liupc/spark/deployments,2016-12-02T09:14:58Z,2019-07-01T03:12:23Z,2020-03-22T08:20:48Z,git://github.com/liupc/spark.git,git@github.com:liupc/spark.git,https://github.com/liupc/spark.git,https://github.com/liupc/spark,,311628,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,29b3e427794b04a6113f04189cc503fa5bb18666,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27604,https://github.com/apache/spark/pull/27604,https://api.github.com/repos/apache/spark/issues/27604,https://api.github.com/repos/apache/spark/issues/27604/comments,https://api.github.com/repos/apache/spark/pulls/27604/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27604/commits,https://api.github.com/repos/apache/spark/statuses/c8826c18006c07145e86bc22fdd7227b9c608515
104,https://api.github.com/repos/apache/spark/pulls/27598,375873657,MDExOlB1bGxSZXF1ZXN0Mzc1ODczNjU3,https://github.com/apache/spark/pull/27598,https://github.com/apache/spark/pull/27598.diff,https://github.com/apache/spark/pull/27598.patch,https://api.github.com/repos/apache/spark/issues/27598,27598,open,False,[SPARK-30845] Do not upload local pyspark archives for spark-submit on Yarn,"### What changes were proposed in this pull request?
Use spark-submit to submit a pyspark app on Yarn, and set this in spark-env.sh:
export PYSPARK_ARCHIVES_PATH=local:/opt/spark/python/lib/pyspark.zip,local:/opt/spark/python/lib/py4j-0.10.7-src.zip

You can see that these local archives are still uploaded to Yarn distributed cache:
yarn.Client: Uploading resource file:/opt/spark/python/lib/pyspark.zip -> hdfs://myhdfs/user/test1/.sparkStaging/application_1581024490249_0001/pyspark.zip

This PR fix this issue by checking the files specified in PYSPARK_ARCHIVES_PATH, if they are local archives, don't distribute to Yarn dist cache.

### Why are the changes needed?
For pyspark appp to support local pyspark archives set in PYSPARK_ARCHIVES_PATH.

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
Existing tests and manual tests.",2020-02-16T21:12:12Z,2020-02-28T07:19:09Z,,,1bd2ce9181b76c2e4934bafda793a0c3b6435212,,[],[],[],"[{'id': 1445212545, 'node_id': 'MDU6TGFiZWwxNDQ1MjEyNTQ1', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20SUBMIT', 'name': 'SPARK SUBMIT', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27598/commits,https://api.github.com/repos/apache/spark/pulls/27598/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27598/comments,https://api.github.com/repos/apache/spark/statuses/f2128488409f671c4be096a5af6e9c16a01b7a2f,CONTRIBUTOR,spark,apache,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,shanyu:shanyu-30845,shanyu-30845,f2128488409f671c4be096a5af6e9c16a01b7a2f,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,40154439,MDEwOlJlcG9zaXRvcnk0MDE1NDQzOQ==,spark,shanyu/spark,False,shanyu,1181711,MDQ6VXNlcjExODE3MTE=,https://avatars0.githubusercontent.com/u/1181711?v=4,,https://api.github.com/users/shanyu,https://github.com/shanyu,https://api.github.com/users/shanyu/followers,https://api.github.com/users/shanyu/following{/other_user},https://api.github.com/users/shanyu/gists{/gist_id},https://api.github.com/users/shanyu/starred{/owner}{/repo},https://api.github.com/users/shanyu/subscriptions,https://api.github.com/users/shanyu/orgs,https://api.github.com/users/shanyu/repos,https://api.github.com/users/shanyu/events{/privacy},https://api.github.com/users/shanyu/received_events,User,False,https://github.com/shanyu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/shanyu/spark,https://api.github.com/repos/shanyu/spark/forks,https://api.github.com/repos/shanyu/spark/keys{/key_id},https://api.github.com/repos/shanyu/spark/collaborators{/collaborator},https://api.github.com/repos/shanyu/spark/teams,https://api.github.com/repos/shanyu/spark/hooks,https://api.github.com/repos/shanyu/spark/issues/events{/number},https://api.github.com/repos/shanyu/spark/events,https://api.github.com/repos/shanyu/spark/assignees{/user},https://api.github.com/repos/shanyu/spark/branches{/branch},https://api.github.com/repos/shanyu/spark/tags,https://api.github.com/repos/shanyu/spark/git/blobs{/sha},https://api.github.com/repos/shanyu/spark/git/tags{/sha},https://api.github.com/repos/shanyu/spark/git/refs{/sha},https://api.github.com/repos/shanyu/spark/git/trees{/sha},https://api.github.com/repos/shanyu/spark/statuses/{sha},https://api.github.com/repos/shanyu/spark/languages,https://api.github.com/repos/shanyu/spark/stargazers,https://api.github.com/repos/shanyu/spark/contributors,https://api.github.com/repos/shanyu/spark/subscribers,https://api.github.com/repos/shanyu/spark/subscription,https://api.github.com/repos/shanyu/spark/commits{/sha},https://api.github.com/repos/shanyu/spark/git/commits{/sha},https://api.github.com/repos/shanyu/spark/comments{/number},https://api.github.com/repos/shanyu/spark/issues/comments{/number},https://api.github.com/repos/shanyu/spark/contents/{+path},https://api.github.com/repos/shanyu/spark/compare/{base}...{head},https://api.github.com/repos/shanyu/spark/merges,https://api.github.com/repos/shanyu/spark/{archive_format}{/ref},https://api.github.com/repos/shanyu/spark/downloads,https://api.github.com/repos/shanyu/spark/issues{/number},https://api.github.com/repos/shanyu/spark/pulls{/number},https://api.github.com/repos/shanyu/spark/milestones{/number},"https://api.github.com/repos/shanyu/spark/notifications{?since,all,participating}",https://api.github.com/repos/shanyu/spark/labels{/name},https://api.github.com/repos/shanyu/spark/releases{/id},https://api.github.com/repos/shanyu/spark/deployments,2015-08-04T00:23:30Z,2020-03-04T01:26:37Z,2020-03-07T21:12:11Z,git://github.com/shanyu/spark.git,git@github.com:shanyu/spark.git,https://github.com/shanyu/spark.git,https://github.com/shanyu/spark,,297505,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8ebbf85a85f7327a97e0c64315f266459b39dbe7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27598,https://github.com/apache/spark/pull/27598,https://api.github.com/repos/apache/spark/issues/27598,https://api.github.com/repos/apache/spark/issues/27598/comments,https://api.github.com/repos/apache/spark/pulls/27598/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27598/commits,https://api.github.com/repos/apache/spark/statuses/f2128488409f671c4be096a5af6e9c16a01b7a2f
105,https://api.github.com/repos/apache/spark/pulls/27588,375567212,MDExOlB1bGxSZXF1ZXN0Mzc1NTY3MjEy,https://github.com/apache/spark/pull/27588,https://github.com/apache/spark/pull/27588.diff,https://github.com/apache/spark/pull/27588.patch,https://api.github.com/repos/apache/spark/issues/27588,27588,open,False,[BACKPORT] Backport of [SPARK-20628][CORE][K8S] Start to improve decommissioning,"This is a work in progress backport of https://github.com/apache/spark/pull/26440/files/15179e5046503815e1b4796126bd24f14351239b#diff-5de3e51dce83ad7e87e0e12db0e0be4f
We've had a bit of discussion on the mailing list but didn't hear any strong opinions at that time http://apache-spark-developers-list.1001551.n3.nabble.com/Initial-Decom-PR-for-Spark-3-td28821.html",2020-02-14T20:48:08Z,2020-03-26T07:08:06Z,,,8dd73fae634b6f5eeb020f6f6782569fd675ba4c,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27588/commits,https://api.github.com/repos/apache/spark/pulls/27588/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27588/comments,https://api.github.com/repos/apache/spark/statuses/7404cf8cff46ea94f71a38a3a819329f6f2273d6,CONTRIBUTOR,spark,apache,holdenk,59893,MDQ6VXNlcjU5ODkz,https://avatars1.githubusercontent.com/u/59893?v=4,,https://api.github.com/users/holdenk,https://github.com/holdenk,https://api.github.com/users/holdenk/followers,https://api.github.com/users/holdenk/following{/other_user},https://api.github.com/users/holdenk/gists{/gist_id},https://api.github.com/users/holdenk/starred{/owner}{/repo},https://api.github.com/users/holdenk/subscriptions,https://api.github.com/users/holdenk/orgs,https://api.github.com/users/holdenk/repos,https://api.github.com/users/holdenk/events{/privacy},https://api.github.com/users/holdenk/received_events,User,False,holdenk:spark-3-backport-SPARK-20628-keep-track-of-nodes-which-are-going-to-be-shutdown-r4,spark-3-backport-SPARK-20628-keep-track-of-nodes-which-are-going-to-be-shutdown-r4,7404cf8cff46ea94f71a38a3a819329f6f2273d6,holdenk,59893,MDQ6VXNlcjU5ODkz,https://avatars1.githubusercontent.com/u/59893?v=4,,https://api.github.com/users/holdenk,https://github.com/holdenk,https://api.github.com/users/holdenk/followers,https://api.github.com/users/holdenk/following{/other_user},https://api.github.com/users/holdenk/gists{/gist_id},https://api.github.com/users/holdenk/starred{/owner}{/repo},https://api.github.com/users/holdenk/subscriptions,https://api.github.com/users/holdenk/orgs,https://api.github.com/users/holdenk/repos,https://api.github.com/users/holdenk/events{/privacy},https://api.github.com/users/holdenk/received_events,User,False,17235154,MDEwOlJlcG9zaXRvcnkxNzIzNTE1NA==,spark,holdenk/spark,False,holdenk,59893,MDQ6VXNlcjU5ODkz,https://avatars1.githubusercontent.com/u/59893?v=4,,https://api.github.com/users/holdenk,https://github.com/holdenk,https://api.github.com/users/holdenk/followers,https://api.github.com/users/holdenk/following{/other_user},https://api.github.com/users/holdenk/gists{/gist_id},https://api.github.com/users/holdenk/starred{/owner}{/repo},https://api.github.com/users/holdenk/subscriptions,https://api.github.com/users/holdenk/orgs,https://api.github.com/users/holdenk/repos,https://api.github.com/users/holdenk/events{/privacy},https://api.github.com/users/holdenk/received_events,User,False,https://github.com/holdenk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/holdenk/spark,https://api.github.com/repos/holdenk/spark/forks,https://api.github.com/repos/holdenk/spark/keys{/key_id},https://api.github.com/repos/holdenk/spark/collaborators{/collaborator},https://api.github.com/repos/holdenk/spark/teams,https://api.github.com/repos/holdenk/spark/hooks,https://api.github.com/repos/holdenk/spark/issues/events{/number},https://api.github.com/repos/holdenk/spark/events,https://api.github.com/repos/holdenk/spark/assignees{/user},https://api.github.com/repos/holdenk/spark/branches{/branch},https://api.github.com/repos/holdenk/spark/tags,https://api.github.com/repos/holdenk/spark/git/blobs{/sha},https://api.github.com/repos/holdenk/spark/git/tags{/sha},https://api.github.com/repos/holdenk/spark/git/refs{/sha},https://api.github.com/repos/holdenk/spark/git/trees{/sha},https://api.github.com/repos/holdenk/spark/statuses/{sha},https://api.github.com/repos/holdenk/spark/languages,https://api.github.com/repos/holdenk/spark/stargazers,https://api.github.com/repos/holdenk/spark/contributors,https://api.github.com/repos/holdenk/spark/subscribers,https://api.github.com/repos/holdenk/spark/subscription,https://api.github.com/repos/holdenk/spark/commits{/sha},https://api.github.com/repos/holdenk/spark/git/commits{/sha},https://api.github.com/repos/holdenk/spark/comments{/number},https://api.github.com/repos/holdenk/spark/issues/comments{/number},https://api.github.com/repos/holdenk/spark/contents/{+path},https://api.github.com/repos/holdenk/spark/compare/{base}...{head},https://api.github.com/repos/holdenk/spark/merges,https://api.github.com/repos/holdenk/spark/{archive_format}{/ref},https://api.github.com/repos/holdenk/spark/downloads,https://api.github.com/repos/holdenk/spark/issues{/number},https://api.github.com/repos/holdenk/spark/pulls{/number},https://api.github.com/repos/holdenk/spark/milestones{/number},"https://api.github.com/repos/holdenk/spark/notifications{?since,all,participating}",https://api.github.com/repos/holdenk/spark/labels{/name},https://api.github.com/repos/holdenk/spark/releases{/id},https://api.github.com/repos/holdenk/spark/deployments,2014-02-27T03:28:28Z,2020-02-23T03:28:39Z,2020-04-06T22:07:48Z,git://github.com/holdenk/spark.git,git@github.com:holdenk/spark.git,https://github.com/holdenk/spark.git,https://github.com/holdenk/spark,,326048,7,7,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,7,master,apache:branch-3.0,branch-3.0,1385fc02ce7d28e6570971e1687e74d245a5533f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27588,https://github.com/apache/spark/pull/27588,https://api.github.com/repos/apache/spark/issues/27588,https://api.github.com/repos/apache/spark/issues/27588/comments,https://api.github.com/repos/apache/spark/pulls/27588/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27588/commits,https://api.github.com/repos/apache/spark/statuses/7404cf8cff46ea94f71a38a3a819329f6f2273d6
106,https://api.github.com/repos/apache/spark/pulls/27578,375271449,MDExOlB1bGxSZXF1ZXN0Mzc1MjcxNDQ5,https://github.com/apache/spark/pull/27578,https://github.com/apache/spark/pull/27578.diff,https://github.com/apache/spark/pull/27578.patch,https://api.github.com/repos/apache/spark/issues/27578,27578,open,False,[WIP][SPARK-30828][SQL] Improving insertInto behaviour,"
### What changes were proposed in this pull request?
The only change is that I've added a column check when using insertInto. Now it checks that the query dataFrame has the same column names as the target table.


### Why are the changes needed?
They are needed because it helps a lot when you have a lot of columns, and if you have one missing the current message doesn't tell you which one. 
Also insertInto just check that the number of columns of both are the same, but not the order or anything.


### Does this PR introduce any user-facing change?
No

### How was this patch tested?
I added a test case just to show the new behaviour, obviously there will be more test added depending on the comments

Jira -> https://issues.apache.org/jira/browse/SPARK-30828
",2020-02-14T08:36:34Z,2020-03-02T07:31:36Z,,,c4086277fd5387068e1ac796a5376909bad141aa,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27578/commits,https://api.github.com/repos/apache/spark/pulls/27578/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27578/comments,https://api.github.com/repos/apache/spark/statuses/785405ff9776f7a19aaf4bd8b5d4d85c85c08d3a,CONTRIBUTOR,spark,apache,Gschiavon,11851009,MDQ6VXNlcjExODUxMDA5,https://avatars3.githubusercontent.com/u/11851009?v=4,,https://api.github.com/users/Gschiavon,https://github.com/Gschiavon,https://api.github.com/users/Gschiavon/followers,https://api.github.com/users/Gschiavon/following{/other_user},https://api.github.com/users/Gschiavon/gists{/gist_id},https://api.github.com/users/Gschiavon/starred{/owner}{/repo},https://api.github.com/users/Gschiavon/subscriptions,https://api.github.com/users/Gschiavon/orgs,https://api.github.com/users/Gschiavon/repos,https://api.github.com/users/Gschiavon/events{/privacy},https://api.github.com/users/Gschiavon/received_events,User,False,Gschiavon:improve-insertinto-behaviour,improve-insertinto-behaviour,785405ff9776f7a19aaf4bd8b5d4d85c85c08d3a,Gschiavon,11851009,MDQ6VXNlcjExODUxMDA5,https://avatars3.githubusercontent.com/u/11851009?v=4,,https://api.github.com/users/Gschiavon,https://github.com/Gschiavon,https://api.github.com/users/Gschiavon/followers,https://api.github.com/users/Gschiavon/following{/other_user},https://api.github.com/users/Gschiavon/gists{/gist_id},https://api.github.com/users/Gschiavon/starred{/owner}{/repo},https://api.github.com/users/Gschiavon/subscriptions,https://api.github.com/users/Gschiavon/orgs,https://api.github.com/users/Gschiavon/repos,https://api.github.com/users/Gschiavon/events{/privacy},https://api.github.com/users/Gschiavon/received_events,User,False,94520604,MDEwOlJlcG9zaXRvcnk5NDUyMDYwNA==,spark,Gschiavon/spark,False,Gschiavon,11851009,MDQ6VXNlcjExODUxMDA5,https://avatars3.githubusercontent.com/u/11851009?v=4,,https://api.github.com/users/Gschiavon,https://github.com/Gschiavon,https://api.github.com/users/Gschiavon/followers,https://api.github.com/users/Gschiavon/following{/other_user},https://api.github.com/users/Gschiavon/gists{/gist_id},https://api.github.com/users/Gschiavon/starred{/owner}{/repo},https://api.github.com/users/Gschiavon/subscriptions,https://api.github.com/users/Gschiavon/orgs,https://api.github.com/users/Gschiavon/repos,https://api.github.com/users/Gschiavon/events{/privacy},https://api.github.com/users/Gschiavon/received_events,User,False,https://github.com/Gschiavon/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Gschiavon/spark,https://api.github.com/repos/Gschiavon/spark/forks,https://api.github.com/repos/Gschiavon/spark/keys{/key_id},https://api.github.com/repos/Gschiavon/spark/collaborators{/collaborator},https://api.github.com/repos/Gschiavon/spark/teams,https://api.github.com/repos/Gschiavon/spark/hooks,https://api.github.com/repos/Gschiavon/spark/issues/events{/number},https://api.github.com/repos/Gschiavon/spark/events,https://api.github.com/repos/Gschiavon/spark/assignees{/user},https://api.github.com/repos/Gschiavon/spark/branches{/branch},https://api.github.com/repos/Gschiavon/spark/tags,https://api.github.com/repos/Gschiavon/spark/git/blobs{/sha},https://api.github.com/repos/Gschiavon/spark/git/tags{/sha},https://api.github.com/repos/Gschiavon/spark/git/refs{/sha},https://api.github.com/repos/Gschiavon/spark/git/trees{/sha},https://api.github.com/repos/Gschiavon/spark/statuses/{sha},https://api.github.com/repos/Gschiavon/spark/languages,https://api.github.com/repos/Gschiavon/spark/stargazers,https://api.github.com/repos/Gschiavon/spark/contributors,https://api.github.com/repos/Gschiavon/spark/subscribers,https://api.github.com/repos/Gschiavon/spark/subscription,https://api.github.com/repos/Gschiavon/spark/commits{/sha},https://api.github.com/repos/Gschiavon/spark/git/commits{/sha},https://api.github.com/repos/Gschiavon/spark/comments{/number},https://api.github.com/repos/Gschiavon/spark/issues/comments{/number},https://api.github.com/repos/Gschiavon/spark/contents/{+path},https://api.github.com/repos/Gschiavon/spark/compare/{base}...{head},https://api.github.com/repos/Gschiavon/spark/merges,https://api.github.com/repos/Gschiavon/spark/{archive_format}{/ref},https://api.github.com/repos/Gschiavon/spark/downloads,https://api.github.com/repos/Gschiavon/spark/issues{/number},https://api.github.com/repos/Gschiavon/spark/pulls{/number},https://api.github.com/repos/Gschiavon/spark/milestones{/number},"https://api.github.com/repos/Gschiavon/spark/notifications{?since,all,participating}",https://api.github.com/repos/Gschiavon/spark/labels{/name},https://api.github.com/repos/Gschiavon/spark/releases{/id},https://api.github.com/repos/Gschiavon/spark/deployments,2017-06-16T08:03:13Z,2018-10-03T14:13:40Z,2020-02-14T08:28:59Z,git://github.com/Gschiavon/spark.git,git@github.com:Gschiavon/spark.git,https://github.com/Gschiavon/spark.git,https://github.com/Gschiavon/spark,,305529,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,b2134ee73cfad4d78aaf8f0a2898011ac0308e48,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27578,https://github.com/apache/spark/pull/27578,https://api.github.com/repos/apache/spark/issues/27578,https://api.github.com/repos/apache/spark/issues/27578/comments,https://api.github.com/repos/apache/spark/pulls/27578/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27578/commits,https://api.github.com/repos/apache/spark/statuses/785405ff9776f7a19aaf4bd8b5d4d85c85c08d3a
107,https://api.github.com/repos/apache/spark/pulls/27568,375086327,MDExOlB1bGxSZXF1ZXN0Mzc1MDg2MzI3,https://github.com/apache/spark/pull/27568,https://github.com/apache/spark/pull/27568.diff,https://github.com/apache/spark/pull/27568.patch,https://api.github.com/repos/apache/spark/issues/27568,27568,open,False,[SPARK-30821][K8S]Handle container failure in executor pods with multiple containers,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
Checking of all containers in the executor pod when reporting executor status.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
A pod remains ""running"" as long as there is at least one running container. This prevents Spark from noticing when a container has failed in an executor pod with multiple containers. If either the executor process or one of its sidecars has failed, it needs to be rescheduled.
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
(not tested yet, will edit later)",2020-02-13T21:02:59Z,2020-03-12T22:52:07Z,,,1198e09001892cddacc8b8f507df06ed3638c453,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27568/commits,https://api.github.com/repos/apache/spark/pulls/27568/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27568/comments,https://api.github.com/repos/apache/spark/statuses/0b89736d7e74e16e9ea6e6b35e5d69e9e32cd944,NONE,spark,apache,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,khogeland:handle-sidecar-failure,handle-sidecar-failure,0b89736d7e74e16e9ea6e6b35e5d69e9e32cd944,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,195895859,MDEwOlJlcG9zaXRvcnkxOTU4OTU4NTk=,spark,khogeland/spark,False,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,https://github.com/khogeland/spark,Apache Spark,True,https://api.github.com/repos/khogeland/spark,https://api.github.com/repos/khogeland/spark/forks,https://api.github.com/repos/khogeland/spark/keys{/key_id},https://api.github.com/repos/khogeland/spark/collaborators{/collaborator},https://api.github.com/repos/khogeland/spark/teams,https://api.github.com/repos/khogeland/spark/hooks,https://api.github.com/repos/khogeland/spark/issues/events{/number},https://api.github.com/repos/khogeland/spark/events,https://api.github.com/repos/khogeland/spark/assignees{/user},https://api.github.com/repos/khogeland/spark/branches{/branch},https://api.github.com/repos/khogeland/spark/tags,https://api.github.com/repos/khogeland/spark/git/blobs{/sha},https://api.github.com/repos/khogeland/spark/git/tags{/sha},https://api.github.com/repos/khogeland/spark/git/refs{/sha},https://api.github.com/repos/khogeland/spark/git/trees{/sha},https://api.github.com/repos/khogeland/spark/statuses/{sha},https://api.github.com/repos/khogeland/spark/languages,https://api.github.com/repos/khogeland/spark/stargazers,https://api.github.com/repos/khogeland/spark/contributors,https://api.github.com/repos/khogeland/spark/subscribers,https://api.github.com/repos/khogeland/spark/subscription,https://api.github.com/repos/khogeland/spark/commits{/sha},https://api.github.com/repos/khogeland/spark/git/commits{/sha},https://api.github.com/repos/khogeland/spark/comments{/number},https://api.github.com/repos/khogeland/spark/issues/comments{/number},https://api.github.com/repos/khogeland/spark/contents/{+path},https://api.github.com/repos/khogeland/spark/compare/{base}...{head},https://api.github.com/repos/khogeland/spark/merges,https://api.github.com/repos/khogeland/spark/{archive_format}{/ref},https://api.github.com/repos/khogeland/spark/downloads,https://api.github.com/repos/khogeland/spark/issues{/number},https://api.github.com/repos/khogeland/spark/pulls{/number},https://api.github.com/repos/khogeland/spark/milestones{/number},"https://api.github.com/repos/khogeland/spark/notifications{?since,all,participating}",https://api.github.com/repos/khogeland/spark/labels{/name},https://api.github.com/repos/khogeland/spark/releases{/id},https://api.github.com/repos/khogeland/spark/deployments,2019-07-08T22:47:12Z,2019-11-11T21:36:32Z,2020-03-12T21:35:07Z,git://github.com/khogeland/spark.git,git@github.com:khogeland/spark.git,https://github.com/khogeland/spark.git,https://github.com/khogeland/spark,,319499,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,74cd46eb691be5dc1cb1c496eeeaa2614945bd98,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27568,https://github.com/apache/spark/pull/27568,https://api.github.com/repos/apache/spark/issues/27568,https://api.github.com/repos/apache/spark/issues/27568/comments,https://api.github.com/repos/apache/spark/pulls/27568/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27568/commits,https://api.github.com/repos/apache/spark/statuses/0b89736d7e74e16e9ea6e6b35e5d69e9e32cd944
108,https://api.github.com/repos/apache/spark/pulls/27557,374673519,MDExOlB1bGxSZXF1ZXN0Mzc0NjczNTE5,https://github.com/apache/spark/pull/27557,https://github.com/apache/spark/pull/27557.diff,https://github.com/apache/spark/pull/27557.patch,https://api.github.com/repos/apache/spark/issues/27557,27557,open,False,"[SPARK-30804][SS] Measure and log elapsed time for ""compact"" operation in CompactibleFileStreamLog","### What changes were proposed in this pull request?

This patch adds some log messages to log elapsed time for ""compact"" operation in FileStreamSourceLog and FileStreamSinkLog (added in CompactibleFileStreamLog) to help investigating the mysterious latency spike during the batch run.

### Why are the changes needed?

Tracking latency is a critical aspect of streaming query. While ""compact"" operation may bring nontrivial latency (it's even synchronous, adding all the latency to the batch run), it's not measured and end users have to guess.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

N/A for UT. Manual test with streaming query using file source & file sink.

> grep ""for compact batch"" <driver log>

```
...
20/02/20 19:27:36 WARN FileStreamSinkLog: Compacting took 24473 ms (load: 14185 ms, write: 10288 ms) for compact batch 21359
20/02/20 19:27:39 WARN FileStreamSinkLog: Loaded 1068000 entries (397985432 bytes in memory), and wrote 1068000 entries for compact batch 21359
20/02/20 19:29:52 WARN FileStreamSourceLog: Compacting took 3777 ms (load: 1524 ms, write: 2253 ms) for compact batch 21369
20/02/20 19:29:52 WARN FileStreamSourceLog: Loaded 229477 entries (68970112 bytes in memory), and wrote 229477 entries for compact batch 21369
20/02/20 19:30:17 WARN FileStreamSinkLog: Compacting took 24183 ms (load: 12992 ms, write: 11191 ms) for compact batch 21369
20/02/20 19:30:20 WARN FileStreamSinkLog: Loaded 1068500 entries (398171880 bytes in memory), and wrote 1068500 entries for compact batch 21369
...
```

![Screen Shot 2020-02-21 at 12 34 22 PM](https://user-images.githubusercontent.com/1317309/75002142-c6830100-54a6-11ea-8da6-17afb056653b.png)

This messages are explaining why the operation duration peaks per every 10 batches which is compact interval. Latency from addBatch heavily increases in each peak which DOES NOT mean it takes more time to write outputs, but we have no idea if such message is not presented.

NOTE: The output may be a bit different from the code, as it may be changed a bit during review phase.",2020-02-13T05:11:57Z,2020-02-28T07:19:19Z,,,b5fd2d410fe426cc985c92e8da48c6cdec1938f0,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27557/commits,https://api.github.com/repos/apache/spark/pulls/27557/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27557/comments,https://api.github.com/repos/apache/spark/statuses/b3b2e763cf395e0579cf53820950c7ee55ea18a3,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30804,SPARK-30804,b3b2e763cf395e0579cf53820950c7ee55ea18a3,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,926e3a1efe9e142804fcbf52146b22700640ae1b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27557,https://github.com/apache/spark/pull/27557,https://api.github.com/repos/apache/spark/issues/27557,https://api.github.com/repos/apache/spark/issues/27557/comments,https://api.github.com/repos/apache/spark/pulls/27557/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27557/commits,https://api.github.com/repos/apache/spark/statuses/b3b2e763cf395e0579cf53820950c7ee55ea18a3
109,https://api.github.com/repos/apache/spark/pulls/27525,373225336,MDExOlB1bGxSZXF1ZXN0MzczMjI1MzM2,https://github.com/apache/spark/pull/27525,https://github.com/apache/spark/pull/27525.diff,https://github.com/apache/spark/pull/27525.patch,https://api.github.com/repos/apache/spark/issues/27525,27525,open,False,update dstream.py with more accurate exceptions,"

### What changes were proposed in this pull request?

The exception messages for dstream.py when using windows were improved to be specific about what sliding duration is important.


### Why are the changes needed?

The batch interval of dstreams are improperly named as sliding windows. The term sliding window is also used to reference the new window of a dstream collected over a window of rdds in a parent dstream. We should probably fix the naming convention of sliding window used in the dstream class, but for now more this more explicit exception message may reduce confusion.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
It wasn't since this is only a change of the exception message
",2020-02-10T16:18:58Z,2020-02-10T16:27:06Z,,,ab9c89945d721fbea9d555d8378e1770d43f12f6,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27525/commits,https://api.github.com/repos/apache/spark/pulls/27525/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27525/comments,https://api.github.com/repos/apache/spark/statuses/3bfc4b1f68566874581ee1d59160f769f16cc95e,NONE,spark,apache,kykrueger,7158199,MDQ6VXNlcjcxNTgxOTk=,https://avatars1.githubusercontent.com/u/7158199?v=4,,https://api.github.com/users/kykrueger,https://github.com/kykrueger,https://api.github.com/users/kykrueger/followers,https://api.github.com/users/kykrueger/following{/other_user},https://api.github.com/users/kykrueger/gists{/gist_id},https://api.github.com/users/kykrueger/starred{/owner}{/repo},https://api.github.com/users/kykrueger/subscriptions,https://api.github.com/users/kykrueger/orgs,https://api.github.com/users/kykrueger/repos,https://api.github.com/users/kykrueger/events{/privacy},https://api.github.com/users/kykrueger/received_events,User,False,kykrueger:kykrueger-patch-1,kykrueger-patch-1,3bfc4b1f68566874581ee1d59160f769f16cc95e,kykrueger,7158199,MDQ6VXNlcjcxNTgxOTk=,https://avatars1.githubusercontent.com/u/7158199?v=4,,https://api.github.com/users/kykrueger,https://github.com/kykrueger,https://api.github.com/users/kykrueger/followers,https://api.github.com/users/kykrueger/following{/other_user},https://api.github.com/users/kykrueger/gists{/gist_id},https://api.github.com/users/kykrueger/starred{/owner}{/repo},https://api.github.com/users/kykrueger/subscriptions,https://api.github.com/users/kykrueger/orgs,https://api.github.com/users/kykrueger/repos,https://api.github.com/users/kykrueger/events{/privacy},https://api.github.com/users/kykrueger/received_events,User,False,239552342,MDEwOlJlcG9zaXRvcnkyMzk1NTIzNDI=,spark,kykrueger/spark,False,kykrueger,7158199,MDQ6VXNlcjcxNTgxOTk=,https://avatars1.githubusercontent.com/u/7158199?v=4,,https://api.github.com/users/kykrueger,https://github.com/kykrueger,https://api.github.com/users/kykrueger/followers,https://api.github.com/users/kykrueger/following{/other_user},https://api.github.com/users/kykrueger/gists{/gist_id},https://api.github.com/users/kykrueger/starred{/owner}{/repo},https://api.github.com/users/kykrueger/subscriptions,https://api.github.com/users/kykrueger/orgs,https://api.github.com/users/kykrueger/repos,https://api.github.com/users/kykrueger/events{/privacy},https://api.github.com/users/kykrueger/received_events,User,False,https://github.com/kykrueger/spark,Apache Spark,True,https://api.github.com/repos/kykrueger/spark,https://api.github.com/repos/kykrueger/spark/forks,https://api.github.com/repos/kykrueger/spark/keys{/key_id},https://api.github.com/repos/kykrueger/spark/collaborators{/collaborator},https://api.github.com/repos/kykrueger/spark/teams,https://api.github.com/repos/kykrueger/spark/hooks,https://api.github.com/repos/kykrueger/spark/issues/events{/number},https://api.github.com/repos/kykrueger/spark/events,https://api.github.com/repos/kykrueger/spark/assignees{/user},https://api.github.com/repos/kykrueger/spark/branches{/branch},https://api.github.com/repos/kykrueger/spark/tags,https://api.github.com/repos/kykrueger/spark/git/blobs{/sha},https://api.github.com/repos/kykrueger/spark/git/tags{/sha},https://api.github.com/repos/kykrueger/spark/git/refs{/sha},https://api.github.com/repos/kykrueger/spark/git/trees{/sha},https://api.github.com/repos/kykrueger/spark/statuses/{sha},https://api.github.com/repos/kykrueger/spark/languages,https://api.github.com/repos/kykrueger/spark/stargazers,https://api.github.com/repos/kykrueger/spark/contributors,https://api.github.com/repos/kykrueger/spark/subscribers,https://api.github.com/repos/kykrueger/spark/subscription,https://api.github.com/repos/kykrueger/spark/commits{/sha},https://api.github.com/repos/kykrueger/spark/git/commits{/sha},https://api.github.com/repos/kykrueger/spark/comments{/number},https://api.github.com/repos/kykrueger/spark/issues/comments{/number},https://api.github.com/repos/kykrueger/spark/contents/{+path},https://api.github.com/repos/kykrueger/spark/compare/{base}...{head},https://api.github.com/repos/kykrueger/spark/merges,https://api.github.com/repos/kykrueger/spark/{archive_format}{/ref},https://api.github.com/repos/kykrueger/spark/downloads,https://api.github.com/repos/kykrueger/spark/issues{/number},https://api.github.com/repos/kykrueger/spark/pulls{/number},https://api.github.com/repos/kykrueger/spark/milestones{/number},"https://api.github.com/repos/kykrueger/spark/notifications{?since,all,participating}",https://api.github.com/repos/kykrueger/spark/labels{/name},https://api.github.com/repos/kykrueger/spark/releases{/id},https://api.github.com/repos/kykrueger/spark/deployments,2020-02-10T16:02:26Z,2020-02-10T16:02:29Z,2020-02-10T16:14:29Z,git://github.com/kykrueger/spark.git,git@github.com:kykrueger/spark.git,https://github.com/kykrueger/spark.git,https://github.com/kykrueger/spark,,320363,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,b2011a295bd78b3693a516e049e90250366b8f52,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27525,https://github.com/apache/spark/pull/27525,https://api.github.com/repos/apache/spark/issues/27525,https://api.github.com/repos/apache/spark/issues/27525/comments,https://api.github.com/repos/apache/spark/pulls/27525/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27525/commits,https://api.github.com/repos/apache/spark/statuses/3bfc4b1f68566874581ee1d59160f769f16cc95e
110,https://api.github.com/repos/apache/spark/pulls/27518,372957956,MDExOlB1bGxSZXF1ZXN0MzcyOTU3OTU2,https://github.com/apache/spark/pull/27518,https://github.com/apache/spark/pull/27518.diff,https://github.com/apache/spark/pull/27518.patch,https://api.github.com/repos/apache/spark/issues/27518,27518,open,False,[SPARK-30768][SQL] Constraints inferred from inequality attributes,"### What changes were proposed in this pull request?

In our production environment, there are many queries similar to this pattern:
```sql
CREATE TABLE spark_30768_1(user_id DECIMAL(18,0), src_cre_dt DATE /*other columns*/);
CREATE TABLE spark_30768_2(user_id DECIMAL(18,0), start_dt DATE, end_dt DATE /*other columns*/);

SELECT spark_30768_1.src_cre_dt /*other columns*/                                                
FROM                                                                            
  spark_30768_1                                                                 
  INNER JOIN spark_30768_2 ON spark_30768_1.user_id = spark_30768_2.user_id     
  AND spark_30768_1.src_cre_dt >= spark_30768_2.start_dt                        
  AND spark_30768_1.src_cre_dt < spark_30768_2.end_dt                           
WHERE spark_30768_1.src_cre_dt BETWEEN date '2020-02-01' AND date '2020-02-07'      
```
In this case, we can infer more constraints to improve query performance. E.g. `spark_30768_2.start_dt <= '2020-02-07'` inferred from `spark_30768_2.start_dt <= spark_30768_1.src_cre_dt <= '2020-02-07'` and `spark_30768_2.end_dt > '2020-02-01'` inferred from `spark_30768_2.end_dt > spark_30768_1.src_cre_dt >= '2020-02-01'`. This PR add support infer these constraints from inequality attributes.

### Why are the changes needed?
Improve query performance.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit test and benchmark test.

Benchmark code and benchmark result:
```scala
import org.apache.spark.benchmark.Benchmark
import org.apache.spark.sql.SaveMode.Overwrite

val numRows = 1024 * 1024
spark.range(numRows).selectExpr(""id as c1"", ""id as c2"").write.saveAsTable(""t1"")
spark.range(numRows).selectExpr(""id as c1"", ""id as c2"").write.saveAsTable(""t2"")

val title = ""Constraints inferred from inequality constraint""
val benchmark = new Benchmark(title, numRows, minNumIters = 5)
benchmark.addCase(s""t1.c1 > ${numRows - 1000}"") { _ =>
  spark.sql(s""select count(*) from t1 join t2 on (t1.c1 > t2.c1 and t2.c1 > ${numRows - 1000})"").write.format(""noop"").mode(Overwrite).save()
}

benchmark.addCase(""t1.c1 < 1000"") { _ =>
  spark.sql(""select count(*) from t1 join t2 on (t1.c1 < t2.c1 and t2.c1 < 1000)"").write.format(""noop"").mode(Overwrite).save()
}
benchmark.run()
```
Before this PR:
```
Java HotSpot(TM) 64-Bit Server VM 1.8.0_191-b12 on Mac OS X 10.13.6
Intel(R) Core(TM) i7-7820HQ CPU @ 2.90GHz
Constraints inferred from inequality constraint:  Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
t1.c1 > 1047576                                   30519          31171         567          0.0       29105.2       1.0X
t1.c1 < 1000                                      50525          50906         331          0.0       48184.7       0.6X
```

After this PR:
```
Java HotSpot(TM) 64-Bit Server VM 1.8.0_191-b12 on Mac OS X 10.13.6
Intel(R) Core(TM) i7-7820HQ CPU @ 2.90GHz
Constraints inferred from inequality constraint:  Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
t1.c1 > 1047576                                     179            191          15          5.9         170.5       1.0X
t1.c1 < 1000                                        175            195          27          6.0         166.7       1.0X
```

Also test this feature in our production environment, it can significantly improve the query performance of at least 6 SQLs (a total of 200 SQLs):

SQL ID | Before this PR(seconds) | After this PR(seconds)
-- | -- | --
323 | 108 | 73
368 | 56 | 26
372 | 72 | 28
373 | 60 | 26
374 | 113 | 44
375 | 82 | 55

For e.g. SQL 372. It prevents (18,413,424,580 - 162,205,133 = 18,251,219,447) rows from participating in shuffle:
Before this PR:
![before](https://user-images.githubusercontent.com/5399861/75850979-8404e100-5e23-11ea-8ea0-9fd4347ac200.png)

After this PR:
![after](https://user-images.githubusercontent.com/5399861/75851328-5704fe00-5e24-11ea-9015-41c63284fafa.png)

",2020-02-10T06:12:36Z,2020-03-20T20:30:07Z,,,b5386b848d17494fe8e6f20f65655f2826f6059e,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27518/commits,https://api.github.com/repos/apache/spark/pulls/27518/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27518/comments,https://api.github.com/repos/apache/spark/statuses/248e3cca6c5f77b768ff738ae5fecc1f9476defb,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-30768,SPARK-30768,248e3cca6c5f77b768ff738ae5fecc1f9476defb,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,ab07c6300c884e772f88694f4b718659c45dbb33,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27518,https://github.com/apache/spark/pull/27518,https://api.github.com/repos/apache/spark/issues/27518,https://api.github.com/repos/apache/spark/issues/27518/comments,https://api.github.com/repos/apache/spark/pulls/27518/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27518/commits,https://api.github.com/repos/apache/spark/statuses/248e3cca6c5f77b768ff738ae5fecc1f9476defb
111,https://api.github.com/repos/apache/spark/pulls/27507,372802777,MDExOlB1bGxSZXF1ZXN0MzcyODAyNzc3,https://github.com/apache/spark/pull/27507,https://github.com/apache/spark/pull/27507.diff,https://github.com/apache/spark/pull/27507.patch,https://api.github.com/repos/apache/spark/issues/27507,27507,open,False,[SPARK-24884][SQL] Support regexp function regexp_extract_all,"### What changes were proposed in this pull request?
`regexp_extract_all` is a very useful function expanded the capabilities of `regexp_extract`.
There are some description of this function.
```
SELECT regexp_extract('1a 2b 14m', '\d+', 0); -- 1
SELECT regexp_extract_all('1a 2b 14m', '\d+', 0); -- [1, 2, 14]
SELECT regexp_extract('1a 2b 14m', '(\d+)([a-z]+)', 2); -- 'a'
SELECT regexp_extract_all('1a 2b 14m', '(\d+)([a-z]+)', 2); -- ['a', 'b', 'm']
```
There are some mainstream database support the syntax.
**Presto:**
https://prestodb.io/docs/current/functions/regexp.html

**Pig:**
https://pig.apache.org/docs/latest/api/org/apache/pig/builtin/REGEX_EXTRACT_ALL.html

Note: This PR pick up the work of https://github.com/apache/spark/pull/21985
### Why are the changes needed?
`regexp_extract_all` is a very useful function and make work easier.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
New UT",2020-02-09T08:05:34Z,2020-02-18T10:19:05Z,,,905e29cc934af7e14dc3a59953fa4bc6975edd23,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27507/commits,https://api.github.com/repos/apache/spark/pulls/27507/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27507/comments,https://api.github.com/repos/apache/spark/statuses/e9c5ef94934924472ae81c7a6e9c5f72bb08905a,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:support-regexp_extract_all,support-regexp_extract_all,e9c5ef94934924472ae81c7a6e9c5f72bb08905a,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f5026b1ba7c05548d5f271d6d3edf7dfd4c3f9ce,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27507,https://github.com/apache/spark/pull/27507,https://api.github.com/repos/apache/spark/issues/27507,https://api.github.com/repos/apache/spark/issues/27507/comments,https://api.github.com/repos/apache/spark/pulls/27507/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27507/commits,https://api.github.com/repos/apache/spark/statuses/e9c5ef94934924472ae81c7a6e9c5f72bb08905a
112,https://api.github.com/repos/apache/spark/pulls/27506,372800724,MDExOlB1bGxSZXF1ZXN0MzcyODAwNzI0,https://github.com/apache/spark/pull/27506,https://github.com/apache/spark/pull/27506.diff,https://github.com/apache/spark/pull/27506.patch,https://api.github.com/repos/apache/spark/issues/27506,27506,open,False,Demo Pipeline of Migrating OnPremise Database to Spark & Hadoop,"### What changes were proposed in this pull request?
This PR consist the following:

1. Many of the organisations are facing issue to migrate their current database such as Mysql to Hadoop & Spark Ecosystem
2. Created a Demo Pipeline where I have covered 3 use cases:
   **Case 1: Storing & then reading from HDFS Part File in Spark**
   **Case 2: Converting it into parquete format & then reading from parquete file format in SPARK**
   **Special Case: Directly analyisng in Spark from MySQL without storing in HDFS**
3. Finally after all the aggregations in Spark, generating a reporting Dashboard using Tableau.

Well, this Code may help many of the Spark Users who are willing to do this.",2020-02-09T07:34:41Z,2020-02-13T22:45:57Z,,,31d1be76708a64bc7445836ef3da76fe670cba30,,[],[],[],[],,False,https://api.github.com/repos/apache/spark/pulls/27506/commits,https://api.github.com/repos/apache/spark/pulls/27506/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27506/comments,https://api.github.com/repos/apache/spark/statuses/797015c1f08d25fe751697045d5311bc995cd33d,NONE,spark,apache,DJeyCodeX,42927710,MDQ6VXNlcjQyOTI3NzEw,https://avatars0.githubusercontent.com/u/42927710?v=4,,https://api.github.com/users/DJeyCodeX,https://github.com/DJeyCodeX,https://api.github.com/users/DJeyCodeX/followers,https://api.github.com/users/DJeyCodeX/following{/other_user},https://api.github.com/users/DJeyCodeX/gists{/gist_id},https://api.github.com/users/DJeyCodeX/starred{/owner}{/repo},https://api.github.com/users/DJeyCodeX/subscriptions,https://api.github.com/users/DJeyCodeX/orgs,https://api.github.com/users/DJeyCodeX/repos,https://api.github.com/users/DJeyCodeX/events{/privacy},https://api.github.com/users/DJeyCodeX/received_events,User,False,DJeyCodeX:feature/migrating-onPremise-database-to-Spark,feature/migrating-onPremise-database-to-Spark,797015c1f08d25fe751697045d5311bc995cd33d,DJeyCodeX,42927710,MDQ6VXNlcjQyOTI3NzEw,https://avatars0.githubusercontent.com/u/42927710?v=4,,https://api.github.com/users/DJeyCodeX,https://github.com/DJeyCodeX,https://api.github.com/users/DJeyCodeX/followers,https://api.github.com/users/DJeyCodeX/following{/other_user},https://api.github.com/users/DJeyCodeX/gists{/gist_id},https://api.github.com/users/DJeyCodeX/starred{/owner}{/repo},https://api.github.com/users/DJeyCodeX/subscriptions,https://api.github.com/users/DJeyCodeX/orgs,https://api.github.com/users/DJeyCodeX/repos,https://api.github.com/users/DJeyCodeX/events{/privacy},https://api.github.com/users/DJeyCodeX/received_events,User,False,239182504,MDEwOlJlcG9zaXRvcnkyMzkxODI1MDQ=,spark-1,DJeyCodeX/spark-1,False,DJeyCodeX,42927710,MDQ6VXNlcjQyOTI3NzEw,https://avatars0.githubusercontent.com/u/42927710?v=4,,https://api.github.com/users/DJeyCodeX,https://github.com/DJeyCodeX,https://api.github.com/users/DJeyCodeX/followers,https://api.github.com/users/DJeyCodeX/following{/other_user},https://api.github.com/users/DJeyCodeX/gists{/gist_id},https://api.github.com/users/DJeyCodeX/starred{/owner}{/repo},https://api.github.com/users/DJeyCodeX/subscriptions,https://api.github.com/users/DJeyCodeX/orgs,https://api.github.com/users/DJeyCodeX/repos,https://api.github.com/users/DJeyCodeX/events{/privacy},https://api.github.com/users/DJeyCodeX/received_events,User,False,https://github.com/DJeyCodeX/spark-1,Apache Spark,True,https://api.github.com/repos/DJeyCodeX/spark-1,https://api.github.com/repos/DJeyCodeX/spark-1/forks,https://api.github.com/repos/DJeyCodeX/spark-1/keys{/key_id},https://api.github.com/repos/DJeyCodeX/spark-1/collaborators{/collaborator},https://api.github.com/repos/DJeyCodeX/spark-1/teams,https://api.github.com/repos/DJeyCodeX/spark-1/hooks,https://api.github.com/repos/DJeyCodeX/spark-1/issues/events{/number},https://api.github.com/repos/DJeyCodeX/spark-1/events,https://api.github.com/repos/DJeyCodeX/spark-1/assignees{/user},https://api.github.com/repos/DJeyCodeX/spark-1/branches{/branch},https://api.github.com/repos/DJeyCodeX/spark-1/tags,https://api.github.com/repos/DJeyCodeX/spark-1/git/blobs{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/git/tags{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/git/refs{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/git/trees{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/statuses/{sha},https://api.github.com/repos/DJeyCodeX/spark-1/languages,https://api.github.com/repos/DJeyCodeX/spark-1/stargazers,https://api.github.com/repos/DJeyCodeX/spark-1/contributors,https://api.github.com/repos/DJeyCodeX/spark-1/subscribers,https://api.github.com/repos/DJeyCodeX/spark-1/subscription,https://api.github.com/repos/DJeyCodeX/spark-1/commits{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/git/commits{/sha},https://api.github.com/repos/DJeyCodeX/spark-1/comments{/number},https://api.github.com/repos/DJeyCodeX/spark-1/issues/comments{/number},https://api.github.com/repos/DJeyCodeX/spark-1/contents/{+path},https://api.github.com/repos/DJeyCodeX/spark-1/compare/{base}...{head},https://api.github.com/repos/DJeyCodeX/spark-1/merges,https://api.github.com/repos/DJeyCodeX/spark-1/{archive_format}{/ref},https://api.github.com/repos/DJeyCodeX/spark-1/downloads,https://api.github.com/repos/DJeyCodeX/spark-1/issues{/number},https://api.github.com/repos/DJeyCodeX/spark-1/pulls{/number},https://api.github.com/repos/DJeyCodeX/spark-1/milestones{/number},"https://api.github.com/repos/DJeyCodeX/spark-1/notifications{?since,all,participating}",https://api.github.com/repos/DJeyCodeX/spark-1/labels{/name},https://api.github.com/repos/DJeyCodeX/spark-1/releases{/id},https://api.github.com/repos/DJeyCodeX/spark-1/deployments,2020-02-08T18:28:13Z,2020-02-08T18:28:18Z,2020-02-09T07:25:12Z,git://github.com/DJeyCodeX/spark-1.git,git@github.com:DJeyCodeX/spark-1.git,https://github.com/DJeyCodeX/spark-1.git,https://github.com/DJeyCodeX/spark-1,,320799,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a7ae77a8d83bfbb8de5bb0dc2a8a0485c1486614,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27506,https://github.com/apache/spark/pull/27506,https://api.github.com/repos/apache/spark/issues/27506,https://api.github.com/repos/apache/spark/issues/27506/comments,https://api.github.com/repos/apache/spark/pulls/27506/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27506/commits,https://api.github.com/repos/apache/spark/statuses/797015c1f08d25fe751697045d5311bc995cd33d
113,https://api.github.com/repos/apache/spark/pulls/27498,372683879,MDExOlB1bGxSZXF1ZXN0MzcyNjgzODc5,https://github.com/apache/spark/pull/27498,https://github.com/apache/spark/pull/27498.diff,https://github.com/apache/spark/pull/27498.patch,https://api.github.com/repos/apache/spark/issues/27498,27498,open,False,[SPARK-30688][SQL] Week based dates not being parsed with TimestampFormatter,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->



### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

When executing the following query using a week based pattern the result is null.
```
scala> spark.sql(""select unix_timestamp('2020-10', 'YYYY-ww')"").show
+--------------------------------+
|unix_timestamp(2020-10, YYYY-ww)|
+--------------------------------+
|                            null|
+--------------------------------+
```

You can replicate this behavior with:

```
import java.time.temporal._
import java.time.format._
import java.util.Locale
import java.time.chrono.IsoChronology

val pattern = ""YYYY-ww""
val locale = Locale.US
val s = ""2020-10""
val formatter = new DateTimeFormatterBuilder().appendPattern(pattern)
    .parseDefaulting(ChronoField.ERA, 1)
    .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)
    .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)
    .parseDefaulting(ChronoField.MINUTE_OF_HOUR, 0)
    .parseDefaulting(ChronoField.SECOND_OF_MINUTE, 0)
    .toFormatter(locale)
    .withChronology(IsoChronology.INSTANCE)
    .withResolverStyle(ResolverStyle.STRICT)

val result = formatter.parse(s)
result.query(TemporalQueries.localDate)
```
The date is parsed, but not resolved.

This is caused by the default temporal fields that are conflicting with the week based values:
```
      .parseDefaulting(ChronoField.ERA, 1)
      .parseDefaulting(ChronoField.MONTH_OF_YEAR, 1)
      .parseDefaulting(ChronoField.DAY_OF_MONTH, 1)
```

To avoid this conflict, I propose to check if the pattern is a week/year based and change the defaults as follows:

```
      .parseDefaulting(ChronoField.ERA, 1)
      .parseDefaulting(ChronoField.DAY_OF_WEEK, 1)
```

#### Note:
Additonally in JDK8 there is know issue for patterns `(YYYYww/YYww)` [https://bugs.openjdk.java.net/browse/JDK-8145633](https://bugs.openjdk.java.net/browse/JDK-8145633) which fails to parse contiguos patterns without separation, this has been fixed in version 9. To avoid parsing issues add a separator like this `(YYYY-ww/YYYY ww)`
### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Week/Year based dates should be supported since it is part of ISO8601. Also, as seen in [SPARK-30688](https://issues.apache.org/jira/browse/SPARK-30688), this issue is failing silently.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
- No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
- Passing current tests
- Added test case for different timezones in `DateExpressionsSuite.scala`",2020-02-08T05:51:57Z,2020-03-19T12:02:05Z,,,7d4177930e7a60e5c8eb70386abd5cebde78e381,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27498/commits,https://api.github.com/repos/apache/spark/pulls/27498/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27498/comments,https://api.github.com/repos/apache/spark/statuses/8c8e996bcad2daa6a66e7a19c8cd175515ddded4,CONTRIBUTOR,spark,apache,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,javierivanov:SPARK-30688,SPARK-30688,8c8e996bcad2daa6a66e7a19c8cd175515ddded4,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,224188155,MDEwOlJlcG9zaXRvcnkyMjQxODgxNTU=,spark,javierivanov/spark,False,javierivanov,7876890,MDQ6VXNlcjc4NzY4OTA=,https://avatars1.githubusercontent.com/u/7876890?v=4,,https://api.github.com/users/javierivanov,https://github.com/javierivanov,https://api.github.com/users/javierivanov/followers,https://api.github.com/users/javierivanov/following{/other_user},https://api.github.com/users/javierivanov/gists{/gist_id},https://api.github.com/users/javierivanov/starred{/owner}{/repo},https://api.github.com/users/javierivanov/subscriptions,https://api.github.com/users/javierivanov/orgs,https://api.github.com/users/javierivanov/repos,https://api.github.com/users/javierivanov/events{/privacy},https://api.github.com/users/javierivanov/received_events,User,False,https://github.com/javierivanov/spark,Apache Spark,True,https://api.github.com/repos/javierivanov/spark,https://api.github.com/repos/javierivanov/spark/forks,https://api.github.com/repos/javierivanov/spark/keys{/key_id},https://api.github.com/repos/javierivanov/spark/collaborators{/collaborator},https://api.github.com/repos/javierivanov/spark/teams,https://api.github.com/repos/javierivanov/spark/hooks,https://api.github.com/repos/javierivanov/spark/issues/events{/number},https://api.github.com/repos/javierivanov/spark/events,https://api.github.com/repos/javierivanov/spark/assignees{/user},https://api.github.com/repos/javierivanov/spark/branches{/branch},https://api.github.com/repos/javierivanov/spark/tags,https://api.github.com/repos/javierivanov/spark/git/blobs{/sha},https://api.github.com/repos/javierivanov/spark/git/tags{/sha},https://api.github.com/repos/javierivanov/spark/git/refs{/sha},https://api.github.com/repos/javierivanov/spark/git/trees{/sha},https://api.github.com/repos/javierivanov/spark/statuses/{sha},https://api.github.com/repos/javierivanov/spark/languages,https://api.github.com/repos/javierivanov/spark/stargazers,https://api.github.com/repos/javierivanov/spark/contributors,https://api.github.com/repos/javierivanov/spark/subscribers,https://api.github.com/repos/javierivanov/spark/subscription,https://api.github.com/repos/javierivanov/spark/commits{/sha},https://api.github.com/repos/javierivanov/spark/git/commits{/sha},https://api.github.com/repos/javierivanov/spark/comments{/number},https://api.github.com/repos/javierivanov/spark/issues/comments{/number},https://api.github.com/repos/javierivanov/spark/contents/{+path},https://api.github.com/repos/javierivanov/spark/compare/{base}...{head},https://api.github.com/repos/javierivanov/spark/merges,https://api.github.com/repos/javierivanov/spark/{archive_format}{/ref},https://api.github.com/repos/javierivanov/spark/downloads,https://api.github.com/repos/javierivanov/spark/issues{/number},https://api.github.com/repos/javierivanov/spark/pulls{/number},https://api.github.com/repos/javierivanov/spark/milestones{/number},"https://api.github.com/repos/javierivanov/spark/notifications{?since,all,participating}",https://api.github.com/repos/javierivanov/spark/labels{/name},https://api.github.com/repos/javierivanov/spark/releases{/id},https://api.github.com/repos/javierivanov/spark/deployments,2019-11-26T12:32:40Z,2020-03-15T23:11:43Z,2020-03-17T21:33:14Z,git://github.com/javierivanov/spark.git,git@github.com:javierivanov/spark.git,https://github.com/javierivanov/spark.git,https://github.com/javierivanov/spark,,323580,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,57d27e900f79e6c5699b9a23db236aae98e761ad,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27498,https://github.com/apache/spark/pull/27498,https://api.github.com/repos/apache/spark/issues/27498,https://api.github.com/repos/apache/spark/issues/27498/comments,https://api.github.com/repos/apache/spark/pulls/27498/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27498/commits,https://api.github.com/repos/apache/spark/statuses/8c8e996bcad2daa6a66e7a19c8cd175515ddded4
114,https://api.github.com/repos/apache/spark/pulls/27477,371894241,MDExOlB1bGxSZXF1ZXN0MzcxODk0MjQx,https://github.com/apache/spark/pull/27477,https://github.com/apache/spark/pull/27477.diff,https://github.com/apache/spark/pull/27477.patch,https://api.github.com/repos/apache/spark/issues/27477,27477,open,False,[SPARK-30724][SQL] Support 'LIKE ANY' and 'LIKE ALL' operators,"### What changes were proposed in this pull request?

`LIKE ANY` and `LIKE ALL` operators are mostly used when we are matching a text field with numbers of patterns. For example:

Teradata / Hive 3.0 / Snowflake:
```sql
--like any
select 'foo' LIKE ANY ('%foo%','%bar%');

--like all
select 'foo' LIKE ALL ('%foo%','%bar%');
```
PostgreSQL:
```sql
-- like any
select 'foo' LIKE ANY (array['%foo%','%bar%']);

-- like all
select 'foo' LIKE ALL (array['%foo%','%bar%']);
```

This PR add support these two operators.

More details:
https://docs.teradata.com/reader/756LNiPSFdY~4JcCCcR5Cw/4~AyrPNmDN0Xk4SALLo6aQ
https://issues.apache.org/jira/browse/HIVE-15229
https://docs.snowflake.net/manuals/sql-reference/functions/like_any.html

### Why are the changes needed?

To smoothly migrate SQLs to Spark SQL.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Unit test.
",2020-02-06T13:17:41Z,2020-02-18T07:56:51Z,,,f6abdf5ddec6dad4c9288771bd46a1d9523648c7,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27477/commits,https://api.github.com/repos/apache/spark/pulls/27477/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27477/comments,https://api.github.com/repos/apache/spark/statuses/1c3d98cb847f76e17c687743e55e8143c47fb4a9,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-30724,SPARK-30724,1c3d98cb847f76e17c687743e55e8143c47fb4a9,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,c1986204e59f1e8cc4b611d5a578cb248cb74c28,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27477,https://github.com/apache/spark/pull/27477,https://api.github.com/repos/apache/spark/issues/27477,https://api.github.com/repos/apache/spark/issues/27477/comments,https://api.github.com/repos/apache/spark/pulls/27477/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27477/commits,https://api.github.com/repos/apache/spark/statuses/1c3d98cb847f76e17c687743e55e8143c47fb4a9
115,https://api.github.com/repos/apache/spark/pulls/27462,371165965,MDExOlB1bGxSZXF1ZXN0MzcxMTY1OTY1,https://github.com/apache/spark/pull/27462,https://github.com/apache/spark/pull/27462.diff,https://github.com/apache/spark/pull/27462.patch,https://api.github.com/repos/apache/spark/issues/27462,27462,open,False,[SPARK-30735][SQL] New functionality for partitionBy to enhance performance when writing data with partitionBy,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Adding new boolean parameter to `partitionBy` method in DataFrameWriter.

```scala
  @scala.annotation.varargs
  def partitionBy(needRepartition: Boolean, colNames: String*): DataFrameWriter[T] = {
    this.partitioningColumns = Option(colNames)
    if(needRepartition) needRepartitionBasedColumns = true
    this
  }
```

If `partitionBy(true, cols)` is specified, the `needRepartitionBasedColumns` parameter sets `true`. Based on this parameter, when writing data with `saveToV1Source()`, the `repartition` method based on columns is called before writing data.

```scala
  private def saveToV1Source(): Unit = {
    partitioningColumns.foreach { columns =>
      extraOptions += (DataSourceUtils.PARTITIONING_COLUMNS_KEY ->
        DataSourceUtils.encodePartitioningColumns(columns))
    }

    // Code path for data source v1.
    var dfx = df
    if(needRepartitionBasedColumns) {
      dfx = df.repartition(partitioningColumns.toArray.flatten.map(df.col): _*)
    }

    runCommand(dfx.sparkSession, ""save"") {
      DataSource(
        sparkSession = dfx.sparkSession,
        className = source,
        partitionColumns = partitioningColumns.getOrElse(Nil),
        options = extraOptions.toMap).planForWriting(mode, dfx.logicalPlan)
    }
  }
```

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

This new functionality is possible to help many Spark users who use partitionBy when writing data with DataFrame.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

Basically not. This new functionality enables user to specify additional boolean parameter for `partitionBy`. When specifying this parameter such as `partitionby(true, cols)`, the repartition method based on specified columns is internally called and is expected to enhance performance and to decrease memory usage when writing.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Not yet. However, I confirmed that it works by actual testing with DataFrameReader and DataFrameWriter",2020-02-05T03:31:36Z,2020-02-07T00:59:40Z,,,87c0bec9362ee41549a3865a3e76af635c6e0568,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27462/commits,https://api.github.com/repos/apache/spark/pulls/27462/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27462/comments,https://api.github.com/repos/apache/spark/statuses/735a64073279358feaeeb76565fe5f0b118de9a6,NONE,spark,apache,tomtongue,43331405,MDQ6VXNlcjQzMzMxNDA1,https://avatars1.githubusercontent.com/u/43331405?v=4,,https://api.github.com/users/tomtongue,https://github.com/tomtongue,https://api.github.com/users/tomtongue/followers,https://api.github.com/users/tomtongue/following{/other_user},https://api.github.com/users/tomtongue/gists{/gist_id},https://api.github.com/users/tomtongue/starred{/owner}{/repo},https://api.github.com/users/tomtongue/subscriptions,https://api.github.com/users/tomtongue/orgs,https://api.github.com/users/tomtongue/repos,https://api.github.com/users/tomtongue/events{/privacy},https://api.github.com/users/tomtongue/received_events,User,False,tomtongue:dev_partitionby,dev_partitionby,735a64073279358feaeeb76565fe5f0b118de9a6,tomtongue,43331405,MDQ6VXNlcjQzMzMxNDA1,https://avatars1.githubusercontent.com/u/43331405?v=4,,https://api.github.com/users/tomtongue,https://github.com/tomtongue,https://api.github.com/users/tomtongue/followers,https://api.github.com/users/tomtongue/following{/other_user},https://api.github.com/users/tomtongue/gists{/gist_id},https://api.github.com/users/tomtongue/starred{/owner}{/repo},https://api.github.com/users/tomtongue/subscriptions,https://api.github.com/users/tomtongue/orgs,https://api.github.com/users/tomtongue/repos,https://api.github.com/users/tomtongue/events{/privacy},https://api.github.com/users/tomtongue/received_events,User,False,223629001,MDEwOlJlcG9zaXRvcnkyMjM2MjkwMDE=,spark,tomtongue/spark,False,tomtongue,43331405,MDQ6VXNlcjQzMzMxNDA1,https://avatars1.githubusercontent.com/u/43331405?v=4,,https://api.github.com/users/tomtongue,https://github.com/tomtongue,https://api.github.com/users/tomtongue/followers,https://api.github.com/users/tomtongue/following{/other_user},https://api.github.com/users/tomtongue/gists{/gist_id},https://api.github.com/users/tomtongue/starred{/owner}{/repo},https://api.github.com/users/tomtongue/subscriptions,https://api.github.com/users/tomtongue/orgs,https://api.github.com/users/tomtongue/repos,https://api.github.com/users/tomtongue/events{/privacy},https://api.github.com/users/tomtongue/received_events,User,False,https://github.com/tomtongue/spark,Apache Spark,True,https://api.github.com/repos/tomtongue/spark,https://api.github.com/repos/tomtongue/spark/forks,https://api.github.com/repos/tomtongue/spark/keys{/key_id},https://api.github.com/repos/tomtongue/spark/collaborators{/collaborator},https://api.github.com/repos/tomtongue/spark/teams,https://api.github.com/repos/tomtongue/spark/hooks,https://api.github.com/repos/tomtongue/spark/issues/events{/number},https://api.github.com/repos/tomtongue/spark/events,https://api.github.com/repos/tomtongue/spark/assignees{/user},https://api.github.com/repos/tomtongue/spark/branches{/branch},https://api.github.com/repos/tomtongue/spark/tags,https://api.github.com/repos/tomtongue/spark/git/blobs{/sha},https://api.github.com/repos/tomtongue/spark/git/tags{/sha},https://api.github.com/repos/tomtongue/spark/git/refs{/sha},https://api.github.com/repos/tomtongue/spark/git/trees{/sha},https://api.github.com/repos/tomtongue/spark/statuses/{sha},https://api.github.com/repos/tomtongue/spark/languages,https://api.github.com/repos/tomtongue/spark/stargazers,https://api.github.com/repos/tomtongue/spark/contributors,https://api.github.com/repos/tomtongue/spark/subscribers,https://api.github.com/repos/tomtongue/spark/subscription,https://api.github.com/repos/tomtongue/spark/commits{/sha},https://api.github.com/repos/tomtongue/spark/git/commits{/sha},https://api.github.com/repos/tomtongue/spark/comments{/number},https://api.github.com/repos/tomtongue/spark/issues/comments{/number},https://api.github.com/repos/tomtongue/spark/contents/{+path},https://api.github.com/repos/tomtongue/spark/compare/{base}...{head},https://api.github.com/repos/tomtongue/spark/merges,https://api.github.com/repos/tomtongue/spark/{archive_format}{/ref},https://api.github.com/repos/tomtongue/spark/downloads,https://api.github.com/repos/tomtongue/spark/issues{/number},https://api.github.com/repos/tomtongue/spark/pulls{/number},https://api.github.com/repos/tomtongue/spark/milestones{/number},"https://api.github.com/repos/tomtongue/spark/notifications{?since,all,participating}",https://api.github.com/repos/tomtongue/spark/labels{/name},https://api.github.com/repos/tomtongue/spark/releases{/id},https://api.github.com/repos/tomtongue/spark/deployments,2019-11-23T17:40:47Z,2019-11-23T17:40:53Z,2020-02-15T17:09:30Z,git://github.com/tomtongue/spark.git,git@github.com:tomtongue/spark.git,https://github.com/tomtongue/spark.git,https://github.com/tomtongue/spark,,314590,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,692e3ddb4e517638156f7427ade8b62fb37634a7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27462,https://github.com/apache/spark/pull/27462,https://api.github.com/repos/apache/spark/issues/27462,https://api.github.com/repos/apache/spark/issues/27462/comments,https://api.github.com/repos/apache/spark/pulls/27462/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27462/commits,https://api.github.com/repos/apache/spark/statuses/735a64073279358feaeeb76565fe5f0b118de9a6
116,https://api.github.com/repos/apache/spark/pulls/27453,370880230,MDExOlB1bGxSZXF1ZXN0MzcwODgwMjMw,https://github.com/apache/spark/pull/27453,https://github.com/apache/spark/pull/27453.diff,https://github.com/apache/spark/pull/27453.patch,https://api.github.com/repos/apache/spark/issues/27453,27453,open,False,[SPARK-24914][SQL] Introduce new statistic to improve data size estimate for columnar storage formats (part 1),"### What changes were proposed in this pull request?

This PR introduces a new statistic called `deserFactor` which can be set manualy as a table property 'spark.deserFactor' and intended to be used for columnar file formats as a ratio of actual data size (raw data size) to file size to scale up the file size to improve the estimate of in-memory data size and having a better query optimization (i.e., join strategy decision).

### Why are the changes needed?

Before this change Spark estimated the table size as the sum of all the file sizes. This estimate can be way too low at columnar file formats where huge data can be compressed into a very small file because of serialization (like dictionary encoding) and compression. 
With the `deserFactor` OOM error raised as a result of a wrongly chosen broadcast join strategy can be avoided.

### Does this PR introduce any user-facing change?

No

### How was this patch tested?

The StatisticsSuite is extended with a new test: `SPARK-24914 - test deserialization factor`.",2020-02-04T14:52:22Z,2020-03-02T19:48:41Z,,,ffa44635fe7b7406cdfe48322f11df325d9b4c31,,[],"[{'login': 'maropu', 'id': 692303, 'node_id': 'MDQ6VXNlcjY5MjMwMw==', 'avatar_url': 'https://avatars3.githubusercontent.com/u/692303?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/maropu', 'html_url': 'https://github.com/maropu', 'followers_url': 'https://api.github.com/users/maropu/followers', 'following_url': 'https://api.github.com/users/maropu/following{/other_user}', 'gists_url': 'https://api.github.com/users/maropu/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/maropu/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/maropu/subscriptions', 'organizations_url': 'https://api.github.com/users/maropu/orgs', 'repos_url': 'https://api.github.com/users/maropu/repos', 'events_url': 'https://api.github.com/users/maropu/events{/privacy}', 'received_events_url': 'https://api.github.com/users/maropu/received_events', 'type': 'User', 'site_admin': False}, {'login': 'HyukjinKwon', 'id': 6477701, 'node_id': 'MDQ6VXNlcjY0Nzc3MDE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/6477701?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/HyukjinKwon', 'html_url': 'https://github.com/HyukjinKwon', 'followers_url': 'https://api.github.com/users/HyukjinKwon/followers', 'following_url': 'https://api.github.com/users/HyukjinKwon/following{/other_user}', 'gists_url': 'https://api.github.com/users/HyukjinKwon/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/HyukjinKwon/subscriptions', 'organizations_url': 'https://api.github.com/users/HyukjinKwon/orgs', 'repos_url': 'https://api.github.com/users/HyukjinKwon/repos', 'events_url': 'https://api.github.com/users/HyukjinKwon/events{/privacy}', 'received_events_url': 'https://api.github.com/users/HyukjinKwon/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27453/commits,https://api.github.com/repos/apache/spark/pulls/27453/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27453/comments,https://api.github.com/repos/apache/spark/statuses/e78b4b07e566a02580502242df13de6a9c0d2a60,CONTRIBUTOR,spark,apache,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,attilapiros:SPARK-24914-first-half,SPARK-24914-first-half,e78b4b07e566a02580502242df13de6a9c0d2a60,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,114023960,MDEwOlJlcG9zaXRvcnkxMTQwMjM5NjA=,spark,attilapiros/spark,False,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,https://github.com/attilapiros/spark,Mirror of Apache Spark,True,https://api.github.com/repos/attilapiros/spark,https://api.github.com/repos/attilapiros/spark/forks,https://api.github.com/repos/attilapiros/spark/keys{/key_id},https://api.github.com/repos/attilapiros/spark/collaborators{/collaborator},https://api.github.com/repos/attilapiros/spark/teams,https://api.github.com/repos/attilapiros/spark/hooks,https://api.github.com/repos/attilapiros/spark/issues/events{/number},https://api.github.com/repos/attilapiros/spark/events,https://api.github.com/repos/attilapiros/spark/assignees{/user},https://api.github.com/repos/attilapiros/spark/branches{/branch},https://api.github.com/repos/attilapiros/spark/tags,https://api.github.com/repos/attilapiros/spark/git/blobs{/sha},https://api.github.com/repos/attilapiros/spark/git/tags{/sha},https://api.github.com/repos/attilapiros/spark/git/refs{/sha},https://api.github.com/repos/attilapiros/spark/git/trees{/sha},https://api.github.com/repos/attilapiros/spark/statuses/{sha},https://api.github.com/repos/attilapiros/spark/languages,https://api.github.com/repos/attilapiros/spark/stargazers,https://api.github.com/repos/attilapiros/spark/contributors,https://api.github.com/repos/attilapiros/spark/subscribers,https://api.github.com/repos/attilapiros/spark/subscription,https://api.github.com/repos/attilapiros/spark/commits{/sha},https://api.github.com/repos/attilapiros/spark/git/commits{/sha},https://api.github.com/repos/attilapiros/spark/comments{/number},https://api.github.com/repos/attilapiros/spark/issues/comments{/number},https://api.github.com/repos/attilapiros/spark/contents/{+path},https://api.github.com/repos/attilapiros/spark/compare/{base}...{head},https://api.github.com/repos/attilapiros/spark/merges,https://api.github.com/repos/attilapiros/spark/{archive_format}{/ref},https://api.github.com/repos/attilapiros/spark/downloads,https://api.github.com/repos/attilapiros/spark/issues{/number},https://api.github.com/repos/attilapiros/spark/pulls{/number},https://api.github.com/repos/attilapiros/spark/milestones{/number},"https://api.github.com/repos/attilapiros/spark/notifications{?since,all,participating}",https://api.github.com/repos/attilapiros/spark/labels{/name},https://api.github.com/repos/attilapiros/spark/releases{/id},https://api.github.com/repos/attilapiros/spark/deployments,2017-12-12T18:15:59Z,2020-04-06T17:28:12Z,2020-04-06T17:27:10Z,git://github.com/attilapiros/spark.git,git@github.com:attilapiros/spark.git,https://github.com/attilapiros/spark.git,https://github.com/attilapiros/spark,,325097,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,dd2f4431f56e02cd06848b02b93b4cf34c97a5d5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27453,https://github.com/apache/spark/pull/27453,https://api.github.com/repos/apache/spark/issues/27453,https://api.github.com/repos/apache/spark/issues/27453/comments,https://api.github.com/repos/apache/spark/pulls/27453/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27453/commits,https://api.github.com/repos/apache/spark/statuses/e78b4b07e566a02580502242df13de6a9c0d2a60
117,https://api.github.com/repos/apache/spark/pulls/27440,370238608,MDExOlB1bGxSZXF1ZXN0MzcwMjM4NjA4,https://github.com/apache/spark/pull/27440,https://github.com/apache/spark/pull/27440.diff,https://github.com/apache/spark/pull/27440.patch,https://api.github.com/repos/apache/spark/issues/27440,27440,open,False,[SPARK-27951][SQL] Support ANSI SQL NTH_VALUE window function,"### What changes were proposed in this pull request?
The `NTH_VALUE` function is an ANSI SQL.
For examples:
```
CREATE TEMPORARY TABLE empsalary (
    depname varchar,
    empno bigint,
    salary int,
    enroll_date date
);

INSERT INTO empsalary VALUES
('develop', 10, 5200, '2007-08-01'),
('sales', 1, 5000, '2006-10-01'),
('personnel', 5, 3500, '2007-12-10'),
('sales', 4, 4800, '2007-08-08'),
('personnel', 2, 3900, '2006-12-23'),
('develop', 7, 4200, '2008-01-01'),
('develop', 9, 4500, '2008-01-01'),
('sales', 3, 4800, '2007-08-01'),
('develop', 8, 6000, '2006-10-01'),
('develop', 11, 5200, '2007-08-15');

select first_value(salary) over(order by salary range between 1000 preceding and 1000 following),
	lead(salary) over(order by salary range between 1000 preceding and 1000 following),
	nth_value(salary, 1) over(order by salary range between 1000 preceding and 1000 following),
	salary from empsalary;
 first_value | lead | nth_value | salary 
-------------+------+-----------+--------
        3500 | 3900 |      3500 |   3500
        3500 | 4200 |      3500 |   3900
        3500 | 4500 |      3500 |   4200
        3500 | 4800 |      3500 |   4500
        3900 | 4800 |      3900 |   4800
        3900 | 5000 |      3900 |   4800
        4200 | 5200 |      4200 |   5000
        4200 | 5200 |      4200 |   5200
        4200 | 6000 |      4200 |   5200
        5000 |      |      5000 |   6000
(10 rows)
```

There are some mainstream database support the syntax.

**PostgreSQL:**
https://www.postgresql.org/docs/8.4/functions-window.html

**Vertica:**
https://www.vertica.com/docs/9.2.x/HTML/Content/Authoring/SQLReferenceManual/Functions/Analytic/NTH_VALUEAnalytic.htm?tocpath=SQL%20Reference%20Manual%7CSQL%20Functions%7CAnalytic%20Functions%7C_____23

**Oracle:**
https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/NTH_VALUE.html#GUID-F8A0E88C-67E5-4AA6-9515-95D03A7F9EA0

**Redshift**
https://docs.aws.amazon.com/redshift/latest/dg/r_WF_NTH.html

**Presto**
https://prestodb.io/docs/current/functions/window.html

### Why are the changes needed?
The `NTH_VALUE` function is an ANSI SQL.
The `NTH_VALUE` function is very useful.

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
Exists and new UT.",2020-02-03T10:27:36Z,2020-02-19T00:56:03Z,,,40270a4d69056cbf78557695648ea3638d92b5dd,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27440/commits,https://api.github.com/repos/apache/spark/pulls/27440/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27440/comments,https://api.github.com/repos/apache/spark/statuses/591c146cdbb71b7bcf771243bcc2b2e8c7792fa1,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:ansi-nth_value-window-function,ansi-nth_value-window-function,591c146cdbb71b7bcf771243bcc2b2e8c7792fa1,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a4912cee615314e9578e6ab4eae25f147feacbd5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27440,https://github.com/apache/spark/pull/27440,https://api.github.com/repos/apache/spark/issues/27440,https://api.github.com/repos/apache/spark/issues/27440/comments,https://api.github.com/repos/apache/spark/pulls/27440/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27440/commits,https://api.github.com/repos/apache/spark/statuses/591c146cdbb71b7bcf771243bcc2b2e8c7792fa1
118,https://api.github.com/repos/apache/spark/pulls/27436,369993025,MDExOlB1bGxSZXF1ZXN0MzY5OTkzMDI1,https://github.com/apache/spark/pull/27436,https://github.com/apache/spark/pull/27436.diff,https://github.com/apache/spark/pull/27436.patch,https://api.github.com/repos/apache/spark/issues/27436,27436,open,False,[SPARK-30705][SQL] Improve CaseWhen sub-expression equality,"### What changes were proposed in this pull request?
For CaseWhen, we currently only support the first condition expression. This PR improves this pattern:
```sql
CASE WHEN testUdf(a) > 3 THEN 4
WHEN testUdf(a) = 3 THEN 3
WHEN testUdf(a) = 2 THEN 2
WHEN testUdf(a) = 1 THEN 1
ELSE 0 END
```

### Why are the changes needed?
Improve query performance.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit test.
",2020-02-02T09:53:49Z,2020-02-10T01:03:36Z,,,a7b498f0c5e4ee3d72067940237a411447f0339d,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27436/commits,https://api.github.com/repos/apache/spark/pulls/27436/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27436/comments,https://api.github.com/repos/apache/spark/statuses/37ba243320ecf4029dfbd1f9dc4ffdc886770d5c,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-30705,SPARK-30705,37ba243320ecf4029dfbd1f9dc4ffdc886770d5c,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,1adf3520e3c753e6df8dccb752e8239de682a09a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27436,https://github.com/apache/spark/pull/27436,https://api.github.com/repos/apache/spark/issues/27436,https://api.github.com/repos/apache/spark/issues/27436/comments,https://api.github.com/repos/apache/spark/pulls/27436/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27436/commits,https://api.github.com/repos/apache/spark/statuses/37ba243320ecf4029dfbd1f9dc4ffdc886770d5c
119,https://api.github.com/repos/apache/spark/pulls/27432,369973507,MDExOlB1bGxSZXF1ZXN0MzY5OTczNTA3,https://github.com/apache/spark/pull/27432,https://github.com/apache/spark/pull/27432.diff,https://github.com/apache/spark/pull/27432.patch,https://api.github.com/repos/apache/spark/issues/27432,27432,open,False,[SPARK-28325][SQL]Support ANSI SQL: SIMILAR TO ... ESCAPE syntax,"### What changes were proposed in this pull request?
`[ NOT ] SIMILAR TO <similar pattern> [ ESCAPE <escape character> ]`
This is a ANSI SQL.
For example:
```
SELECT 'abc' SIMILAR TO 'abc' AS `true`;
SELECT 'abc' SIMILAR TO 'a' AS `false`;
SELECT 'abc' SIMILAR TO '%(b|d)%' AS `true`;
SELECT 'abc' SIMILAR TO '(b|c)%' AS `false`;
```
There are some mainstream database support the syntax.
**PostgreSQL:**
https://www.postgresql.org/docs/current/functions-matching.html#FUNCTIONS-SIMILARTO-REGEXP
**Redshift:**
https://docs.aws.amazon.com/redshift/latest/dg/pattern-matching-conditions-similar-to.html

`SIMILAR TO` is similar to `RLIKE`, but with the following differences:
       1. The `SIMILAR TO` operator returns true only if its pattern matches the entire string,
          unlike `RLIKE` behavior, where the pattern can match any portion of the string.
       2. The regex string allow uses _ and % as wildcard characters denoting any single character
          and any string, respectively (these are comparable to . and .* in POSIX regular
          expressions).
       3. The regex string allow uses escape character like `LIKE` behavior.
       4. '.', '^' and '$' is not a meta character for `SIMILAR TO`.


### Why are the changes needed?
Support ANSI SQL: `SIMILAR TO ... ESCAPE` syntax
`SIMILAR TO ... ESCAPE ` has a lot of convenience compared to `RLIKE`.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Exists and new UT",2020-02-02T05:20:00Z,2020-03-06T19:04:08Z,,,bc236069bf3d9c5d29211b80a42b551d3919d763,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27432/commits,https://api.github.com/repos/apache/spark/pulls/27432/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27432/comments,https://api.github.com/repos/apache/spark/statuses/5cf6f9ab0eaed73bdfc6a56517b11317bf1dc026,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:ansi-sql-similar-to,ansi-sql-similar-to,5cf6f9ab0eaed73bdfc6a56517b11317bf1dc026,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ebcff675e0c8c915075541af8fa8f9a24087ac11,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27432,https://github.com/apache/spark/pull/27432,https://api.github.com/repos/apache/spark/issues/27432,https://api.github.com/repos/apache/spark/issues/27432/comments,https://api.github.com/repos/apache/spark/pulls/27432/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27432/commits,https://api.github.com/repos/apache/spark/statuses/5cf6f9ab0eaed73bdfc6a56517b11317bf1dc026
120,https://api.github.com/repos/apache/spark/pulls/27429,369910813,MDExOlB1bGxSZXF1ZXN0MzY5OTEwODEz,https://github.com/apache/spark/pull/27429,https://github.com/apache/spark/pull/27429.diff,https://github.com/apache/spark/pull/27429.patch,https://api.github.com/repos/apache/spark/issues/27429,27429,open,False,[SPARK-28330][SQL] Support ANSI SQL: result offset clause in query expression,"### What changes were proposed in this pull request?
This is a ANSI SQL and feature id is `F861`
```
<query expression> ::=
[ <with clause> ] <query expression body>
[ <order by clause> ] [ <result offset clause> ] [ <fetch first clause> ]

<result offset clause> ::=
OFFSET <offset row count> { ROW | ROWS }
```
For example:
```
SELECT customer_name, customer_gender FROM customer_dimension 
   WHERE occupation='Dancer' AND customer_city = 'San Francisco' ORDER BY customer_name;
    customer_name     | customer_gender
----------------------+-----------------
 Amy X. Lang          | Female
 Anna H. Li           | Female
 Brian O. Weaver      | Male
 Craig O. Pavlov      | Male
 Doug Z. Goldberg     | Male
 Harold S. Jones      | Male
 Jack E. Perkins      | Male
 Joseph W. Overstreet | Male
 Kevin . Campbell     | Male
 Raja Y. Wilson       | Male
 Samantha O. Brown    | Female
 Steve H. Gauthier    | Male
 William . Nielson    | Male
 William Z. Roy       | Male
(14 rows)

SELECT customer_name, customer_gender FROM customer_dimension 
   WHERE occupation='Dancer' AND customer_city = 'San Francisco' ORDER BY customer_name OFFSET 8;
   customer_name   | customer_gender
-------------------+-----------------
 Kevin . Campbell  | Male
 Raja Y. Wilson    | Male
 Samantha O. Brown | Female
 Steve H. Gauthier | Male
 William . Nielson | Male
 William Z. Roy    | Male
(6 rows)
```
There are some mainstream database support the syntax.
**PostgreSQL:**
https://www.postgresql.org/docs/11/queries-limit.html

**Vertica:**
https://www.vertica.com/docs/9.2.x/HTML/Content/Authoring/SQLReferenceManual/Statements/SELECT/OFFSETClause.htm?zoom_highlight=offset

**MySQL:**
https://dev.mysql.com/doc/refman/5.6/en/select.html

The description for design:
**1**. Consider `OFFSET` as the special case of `LIMIT`. For example:
`SELECT * FROM a limit 10;` similar to `SELECT * FROM a limit 10 offset 0;`
`SELECT * FROM a offset 10;` similar to `SELECT * FROM a limit -1 offset 10;`
**2**. Because the current implement of `LIMIT` has good performance. For example:
`SELECT * FROM a limit 10;` parsed to the logic plan as below:
```
GlobalLimit (limit = 10)
|--LocalLimit (limit = 10)
```
and then the physical plan as below:
```
GlobalLimitExec (limit = 10) // Take the first 10 rows globally
|--LocalLimitExec (limit = 10) // Take the first 10 rows locally
```
This operator reduce massive shuffle and has good performance.
Sometimes, the logic plan transformed to the physical plan as:
```
CollectLimitExec (limit = 10) // Take the first 10 rows globally
```
If the SQL contains order by, such as `SELECT * FROM a order by c limit 10;`.
This SQL will be transformed to the physical plan as below:
```
TakeOrderedAndProjectExec (limit = 10) // Take the first 10 rows after sort globally
```

Based on this situation, this PR produces the following operations. For example:
`SELECT * FROM a limit 10 offset 10;` parsed to the logic plan as below:
```
GlobalLimit (limit = 10)
|--LocalLimit (limit = 10)
   |--Offset (offset = 10)
```
After optimization, the above logic plan will be transformed to:
```
GlobalLimitAndOffset (limit = 10, offset = 10) // Limit clause accompanied by offset clause
|--LocalLimit (limit = 20)   // 10 + offset = 20
```

and then the physical plan as below:
```
GlobalLimitAndOffsetExec (limit = 10, offset = 10) // Skip the first 10 rows and take the next 10 rows globally
|--LocalLimitExec (limit = 20) // Take the first 20(limit + offset) rows locally
```
Sometimes, the logic plan transformed to the physical plan as:
```
CollectLimitExec (limit = 10, offset = 10) // Skip the first 10 rows and take the next 10 rows globally
```
If the SQL contains order by, such as `SELECT * FROM a order by c limit 10 offset 10;`.
This SQL will be transformed to the physical plan as below:
```
TakeOrderedAndProjectExec (limit = 10, offset 10) // Skip the first 10 rows and take the next 10 rows after sort globally
```
**3**.In addition to the above, there is a special case that is only offset but no limit. For example:
`SELECT * FROM a offset 10;` parsed to the logic plan as below:
```
Offset (offset = 10) // Only offset clause
```
If offset is very large, will generate a lot of overhead. So this PR will refuse use offset clause without limit clause, although we can parse, transform and execute it.

A balanced idea is add a configuration item `spark.sql.forceUsingOffsetWithoutLimit` to force running query when user knows the offset is small enough. The default value of `spark.sql.forceUsingOffsetWithoutLimit` is false. This PR just came up with the idea so that it could be implemented at a better time in the future.

Note: The origin PR to support this feature is https://github.com/apache/spark/pull/25416.
Because the origin PR too old, there exists massive conflict which is hard to resolve. So I open this new PR to support this feature.

### Why are the changes needed?
new feature

### Does this PR introduce any user-facing change?
'No'


### How was this patch tested?
Exists and new UT",2020-02-01T15:45:36Z,2020-02-25T13:26:10Z,,,5e61d3f8ab0fc77d02931b5530deb8cb021fc7b1,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27429/commits,https://api.github.com/repos/apache/spark/pulls/27429/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27429/comments,https://api.github.com/repos/apache/spark/statuses/44b1861cac33ea7692a6d30b0013ff61cfdf280d,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:ansi_offset-clause,ansi_offset-clause,44b1861cac33ea7692a6d30b0013ff61cfdf280d,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8b73b92aadd685b29ef3d9b33366f5e1fd3dae99,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27429,https://github.com/apache/spark/pull/27429,https://api.github.com/repos/apache/spark/issues/27429,https://api.github.com/repos/apache/spark/issues/27429/comments,https://api.github.com/repos/apache/spark/pulls/27429/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27429/commits,https://api.github.com/repos/apache/spark/statuses/44b1861cac33ea7692a6d30b0013ff61cfdf280d
121,https://api.github.com/repos/apache/spark/pulls/27428,369902276,MDExOlB1bGxSZXF1ZXN0MzY5OTAyMjc2,https://github.com/apache/spark/pull/27428,https://github.com/apache/spark/pull/27428.diff,https://github.com/apache/spark/pull/27428.patch,https://api.github.com/repos/apache/spark/issues/27428,27428,open,False,[SPARK-30276][SQL] Support Filter expression allows simultaneous use of DISTINCT,"### What changes were proposed in this pull request?
This PR is related to https://github.com/apache/spark/pull/26656.
https://github.com/apache/spark/pull/26656 only support use FILTER clause on aggregate expression without DISTINCT.
This PR will enhance this feature when one or more DISTINCT aggregate expressions which allows the use of the FILTER clause.
Such as:
```
select sum(distinct id) filter (where sex = 'man') from student;
select class_id, sum(distinct id) filter (where sex = 'man') from student group by class_id;
select count(id) filter (where class_id = 1), sum(distinct id) filter (where sex = 'man') from student;
select class_id, count(id) filter (where class_id = 1), sum(distinct id) filter (where sex = 'man') from student group by class_id;
select sum(distinct id), sum(distinct id) filter (where sex = 'man') from student;
select class_id, sum(distinct id), sum(distinct id) filter (where sex = 'man') from student group by class_id;
select class_id, count(id), count(id) filter (where class_id = 1), sum(distinct id), sum(distinct id) filter (where sex = 'man') from student group by class_id;
```

**Note:**
In https://github.com/apache/spark/pull/26656, we use `AggregationIterator` to treat the filter conditions of aggregate expr. This is good because we can evaluate filter in first aggregate locally.
If we use `AggregationIterator` too, the filter conditions of DISTINCT aggregate expr will be treated in second or thrid aggregate.
In order to reduce cost, we treat the filter conditions of DISTINCT aggregate expr in first aggregate or local is better.
So, this PR uses `Expand` to ensure the evaluation at local.

### Why are the changes needed?
Spark SQL only support use FILTER clause on aggregate expression without DISTINCT.
This PR support Filter expression allows simultaneous use of DISTINCT

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
Exists and new UT ",2020-02-01T14:11:33Z,2020-02-24T09:01:54Z,,,182c23024267dd12e9cdaec4c896add3e8168bf8,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27428/commits,https://api.github.com/repos/apache/spark/pulls/27428/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27428/comments,https://api.github.com/repos/apache/spark/statuses/cd00f915cae0ba453903d6f7329ff11289801954,CONTRIBUTOR,spark,apache,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,beliefer:same_distinct_aggregate_with_filter,same_distinct_aggregate_with_filter,cd00f915cae0ba453903d6f7329ff11289801954,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,237617513,MDEwOlJlcG9zaXRvcnkyMzc2MTc1MTM=,spark,beliefer/spark,False,beliefer,8486025,MDQ6VXNlcjg0ODYwMjU=,https://avatars0.githubusercontent.com/u/8486025?v=4,,https://api.github.com/users/beliefer,https://github.com/beliefer,https://api.github.com/users/beliefer/followers,https://api.github.com/users/beliefer/following{/other_user},https://api.github.com/users/beliefer/gists{/gist_id},https://api.github.com/users/beliefer/starred{/owner}{/repo},https://api.github.com/users/beliefer/subscriptions,https://api.github.com/users/beliefer/orgs,https://api.github.com/users/beliefer/repos,https://api.github.com/users/beliefer/events{/privacy},https://api.github.com/users/beliefer/received_events,User,False,https://github.com/beliefer/spark,Apache Spark,True,https://api.github.com/repos/beliefer/spark,https://api.github.com/repos/beliefer/spark/forks,https://api.github.com/repos/beliefer/spark/keys{/key_id},https://api.github.com/repos/beliefer/spark/collaborators{/collaborator},https://api.github.com/repos/beliefer/spark/teams,https://api.github.com/repos/beliefer/spark/hooks,https://api.github.com/repos/beliefer/spark/issues/events{/number},https://api.github.com/repos/beliefer/spark/events,https://api.github.com/repos/beliefer/spark/assignees{/user},https://api.github.com/repos/beliefer/spark/branches{/branch},https://api.github.com/repos/beliefer/spark/tags,https://api.github.com/repos/beliefer/spark/git/blobs{/sha},https://api.github.com/repos/beliefer/spark/git/tags{/sha},https://api.github.com/repos/beliefer/spark/git/refs{/sha},https://api.github.com/repos/beliefer/spark/git/trees{/sha},https://api.github.com/repos/beliefer/spark/statuses/{sha},https://api.github.com/repos/beliefer/spark/languages,https://api.github.com/repos/beliefer/spark/stargazers,https://api.github.com/repos/beliefer/spark/contributors,https://api.github.com/repos/beliefer/spark/subscribers,https://api.github.com/repos/beliefer/spark/subscription,https://api.github.com/repos/beliefer/spark/commits{/sha},https://api.github.com/repos/beliefer/spark/git/commits{/sha},https://api.github.com/repos/beliefer/spark/comments{/number},https://api.github.com/repos/beliefer/spark/issues/comments{/number},https://api.github.com/repos/beliefer/spark/contents/{+path},https://api.github.com/repos/beliefer/spark/compare/{base}...{head},https://api.github.com/repos/beliefer/spark/merges,https://api.github.com/repos/beliefer/spark/{archive_format}{/ref},https://api.github.com/repos/beliefer/spark/downloads,https://api.github.com/repos/beliefer/spark/issues{/number},https://api.github.com/repos/beliefer/spark/pulls{/number},https://api.github.com/repos/beliefer/spark/milestones{/number},"https://api.github.com/repos/beliefer/spark/notifications{?since,all,participating}",https://api.github.com/repos/beliefer/spark/labels{/name},https://api.github.com/repos/beliefer/spark/releases{/id},https://api.github.com/repos/beliefer/spark/deployments,2020-02-01T13:17:08Z,2020-04-10T04:11:17Z,2020-04-10T08:05:21Z,git://github.com/beliefer/spark.git,git@github.com:beliefer/spark.git,https://github.com/beliefer/spark.git,https://github.com/beliefer/spark,,327053,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,4804445327f06ae3a26365d8f110f06ea07eb637,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27428,https://github.com/apache/spark/pull/27428,https://api.github.com/repos/apache/spark/issues/27428,https://api.github.com/repos/apache/spark/issues/27428/comments,https://api.github.com/repos/apache/spark/pulls/27428/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27428/commits,https://api.github.com/repos/apache/spark/statuses/cd00f915cae0ba453903d6f7329ff11289801954
122,https://api.github.com/repos/apache/spark/pulls/27419,369600294,MDExOlB1bGxSZXF1ZXN0MzY5NjAwMjk0,https://github.com/apache/spark/pull/27419,https://github.com/apache/spark/pull/27419.diff,https://github.com/apache/spark/pull/27419.patch,https://api.github.com/repos/apache/spark/issues/27419,27419,open,False,"[WIP][SPARK-30694][SHUFFLE]If exception occured while fetching blocks by ExternalBlockClient, fail early when External Shuffle Service is not alive","
### What changes were proposed in this pull request?
Like [SPARK-27637](https://github.com/apache/spark/pull/25469), 
When we fetch data use External Shuffle Service, we use ExternalBlockStoreClient to fetch blocks
from External Shuffle Service, in real huge cluster, we always need to offline some bad machine, and remote External Shuffle Service will down and we will can't create TransportClient to connect.
It will throw IOException, but in current way, we will only retry until run out of retry times. 

I think we should throw this error early like  [SPARK-27637](https://github.com/apache/spark/pull/25469)


### Why are the changes needed?
Old solution not comprehensive. Throw exception early and reduce unnecessary retry.


### Does this PR introduce any user-facing change?
NO

### How was this patch tested?
WIP
",2020-01-31T14:11:44Z,2020-03-21T08:53:13Z,,,7aab8093f7af0ee30a912666a6bfb5bf0bce445e,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27419/commits,https://api.github.com/repos/apache/spark/pulls/27419/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27419/comments,https://api.github.com/repos/apache/spark/statuses/2c4995e985baca97838523954395dc68b38b0c3c,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:external-shuffle-client-catch-connection-exception,external-shuffle-client-catch-connection-exception,2c4995e985baca97838523954395dc68b38b0c3c,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,6f4703e22e89a72eb3b0f8c9f84e9a782de82976,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27419,https://github.com/apache/spark/pull/27419,https://api.github.com/repos/apache/spark/issues/27419,https://api.github.com/repos/apache/spark/issues/27419/comments,https://api.github.com/repos/apache/spark/pulls/27419/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27419/commits,https://api.github.com/repos/apache/spark/statuses/2c4995e985baca97838523954395dc68b38b0c3c
123,https://api.github.com/repos/apache/spark/pulls/27402,369022902,MDExOlB1bGxSZXF1ZXN0MzY5MDIyOTAy,https://github.com/apache/spark/pull/27402,https://github.com/apache/spark/pull/27402.diff,https://github.com/apache/spark/pull/27402.patch,https://api.github.com/repos/apache/spark/issues/27402,27402,open,False,[SPARK-30679][SQL] REPLACE TABLE can omit the USING clause,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR updates the parser rule to allow `REPLACE TABLE` statement to omit the `USING` clause.

This is extracted from https://github.com/apache/spark/pull/27345

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
`CREATE TABLE` can omit the `USING` clause, and `REPLACE TABLE` should be consistent.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
yes, now it's easier to write `REPLACE TABLE` command.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
a new test",2020-01-30T11:29:42Z,2020-02-20T15:40:53Z,,,442e4e88dd3e1cb7281e85930c3540bf38bf245f,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27402/commits,https://api.github.com/repos/apache/spark/pulls/27402/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27402/comments,https://api.github.com/repos/apache/spark/statuses/647851c3b6a76f49f9546bbd364202b9fa2d9228,CONTRIBUTOR,spark,apache,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,cloud-fan:rtas,rtas,647851c3b6a76f49f9546bbd364202b9fa2d9228,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,19689699,MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==,spark,cloud-fan/spark,False,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,https://github.com/cloud-fan/spark,Mirror of Apache Spark,True,https://api.github.com/repos/cloud-fan/spark,https://api.github.com/repos/cloud-fan/spark/forks,https://api.github.com/repos/cloud-fan/spark/keys{/key_id},https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator},https://api.github.com/repos/cloud-fan/spark/teams,https://api.github.com/repos/cloud-fan/spark/hooks,https://api.github.com/repos/cloud-fan/spark/issues/events{/number},https://api.github.com/repos/cloud-fan/spark/events,https://api.github.com/repos/cloud-fan/spark/assignees{/user},https://api.github.com/repos/cloud-fan/spark/branches{/branch},https://api.github.com/repos/cloud-fan/spark/tags,https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha},https://api.github.com/repos/cloud-fan/spark/git/tags{/sha},https://api.github.com/repos/cloud-fan/spark/git/refs{/sha},https://api.github.com/repos/cloud-fan/spark/git/trees{/sha},https://api.github.com/repos/cloud-fan/spark/statuses/{sha},https://api.github.com/repos/cloud-fan/spark/languages,https://api.github.com/repos/cloud-fan/spark/stargazers,https://api.github.com/repos/cloud-fan/spark/contributors,https://api.github.com/repos/cloud-fan/spark/subscribers,https://api.github.com/repos/cloud-fan/spark/subscription,https://api.github.com/repos/cloud-fan/spark/commits{/sha},https://api.github.com/repos/cloud-fan/spark/git/commits{/sha},https://api.github.com/repos/cloud-fan/spark/comments{/number},https://api.github.com/repos/cloud-fan/spark/issues/comments{/number},https://api.github.com/repos/cloud-fan/spark/contents/{+path},https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head},https://api.github.com/repos/cloud-fan/spark/merges,https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref},https://api.github.com/repos/cloud-fan/spark/downloads,https://api.github.com/repos/cloud-fan/spark/issues{/number},https://api.github.com/repos/cloud-fan/spark/pulls{/number},https://api.github.com/repos/cloud-fan/spark/milestones{/number},"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}",https://api.github.com/repos/cloud-fan/spark/labels{/name},https://api.github.com/repos/cloud-fan/spark/releases{/id},https://api.github.com/repos/cloud-fan/spark/deployments,2014-05-12T07:32:26Z,2017-06-22T06:57:26Z,2020-04-10T08:35:09Z,git://github.com/cloud-fan/spark.git,git@github.com:cloud-fan/spark.git,https://github.com/cloud-fan/spark.git,https://github.com/cloud-fan/spark,,319781,1,1,Scala,False,True,True,False,False,1,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,1,1,master,apache:master,master,21bc0474bbb16c7648aed40f25a2945d98d2a167,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27402,https://github.com/apache/spark/pull/27402,https://api.github.com/repos/apache/spark/issues/27402,https://api.github.com/repos/apache/spark/issues/27402/comments,https://api.github.com/repos/apache/spark/pulls/27402/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27402/commits,https://api.github.com/repos/apache/spark/statuses/647851c3b6a76f49f9546bbd364202b9fa2d9228
124,https://api.github.com/repos/apache/spark/pulls/27378,368206374,MDExOlB1bGxSZXF1ZXN0MzY4MjA2Mzc0,https://github.com/apache/spark/pull/27378,https://github.com/apache/spark/pull/27378.diff,https://github.com/apache/spark/pull/27378.patch,https://api.github.com/repos/apache/spark/issues/27378,27378,open,False,[SPARK-30366][WebUI] Show cached subplan of InMemoryTableScan and remove redundant subplans,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
1. Adds a InMemoryRelation node and its cachedPlan as a child node of InMemoryTableScan ([SPARK-29431](https://issues.apache.org/jira/browse/SPARK-29431)).
2. De-duplicate identical subplans shared by InMemoryTableScan operators within the same query ([SPARK-30367](https://issues.apache.org/jira/browse/SPARK-30367)).
3. Add computed rows metric to InMemoryRelation operators ([SPARK-30368](https://issues.apache.org/jira/browse/SPARK-30368)).
4. Prune the cached subplan if it was not actually computed ([SPARK-30369](https://issues.apache.org/jira/browse/SPARK-30369)).
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
Currently, if a user caches a dataframe as part of the query, it introduces an InMemoryTableScan operator into the query plan when the cached data is read again. The InMemoryTableScan operator does not have child operators and thus doesn't show the subplan of the query that is run before caching the dataframe.

However, simply showing the subplan as a child of InMemoryTableScan can lead to some confusion for the user. It is possible for the cached dataframe to be read multiple times within the query, which will cause multiple InMemoryTableScan operators to be shown within the plan and thus cause the subplan to be shown multiple times across the query plan even though it is computed only once. 

Additionally, it is possible for the cached dataframe to be read in another query. This will cause the subplan to be shown in a query it was not actually computed in, which is misleading, so we should remove it in this case. However, It is also possible for the dataframe to be partially cached, meaning some partitions are cached whereas some need to be recomputed. In this case, we should still show the subplan in the query as it is will still be computed for some partitions of the dataframe. A ""num computed rows"" metric is added to InMemoryRelation (the child node of InMemoryTableScan which has the subplan as its child) to make it more clear when only some partitions of the cached data are recomputed.

<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
Yes, in the SQL tab of the WebUI. See the JIRA for examples of the WebUI with and without the changes.
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
* Added unit tests in SparkPlanInfoSuite, CachedRDDBuilderSuite, SparkPlanGraphSuite, SparkPlanGraphUpdaterSuite, and SparkPlanGraphNodeTransformersSuite.
* Integration tests using the spark shell to show the desired behavior change in the UI is achieved.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-01-28T20:10:42Z,2020-02-05T18:05:39Z,,,e47ae73d78d78750094c56e87809a6c483a2ce2e,,[],"[{'login': 'wangyum', 'id': 5399861, 'node_id': 'MDQ6VXNlcjUzOTk4NjE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/5399861?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/wangyum', 'html_url': 'https://github.com/wangyum', 'followers_url': 'https://api.github.com/users/wangyum/followers', 'following_url': 'https://api.github.com/users/wangyum/following{/other_user}', 'gists_url': 'https://api.github.com/users/wangyum/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/wangyum/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/wangyum/subscriptions', 'organizations_url': 'https://api.github.com/users/wangyum/orgs', 'repos_url': 'https://api.github.com/users/wangyum/repos', 'events_url': 'https://api.github.com/users/wangyum/events{/privacy}', 'received_events_url': 'https://api.github.com/users/wangyum/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27378/commits,https://api.github.com/repos/apache/spark/pulls/27378/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27378/comments,https://api.github.com/repos/apache/spark/statuses/c992eda9856a66a5a7fc907a95d148ad07dd5f08,NONE,spark,apache,thompsonmax,22264180,MDQ6VXNlcjIyMjY0MTgw,https://avatars2.githubusercontent.com/u/22264180?v=4,,https://api.github.com/users/thompsonmax,https://github.com/thompsonmax,https://api.github.com/users/thompsonmax/followers,https://api.github.com/users/thompsonmax/following{/other_user},https://api.github.com/users/thompsonmax/gists{/gist_id},https://api.github.com/users/thompsonmax/starred{/owner}{/repo},https://api.github.com/users/thompsonmax/subscriptions,https://api.github.com/users/thompsonmax/orgs,https://api.github.com/users/thompsonmax/repos,https://api.github.com/users/thompsonmax/events{/privacy},https://api.github.com/users/thompsonmax/received_events,User,False,thompsonmax:InMemoryTableScan,InMemoryTableScan,c992eda9856a66a5a7fc907a95d148ad07dd5f08,thompsonmax,22264180,MDQ6VXNlcjIyMjY0MTgw,https://avatars2.githubusercontent.com/u/22264180?v=4,,https://api.github.com/users/thompsonmax,https://github.com/thompsonmax,https://api.github.com/users/thompsonmax/followers,https://api.github.com/users/thompsonmax/following{/other_user},https://api.github.com/users/thompsonmax/gists{/gist_id},https://api.github.com/users/thompsonmax/starred{/owner}{/repo},https://api.github.com/users/thompsonmax/subscriptions,https://api.github.com/users/thompsonmax/orgs,https://api.github.com/users/thompsonmax/repos,https://api.github.com/users/thompsonmax/events{/privacy},https://api.github.com/users/thompsonmax/received_events,User,False,236579282,MDEwOlJlcG9zaXRvcnkyMzY1NzkyODI=,spark,thompsonmax/spark,False,thompsonmax,22264180,MDQ6VXNlcjIyMjY0MTgw,https://avatars2.githubusercontent.com/u/22264180?v=4,,https://api.github.com/users/thompsonmax,https://github.com/thompsonmax,https://api.github.com/users/thompsonmax/followers,https://api.github.com/users/thompsonmax/following{/other_user},https://api.github.com/users/thompsonmax/gists{/gist_id},https://api.github.com/users/thompsonmax/starred{/owner}{/repo},https://api.github.com/users/thompsonmax/subscriptions,https://api.github.com/users/thompsonmax/orgs,https://api.github.com/users/thompsonmax/repos,https://api.github.com/users/thompsonmax/events{/privacy},https://api.github.com/users/thompsonmax/received_events,User,False,https://github.com/thompsonmax/spark,Apache Spark,True,https://api.github.com/repos/thompsonmax/spark,https://api.github.com/repos/thompsonmax/spark/forks,https://api.github.com/repos/thompsonmax/spark/keys{/key_id},https://api.github.com/repos/thompsonmax/spark/collaborators{/collaborator},https://api.github.com/repos/thompsonmax/spark/teams,https://api.github.com/repos/thompsonmax/spark/hooks,https://api.github.com/repos/thompsonmax/spark/issues/events{/number},https://api.github.com/repos/thompsonmax/spark/events,https://api.github.com/repos/thompsonmax/spark/assignees{/user},https://api.github.com/repos/thompsonmax/spark/branches{/branch},https://api.github.com/repos/thompsonmax/spark/tags,https://api.github.com/repos/thompsonmax/spark/git/blobs{/sha},https://api.github.com/repos/thompsonmax/spark/git/tags{/sha},https://api.github.com/repos/thompsonmax/spark/git/refs{/sha},https://api.github.com/repos/thompsonmax/spark/git/trees{/sha},https://api.github.com/repos/thompsonmax/spark/statuses/{sha},https://api.github.com/repos/thompsonmax/spark/languages,https://api.github.com/repos/thompsonmax/spark/stargazers,https://api.github.com/repos/thompsonmax/spark/contributors,https://api.github.com/repos/thompsonmax/spark/subscribers,https://api.github.com/repos/thompsonmax/spark/subscription,https://api.github.com/repos/thompsonmax/spark/commits{/sha},https://api.github.com/repos/thompsonmax/spark/git/commits{/sha},https://api.github.com/repos/thompsonmax/spark/comments{/number},https://api.github.com/repos/thompsonmax/spark/issues/comments{/number},https://api.github.com/repos/thompsonmax/spark/contents/{+path},https://api.github.com/repos/thompsonmax/spark/compare/{base}...{head},https://api.github.com/repos/thompsonmax/spark/merges,https://api.github.com/repos/thompsonmax/spark/{archive_format}{/ref},https://api.github.com/repos/thompsonmax/spark/downloads,https://api.github.com/repos/thompsonmax/spark/issues{/number},https://api.github.com/repos/thompsonmax/spark/pulls{/number},https://api.github.com/repos/thompsonmax/spark/milestones{/number},"https://api.github.com/repos/thompsonmax/spark/notifications{?since,all,participating}",https://api.github.com/repos/thompsonmax/spark/labels{/name},https://api.github.com/repos/thompsonmax/spark/releases{/id},https://api.github.com/repos/thompsonmax/spark/deployments,2020-01-27T19:49:56Z,2020-01-27T19:50:00Z,2020-02-03T19:37:36Z,git://github.com/thompsonmax/spark.git,git@github.com:thompsonmax/spark.git,https://github.com/thompsonmax/spark.git,https://github.com/thompsonmax/spark,,319396,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,96d27274f54062a231ff12fd397a3cc051bc063d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27378,https://github.com/apache/spark/pull/27378,https://api.github.com/repos/apache/spark/issues/27378,https://api.github.com/repos/apache/spark/issues/27378/comments,https://api.github.com/repos/apache/spark/pulls/27378/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27378/commits,https://api.github.com/repos/apache/spark/statuses/c992eda9856a66a5a7fc907a95d148ad07dd5f08
125,https://api.github.com/repos/apache/spark/pulls/27377,368189806,MDExOlB1bGxSZXF1ZXN0MzY4MTg5ODA2,https://github.com/apache/spark/pull/27377,https://github.com/apache/spark/pull/27377.diff,https://github.com/apache/spark/pull/27377.patch,https://api.github.com/repos/apache/spark/issues/27377,27377,open,False,[SPARK-30666][Core][WIP] Reliable single-stage accumulators,"### What changes were proposed in this pull request?
This PR introduces a reliable accumulator which only merges the first accumulator from each partition. Together with `AccumulatorMetadata.countFailedValues == false`, this makes accumulator values reliable in the presence of reprocessing partitions.

The current implementation has no means to identify which partition a remote accumulator value is merged from. When partitions are executed multiple times (e.g. re-run on failure or cache eviction, rerunning actions, usage of a stage in multiple actions), accumulators currently consider all partitions' accumulator values.

The `ReliableAccumulator` keeps the first accumulator per partition only. For accumulators registered with `countFailedValues == false`, this provides the accumulator value equivalent to a single successful stage, which does not change any more.

The reliable accumulator on the driver uses additional memory in the order of the number of partitions.

### Why are the changes needed?
With the current behaviour, only a very limited class of accumulator use cases can be implemented, those that count across partition executions. Counting read and written bytes is a good example where this behaviour is desired. Counting the number of rows of the dataset, or rows that meet a certain condition cannot be implemented with this behaviour. The accumulator over-counts and thus only provides a pessimistic upper bound of the true value. With this PR, exact reliable numbers can be extracted.

### Does this PR introduce any user-facing change?
Yes, it introduces the method `ReliableAccumulator.merge(AccumulatorV2, int)` that is called by DAGScheduler to provide the partition id.

### How was this patch tested?
Unit tests in the `ReliableAccumulatorSuite`.",2020-01-28T19:34:09Z,2020-03-17T16:34:25Z,,,ec11b9fadc0e0aef31a501720b7495490cbf8ca4,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27377/commits,https://api.github.com/repos/apache/spark/pulls/27377/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27377/comments,https://api.github.com/repos/apache/spark/statuses/575f10427bb8890411b944a19ec8fe03c1d2f9aa,CONTRIBUTOR,spark,apache,EnricoMi,44700269,MDQ6VXNlcjQ0NzAwMjY5,https://avatars1.githubusercontent.com/u/44700269?v=4,,https://api.github.com/users/EnricoMi,https://github.com/EnricoMi,https://api.github.com/users/EnricoMi/followers,https://api.github.com/users/EnricoMi/following{/other_user},https://api.github.com/users/EnricoMi/gists{/gist_id},https://api.github.com/users/EnricoMi/starred{/owner}{/repo},https://api.github.com/users/EnricoMi/subscriptions,https://api.github.com/users/EnricoMi/orgs,https://api.github.com/users/EnricoMi/repos,https://api.github.com/users/EnricoMi/events{/privacy},https://api.github.com/users/EnricoMi/received_events,User,False,G-Research:branch-accumulator,branch-accumulator,575f10427bb8890411b944a19ec8fe03c1d2f9aa,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,214350064,MDEwOlJlcG9zaXRvcnkyMTQzNTAwNjQ=,spark,G-Research/spark,False,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,https://github.com/G-Research/spark,Apache Spark,True,https://api.github.com/repos/G-Research/spark,https://api.github.com/repos/G-Research/spark/forks,https://api.github.com/repos/G-Research/spark/keys{/key_id},https://api.github.com/repos/G-Research/spark/collaborators{/collaborator},https://api.github.com/repos/G-Research/spark/teams,https://api.github.com/repos/G-Research/spark/hooks,https://api.github.com/repos/G-Research/spark/issues/events{/number},https://api.github.com/repos/G-Research/spark/events,https://api.github.com/repos/G-Research/spark/assignees{/user},https://api.github.com/repos/G-Research/spark/branches{/branch},https://api.github.com/repos/G-Research/spark/tags,https://api.github.com/repos/G-Research/spark/git/blobs{/sha},https://api.github.com/repos/G-Research/spark/git/tags{/sha},https://api.github.com/repos/G-Research/spark/git/refs{/sha},https://api.github.com/repos/G-Research/spark/git/trees{/sha},https://api.github.com/repos/G-Research/spark/statuses/{sha},https://api.github.com/repos/G-Research/spark/languages,https://api.github.com/repos/G-Research/spark/stargazers,https://api.github.com/repos/G-Research/spark/contributors,https://api.github.com/repos/G-Research/spark/subscribers,https://api.github.com/repos/G-Research/spark/subscription,https://api.github.com/repos/G-Research/spark/commits{/sha},https://api.github.com/repos/G-Research/spark/git/commits{/sha},https://api.github.com/repos/G-Research/spark/comments{/number},https://api.github.com/repos/G-Research/spark/issues/comments{/number},https://api.github.com/repos/G-Research/spark/contents/{+path},https://api.github.com/repos/G-Research/spark/compare/{base}...{head},https://api.github.com/repos/G-Research/spark/merges,https://api.github.com/repos/G-Research/spark/{archive_format}{/ref},https://api.github.com/repos/G-Research/spark/downloads,https://api.github.com/repos/G-Research/spark/issues{/number},https://api.github.com/repos/G-Research/spark/pulls{/number},https://api.github.com/repos/G-Research/spark/milestones{/number},"https://api.github.com/repos/G-Research/spark/notifications{?since,all,participating}",https://api.github.com/repos/G-Research/spark/labels{/name},https://api.github.com/repos/G-Research/spark/releases{/id},https://api.github.com/repos/G-Research/spark/deployments,2019-10-11T05:23:46Z,2020-02-11T16:12:31Z,2020-03-05T09:46:15Z,git://github.com/G-Research/spark.git,git@github.com:G-Research/spark.git,https://github.com/G-Research/spark.git,https://github.com/G-Research/spark,,322153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,293e5364e570e8a6569e47e58918db2f1d45ddff,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27377,https://github.com/apache/spark/pull/27377,https://api.github.com/repos/apache/spark/issues/27377,https://api.github.com/repos/apache/spark/issues/27377/comments,https://api.github.com/repos/apache/spark/pulls/27377/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27377/commits,https://api.github.com/repos/apache/spark/statuses/575f10427bb8890411b944a19ec8fe03c1d2f9aa
126,https://api.github.com/repos/apache/spark/pulls/27375,368074181,MDExOlB1bGxSZXF1ZXN0MzY4MDc0MTgx,https://github.com/apache/spark/pull/27375,https://github.com/apache/spark/pull/27375.diff,https://github.com/apache/spark/pull/27375.patch,https://api.github.com/repos/apache/spark/issues/27375,27375,open,False,[SPARK-30664][Web UI] Add optional metrics to all-stages page,"### What changes were proposed in this pull request?
Adding more metrics to the all-stages page, some of those available at the individual stages pages, namely `Peak Execution Memory`, `Spill (Memory)`, `Spill (Disk)` and `GC Time`.

### Why are the changes needed?
Finding stages that perform poorly is difficult when you have hundreds or thousands of stages. Sorting all stages by those extra metrics helps to identify those stages.

### Does this PR introduce any user-facing change?
Yes, in the Web UI, not in the API.
![grafik](https://user-images.githubusercontent.com/44700269/73278310-b2234f80-41eb-11ea-8f38-ff6bda893678.png)
![grafik](https://user-images.githubusercontent.com/44700269/73278326-b8b1c700-41eb-11ea-8c09-714a18642691.png)

### How was this patch tested?
Manual tests.",2020-01-28T15:24:02Z,2020-03-05T15:52:39Z,,,19d63d45627fb1e43324c04cce23245e271ec19d,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27375/commits,https://api.github.com/repos/apache/spark/pulls/27375/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27375/comments,https://api.github.com/repos/apache/spark/statuses/3b8323b6cdcdf70842595d0ef8f44b66455a2d90,CONTRIBUTOR,spark,apache,EnricoMi,44700269,MDQ6VXNlcjQ0NzAwMjY5,https://avatars1.githubusercontent.com/u/44700269?v=4,,https://api.github.com/users/EnricoMi,https://github.com/EnricoMi,https://api.github.com/users/EnricoMi/followers,https://api.github.com/users/EnricoMi/following{/other_user},https://api.github.com/users/EnricoMi/gists{/gist_id},https://api.github.com/users/EnricoMi/starred{/owner}{/repo},https://api.github.com/users/EnricoMi/subscriptions,https://api.github.com/users/EnricoMi/orgs,https://api.github.com/users/EnricoMi/repos,https://api.github.com/users/EnricoMi/events{/privacy},https://api.github.com/users/EnricoMi/received_events,User,False,G-Research:branch-stage-page-with-more-metrics,branch-stage-page-with-more-metrics,3b8323b6cdcdf70842595d0ef8f44b66455a2d90,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,214350064,MDEwOlJlcG9zaXRvcnkyMTQzNTAwNjQ=,spark,G-Research/spark,False,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,https://github.com/G-Research/spark,Apache Spark,True,https://api.github.com/repos/G-Research/spark,https://api.github.com/repos/G-Research/spark/forks,https://api.github.com/repos/G-Research/spark/keys{/key_id},https://api.github.com/repos/G-Research/spark/collaborators{/collaborator},https://api.github.com/repos/G-Research/spark/teams,https://api.github.com/repos/G-Research/spark/hooks,https://api.github.com/repos/G-Research/spark/issues/events{/number},https://api.github.com/repos/G-Research/spark/events,https://api.github.com/repos/G-Research/spark/assignees{/user},https://api.github.com/repos/G-Research/spark/branches{/branch},https://api.github.com/repos/G-Research/spark/tags,https://api.github.com/repos/G-Research/spark/git/blobs{/sha},https://api.github.com/repos/G-Research/spark/git/tags{/sha},https://api.github.com/repos/G-Research/spark/git/refs{/sha},https://api.github.com/repos/G-Research/spark/git/trees{/sha},https://api.github.com/repos/G-Research/spark/statuses/{sha},https://api.github.com/repos/G-Research/spark/languages,https://api.github.com/repos/G-Research/spark/stargazers,https://api.github.com/repos/G-Research/spark/contributors,https://api.github.com/repos/G-Research/spark/subscribers,https://api.github.com/repos/G-Research/spark/subscription,https://api.github.com/repos/G-Research/spark/commits{/sha},https://api.github.com/repos/G-Research/spark/git/commits{/sha},https://api.github.com/repos/G-Research/spark/comments{/number},https://api.github.com/repos/G-Research/spark/issues/comments{/number},https://api.github.com/repos/G-Research/spark/contents/{+path},https://api.github.com/repos/G-Research/spark/compare/{base}...{head},https://api.github.com/repos/G-Research/spark/merges,https://api.github.com/repos/G-Research/spark/{archive_format}{/ref},https://api.github.com/repos/G-Research/spark/downloads,https://api.github.com/repos/G-Research/spark/issues{/number},https://api.github.com/repos/G-Research/spark/pulls{/number},https://api.github.com/repos/G-Research/spark/milestones{/number},"https://api.github.com/repos/G-Research/spark/notifications{?since,all,participating}",https://api.github.com/repos/G-Research/spark/labels{/name},https://api.github.com/repos/G-Research/spark/releases{/id},https://api.github.com/repos/G-Research/spark/deployments,2019-10-11T05:23:46Z,2020-02-11T16:12:31Z,2020-03-05T09:46:15Z,git://github.com/G-Research/spark.git,git@github.com:G-Research/spark.git,https://github.com/G-Research/spark.git,https://github.com/G-Research/spark,,322153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,96d27274f54062a231ff12fd397a3cc051bc063d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27375,https://github.com/apache/spark/pull/27375,https://api.github.com/repos/apache/spark/issues/27375,https://api.github.com/repos/apache/spark/issues/27375/comments,https://api.github.com/repos/apache/spark/pulls/27375/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27375/commits,https://api.github.com/repos/apache/spark/statuses/3b8323b6cdcdf70842595d0ef8f44b66455a2d90
127,https://api.github.com/repos/apache/spark/pulls/27369,367678740,MDExOlB1bGxSZXF1ZXN0MzY3Njc4NzQw,https://github.com/apache/spark/pull/27369,https://github.com/apache/spark/pull/27369.diff,https://github.com/apache/spark/pull/27369.patch,https://api.github.com/repos/apache/spark/issues/27369,27369,open,False,[SPARK-30654] Bootstrap4 docs upgrade,"### What changes were proposed in this pull request?
We are using an older version of Bootstrap (v. 2.1.0) for the online documentation site.  Bootstrap 2.x was moved to EOL in Aug 2013 and Bootstrap 3.x was moved to EOL in July 2019 (https://github.com/twbs/release).  Older versions of Bootstrap are also getting flagged in security scans for various CVEs:

    https://snyk.io/vuln/SNYK-JS-BOOTSTRAP-72889
    https://snyk.io/vuln/SNYK-JS-BOOTSTRAP-173700
    https://snyk.io/vuln/npm:bootstrap:20180529
    https://snyk.io/vuln/npm:bootstrap:20160627

I haven't validated each CVE, but it would probably be good practice to resolve any potential issues and get on a supported release.

The bad news is that there have been quite a few changes between Bootstrap 2 and Bootstrap 4.  I've tried updating the library, refactoring/tweaking the CSS and JS to maintain a similar appearance and functionality, and testing the documentation.  This is a fairly large change so I'm sure additional testing and fixes will be needed.

### How was this patch tested?
This has been manually tested, but as there is a lot of documentation it is possible issues were missed.  Additional testing and feedback is welcomed.  If it appears a whole section was missed let me know and I'll take a pass at addressing that section.",2020-01-27T20:06:54Z,2020-02-28T19:12:18Z,,,8ca88ac88d8365c996236f3bf41d34f4ddabc11f,,[],[],[],"[{'id': 1406627011, 'node_id': 'MDU6TGFiZWwxNDA2NjI3MDEx', 'url': 'https://api.github.com/repos/apache/spark/labels/DOCUMENTATION', 'name': 'DOCUMENTATION', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27369/commits,https://api.github.com/repos/apache/spark/pulls/27369/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27369/comments,https://api.github.com/repos/apache/spark/statuses/85bc0b29b1ecd26c3df67f8d3200ffb74c08c1c8,CONTRIBUTOR,spark,apache,clarkead,13144168,MDQ6VXNlcjEzMTQ0MTY4,https://avatars2.githubusercontent.com/u/13144168?v=4,,https://api.github.com/users/clarkead,https://github.com/clarkead,https://api.github.com/users/clarkead/followers,https://api.github.com/users/clarkead/following{/other_user},https://api.github.com/users/clarkead/gists{/gist_id},https://api.github.com/users/clarkead/starred{/owner}{/repo},https://api.github.com/users/clarkead/subscriptions,https://api.github.com/users/clarkead/orgs,https://api.github.com/users/clarkead/repos,https://api.github.com/users/clarkead/events{/privacy},https://api.github.com/users/clarkead/received_events,User,False,clarkead:bootstrap4-docs-upgrade,bootstrap4-docs-upgrade,85bc0b29b1ecd26c3df67f8d3200ffb74c08c1c8,clarkead,13144168,MDQ6VXNlcjEzMTQ0MTY4,https://avatars2.githubusercontent.com/u/13144168?v=4,,https://api.github.com/users/clarkead,https://github.com/clarkead,https://api.github.com/users/clarkead/followers,https://api.github.com/users/clarkead/following{/other_user},https://api.github.com/users/clarkead/gists{/gist_id},https://api.github.com/users/clarkead/starred{/owner}{/repo},https://api.github.com/users/clarkead/subscriptions,https://api.github.com/users/clarkead/orgs,https://api.github.com/users/clarkead/repos,https://api.github.com/users/clarkead/events{/privacy},https://api.github.com/users/clarkead/received_events,User,False,227725321,MDEwOlJlcG9zaXRvcnkyMjc3MjUzMjE=,spark,clarkead/spark,False,clarkead,13144168,MDQ6VXNlcjEzMTQ0MTY4,https://avatars2.githubusercontent.com/u/13144168?v=4,,https://api.github.com/users/clarkead,https://github.com/clarkead,https://api.github.com/users/clarkead/followers,https://api.github.com/users/clarkead/following{/other_user},https://api.github.com/users/clarkead/gists{/gist_id},https://api.github.com/users/clarkead/starred{/owner}{/repo},https://api.github.com/users/clarkead/subscriptions,https://api.github.com/users/clarkead/orgs,https://api.github.com/users/clarkead/repos,https://api.github.com/users/clarkead/events{/privacy},https://api.github.com/users/clarkead/received_events,User,False,https://github.com/clarkead/spark,Apache Spark,True,https://api.github.com/repos/clarkead/spark,https://api.github.com/repos/clarkead/spark/forks,https://api.github.com/repos/clarkead/spark/keys{/key_id},https://api.github.com/repos/clarkead/spark/collaborators{/collaborator},https://api.github.com/repos/clarkead/spark/teams,https://api.github.com/repos/clarkead/spark/hooks,https://api.github.com/repos/clarkead/spark/issues/events{/number},https://api.github.com/repos/clarkead/spark/events,https://api.github.com/repos/clarkead/spark/assignees{/user},https://api.github.com/repos/clarkead/spark/branches{/branch},https://api.github.com/repos/clarkead/spark/tags,https://api.github.com/repos/clarkead/spark/git/blobs{/sha},https://api.github.com/repos/clarkead/spark/git/tags{/sha},https://api.github.com/repos/clarkead/spark/git/refs{/sha},https://api.github.com/repos/clarkead/spark/git/trees{/sha},https://api.github.com/repos/clarkead/spark/statuses/{sha},https://api.github.com/repos/clarkead/spark/languages,https://api.github.com/repos/clarkead/spark/stargazers,https://api.github.com/repos/clarkead/spark/contributors,https://api.github.com/repos/clarkead/spark/subscribers,https://api.github.com/repos/clarkead/spark/subscription,https://api.github.com/repos/clarkead/spark/commits{/sha},https://api.github.com/repos/clarkead/spark/git/commits{/sha},https://api.github.com/repos/clarkead/spark/comments{/number},https://api.github.com/repos/clarkead/spark/issues/comments{/number},https://api.github.com/repos/clarkead/spark/contents/{+path},https://api.github.com/repos/clarkead/spark/compare/{base}...{head},https://api.github.com/repos/clarkead/spark/merges,https://api.github.com/repos/clarkead/spark/{archive_format}{/ref},https://api.github.com/repos/clarkead/spark/downloads,https://api.github.com/repos/clarkead/spark/issues{/number},https://api.github.com/repos/clarkead/spark/pulls{/number},https://api.github.com/repos/clarkead/spark/milestones{/number},"https://api.github.com/repos/clarkead/spark/notifications{?since,all,participating}",https://api.github.com/repos/clarkead/spark/labels{/name},https://api.github.com/repos/clarkead/spark/releases{/id},https://api.github.com/repos/clarkead/spark/deployments,2019-12-13T00:56:17Z,2020-03-09T17:54:29Z,2020-03-11T21:56:18Z,git://github.com/clarkead/spark.git,git@github.com:clarkead/spark.git,https://github.com/clarkead/spark.git,https://github.com/clarkead/spark,,322937,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3b69796a897a67675b27e192ba9d6714106fdd81,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27369,https://github.com/apache/spark/pull/27369,https://api.github.com/repos/apache/spark/issues/27369,https://api.github.com/repos/apache/spark/issues/27369/comments,https://api.github.com/repos/apache/spark/pulls/27369/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27369/commits,https://api.github.com/repos/apache/spark/statuses/85bc0b29b1ecd26c3df67f8d3200ffb74c08c1c8
128,https://api.github.com/repos/apache/spark/pulls/27366,367449952,MDExOlB1bGxSZXF1ZXN0MzY3NDQ5OTUy,https://github.com/apache/spark/pull/27366,https://github.com/apache/spark/pull/27366.diff,https://github.com/apache/spark/pull/27366.patch,https://api.github.com/repos/apache/spark/issues/27366,27366,open,False,[SPARK-30648][SQL] Support filters pushdown in JSON datasource,"### What changes were proposed in this pull request?
In the PR, I propose to support pushed down filters in JSON datasource. The reason of pushing a filter up to `JacksonParser` is to apply the filter as soon as all its attributes become available i.e. converted from JSON field values to desired values according to the schema. This allows to skip parsing of the rest of JSON record and conversions of other values if the filter returns `false`. This can improve performance when pushed filters are highly selective and conversion of JSON string fields to desired values are comparably expensive ( for example, the conversion to `TIMESTAMP` values).

The main idea behind of `JsonFilters` is to group pushdown filters by their references, convert the grouped filters to expressions, and then compile to predicates. The predicates are indexed by schema field positions. Each predicate has a state with reference counter to non-set row fields. As soon as the counter reaches `0`, it can be applied to the row because all its dependencies has been set. Before processing new row, predicate's reference counter is reset to total number of predicate references (dependencies in a row).

The common code shared between `CSVFilters` and `JsonFilters` is moved to the `StructFilters` class and its companion object.

### Why are the changes needed?
The changes improve performance on synthetic benchmarks up to **27 times** on JDK 8 and **25** times on JDK 11:
```
OpenJDK 64-Bit Server VM 1.8.0_242-8u242-b08-0ubuntu3~18.04-b08 on Linux 4.15.0-1044-aws
Intel(R) Xeon(R) CPU E5-2670 v2 @ 2.50GHz
Filters pushdown:                         Best Time(ms)   Avg Time(ms)   Stdev(ms)    Rate(M/s)   Per Row(ns)   Relative
------------------------------------------------------------------------------------------------------------------------
w/o filters                                       25230          25255          22          0.0      252299.6       1.0X
pushdown disabled                                 25248          25282          33          0.0      252475.6       1.0X
w/ filters                                          905            911           8          0.1        9047.9      27.9X
```

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
- Added new test suites `JsonFiltersSuite` and `JacksonParserSuite`.
- By new end-to-end and case sensitivity tests in `JsonSuite`.
- By `CSVFiltersSuite`, `UnivocityParserSuite` and `CSVSuite`.
- Re-running `CSVBenchmark` and `JsonBenchmark` using Amazon EC2:

| Item | Description |
| ---- | ----|
| Region | us-west-2 (Oregon) |
| Instance | r3.xlarge (spot instance) |
| AMI | ami-06f2f779464715dc5 (ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-20190722.1) |
| Java | OpenJDK8/11 installed by`sudo add-apt-repository ppa:openjdk-r/ppa` & `sudo apt install openjdk-11-jdk`|

and `./dev/run-benchmarks`:
```python
#!/usr/bin/env python3

import os
from sparktestsupport.shellutils import run_cmd

benchmarks = [
    ['sql/test', 'org.apache.spark.sql.execution.datasources.csv.CSVBenchmark'],
    ['sql/test', 'org.apache.spark.sql.execution.datasources.json.JsonBenchmark']
]

print('Set SPARK_GENERATE_BENCHMARK_FILES=1')
os.environ['SPARK_GENERATE_BENCHMARK_FILES'] = '1'

for b in benchmarks:
    print(""Run benchmark: %s"" % b[1])
    run_cmd(['build/sbt', '%s:runMain %s' % (b[0], b[1])])
```",2020-01-27T11:50:35Z,2020-03-26T22:11:07Z,,,c36a3f9554bcff1011ddbd74fe606ef64924e4d9,,[],"[{'login': 'cloud-fan', 'id': 3182036, 'node_id': 'MDQ6VXNlcjMxODIwMzY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/3182036?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/cloud-fan', 'html_url': 'https://github.com/cloud-fan', 'followers_url': 'https://api.github.com/users/cloud-fan/followers', 'following_url': 'https://api.github.com/users/cloud-fan/following{/other_user}', 'gists_url': 'https://api.github.com/users/cloud-fan/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/cloud-fan/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/cloud-fan/subscriptions', 'organizations_url': 'https://api.github.com/users/cloud-fan/orgs', 'repos_url': 'https://api.github.com/users/cloud-fan/repos', 'events_url': 'https://api.github.com/users/cloud-fan/events{/privacy}', 'received_events_url': 'https://api.github.com/users/cloud-fan/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27366/commits,https://api.github.com/repos/apache/spark/pulls/27366/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27366/comments,https://api.github.com/repos/apache/spark/statuses/443992ac9324cedd68ea3d1f93197431fafb0ead,CONTRIBUTOR,spark,apache,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,MaxGekk:json-filters-pushdown,json-filters-pushdown,443992ac9324cedd68ea3d1f93197431fafb0ead,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,123690489,MDEwOlJlcG9zaXRvcnkxMjM2OTA0ODk=,spark,MaxGekk/spark,False,MaxGekk,1580697,MDQ6VXNlcjE1ODA2OTc=,https://avatars1.githubusercontent.com/u/1580697?v=4,,https://api.github.com/users/MaxGekk,https://github.com/MaxGekk,https://api.github.com/users/MaxGekk/followers,https://api.github.com/users/MaxGekk/following{/other_user},https://api.github.com/users/MaxGekk/gists{/gist_id},https://api.github.com/users/MaxGekk/starred{/owner}{/repo},https://api.github.com/users/MaxGekk/subscriptions,https://api.github.com/users/MaxGekk/orgs,https://api.github.com/users/MaxGekk/repos,https://api.github.com/users/MaxGekk/events{/privacy},https://api.github.com/users/MaxGekk/received_events,User,False,https://github.com/MaxGekk/spark,Mirror of Apache Spark,True,https://api.github.com/repos/MaxGekk/spark,https://api.github.com/repos/MaxGekk/spark/forks,https://api.github.com/repos/MaxGekk/spark/keys{/key_id},https://api.github.com/repos/MaxGekk/spark/collaborators{/collaborator},https://api.github.com/repos/MaxGekk/spark/teams,https://api.github.com/repos/MaxGekk/spark/hooks,https://api.github.com/repos/MaxGekk/spark/issues/events{/number},https://api.github.com/repos/MaxGekk/spark/events,https://api.github.com/repos/MaxGekk/spark/assignees{/user},https://api.github.com/repos/MaxGekk/spark/branches{/branch},https://api.github.com/repos/MaxGekk/spark/tags,https://api.github.com/repos/MaxGekk/spark/git/blobs{/sha},https://api.github.com/repos/MaxGekk/spark/git/tags{/sha},https://api.github.com/repos/MaxGekk/spark/git/refs{/sha},https://api.github.com/repos/MaxGekk/spark/git/trees{/sha},https://api.github.com/repos/MaxGekk/spark/statuses/{sha},https://api.github.com/repos/MaxGekk/spark/languages,https://api.github.com/repos/MaxGekk/spark/stargazers,https://api.github.com/repos/MaxGekk/spark/contributors,https://api.github.com/repos/MaxGekk/spark/subscribers,https://api.github.com/repos/MaxGekk/spark/subscription,https://api.github.com/repos/MaxGekk/spark/commits{/sha},https://api.github.com/repos/MaxGekk/spark/git/commits{/sha},https://api.github.com/repos/MaxGekk/spark/comments{/number},https://api.github.com/repos/MaxGekk/spark/issues/comments{/number},https://api.github.com/repos/MaxGekk/spark/contents/{+path},https://api.github.com/repos/MaxGekk/spark/compare/{base}...{head},https://api.github.com/repos/MaxGekk/spark/merges,https://api.github.com/repos/MaxGekk/spark/{archive_format}{/ref},https://api.github.com/repos/MaxGekk/spark/downloads,https://api.github.com/repos/MaxGekk/spark/issues{/number},https://api.github.com/repos/MaxGekk/spark/pulls{/number},https://api.github.com/repos/MaxGekk/spark/milestones{/number},"https://api.github.com/repos/MaxGekk/spark/notifications{?since,all,participating}",https://api.github.com/repos/MaxGekk/spark/labels{/name},https://api.github.com/repos/MaxGekk/spark/releases{/id},https://api.github.com/repos/MaxGekk/spark/deployments,2018-03-03T12:37:00Z,2020-04-10T19:15:57Z,2020-04-10T20:37:52Z,git://github.com/MaxGekk/spark.git,git@github.com:MaxGekk/spark.git,https://github.com/MaxGekk/spark.git,https://github.com/MaxGekk/spark,,325420,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,33f532a9f201fb9c7895d685b3dce82cf042dc61,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27366,https://github.com/apache/spark/pull/27366,https://api.github.com/repos/apache/spark/issues/27366,https://api.github.com/repos/apache/spark/issues/27366/comments,https://api.github.com/repos/apache/spark/pulls/27366/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27366/commits,https://api.github.com/repos/apache/spark/statuses/443992ac9324cedd68ea3d1f93197431fafb0ead
129,https://api.github.com/repos/apache/spark/pulls/27364,367211167,MDExOlB1bGxSZXF1ZXN0MzY3MjExMTY3,https://github.com/apache/spark/pull/27364,https://github.com/apache/spark/pull/27364.diff,https://github.com/apache/spark/pull/27364.patch,https://api.github.com/repos/apache/spark/issues/27364,27364,open,False,[SPARK-31394][K8S] Adds support for Kubernetes NFS volume mounts,"### What changes were proposed in this pull request?
This PR (SPARK-31394) aims to add a new feature that enables mounting of Kubernetes NFS volumes. Most of the codes are just slight modifications from the existing codes for EmptyDir/HostDir/PVC support.

### Why are the changes needed?
Kubernetes supports various kinds of volumes, but Spark for Kubernetes supports only EmptyDir/HostDir/PVC. By adding support for NFS, we can use Spark for Kubernetes with NFS storage.

In order to use NFS with the current Spark using PVC, the user needs to first create an empty new PVC with NFS. Kubernetes' NFS provisioner will create a new empty dir in NFS under some pre-configured dir for this PVC, for example, `/nfs/k8s/sjcho-my-notebook-pvc-dce84888-7a9d-11e6-b1ee-5254001e0c1b`. Then the user should add files to process in the newly created PVC using some file-copying job, and then run the desired Spark job using that populated PVC. And then to get the final results out, the user should run another file-copying job.

This in theory works, but for data analysis tasks, is quite cumbersome. With this change, one could simply use existing files in NFS, say `/nfs/home/sjcho/myfiles@10.sstable` from the Spark job directly, and also write the results directly to some existing dir under NFS such as `/nfs/home/sjcho/output`.

This PR doesn't use any features other than the features already provided by Kubernetes itself, so there should be no compatibility issues (other than limited by k8s) between the wide variety of NFS choices. This PR merely enables an existing volume type `nfs` supported officially by Kubernetes, just like Spark is currently supporting `hostPath` and `persistentVolumeClaim` right now.

### Does this PR introduce any user-facing change?
Users can now mount NFS volumes by running commands like:
```
spark-submit \
--conf spark.kubernetes.driver.volumes.nfs.myshare.mount.path=/myshare \
--conf spark.kubernetes.driver.volumes.nfs.myshare.mount.readOnly=false \
--conf spark.kubernetes.driver.volumes.nfs.myshare.options.server=nfs.example.com \
--conf spark.kubernetes.driver.volumes.nfs.myshare.options.path=/storage/myshare \
...
```

### How was this patch tested?
Test cases were added just like the existing EmptyDir support.
Also the code were ran against my Kubernetes and NFS using pyspark.",2020-01-26T12:10:28Z,2020-04-10T05:46:17Z,,,ca62db22040df2f6d69d59cc2a16fcaf3837b09d,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27364/commits,https://api.github.com/repos/apache/spark/pulls/27364/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27364/comments,https://api.github.com/repos/apache/spark/statuses/dae9b9ca256f6c34c9375a0c8824cbcaf57561c6,NONE,spark,apache,w4-sjcho,8187891,MDQ6VXNlcjgxODc4OTE=,https://avatars2.githubusercontent.com/u/8187891?v=4,,https://api.github.com/users/w4-sjcho,https://github.com/w4-sjcho,https://api.github.com/users/w4-sjcho/followers,https://api.github.com/users/w4-sjcho/following{/other_user},https://api.github.com/users/w4-sjcho/gists{/gist_id},https://api.github.com/users/w4-sjcho/starred{/owner}{/repo},https://api.github.com/users/w4-sjcho/subscriptions,https://api.github.com/users/w4-sjcho/orgs,https://api.github.com/users/w4-sjcho/repos,https://api.github.com/users/w4-sjcho/events{/privacy},https://api.github.com/users/w4-sjcho/received_events,User,False,w4-sjcho:master,master,dae9b9ca256f6c34c9375a0c8824cbcaf57561c6,w4-sjcho,8187891,MDQ6VXNlcjgxODc4OTE=,https://avatars2.githubusercontent.com/u/8187891?v=4,,https://api.github.com/users/w4-sjcho,https://github.com/w4-sjcho,https://api.github.com/users/w4-sjcho/followers,https://api.github.com/users/w4-sjcho/following{/other_user},https://api.github.com/users/w4-sjcho/gists{/gist_id},https://api.github.com/users/w4-sjcho/starred{/owner}{/repo},https://api.github.com/users/w4-sjcho/subscriptions,https://api.github.com/users/w4-sjcho/orgs,https://api.github.com/users/w4-sjcho/repos,https://api.github.com/users/w4-sjcho/events{/privacy},https://api.github.com/users/w4-sjcho/received_events,User,False,235735269,MDEwOlJlcG9zaXRvcnkyMzU3MzUyNjk=,spark,w4-sjcho/spark,False,w4-sjcho,8187891,MDQ6VXNlcjgxODc4OTE=,https://avatars2.githubusercontent.com/u/8187891?v=4,,https://api.github.com/users/w4-sjcho,https://github.com/w4-sjcho,https://api.github.com/users/w4-sjcho/followers,https://api.github.com/users/w4-sjcho/following{/other_user},https://api.github.com/users/w4-sjcho/gists{/gist_id},https://api.github.com/users/w4-sjcho/starred{/owner}{/repo},https://api.github.com/users/w4-sjcho/subscriptions,https://api.github.com/users/w4-sjcho/orgs,https://api.github.com/users/w4-sjcho/repos,https://api.github.com/users/w4-sjcho/events{/privacy},https://api.github.com/users/w4-sjcho/received_events,User,False,https://github.com/w4-sjcho/spark,Apache Spark,True,https://api.github.com/repos/w4-sjcho/spark,https://api.github.com/repos/w4-sjcho/spark/forks,https://api.github.com/repos/w4-sjcho/spark/keys{/key_id},https://api.github.com/repos/w4-sjcho/spark/collaborators{/collaborator},https://api.github.com/repos/w4-sjcho/spark/teams,https://api.github.com/repos/w4-sjcho/spark/hooks,https://api.github.com/repos/w4-sjcho/spark/issues/events{/number},https://api.github.com/repos/w4-sjcho/spark/events,https://api.github.com/repos/w4-sjcho/spark/assignees{/user},https://api.github.com/repos/w4-sjcho/spark/branches{/branch},https://api.github.com/repos/w4-sjcho/spark/tags,https://api.github.com/repos/w4-sjcho/spark/git/blobs{/sha},https://api.github.com/repos/w4-sjcho/spark/git/tags{/sha},https://api.github.com/repos/w4-sjcho/spark/git/refs{/sha},https://api.github.com/repos/w4-sjcho/spark/git/trees{/sha},https://api.github.com/repos/w4-sjcho/spark/statuses/{sha},https://api.github.com/repos/w4-sjcho/spark/languages,https://api.github.com/repos/w4-sjcho/spark/stargazers,https://api.github.com/repos/w4-sjcho/spark/contributors,https://api.github.com/repos/w4-sjcho/spark/subscribers,https://api.github.com/repos/w4-sjcho/spark/subscription,https://api.github.com/repos/w4-sjcho/spark/commits{/sha},https://api.github.com/repos/w4-sjcho/spark/git/commits{/sha},https://api.github.com/repos/w4-sjcho/spark/comments{/number},https://api.github.com/repos/w4-sjcho/spark/issues/comments{/number},https://api.github.com/repos/w4-sjcho/spark/contents/{+path},https://api.github.com/repos/w4-sjcho/spark/compare/{base}...{head},https://api.github.com/repos/w4-sjcho/spark/merges,https://api.github.com/repos/w4-sjcho/spark/{archive_format}{/ref},https://api.github.com/repos/w4-sjcho/spark/downloads,https://api.github.com/repos/w4-sjcho/spark/issues{/number},https://api.github.com/repos/w4-sjcho/spark/pulls{/number},https://api.github.com/repos/w4-sjcho/spark/milestones{/number},"https://api.github.com/repos/w4-sjcho/spark/notifications{?since,all,participating}",https://api.github.com/repos/w4-sjcho/spark/labels{/name},https://api.github.com/repos/w4-sjcho/spark/releases{/id},https://api.github.com/repos/w4-sjcho/spark/deployments,2020-01-23T06:17:40Z,2020-02-06T06:15:38Z,2020-02-06T06:14:52Z,git://github.com/w4-sjcho/spark.git,git@github.com:w4-sjcho/spark.git,https://github.com/w4-sjcho/spark.git,https://github.com/w4-sjcho/spark,,320047,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c27a616450959a5e984d10bf93b12ac0ced6c94d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27364,https://github.com/apache/spark/pull/27364,https://api.github.com/repos/apache/spark/issues/27364,https://api.github.com/repos/apache/spark/issues/27364/comments,https://api.github.com/repos/apache/spark/pulls/27364/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27364/commits,https://api.github.com/repos/apache/spark/statuses/dae9b9ca256f6c34c9375a0c8824cbcaf57561c6
130,https://api.github.com/repos/apache/spark/pulls/27345,366462679,MDExOlB1bGxSZXF1ZXN0MzY2NDYyNjc5,https://github.com/apache/spark/pull/27345,https://github.com/apache/spark/pull/27345.diff,https://github.com/apache/spark/pull/27345.patch,https://api.github.com/repos/apache/spark/issues/27345,27345,open,False,[SPARK-30624][SQL] JDBC v2 with catalog functionalities,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR implements `JDBCTableCatalog`, so that end-users can use the JDBC as a catalog.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
JDBC is a good fit for the new catalog plugin API. It's good to have one builtin implementation of the catalog plugin API.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes, now end-users can register JDBC as a catalog.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
a new test suite.",2020-01-23T16:50:52Z,2020-01-30T01:06:04Z,,,d5f92c4148be61f51b175d95b8d037c01c075ae0,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27345/commits,https://api.github.com/repos/apache/spark/pulls/27345/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27345/comments,https://api.github.com/repos/apache/spark/statuses/f10d256a99de9505b4ebd761bb86e485f7bf8493,CONTRIBUTOR,spark,apache,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,cloud-fan:jdbc,jdbc,f10d256a99de9505b4ebd761bb86e485f7bf8493,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,19689699,MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==,spark,cloud-fan/spark,False,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,https://github.com/cloud-fan/spark,Mirror of Apache Spark,True,https://api.github.com/repos/cloud-fan/spark,https://api.github.com/repos/cloud-fan/spark/forks,https://api.github.com/repos/cloud-fan/spark/keys{/key_id},https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator},https://api.github.com/repos/cloud-fan/spark/teams,https://api.github.com/repos/cloud-fan/spark/hooks,https://api.github.com/repos/cloud-fan/spark/issues/events{/number},https://api.github.com/repos/cloud-fan/spark/events,https://api.github.com/repos/cloud-fan/spark/assignees{/user},https://api.github.com/repos/cloud-fan/spark/branches{/branch},https://api.github.com/repos/cloud-fan/spark/tags,https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha},https://api.github.com/repos/cloud-fan/spark/git/tags{/sha},https://api.github.com/repos/cloud-fan/spark/git/refs{/sha},https://api.github.com/repos/cloud-fan/spark/git/trees{/sha},https://api.github.com/repos/cloud-fan/spark/statuses/{sha},https://api.github.com/repos/cloud-fan/spark/languages,https://api.github.com/repos/cloud-fan/spark/stargazers,https://api.github.com/repos/cloud-fan/spark/contributors,https://api.github.com/repos/cloud-fan/spark/subscribers,https://api.github.com/repos/cloud-fan/spark/subscription,https://api.github.com/repos/cloud-fan/spark/commits{/sha},https://api.github.com/repos/cloud-fan/spark/git/commits{/sha},https://api.github.com/repos/cloud-fan/spark/comments{/number},https://api.github.com/repos/cloud-fan/spark/issues/comments{/number},https://api.github.com/repos/cloud-fan/spark/contents/{+path},https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head},https://api.github.com/repos/cloud-fan/spark/merges,https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref},https://api.github.com/repos/cloud-fan/spark/downloads,https://api.github.com/repos/cloud-fan/spark/issues{/number},https://api.github.com/repos/cloud-fan/spark/pulls{/number},https://api.github.com/repos/cloud-fan/spark/milestones{/number},"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}",https://api.github.com/repos/cloud-fan/spark/labels{/name},https://api.github.com/repos/cloud-fan/spark/releases{/id},https://api.github.com/repos/cloud-fan/spark/deployments,2014-05-12T07:32:26Z,2017-06-22T06:57:26Z,2020-04-10T08:35:09Z,git://github.com/cloud-fan/spark.git,git@github.com:cloud-fan/spark.git,https://github.com/cloud-fan/spark.git,https://github.com/cloud-fan/spark,,319781,1,1,Scala,False,True,True,False,False,1,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,1,1,master,apache:master,master,afe70b3b5321439318a456c7d19b7074171a286a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27345,https://github.com/apache/spark/pull/27345,https://api.github.com/repos/apache/spark/issues/27345,https://api.github.com/repos/apache/spark/issues/27345/comments,https://api.github.com/repos/apache/spark/pulls/27345/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27345/commits,https://api.github.com/repos/apache/spark/statuses/f10d256a99de9505b4ebd761bb86e485f7bf8493
131,https://api.github.com/repos/apache/spark/pulls/27343,366352731,MDExOlB1bGxSZXF1ZXN0MzY2MzUyNzMx,https://github.com/apache/spark/pull/27343,https://github.com/apache/spark/pull/27343.diff,https://github.com/apache/spark/pull/27343.patch,https://api.github.com/repos/apache/spark/issues/27343,27343,open,False,[WIP][SPARK-30621][SQL] Dynamic Pruning thread propagates the localProperties to executionContext,"### What changes were proposed in this pull request?
In `org.apache.spark.sql.execution.SubqueryBroadcastExec#relationFuture` make a copy of `org.apache.spark.SparkContext#localProperties` and pass it to the execution thread in `org.apache.spark.sql.execution.SubqueryBroadcastExec#executionContext`

### Why are the changes needed?
In Dynamic pruning feature, when executing `SubqueryBroadcastExec`, the relationFuture is evaluated via a separate thread. The threads inherit the `localProperties` from `sparkContext` as they are the child threads.
These threads are created in the executionContext (thread pools). Each Thread pool has a default `keepAliveSeconds` of 60 seconds for idle threads.
Scenarios where the thread pool has threads which are idle and reused for a subsequent new query, the thread local properties will not be inherited from spark context (thread properties are inherited only on thread creation) hence end up having old or no properties set. This will cause `SubqueryBroadcastExec#executionContext` local properties to be missing or stale

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
WIP",2020-01-23T13:07:41Z,2020-02-05T18:05:45Z,,,138d506bb1d21ec66058471119f39739744013be,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27343/commits,https://api.github.com/repos/apache/spark/pulls/27343/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27343/comments,https://api.github.com/repos/apache/spark/statuses/1c174bc3eebbb3cb4e5b3d583176eaaf0fee6fff,CONTRIBUTOR,spark,apache,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,ajithme:subquerybroadcastlocalprop,subquerybroadcastlocalprop,1c174bc3eebbb3cb4e5b3d583176eaaf0fee6fff,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,124182301,MDEwOlJlcG9zaXRvcnkxMjQxODIzMDE=,spark,ajithme/spark,False,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,https://github.com/ajithme/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ajithme/spark,https://api.github.com/repos/ajithme/spark/forks,https://api.github.com/repos/ajithme/spark/keys{/key_id},https://api.github.com/repos/ajithme/spark/collaborators{/collaborator},https://api.github.com/repos/ajithme/spark/teams,https://api.github.com/repos/ajithme/spark/hooks,https://api.github.com/repos/ajithme/spark/issues/events{/number},https://api.github.com/repos/ajithme/spark/events,https://api.github.com/repos/ajithme/spark/assignees{/user},https://api.github.com/repos/ajithme/spark/branches{/branch},https://api.github.com/repos/ajithme/spark/tags,https://api.github.com/repos/ajithme/spark/git/blobs{/sha},https://api.github.com/repos/ajithme/spark/git/tags{/sha},https://api.github.com/repos/ajithme/spark/git/refs{/sha},https://api.github.com/repos/ajithme/spark/git/trees{/sha},https://api.github.com/repos/ajithme/spark/statuses/{sha},https://api.github.com/repos/ajithme/spark/languages,https://api.github.com/repos/ajithme/spark/stargazers,https://api.github.com/repos/ajithme/spark/contributors,https://api.github.com/repos/ajithme/spark/subscribers,https://api.github.com/repos/ajithme/spark/subscription,https://api.github.com/repos/ajithme/spark/commits{/sha},https://api.github.com/repos/ajithme/spark/git/commits{/sha},https://api.github.com/repos/ajithme/spark/comments{/number},https://api.github.com/repos/ajithme/spark/issues/comments{/number},https://api.github.com/repos/ajithme/spark/contents/{+path},https://api.github.com/repos/ajithme/spark/compare/{base}...{head},https://api.github.com/repos/ajithme/spark/merges,https://api.github.com/repos/ajithme/spark/{archive_format}{/ref},https://api.github.com/repos/ajithme/spark/downloads,https://api.github.com/repos/ajithme/spark/issues{/number},https://api.github.com/repos/ajithme/spark/pulls{/number},https://api.github.com/repos/ajithme/spark/milestones{/number},"https://api.github.com/repos/ajithme/spark/notifications{?since,all,participating}",https://api.github.com/repos/ajithme/spark/labels{/name},https://api.github.com/repos/ajithme/spark/releases{/id},https://api.github.com/repos/ajithme/spark/deployments,2018-03-07T05:08:43Z,2020-01-15T04:25:12Z,2020-02-18T15:06:53Z,git://github.com/ajithme/spark.git,git@github.com:ajithme/spark.git,https://github.com/ajithme/spark.git,https://github.com/ajithme/spark,,318153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,d0bf4474212e8eef1c6e124eca0772931fccd1fd,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27343,https://github.com/apache/spark/pull/27343,https://api.github.com/repos/apache/spark/issues/27343,https://api.github.com/repos/apache/spark/issues/27343/comments,https://api.github.com/repos/apache/spark/pulls/27343/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27343/commits,https://api.github.com/repos/apache/spark/statuses/1c174bc3eebbb3cb4e5b3d583176eaaf0fee6fff
132,https://api.github.com/repos/apache/spark/pulls/27333,366169120,MDExOlB1bGxSZXF1ZXN0MzY2MTY5MTIw,https://github.com/apache/spark/pull/27333,https://github.com/apache/spark/pull/27333.diff,https://github.com/apache/spark/pull/27333.patch,https://api.github.com/repos/apache/spark/issues/27333,27333,open,False,[SPARK-29438][SS][FOLLOWUP] Add regression tests for Streaming Aggregation and flatMapGroupsWithState,"### What changes were proposed in this pull request?

This patch adds new UTs to prevent SPARK-29438 for streaming aggregation as well as flatMapGroupsWithState, as we agree about the review comment quote here:

https://github.com/apache/spark/pull/26162#issuecomment-576929692

> LGTM for this PR. But on a additional note, this is a very subtle and easy-to-make bug with TaskContext.getPartitionId. I wonder if this bug is present in any other stateful operation. I wonder if this bug is present in any other stateful operation. Can you please verify how partitionId is used in the other stateful operations?

For now they're not broken, but even better if we have UTs to prevent the case for the future.

### Why are the changes needed?

New UTs will prevent streaming aggregation and flatMapGroupsWithState to be broken in future where it is placed on the right side of UNION and the number of partition is changing on the left side of UNION. Please refer SPARK-29438 for more details.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

Added UTs.",2020-01-23T04:00:36Z,2020-03-24T08:38:15Z,,,2779012ce834ed30506bba3e0f0db09d72b49cb7,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27333/commits,https://api.github.com/repos/apache/spark/pulls/27333/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27333/comments,https://api.github.com/repos/apache/spark/statuses/466363edb22ea83a81e21a72f1b983dc7b5a733e,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-29438-add-regression-test,SPARK-29438-add-regression-test,466363edb22ea83a81e21a72f1b983dc7b5a733e,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ca3a64bffb8e709a3c0e3849cdc4cec6a29e29bf,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27333,https://github.com/apache/spark/pull/27333,https://api.github.com/repos/apache/spark/issues/27333,https://api.github.com/repos/apache/spark/issues/27333/comments,https://api.github.com/repos/apache/spark/pulls/27333/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27333/commits,https://api.github.com/repos/apache/spark/statuses/466363edb22ea83a81e21a72f1b983dc7b5a733e
133,https://api.github.com/repos/apache/spark/pulls/27331,366159004,MDExOlB1bGxSZXF1ZXN0MzY2MTU5MDA0,https://github.com/apache/spark/pull/27331,https://github.com/apache/spark/pull/27331.diff,https://github.com/apache/spark/pull/27331.patch,https://api.github.com/repos/apache/spark/issues/27331,27331,open,False,[SPARK-29157][SQL][PYSPARK] Add DataFrameWriterV2 to Python API,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

- Adds `DataFramWriterV2` class.
- Adds `writeTo` method to `pyspark.sql.DataFrame`.
- Adds related SQL partitioning functions (`years`, `months`, ..., `bucket`).


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Feature parity.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Added new unit tests.

TODO: Should we test against `org.apache.spark.sql.connector.InMemoryTableCatalog`? If so, how to expose it in Python tests?
",2020-01-23T03:01:55Z,2020-03-04T19:08:28Z,,,870d941337311bffd7e88e769f84554cb440d4a5,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27331/commits,https://api.github.com/repos/apache/spark/pulls/27331/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27331/comments,https://api.github.com/repos/apache/spark/statuses/ac9eab4fdeb3ae31e452bf8ad0c5cd13f27c055f,CONTRIBUTOR,spark,apache,zero323,1554276,MDQ6VXNlcjE1NTQyNzY=,https://avatars3.githubusercontent.com/u/1554276?v=4,,https://api.github.com/users/zero323,https://github.com/zero323,https://api.github.com/users/zero323/followers,https://api.github.com/users/zero323/following{/other_user},https://api.github.com/users/zero323/gists{/gist_id},https://api.github.com/users/zero323/starred{/owner}{/repo},https://api.github.com/users/zero323/subscriptions,https://api.github.com/users/zero323/orgs,https://api.github.com/users/zero323/repos,https://api.github.com/users/zero323/events{/privacy},https://api.github.com/users/zero323/received_events,User,False,zero323:SPARK-29157,SPARK-29157,ac9eab4fdeb3ae31e452bf8ad0c5cd13f27c055f,zero323,1554276,MDQ6VXNlcjE1NTQyNzY=,https://avatars3.githubusercontent.com/u/1554276?v=4,,https://api.github.com/users/zero323,https://github.com/zero323,https://api.github.com/users/zero323/followers,https://api.github.com/users/zero323/following{/other_user},https://api.github.com/users/zero323/gists{/gist_id},https://api.github.com/users/zero323/starred{/owner}{/repo},https://api.github.com/users/zero323/subscriptions,https://api.github.com/users/zero323/orgs,https://api.github.com/users/zero323/repos,https://api.github.com/users/zero323/events{/privacy},https://api.github.com/users/zero323/received_events,User,False,43824676,MDEwOlJlcG9zaXRvcnk0MzgyNDY3Ng==,spark,zero323/spark,False,zero323,1554276,MDQ6VXNlcjE1NTQyNzY=,https://avatars3.githubusercontent.com/u/1554276?v=4,,https://api.github.com/users/zero323,https://github.com/zero323,https://api.github.com/users/zero323/followers,https://api.github.com/users/zero323/following{/other_user},https://api.github.com/users/zero323/gists{/gist_id},https://api.github.com/users/zero323/starred{/owner}{/repo},https://api.github.com/users/zero323/subscriptions,https://api.github.com/users/zero323/orgs,https://api.github.com/users/zero323/repos,https://api.github.com/users/zero323/events{/privacy},https://api.github.com/users/zero323/received_events,User,False,https://github.com/zero323/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zero323/spark,https://api.github.com/repos/zero323/spark/forks,https://api.github.com/repos/zero323/spark/keys{/key_id},https://api.github.com/repos/zero323/spark/collaborators{/collaborator},https://api.github.com/repos/zero323/spark/teams,https://api.github.com/repos/zero323/spark/hooks,https://api.github.com/repos/zero323/spark/issues/events{/number},https://api.github.com/repos/zero323/spark/events,https://api.github.com/repos/zero323/spark/assignees{/user},https://api.github.com/repos/zero323/spark/branches{/branch},https://api.github.com/repos/zero323/spark/tags,https://api.github.com/repos/zero323/spark/git/blobs{/sha},https://api.github.com/repos/zero323/spark/git/tags{/sha},https://api.github.com/repos/zero323/spark/git/refs{/sha},https://api.github.com/repos/zero323/spark/git/trees{/sha},https://api.github.com/repos/zero323/spark/statuses/{sha},https://api.github.com/repos/zero323/spark/languages,https://api.github.com/repos/zero323/spark/stargazers,https://api.github.com/repos/zero323/spark/contributors,https://api.github.com/repos/zero323/spark/subscribers,https://api.github.com/repos/zero323/spark/subscription,https://api.github.com/repos/zero323/spark/commits{/sha},https://api.github.com/repos/zero323/spark/git/commits{/sha},https://api.github.com/repos/zero323/spark/comments{/number},https://api.github.com/repos/zero323/spark/issues/comments{/number},https://api.github.com/repos/zero323/spark/contents/{+path},https://api.github.com/repos/zero323/spark/compare/{base}...{head},https://api.github.com/repos/zero323/spark/merges,https://api.github.com/repos/zero323/spark/{archive_format}{/ref},https://api.github.com/repos/zero323/spark/downloads,https://api.github.com/repos/zero323/spark/issues{/number},https://api.github.com/repos/zero323/spark/pulls{/number},https://api.github.com/repos/zero323/spark/milestones{/number},"https://api.github.com/repos/zero323/spark/notifications{?since,all,participating}",https://api.github.com/repos/zero323/spark/labels{/name},https://api.github.com/repos/zero323/spark/releases{/id},https://api.github.com/repos/zero323/spark/deployments,2015-10-07T15:16:38Z,2020-04-10T11:38:05Z,2020-04-10T11:37:38Z,git://github.com/zero323/spark.git,git@github.com:zero323/spark.git,https://github.com/zero323/spark.git,https://github.com/zero323/spark,,305981,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,380e8876316d6ef5a74358be2a04ab20e8b6e7ca,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27331,https://github.com/apache/spark/pull/27331,https://api.github.com/repos/apache/spark/issues/27331,https://api.github.com/repos/apache/spark/issues/27331/comments,https://api.github.com/repos/apache/spark/pulls/27331/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27331/commits,https://api.github.com/repos/apache/spark/statuses/ac9eab4fdeb3ae31e452bf8ad0c5cd13f27c055f
134,https://api.github.com/repos/apache/spark/pulls/27316,365633055,MDExOlB1bGxSZXF1ZXN0MzY1NjMzMDU1,https://github.com/apache/spark/pull/27316,https://github.com/apache/spark/pull/27316.diff,https://github.com/apache/spark/pull/27316.patch,https://api.github.com/repos/apache/spark/issues/27316,27316,open,False,[SPARK-26509][SQL] Support DELTA_BYTE_ARRAY encoding for Parquet vectorized reader,"### What changes were proposed in this pull request?
Implement Parquet delta encoding for the vectorized interface, which is needed for V2 pages. The implementation simply delegates the decoding to the Parquet implementation.

#### Reference:
[Parquet encodings](https://github.com/apache/parquet-format/blob/ee02ef8c8f33bd3d5ed0582ded7e20439e12d933/Encodings.md)
[DefaultV2ValuesWriterFactory](https://github.com/apache/parquet-mr/blob/30aa91012cf6019bb9720609c1d03b5386a87ffb/parquet-column/src/main/java/org/apache/parquet/column/values/factory/DefaultV2ValuesWriterFactory.java)

### Why are the changes needed?
Support for parquet DataPageV2.


### Does this PR introduce any user-facing change?


### How was this patch tested?
New UT.

Credit to @nandorKollar, Closes #23988.",2020-01-22T02:29:53Z,2020-02-04T06:02:16Z,,,19c04ff021cec17215f33a60182f70587773815c,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27316/commits,https://api.github.com/repos/apache/spark/pulls/27316/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27316/comments,https://api.github.com/repos/apache/spark/statuses/947c6f732ea127d6f60f0371138127bda6e78770,CONTRIBUTOR,spark,apache,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,xuanyuanking:SPARK-26509,SPARK-26509,947c6f732ea127d6f60f0371138127bda6e78770,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,52511431,MDEwOlJlcG9zaXRvcnk1MjUxMTQzMQ==,spark,xuanyuanking/spark,False,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,https://github.com/xuanyuanking/spark,Mirror of Apache Spark,True,https://api.github.com/repos/xuanyuanking/spark,https://api.github.com/repos/xuanyuanking/spark/forks,https://api.github.com/repos/xuanyuanking/spark/keys{/key_id},https://api.github.com/repos/xuanyuanking/spark/collaborators{/collaborator},https://api.github.com/repos/xuanyuanking/spark/teams,https://api.github.com/repos/xuanyuanking/spark/hooks,https://api.github.com/repos/xuanyuanking/spark/issues/events{/number},https://api.github.com/repos/xuanyuanking/spark/events,https://api.github.com/repos/xuanyuanking/spark/assignees{/user},https://api.github.com/repos/xuanyuanking/spark/branches{/branch},https://api.github.com/repos/xuanyuanking/spark/tags,https://api.github.com/repos/xuanyuanking/spark/git/blobs{/sha},https://api.github.com/repos/xuanyuanking/spark/git/tags{/sha},https://api.github.com/repos/xuanyuanking/spark/git/refs{/sha},https://api.github.com/repos/xuanyuanking/spark/git/trees{/sha},https://api.github.com/repos/xuanyuanking/spark/statuses/{sha},https://api.github.com/repos/xuanyuanking/spark/languages,https://api.github.com/repos/xuanyuanking/spark/stargazers,https://api.github.com/repos/xuanyuanking/spark/contributors,https://api.github.com/repos/xuanyuanking/spark/subscribers,https://api.github.com/repos/xuanyuanking/spark/subscription,https://api.github.com/repos/xuanyuanking/spark/commits{/sha},https://api.github.com/repos/xuanyuanking/spark/git/commits{/sha},https://api.github.com/repos/xuanyuanking/spark/comments{/number},https://api.github.com/repos/xuanyuanking/spark/issues/comments{/number},https://api.github.com/repos/xuanyuanking/spark/contents/{+path},https://api.github.com/repos/xuanyuanking/spark/compare/{base}...{head},https://api.github.com/repos/xuanyuanking/spark/merges,https://api.github.com/repos/xuanyuanking/spark/{archive_format}{/ref},https://api.github.com/repos/xuanyuanking/spark/downloads,https://api.github.com/repos/xuanyuanking/spark/issues{/number},https://api.github.com/repos/xuanyuanking/spark/pulls{/number},https://api.github.com/repos/xuanyuanking/spark/milestones{/number},"https://api.github.com/repos/xuanyuanking/spark/notifications{?since,all,participating}",https://api.github.com/repos/xuanyuanking/spark/labels{/name},https://api.github.com/repos/xuanyuanking/spark/releases{/id},https://api.github.com/repos/xuanyuanking/spark/deployments,2016-02-25T09:08:00Z,2020-03-26T06:11:09Z,2020-03-30T14:23:05Z,git://github.com/xuanyuanking/spark.git,git@github.com:xuanyuanking/spark.git,https://github.com/xuanyuanking/spark.git,https://github.com/xuanyuanking/spark,,315292,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a131031f95dbd426516b88e1dac38965351eb501,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27316,https://github.com/apache/spark/pull/27316,https://api.github.com/repos/apache/spark/issues/27316,https://api.github.com/repos/apache/spark/issues/27316/comments,https://api.github.com/repos/apache/spark/pulls/27316/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27316/commits,https://api.github.com/repos/apache/spark/statuses/947c6f732ea127d6f60f0371138127bda6e78770
135,https://api.github.com/repos/apache/spark/pulls/27314,365562895,MDExOlB1bGxSZXF1ZXN0MzY1NTYyODk1,https://github.com/apache/spark/pull/27314,https://github.com/apache/spark/pull/27314.diff,https://github.com/apache/spark/pull/27314.patch,https://api.github.com/repos/apache/spark/issues/27314,27314,open,False,[SPARK-30600][SQL] Migrate ALTER VIEW SET/UNSET commands to the new framework,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Use the new framework to resolve the ALTER VIEW SET/UNSET TBLPROPERTIES commands.

This PR also introduces `UnresolvedView` and `UnresolvedViewWithTableExists` to the framework to handle commands with views.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
This is a part of effort to make the relation lookup behavior consistent: [SPARK-29900](https://issues.apache.org/jira/browse/SPARK-29900).

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Added new tests.",2020-01-21T22:45:09Z,2020-02-05T18:05:48Z,,,24aa00757f4a31168958fec60288c5464171d199,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27314/commits,https://api.github.com/repos/apache/spark/pulls/27314/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27314/comments,https://api.github.com/repos/apache/spark/statuses/d3b3c278f92e3e519e94ce6ba0a72ad95bb914c9,CONTRIBUTOR,spark,apache,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,imback82:alter_view_new_framework,alter_view_new_framework,d3b3c278f92e3e519e94ce6ba0a72ad95bb914c9,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,190453549,MDEwOlJlcG9zaXRvcnkxOTA0NTM1NDk=,spark-4,imback82/spark-4,False,imback82,12103644,MDQ6VXNlcjEyMTAzNjQ0,https://avatars3.githubusercontent.com/u/12103644?v=4,,https://api.github.com/users/imback82,https://github.com/imback82,https://api.github.com/users/imback82/followers,https://api.github.com/users/imback82/following{/other_user},https://api.github.com/users/imback82/gists{/gist_id},https://api.github.com/users/imback82/starred{/owner}{/repo},https://api.github.com/users/imback82/subscriptions,https://api.github.com/users/imback82/orgs,https://api.github.com/users/imback82/repos,https://api.github.com/users/imback82/events{/privacy},https://api.github.com/users/imback82/received_events,User,False,https://github.com/imback82/spark-4,Apache Spark,True,https://api.github.com/repos/imback82/spark-4,https://api.github.com/repos/imback82/spark-4/forks,https://api.github.com/repos/imback82/spark-4/keys{/key_id},https://api.github.com/repos/imback82/spark-4/collaborators{/collaborator},https://api.github.com/repos/imback82/spark-4/teams,https://api.github.com/repos/imback82/spark-4/hooks,https://api.github.com/repos/imback82/spark-4/issues/events{/number},https://api.github.com/repos/imback82/spark-4/events,https://api.github.com/repos/imback82/spark-4/assignees{/user},https://api.github.com/repos/imback82/spark-4/branches{/branch},https://api.github.com/repos/imback82/spark-4/tags,https://api.github.com/repos/imback82/spark-4/git/blobs{/sha},https://api.github.com/repos/imback82/spark-4/git/tags{/sha},https://api.github.com/repos/imback82/spark-4/git/refs{/sha},https://api.github.com/repos/imback82/spark-4/git/trees{/sha},https://api.github.com/repos/imback82/spark-4/statuses/{sha},https://api.github.com/repos/imback82/spark-4/languages,https://api.github.com/repos/imback82/spark-4/stargazers,https://api.github.com/repos/imback82/spark-4/contributors,https://api.github.com/repos/imback82/spark-4/subscribers,https://api.github.com/repos/imback82/spark-4/subscription,https://api.github.com/repos/imback82/spark-4/commits{/sha},https://api.github.com/repos/imback82/spark-4/git/commits{/sha},https://api.github.com/repos/imback82/spark-4/comments{/number},https://api.github.com/repos/imback82/spark-4/issues/comments{/number},https://api.github.com/repos/imback82/spark-4/contents/{+path},https://api.github.com/repos/imback82/spark-4/compare/{base}...{head},https://api.github.com/repos/imback82/spark-4/merges,https://api.github.com/repos/imback82/spark-4/{archive_format}{/ref},https://api.github.com/repos/imback82/spark-4/downloads,https://api.github.com/repos/imback82/spark-4/issues{/number},https://api.github.com/repos/imback82/spark-4/pulls{/number},https://api.github.com/repos/imback82/spark-4/milestones{/number},"https://api.github.com/repos/imback82/spark-4/notifications{?since,all,participating}",https://api.github.com/repos/imback82/spark-4/labels{/name},https://api.github.com/repos/imback82/spark-4/releases{/id},https://api.github.com/repos/imback82/spark-4/deployments,2019-06-05T19:09:03Z,2020-04-04T00:25:57Z,2020-04-04T23:57:41Z,git://github.com/imback82/spark-4.git,git@github.com:imback82/spark-4.git,https://github.com/imback82/spark-4.git,https://github.com/imback82/spark-4,,325946,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a131031f95dbd426516b88e1dac38965351eb501,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27314,https://github.com/apache/spark/pull/27314,https://api.github.com/repos/apache/spark/issues/27314,https://api.github.com/repos/apache/spark/issues/27314/comments,https://api.github.com/repos/apache/spark/pulls/27314/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27314/commits,https://api.github.com/repos/apache/spark/statuses/d3b3c278f92e3e519e94ce6ba0a72ad95bb914c9
136,https://api.github.com/repos/apache/spark/pulls/27311,365451632,MDExOlB1bGxSZXF1ZXN0MzY1NDUxNjMy,https://github.com/apache/spark/pull/27311,https://github.com/apache/spark/pull/27311.diff,https://github.com/apache/spark/pull/27311.patch,https://api.github.com/repos/apache/spark/issues/27311,27311,open,False,[SPARK-27996][WEBUI] Send HTTP redirect using the correct protocol when Spark History server is deployed behind the reverse proxy,"### What changes were proposed in this pull request?
This PR adds method `updateProtocolFromHeader(request: HttpServletRequest, url: String): String` to JettyUtils.scala and calls this method from when Spark History Server is generating a redirect response.

### Why are the changes needed?
This change is needed to address bug SPARK-27996 in History Server. Please note that similar change is likely needed in Spark UI. The scope of this PR is only to address the problem in History Server.

### Does this PR introduce any user-facing change?
Yes, the Spark History server deployed in Kubernetes now correctly opens the job page.

### How was this patch tested?
The patch was tested by building and deploying Spark History Server to Kubernetes cluster and then observing the behavior of the History Server UI. The regression testing was not performed. I will appreciate is someone can can confirm the Spark History Server still works when deployed on regular infrastructure (e.g. not behind the reverse proxy).
",2020-01-21T18:38:22Z,2020-01-29T05:12:05Z,,,f6f768a86135b05af6cde0889ac485fbc16ca7f4,,[],"[{'login': 'dongjoon-hyun', 'id': 9700541, 'node_id': 'MDQ6VXNlcjk3MDA1NDE=', 'avatar_url': 'https://avatars2.githubusercontent.com/u/9700541?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/dongjoon-hyun', 'html_url': 'https://github.com/dongjoon-hyun', 'followers_url': 'https://api.github.com/users/dongjoon-hyun/followers', 'following_url': 'https://api.github.com/users/dongjoon-hyun/following{/other_user}', 'gists_url': 'https://api.github.com/users/dongjoon-hyun/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/dongjoon-hyun/subscriptions', 'organizations_url': 'https://api.github.com/users/dongjoon-hyun/orgs', 'repos_url': 'https://api.github.com/users/dongjoon-hyun/repos', 'events_url': 'https://api.github.com/users/dongjoon-hyun/events{/privacy}', 'received_events_url': 'https://api.github.com/users/dongjoon-hyun/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27311/commits,https://api.github.com/repos/apache/spark/pulls/27311/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27311/comments,https://api.github.com/repos/apache/spark/statuses/d0727980968ee7a0bd3807298273bc4f94b8ddfd,NONE,spark,apache,ishikin,20684067,MDQ6VXNlcjIwNjg0MDY3,https://avatars3.githubusercontent.com/u/20684067?v=4,,https://api.github.com/users/ishikin,https://github.com/ishikin,https://api.github.com/users/ishikin/followers,https://api.github.com/users/ishikin/following{/other_user},https://api.github.com/users/ishikin/gists{/gist_id},https://api.github.com/users/ishikin/starred{/owner}{/repo},https://api.github.com/users/ishikin/subscriptions,https://api.github.com/users/ishikin/orgs,https://api.github.com/users/ishikin/repos,https://api.github.com/users/ishikin/events{/privacy},https://api.github.com/users/ishikin/received_events,User,False,ishikin:master,master,d0727980968ee7a0bd3807298273bc4f94b8ddfd,ishikin,20684067,MDQ6VXNlcjIwNjg0MDY3,https://avatars3.githubusercontent.com/u/20684067?v=4,,https://api.github.com/users/ishikin,https://github.com/ishikin,https://api.github.com/users/ishikin/followers,https://api.github.com/users/ishikin/following{/other_user},https://api.github.com/users/ishikin/gists{/gist_id},https://api.github.com/users/ishikin/starred{/owner}{/repo},https://api.github.com/users/ishikin/subscriptions,https://api.github.com/users/ishikin/orgs,https://api.github.com/users/ishikin/repos,https://api.github.com/users/ishikin/events{/privacy},https://api.github.com/users/ishikin/received_events,User,False,231417685,MDEwOlJlcG9zaXRvcnkyMzE0MTc2ODU=,spark,ishikin/spark,False,ishikin,20684067,MDQ6VXNlcjIwNjg0MDY3,https://avatars3.githubusercontent.com/u/20684067?v=4,,https://api.github.com/users/ishikin,https://github.com/ishikin,https://api.github.com/users/ishikin/followers,https://api.github.com/users/ishikin/following{/other_user},https://api.github.com/users/ishikin/gists{/gist_id},https://api.github.com/users/ishikin/starred{/owner}{/repo},https://api.github.com/users/ishikin/subscriptions,https://api.github.com/users/ishikin/orgs,https://api.github.com/users/ishikin/repos,https://api.github.com/users/ishikin/events{/privacy},https://api.github.com/users/ishikin/received_events,User,False,https://github.com/ishikin/spark,Apache Spark,True,https://api.github.com/repos/ishikin/spark,https://api.github.com/repos/ishikin/spark/forks,https://api.github.com/repos/ishikin/spark/keys{/key_id},https://api.github.com/repos/ishikin/spark/collaborators{/collaborator},https://api.github.com/repos/ishikin/spark/teams,https://api.github.com/repos/ishikin/spark/hooks,https://api.github.com/repos/ishikin/spark/issues/events{/number},https://api.github.com/repos/ishikin/spark/events,https://api.github.com/repos/ishikin/spark/assignees{/user},https://api.github.com/repos/ishikin/spark/branches{/branch},https://api.github.com/repos/ishikin/spark/tags,https://api.github.com/repos/ishikin/spark/git/blobs{/sha},https://api.github.com/repos/ishikin/spark/git/tags{/sha},https://api.github.com/repos/ishikin/spark/git/refs{/sha},https://api.github.com/repos/ishikin/spark/git/trees{/sha},https://api.github.com/repos/ishikin/spark/statuses/{sha},https://api.github.com/repos/ishikin/spark/languages,https://api.github.com/repos/ishikin/spark/stargazers,https://api.github.com/repos/ishikin/spark/contributors,https://api.github.com/repos/ishikin/spark/subscribers,https://api.github.com/repos/ishikin/spark/subscription,https://api.github.com/repos/ishikin/spark/commits{/sha},https://api.github.com/repos/ishikin/spark/git/commits{/sha},https://api.github.com/repos/ishikin/spark/comments{/number},https://api.github.com/repos/ishikin/spark/issues/comments{/number},https://api.github.com/repos/ishikin/spark/contents/{+path},https://api.github.com/repos/ishikin/spark/compare/{base}...{head},https://api.github.com/repos/ishikin/spark/merges,https://api.github.com/repos/ishikin/spark/{archive_format}{/ref},https://api.github.com/repos/ishikin/spark/downloads,https://api.github.com/repos/ishikin/spark/issues{/number},https://api.github.com/repos/ishikin/spark/pulls{/number},https://api.github.com/repos/ishikin/spark/milestones{/number},"https://api.github.com/repos/ishikin/spark/notifications{?since,all,participating}",https://api.github.com/repos/ishikin/spark/labels{/name},https://api.github.com/repos/ishikin/spark/releases{/id},https://api.github.com/repos/ishikin/spark/deployments,2020-01-02T16:20:02Z,2020-01-24T20:52:05Z,2020-01-24T20:52:02Z,git://github.com/ishikin/spark.git,git@github.com:ishikin/spark.git,https://github.com/ishikin/spark.git,https://github.com/ishikin/spark,,318700,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cfb1706eaa59848cfda88a2f3a6fd90262f55b3e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27311,https://github.com/apache/spark/pull/27311,https://api.github.com/repos/apache/spark/issues/27311,https://api.github.com/repos/apache/spark/issues/27311/comments,https://api.github.com/repos/apache/spark/pulls/27311/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27311/commits,https://api.github.com/repos/apache/spark/statuses/d0727980968ee7a0bd3807298273bc4f94b8ddfd
137,https://api.github.com/repos/apache/spark/pulls/27309,365377446,MDExOlB1bGxSZXF1ZXN0MzY1Mzc3NDQ2,https://github.com/apache/spark/pull/27309,https://github.com/apache/spark/pull/27309.diff,https://github.com/apache/spark/pull/27309.patch,https://api.github.com/repos/apache/spark/issues/27309,27309,open,False,[SPARK-30598][SQL] Detect equijoins better,"# What changes were proposed in this pull request?
The improvement in this is PR can extract equalities from join conditions so that we can recognise implicit equijoins.

E.g. this example query:
```
SELECT * FROM t1 FULL OUTER JOIN t2 ON t1.c2 = 2 AND t2.c2 = 2
```
has the following plan currently:
```
BroadcastNestedLoopJoin BuildRight, FullOuter, ((c2#226 = 2) AND (c2#237 = 2))
:- *(1) Project [_1#220 AS c#225, _2#221 AS c2#226]
:  +- *(1) LocalTableScan [_1#220, _2#221]
+- BroadcastExchange IdentityBroadcastMode, [id=#146]
   +- *(2) Project [_1#231 AS c#236, _2#232 AS c2#237]
      +- *(2) LocalTableScan [_1#231, _2#232]
```
But if we take
```
SELECT * FROM t1 FULL OUTER JOIN t2 ON t1.c2 = 2 AND t2.c2 = 2 AND t1.c2 = t2.c2
```
where the equality between the sides explicitly defined (`t1.c2 = t2.c2`) the plan is:
```
SortMergeJoin [c#225], [c#236], FullOuter, ((c2#226 = 2) AND (c2#237 = 2))
:- *(2) Sort [c#225 ASC NULLS FIRST], false, 0
:  +- Exchange hashpartitioning(c#225, 5), true, [id=#101]
:     +- *(1) Project [_1#220 AS c#225, _2#221 AS c2#226]
:        +- *(1) LocalTableScan [_1#220, _2#221]
+- *(4) Sort [c#236 ASC NULLS FIRST], false, 0
   +- Exchange hashpartitioning(c#236, 5), true, [id=#106]
      +- *(3) Project [_1#231 AS c#236, _2#232 AS c2#237]
         +- *(3) LocalTableScan [_1#231, _2#232]
```
The second plan is better as SMJ doesn't have the broadcast size limitation as BNLJ do.
After this PR the implicit equalities are detected and the first query has the same plan as the second.

### Why are the changes needed?
Improve stability.

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Existing and new UTs.",2020-01-21T15:52:09Z,2020-01-23T11:52:58Z,,,4f1914913b7069294e9e4b4f6455097432fc43b9,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27309/commits,https://api.github.com/repos/apache/spark/pulls/27309/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27309/comments,https://api.github.com/repos/apache/spark/statuses/6dfd8c02a4215d862ee469650a4d0a4b77f0861f,CONTRIBUTOR,spark,apache,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,peter-toth:SPARK-30598-detect-equijoins-better,SPARK-30598-detect-equijoins-better,6dfd8c02a4215d862ee469650a4d0a4b77f0861f,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,130546049,MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=,spark,peter-toth/spark,False,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,https://github.com/peter-toth/spark,Mirror of Apache Spark,True,https://api.github.com/repos/peter-toth/spark,https://api.github.com/repos/peter-toth/spark/forks,https://api.github.com/repos/peter-toth/spark/keys{/key_id},https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator},https://api.github.com/repos/peter-toth/spark/teams,https://api.github.com/repos/peter-toth/spark/hooks,https://api.github.com/repos/peter-toth/spark/issues/events{/number},https://api.github.com/repos/peter-toth/spark/events,https://api.github.com/repos/peter-toth/spark/assignees{/user},https://api.github.com/repos/peter-toth/spark/branches{/branch},https://api.github.com/repos/peter-toth/spark/tags,https://api.github.com/repos/peter-toth/spark/git/blobs{/sha},https://api.github.com/repos/peter-toth/spark/git/tags{/sha},https://api.github.com/repos/peter-toth/spark/git/refs{/sha},https://api.github.com/repos/peter-toth/spark/git/trees{/sha},https://api.github.com/repos/peter-toth/spark/statuses/{sha},https://api.github.com/repos/peter-toth/spark/languages,https://api.github.com/repos/peter-toth/spark/stargazers,https://api.github.com/repos/peter-toth/spark/contributors,https://api.github.com/repos/peter-toth/spark/subscribers,https://api.github.com/repos/peter-toth/spark/subscription,https://api.github.com/repos/peter-toth/spark/commits{/sha},https://api.github.com/repos/peter-toth/spark/git/commits{/sha},https://api.github.com/repos/peter-toth/spark/comments{/number},https://api.github.com/repos/peter-toth/spark/issues/comments{/number},https://api.github.com/repos/peter-toth/spark/contents/{+path},https://api.github.com/repos/peter-toth/spark/compare/{base}...{head},https://api.github.com/repos/peter-toth/spark/merges,https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref},https://api.github.com/repos/peter-toth/spark/downloads,https://api.github.com/repos/peter-toth/spark/issues{/number},https://api.github.com/repos/peter-toth/spark/pulls{/number},https://api.github.com/repos/peter-toth/spark/milestones{/number},"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}",https://api.github.com/repos/peter-toth/spark/labels{/name},https://api.github.com/repos/peter-toth/spark/releases{/id},https://api.github.com/repos/peter-toth/spark/deployments,2018-04-22T07:43:37Z,2018-04-22T07:44:03Z,2020-03-31T12:39:44Z,git://github.com/peter-toth/spark.git,git@github.com:peter-toth/spark.git,https://github.com/peter-toth/spark.git,https://github.com/peter-toth/spark,,330225,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cfb1706eaa59848cfda88a2f3a6fd90262f55b3e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27309,https://github.com/apache/spark/pull/27309,https://api.github.com/repos/apache/spark/issues/27309,https://api.github.com/repos/apache/spark/issues/27309/comments,https://api.github.com/repos/apache/spark/pulls/27309/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27309/commits,https://api.github.com/repos/apache/spark/statuses/6dfd8c02a4215d862ee469650a4d0a4b77f0861f
138,https://api.github.com/repos/apache/spark/pulls/27286,364658392,MDExOlB1bGxSZXF1ZXN0MzY0NjU4Mzky,https://github.com/apache/spark/pull/27286,https://github.com/apache/spark/pull/27286.diff,https://github.com/apache/spark/pull/27286.patch,https://api.github.com/repos/apache/spark/issues/27286,27286,open,False,"[SPARK-30576] [SS]  block streaming batch commit, until completed。","## What changes were proposed in this pull request?
When the current job is not completed block streaming batch commit, until completed。The next job will merge all batch which  during the blocking.
## How was this patch tested?
 the input seq [1, 2, 3, 4, 5, 6]。 
batch duration: 1s。
The 3th batch will take a long time。Normally the other batches will be completed quickly.
We expect:
      1. the 4th batch will not be commited during the 3th batch computing, and 4th batch will be merge in the next batch. So that
the size of jobSets  is always less than 1。
      2. the num completedBatches less than the size of seq。
      3. the data is not lost",2020-01-20T06:02:42Z,2020-02-05T18:05:50Z,,,61b88b53af83a939a1bb9d0da4c4d042cd340f4d,,[],[],[],"[{'id': 1406587334, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzM0', 'url': 'https://api.github.com/repos/apache/spark/labels/DSTREAMS', 'name': 'DSTREAMS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27286/commits,https://api.github.com/repos/apache/spark/pulls/27286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27286/comments,https://api.github.com/repos/apache/spark/statuses/2b31011a5f737dbccb2620c3c44cd74cb85929bc,NONE,spark,apache,yingshikong186,18115524,MDQ6VXNlcjE4MTE1NTI0,https://avatars3.githubusercontent.com/u/18115524?v=4,,https://api.github.com/users/yingshikong186,https://github.com/yingshikong186,https://api.github.com/users/yingshikong186/followers,https://api.github.com/users/yingshikong186/following{/other_user},https://api.github.com/users/yingshikong186/gists{/gist_id},https://api.github.com/users/yingshikong186/starred{/owner}{/repo},https://api.github.com/users/yingshikong186/subscriptions,https://api.github.com/users/yingshikong186/orgs,https://api.github.com/users/yingshikong186/repos,https://api.github.com/users/yingshikong186/events{/privacy},https://api.github.com/users/yingshikong186/received_events,User,False,yingshikong186:onlyOneBatch,onlyOneBatch,2b31011a5f737dbccb2620c3c44cd74cb85929bc,yingshikong186,18115524,MDQ6VXNlcjE4MTE1NTI0,https://avatars3.githubusercontent.com/u/18115524?v=4,,https://api.github.com/users/yingshikong186,https://github.com/yingshikong186,https://api.github.com/users/yingshikong186/followers,https://api.github.com/users/yingshikong186/following{/other_user},https://api.github.com/users/yingshikong186/gists{/gist_id},https://api.github.com/users/yingshikong186/starred{/owner}{/repo},https://api.github.com/users/yingshikong186/subscriptions,https://api.github.com/users/yingshikong186/orgs,https://api.github.com/users/yingshikong186/repos,https://api.github.com/users/yingshikong186/events{/privacy},https://api.github.com/users/yingshikong186/received_events,User,False,180741459,MDEwOlJlcG9zaXRvcnkxODA3NDE0NTk=,spark,yingshikong186/spark,False,yingshikong186,18115524,MDQ6VXNlcjE4MTE1NTI0,https://avatars3.githubusercontent.com/u/18115524?v=4,,https://api.github.com/users/yingshikong186,https://github.com/yingshikong186,https://api.github.com/users/yingshikong186/followers,https://api.github.com/users/yingshikong186/following{/other_user},https://api.github.com/users/yingshikong186/gists{/gist_id},https://api.github.com/users/yingshikong186/starred{/owner}{/repo},https://api.github.com/users/yingshikong186/subscriptions,https://api.github.com/users/yingshikong186/orgs,https://api.github.com/users/yingshikong186/repos,https://api.github.com/users/yingshikong186/events{/privacy},https://api.github.com/users/yingshikong186/received_events,User,False,https://github.com/yingshikong186/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yingshikong186/spark,https://api.github.com/repos/yingshikong186/spark/forks,https://api.github.com/repos/yingshikong186/spark/keys{/key_id},https://api.github.com/repos/yingshikong186/spark/collaborators{/collaborator},https://api.github.com/repos/yingshikong186/spark/teams,https://api.github.com/repos/yingshikong186/spark/hooks,https://api.github.com/repos/yingshikong186/spark/issues/events{/number},https://api.github.com/repos/yingshikong186/spark/events,https://api.github.com/repos/yingshikong186/spark/assignees{/user},https://api.github.com/repos/yingshikong186/spark/branches{/branch},https://api.github.com/repos/yingshikong186/spark/tags,https://api.github.com/repos/yingshikong186/spark/git/blobs{/sha},https://api.github.com/repos/yingshikong186/spark/git/tags{/sha},https://api.github.com/repos/yingshikong186/spark/git/refs{/sha},https://api.github.com/repos/yingshikong186/spark/git/trees{/sha},https://api.github.com/repos/yingshikong186/spark/statuses/{sha},https://api.github.com/repos/yingshikong186/spark/languages,https://api.github.com/repos/yingshikong186/spark/stargazers,https://api.github.com/repos/yingshikong186/spark/contributors,https://api.github.com/repos/yingshikong186/spark/subscribers,https://api.github.com/repos/yingshikong186/spark/subscription,https://api.github.com/repos/yingshikong186/spark/commits{/sha},https://api.github.com/repos/yingshikong186/spark/git/commits{/sha},https://api.github.com/repos/yingshikong186/spark/comments{/number},https://api.github.com/repos/yingshikong186/spark/issues/comments{/number},https://api.github.com/repos/yingshikong186/spark/contents/{+path},https://api.github.com/repos/yingshikong186/spark/compare/{base}...{head},https://api.github.com/repos/yingshikong186/spark/merges,https://api.github.com/repos/yingshikong186/spark/{archive_format}{/ref},https://api.github.com/repos/yingshikong186/spark/downloads,https://api.github.com/repos/yingshikong186/spark/issues{/number},https://api.github.com/repos/yingshikong186/spark/pulls{/number},https://api.github.com/repos/yingshikong186/spark/milestones{/number},"https://api.github.com/repos/yingshikong186/spark/notifications{?since,all,participating}",https://api.github.com/repos/yingshikong186/spark/labels{/name},https://api.github.com/repos/yingshikong186/spark/releases{/id},https://api.github.com/repos/yingshikong186/spark/deployments,2019-04-11T07:47:29Z,2020-01-20T04:32:48Z,2020-01-20T13:10:48Z,git://github.com/yingshikong186/spark.git,git@github.com:yingshikong186/spark.git,https://github.com/yingshikong186/spark.git,https://github.com/yingshikong186/spark,,313165,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,00039cc482643a4f0a511813970b4727005da1b3,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27286,https://github.com/apache/spark/pull/27286,https://api.github.com/repos/apache/spark/issues/27286,https://api.github.com/repos/apache/spark/issues/27286/comments,https://api.github.com/repos/apache/spark/pulls/27286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27286/commits,https://api.github.com/repos/apache/spark/statuses/2b31011a5f737dbccb2620c3c44cd74cb85929bc
139,https://api.github.com/repos/apache/spark/pulls/27257,364025943,MDExOlB1bGxSZXF1ZXN0MzY0MDI1OTQz,https://github.com/apache/spark/pull/27257,https://github.com/apache/spark/pull/27257.diff,https://github.com/apache/spark/pull/27257.patch,https://api.github.com/repos/apache/spark/issues/27257,27257,open,False,[SPARK-30540][WEBUI] HistoryServer application link is incorrect when one application having multiple attempts,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Add returning params of attempId in js script file.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
When having multiple attempts, the applicaiton link is incorrect. No matter which attempt is clicked, the link still points to the largest attemptId.This patch fix it.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes, before screenshot as follows:
![屏幕快照 2020-01-17 下午3 22 46](https://user-images.githubusercontent.com/8609142/72597510-e7f14a00-3948-11ea-9c91-7c31d9979a82.png)

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
WebUI involved, may not require testing",2020-01-17T08:28:34Z,2020-01-23T11:10:10Z,,,7257a6ee64360bf4cf8d5c92dddeebaacfd87cb3,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27257/commits,https://api.github.com/repos/apache/spark/pulls/27257/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27257/comments,https://api.github.com/repos/apache/spark/statuses/4ea704231acae8d99aa5d3005271c51a93d083b5,NONE,spark,apache,zuston,8609142,MDQ6VXNlcjg2MDkxNDI=,https://avatars0.githubusercontent.com/u/8609142?v=4,,https://api.github.com/users/zuston,https://github.com/zuston,https://api.github.com/users/zuston/followers,https://api.github.com/users/zuston/following{/other_user},https://api.github.com/users/zuston/gists{/gist_id},https://api.github.com/users/zuston/starred{/owner}{/repo},https://api.github.com/users/zuston/subscriptions,https://api.github.com/users/zuston/orgs,https://api.github.com/users/zuston/repos,https://api.github.com/users/zuston/events{/privacy},https://api.github.com/users/zuston/received_events,User,False,zuston:SPARK-30540,SPARK-30540,4ea704231acae8d99aa5d3005271c51a93d083b5,zuston,8609142,MDQ6VXNlcjg2MDkxNDI=,https://avatars0.githubusercontent.com/u/8609142?v=4,,https://api.github.com/users/zuston,https://github.com/zuston,https://api.github.com/users/zuston/followers,https://api.github.com/users/zuston/following{/other_user},https://api.github.com/users/zuston/gists{/gist_id},https://api.github.com/users/zuston/starred{/owner}{/repo},https://api.github.com/users/zuston/subscriptions,https://api.github.com/users/zuston/orgs,https://api.github.com/users/zuston/repos,https://api.github.com/users/zuston/events{/privacy},https://api.github.com/users/zuston/received_events,User,False,171999995,MDEwOlJlcG9zaXRvcnkxNzE5OTk5OTU=,spark,zuston/spark,False,zuston,8609142,MDQ6VXNlcjg2MDkxNDI=,https://avatars0.githubusercontent.com/u/8609142?v=4,,https://api.github.com/users/zuston,https://github.com/zuston,https://api.github.com/users/zuston/followers,https://api.github.com/users/zuston/following{/other_user},https://api.github.com/users/zuston/gists{/gist_id},https://api.github.com/users/zuston/starred{/owner}{/repo},https://api.github.com/users/zuston/subscriptions,https://api.github.com/users/zuston/orgs,https://api.github.com/users/zuston/repos,https://api.github.com/users/zuston/events{/privacy},https://api.github.com/users/zuston/received_events,User,False,https://github.com/zuston/spark,Apache Spark,True,https://api.github.com/repos/zuston/spark,https://api.github.com/repos/zuston/spark/forks,https://api.github.com/repos/zuston/spark/keys{/key_id},https://api.github.com/repos/zuston/spark/collaborators{/collaborator},https://api.github.com/repos/zuston/spark/teams,https://api.github.com/repos/zuston/spark/hooks,https://api.github.com/repos/zuston/spark/issues/events{/number},https://api.github.com/repos/zuston/spark/events,https://api.github.com/repos/zuston/spark/assignees{/user},https://api.github.com/repos/zuston/spark/branches{/branch},https://api.github.com/repos/zuston/spark/tags,https://api.github.com/repos/zuston/spark/git/blobs{/sha},https://api.github.com/repos/zuston/spark/git/tags{/sha},https://api.github.com/repos/zuston/spark/git/refs{/sha},https://api.github.com/repos/zuston/spark/git/trees{/sha},https://api.github.com/repos/zuston/spark/statuses/{sha},https://api.github.com/repos/zuston/spark/languages,https://api.github.com/repos/zuston/spark/stargazers,https://api.github.com/repos/zuston/spark/contributors,https://api.github.com/repos/zuston/spark/subscribers,https://api.github.com/repos/zuston/spark/subscription,https://api.github.com/repos/zuston/spark/commits{/sha},https://api.github.com/repos/zuston/spark/git/commits{/sha},https://api.github.com/repos/zuston/spark/comments{/number},https://api.github.com/repos/zuston/spark/issues/comments{/number},https://api.github.com/repos/zuston/spark/contents/{+path},https://api.github.com/repos/zuston/spark/compare/{base}...{head},https://api.github.com/repos/zuston/spark/merges,https://api.github.com/repos/zuston/spark/{archive_format}{/ref},https://api.github.com/repos/zuston/spark/downloads,https://api.github.com/repos/zuston/spark/issues{/number},https://api.github.com/repos/zuston/spark/pulls{/number},https://api.github.com/repos/zuston/spark/milestones{/number},"https://api.github.com/repos/zuston/spark/notifications{?since,all,participating}",https://api.github.com/repos/zuston/spark/labels{/name},https://api.github.com/repos/zuston/spark/releases{/id},https://api.github.com/repos/zuston/spark/deployments,2019-02-22T05:28:17Z,2020-01-17T08:20:44Z,2020-01-23T07:34:13Z,git://github.com/zuston/spark.git,git@github.com:zuston/spark.git,https://github.com/zuston/spark.git,https://github.com/zuston/spark,,315868,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2330a5682d376c21b73dbdf5ea10e253941e8cc8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27257,https://github.com/apache/spark/pull/27257,https://api.github.com/repos/apache/spark/issues/27257,https://api.github.com/repos/apache/spark/issues/27257/comments,https://api.github.com/repos/apache/spark/pulls/27257/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27257/commits,https://api.github.com/repos/apache/spark/statuses/4ea704231acae8d99aa5d3005271c51a93d083b5
140,https://api.github.com/repos/apache/spark/pulls/27248,363949420,MDExOlB1bGxSZXF1ZXN0MzYzOTQ5NDIw,https://github.com/apache/spark/pull/27248,https://github.com/apache/spark/pull/27248.diff,https://github.com/apache/spark/pull/27248.patch,https://api.github.com/repos/apache/spark/issues/27248,27248,open,False,[WIP][SPARK-30538][SQL] Control spark sql output small file by merge small partition,"### What changes were proposed in this pull request?
Add a method to control small file problem


### Why are the changes needed?
Spark SQL always generate too many small files of insert type SQL result, here we add a control method to minimize the output file number automatic。

### Does this PR introduce any user-facing change?
When set `spark.sql.files.mergeSmallFile.enabled=false`, 
we will combine neighbouring small partition, then will reduce output small files 

### How was this patch tested?
manual tested 
```
create table test_dy_data(id string, dt string);
create table test_dy_part(id string) partitioned by(dt string);

insert into table test_dy_data select 1, '20191201';
insert into table test_dy_data select 2, '20191201';
insert into table test_dy_data select 3, '20191201';
insert into table test_dy_data select 4, '20191201';
insert into table test_dy_data select 5, '20191201';
insert into table test_dy_data select 6, '20191201';
insert into table test_dy_data select 7, '20191201';
insert into table test_dy_data select 8, '20191201';



insert into table test_dy_data select 1, '20191202';
insert into table test_dy_data select 2, '20191202';
insert into table test_dy_data select 3, '20191202';
insert into table test_dy_data select 4, '20191202';
insert into table test_dy_data select 5, '20191202';
insert into table test_dy_data select 6, '20191202';
insert into table test_dy_data select 7, '20191202';
insert into table test_dy_data select 8, '20191202';

insert into table test_dy_data select 1, '20191203';
insert into table test_dy_data select 2, '20191203';
insert into table test_dy_data select 3, '20191203';
insert into table test_dy_data select 4, '20191203';
insert into table test_dy_data select 5, '20191203';
insert into table test_dy_data select 6, '20191203';
insert into table test_dy_data select 7, '20191203';
insert into table test_dy_data select 8, '20191203';


set hive.exec.stagingdir=/Users/angerszhu/Documents/data/;
set hive.exec.dynamic.partition.mode=nonstrict;

insert overwrite table test_dy_part select * from test_dy_data;
```
**spark.sql.files.mergeSmallFile.enabled=false**
![image](https://user-images.githubusercontent.com/46485123/72582761-d1ce9400-391e-11ea-8a9e-5dbf10112288.png)

**spark.sql.files.mergeSmallFile.enabled=true**

![image](https://user-images.githubusercontent.com/46485123/72582803-f9bdf780-391e-11ea-806a-cf45217cb3fa.png)
",2020-01-17T03:43:22Z,2020-03-28T07:50:53Z,,,67e51be22da471d2db19e4494a6b897240eec90c,,[],"[{'login': 'viirya', 'id': 68855, 'node_id': 'MDQ6VXNlcjY4ODU1', 'avatar_url': 'https://avatars1.githubusercontent.com/u/68855?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/viirya', 'html_url': 'https://github.com/viirya', 'followers_url': 'https://api.github.com/users/viirya/followers', 'following_url': 'https://api.github.com/users/viirya/following{/other_user}', 'gists_url': 'https://api.github.com/users/viirya/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/viirya/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/viirya/subscriptions', 'organizations_url': 'https://api.github.com/users/viirya/orgs', 'repos_url': 'https://api.github.com/users/viirya/repos', 'events_url': 'https://api.github.com/users/viirya/events{/privacy}', 'received_events_url': 'https://api.github.com/users/viirya/received_events', 'type': 'User', 'site_admin': False}, {'login': 'cloud-fan', 'id': 3182036, 'node_id': 'MDQ6VXNlcjMxODIwMzY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/3182036?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/cloud-fan', 'html_url': 'https://github.com/cloud-fan', 'followers_url': 'https://api.github.com/users/cloud-fan/followers', 'following_url': 'https://api.github.com/users/cloud-fan/following{/other_user}', 'gists_url': 'https://api.github.com/users/cloud-fan/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/cloud-fan/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/cloud-fan/subscriptions', 'organizations_url': 'https://api.github.com/users/cloud-fan/orgs', 'repos_url': 'https://api.github.com/users/cloud-fan/repos', 'events_url': 'https://api.github.com/users/cloud-fan/events{/privacy}', 'received_events_url': 'https://api.github.com/users/cloud-fan/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27248/commits,https://api.github.com/repos/apache/spark/pulls/27248/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27248/comments,https://api.github.com/repos/apache/spark/statuses/14cd426e871306af6f8afa7932a4bb7965e8fb4b,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:small-file-merge-by-size,small-file-merge-by-size,14cd426e871306af6f8afa7932a4bb7965e8fb4b,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,4398dfa709598226517474afbf47cd9e3e384826,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27248,https://github.com/apache/spark/pull/27248,https://api.github.com/repos/apache/spark/issues/27248,https://api.github.com/repos/apache/spark/issues/27248/comments,https://api.github.com/repos/apache/spark/pulls/27248/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27248/commits,https://api.github.com/repos/apache/spark/statuses/14cd426e871306af6f8afa7932a4bb7965e8fb4b
141,https://api.github.com/repos/apache/spark/pulls/27246,363926981,MDExOlB1bGxSZXF1ZXN0MzYzOTI2OTgx,https://github.com/apache/spark/pull/27246,https://github.com/apache/spark/pull/27246.diff,https://github.com/apache/spark/pull/27246.patch,https://api.github.com/repos/apache/spark/issues/27246,27246,open,False,[SPARK-30536][CORE][SQL] Sort-merge join operator spilling performance improvements,"### What changes were proposed in this pull request?

The following list of changes will improve SQL execution performance when data is spilled on the disk:
1)	Implement lazy initialization of UnsafeSorterSpillReader - iterator on top of spilled rows:
        ... During SortMergeJoin (Left Semi Join) execution, the iterator on the spill data is created but no iteration over the data is done.
        ... Having lazy initialization of UnsafeSorterSpillReader will enable efficient processing of SortMergeJoin even if data is spilled onto disk. Unnecessary I/O will be avoided.
2)	Decrease initial memory read buffer size in UnsafeSorterSpillReader from 1MB to 1KB:
... UnsafeSorterSpillReader constructor takes lot of time due to size of default 1MB memory read buffer.
        ... The code already has logic to increase the memory read buffer if it cannot fit the data, so decreasing the size to 1K is safe and has positive performance impact.
3)	Improve memory utilization when spilling is enabled in ExternalAppendOnlyUnsafeRowArrey
        ... In the current implementation, when spilling is enabled, UnsafeExternalSorter object is created and then data moved from ExternalAppendOnlyUnsafeRowArrey object into UnsafeExternalSorter and then ExternalAppendOnlyUnsafeRowArrey object is emptied. Just before ExternalAppendOnlyUnsafeRowArrey object is emptied there are both objects in the memory with the same data. That require double memory and there is duplication of data. This can be avoided.
        ... In the proposed solution, when spark.sql.sortMergeJoinExec.buffer.in.memory.threshold is reached  adding new rows into ExternalAppendOnlyUnsafeRowArray object stops. UnsafeExternalSorter object is created and new rows are added into this object. ExternalAppendOnlyUnsafeRowArray object retains all rows already added into this object. This approach will enable better memory utilization and avoid unnecessary movement of data from one object into another.

### Why are the changes needed?

Testing with TPC-DS 100 TB benchmark data set showed that some of SQLs (example query 14) are not able to run even with extremely large Spark executor memory.Spark spilling feature has to be enabled, in order to be able to process these SQLs. Processing of SQLs becomes extremely slow when spilling is enabled. The test of this solution with query 14 and enabled spilling on the disk, showed 500X performance improvements and it didnt degrade performance of the other SQLs from TPC-DS benchmark.

### Does this PR introduce any user-facing change?

No

### How was this patch tested?

By running TPC-DS SQLs with different data sets 10 TB and 100 TB
By running all Spark tests.

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

",2020-01-17T01:51:06Z,2020-02-18T21:15:08Z,,,4dcd8a8c05cde8164723772701592dfc3d52bd1a,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27246/commits,https://api.github.com/repos/apache/spark/pulls/27246/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27246/comments,https://api.github.com/repos/apache/spark/statuses/e48a936c0a4205e12994767ff47a21fddef60ac4,NONE,spark,apache,siknezevic,59935573,MDQ6VXNlcjU5OTM1NTcz,https://avatars1.githubusercontent.com/u/59935573?v=4,,https://api.github.com/users/siknezevic,https://github.com/siknezevic,https://api.github.com/users/siknezevic/followers,https://api.github.com/users/siknezevic/following{/other_user},https://api.github.com/users/siknezevic/gists{/gist_id},https://api.github.com/users/siknezevic/starred{/owner}{/repo},https://api.github.com/users/siknezevic/subscriptions,https://api.github.com/users/siknezevic/orgs,https://api.github.com/users/siknezevic/repos,https://api.github.com/users/siknezevic/events{/privacy},https://api.github.com/users/siknezevic/received_events,User,False,siknezevic:master,master,e48a936c0a4205e12994767ff47a21fddef60ac4,siknezevic,59935573,MDQ6VXNlcjU5OTM1NTcz,https://avatars1.githubusercontent.com/u/59935573?v=4,,https://api.github.com/users/siknezevic,https://github.com/siknezevic,https://api.github.com/users/siknezevic/followers,https://api.github.com/users/siknezevic/following{/other_user},https://api.github.com/users/siknezevic/gists{/gist_id},https://api.github.com/users/siknezevic/starred{/owner}{/repo},https://api.github.com/users/siknezevic/subscriptions,https://api.github.com/users/siknezevic/orgs,https://api.github.com/users/siknezevic/repos,https://api.github.com/users/siknezevic/events{/privacy},https://api.github.com/users/siknezevic/received_events,User,False,234207239,MDEwOlJlcG9zaXRvcnkyMzQyMDcyMzk=,spark,siknezevic/spark,False,siknezevic,59935573,MDQ6VXNlcjU5OTM1NTcz,https://avatars1.githubusercontent.com/u/59935573?v=4,,https://api.github.com/users/siknezevic,https://github.com/siknezevic,https://api.github.com/users/siknezevic/followers,https://api.github.com/users/siknezevic/following{/other_user},https://api.github.com/users/siknezevic/gists{/gist_id},https://api.github.com/users/siknezevic/starred{/owner}{/repo},https://api.github.com/users/siknezevic/subscriptions,https://api.github.com/users/siknezevic/orgs,https://api.github.com/users/siknezevic/repos,https://api.github.com/users/siknezevic/events{/privacy},https://api.github.com/users/siknezevic/received_events,User,False,https://github.com/siknezevic/spark,Apache Spark,True,https://api.github.com/repos/siknezevic/spark,https://api.github.com/repos/siknezevic/spark/forks,https://api.github.com/repos/siknezevic/spark/keys{/key_id},https://api.github.com/repos/siknezevic/spark/collaborators{/collaborator},https://api.github.com/repos/siknezevic/spark/teams,https://api.github.com/repos/siknezevic/spark/hooks,https://api.github.com/repos/siknezevic/spark/issues/events{/number},https://api.github.com/repos/siknezevic/spark/events,https://api.github.com/repos/siknezevic/spark/assignees{/user},https://api.github.com/repos/siknezevic/spark/branches{/branch},https://api.github.com/repos/siknezevic/spark/tags,https://api.github.com/repos/siknezevic/spark/git/blobs{/sha},https://api.github.com/repos/siknezevic/spark/git/tags{/sha},https://api.github.com/repos/siknezevic/spark/git/refs{/sha},https://api.github.com/repos/siknezevic/spark/git/trees{/sha},https://api.github.com/repos/siknezevic/spark/statuses/{sha},https://api.github.com/repos/siknezevic/spark/languages,https://api.github.com/repos/siknezevic/spark/stargazers,https://api.github.com/repos/siknezevic/spark/contributors,https://api.github.com/repos/siknezevic/spark/subscribers,https://api.github.com/repos/siknezevic/spark/subscription,https://api.github.com/repos/siknezevic/spark/commits{/sha},https://api.github.com/repos/siknezevic/spark/git/commits{/sha},https://api.github.com/repos/siknezevic/spark/comments{/number},https://api.github.com/repos/siknezevic/spark/issues/comments{/number},https://api.github.com/repos/siknezevic/spark/contents/{+path},https://api.github.com/repos/siknezevic/spark/compare/{base}...{head},https://api.github.com/repos/siknezevic/spark/merges,https://api.github.com/repos/siknezevic/spark/{archive_format}{/ref},https://api.github.com/repos/siknezevic/spark/downloads,https://api.github.com/repos/siknezevic/spark/issues{/number},https://api.github.com/repos/siknezevic/spark/pulls{/number},https://api.github.com/repos/siknezevic/spark/milestones{/number},"https://api.github.com/repos/siknezevic/spark/notifications{?since,all,participating}",https://api.github.com/repos/siknezevic/spark/labels{/name},https://api.github.com/repos/siknezevic/spark/releases{/id},https://api.github.com/repos/siknezevic/spark/deployments,2020-01-16T01:21:49Z,2020-02-01T19:11:16Z,2020-02-01T19:10:18Z,git://github.com/siknezevic/spark.git,git@github.com:siknezevic/spark.git,https://github.com/siknezevic/spark.git,https://github.com/siknezevic/spark,,318160,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,da32d1e6b5cc409f408384576002ccf63a83e9a1,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27246,https://github.com/apache/spark/pull/27246,https://api.github.com/repos/apache/spark/issues/27246,https://api.github.com/repos/apache/spark/issues/27246/comments,https://api.github.com/repos/apache/spark/pulls/27246/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27246/commits,https://api.github.com/repos/apache/spark/statuses/e48a936c0a4205e12994767ff47a21fddef60ac4
142,https://api.github.com/repos/apache/spark/pulls/27244,363897071,MDExOlB1bGxSZXF1ZXN0MzYzODk3MDcx,https://github.com/apache/spark/pull/27244,https://github.com/apache/spark/pull/27244.diff,https://github.com/apache/spark/pull/27244.patch,https://api.github.com/repos/apache/spark/issues/27244,27244,open,False,[MINOR][DOCS] Update runtime dynamic configuration command,"

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
The runtime dynamic configuration command is modified.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
It seems that in local mode, Spark takes *spark.driver.extraJavaOptions* as Java options for the JVM instead of *spark.executor.extraJavaOptions*.
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-01-16T23:35:14Z,2020-02-02T19:39:52Z,,,4294f5d9283d2e10fd51a9f2ed9387040e4d4923,,[],[],[],"[{'id': 1406627011, 'node_id': 'MDU6TGFiZWwxNDA2NjI3MDEx', 'url': 'https://api.github.com/repos/apache/spark/labels/DOCUMENTATION', 'name': 'DOCUMENTATION', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27244/commits,https://api.github.com/repos/apache/spark/pulls/27244/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27244/comments,https://api.github.com/repos/apache/spark/statuses/19ffc9096339bde87f774b92f16c2441adf5841c,NONE,spark,apache,FereX98,35025968,MDQ6VXNlcjM1MDI1OTY4,https://avatars3.githubusercontent.com/u/35025968?v=4,,https://api.github.com/users/FereX98,https://github.com/FereX98,https://api.github.com/users/FereX98/followers,https://api.github.com/users/FereX98/following{/other_user},https://api.github.com/users/FereX98/gists{/gist_id},https://api.github.com/users/FereX98/starred{/owner}{/repo},https://api.github.com/users/FereX98/subscriptions,https://api.github.com/users/FereX98/orgs,https://api.github.com/users/FereX98/repos,https://api.github.com/users/FereX98/events{/privacy},https://api.github.com/users/FereX98/received_events,User,False,FereX98:patch-1,patch-1,19ffc9096339bde87f774b92f16c2441adf5841c,FereX98,35025968,MDQ6VXNlcjM1MDI1OTY4,https://avatars3.githubusercontent.com/u/35025968?v=4,,https://api.github.com/users/FereX98,https://github.com/FereX98,https://api.github.com/users/FereX98/followers,https://api.github.com/users/FereX98/following{/other_user},https://api.github.com/users/FereX98/gists{/gist_id},https://api.github.com/users/FereX98/starred{/owner}{/repo},https://api.github.com/users/FereX98/subscriptions,https://api.github.com/users/FereX98/orgs,https://api.github.com/users/FereX98/repos,https://api.github.com/users/FereX98/events{/privacy},https://api.github.com/users/FereX98/received_events,User,False,234431358,MDEwOlJlcG9zaXRvcnkyMzQ0MzEzNTg=,spark,FereX98/spark,False,FereX98,35025968,MDQ6VXNlcjM1MDI1OTY4,https://avatars3.githubusercontent.com/u/35025968?v=4,,https://api.github.com/users/FereX98,https://github.com/FereX98,https://api.github.com/users/FereX98/followers,https://api.github.com/users/FereX98/following{/other_user},https://api.github.com/users/FereX98/gists{/gist_id},https://api.github.com/users/FereX98/starred{/owner}{/repo},https://api.github.com/users/FereX98/subscriptions,https://api.github.com/users/FereX98/orgs,https://api.github.com/users/FereX98/repos,https://api.github.com/users/FereX98/events{/privacy},https://api.github.com/users/FereX98/received_events,User,False,https://github.com/FereX98/spark,Apache Spark,True,https://api.github.com/repos/FereX98/spark,https://api.github.com/repos/FereX98/spark/forks,https://api.github.com/repos/FereX98/spark/keys{/key_id},https://api.github.com/repos/FereX98/spark/collaborators{/collaborator},https://api.github.com/repos/FereX98/spark/teams,https://api.github.com/repos/FereX98/spark/hooks,https://api.github.com/repos/FereX98/spark/issues/events{/number},https://api.github.com/repos/FereX98/spark/events,https://api.github.com/repos/FereX98/spark/assignees{/user},https://api.github.com/repos/FereX98/spark/branches{/branch},https://api.github.com/repos/FereX98/spark/tags,https://api.github.com/repos/FereX98/spark/git/blobs{/sha},https://api.github.com/repos/FereX98/spark/git/tags{/sha},https://api.github.com/repos/FereX98/spark/git/refs{/sha},https://api.github.com/repos/FereX98/spark/git/trees{/sha},https://api.github.com/repos/FereX98/spark/statuses/{sha},https://api.github.com/repos/FereX98/spark/languages,https://api.github.com/repos/FereX98/spark/stargazers,https://api.github.com/repos/FereX98/spark/contributors,https://api.github.com/repos/FereX98/spark/subscribers,https://api.github.com/repos/FereX98/spark/subscription,https://api.github.com/repos/FereX98/spark/commits{/sha},https://api.github.com/repos/FereX98/spark/git/commits{/sha},https://api.github.com/repos/FereX98/spark/comments{/number},https://api.github.com/repos/FereX98/spark/issues/comments{/number},https://api.github.com/repos/FereX98/spark/contents/{+path},https://api.github.com/repos/FereX98/spark/compare/{base}...{head},https://api.github.com/repos/FereX98/spark/merges,https://api.github.com/repos/FereX98/spark/{archive_format}{/ref},https://api.github.com/repos/FereX98/spark/downloads,https://api.github.com/repos/FereX98/spark/issues{/number},https://api.github.com/repos/FereX98/spark/pulls{/number},https://api.github.com/repos/FereX98/spark/milestones{/number},"https://api.github.com/repos/FereX98/spark/notifications{?since,all,participating}",https://api.github.com/repos/FereX98/spark/labels{/name},https://api.github.com/repos/FereX98/spark/releases{/id},https://api.github.com/repos/FereX98/spark/deployments,2020-01-16T23:26:22Z,2020-01-16T23:26:25Z,2020-01-16T23:31:17Z,git://github.com/FereX98/spark.git,git@github.com:FereX98/spark.git,https://github.com/FereX98/spark.git,https://github.com/FereX98/spark,,323038,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,dca838058ffd0e2c01591fd9ab0f192de446d606,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27244,https://github.com/apache/spark/pull/27244,https://api.github.com/repos/apache/spark/issues/27244,https://api.github.com/repos/apache/spark/issues/27244/comments,https://api.github.com/repos/apache/spark/pulls/27244/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27244/commits,https://api.github.com/repos/apache/spark/statuses/19ffc9096339bde87f774b92f16c2441adf5841c
143,https://api.github.com/repos/apache/spark/pulls/27234,363543305,MDExOlB1bGxSZXF1ZXN0MzYzNTQzMzA1,https://github.com/apache/spark/pull/27234,https://github.com/apache/spark/pull/27234.diff,https://github.com/apache/spark/pull/27234.patch,https://api.github.com/repos/apache/spark/issues/27234,27234,open,False,[SPARK-23626][CORE] DAGScheduler blocked due to JobSubmitted event,"### What changes were proposed in this pull request?
Forcing partition evaluation in `callsite` thread before sending `org.apache.spark.scheduler.JobSubmitted` event to `org.apache.spark.scheduler.DAGScheduler#eventProcessLoop` can help in mitigation against job submission event blocking the `DAGScheduler` thread

### Why are the changes needed?
`DAGScheduler` becomes a bottleneck in cluster when multiple `JobSubmitted` events has to be processed as `DAGSchedulerEventProcessLoop` is single threaded and it will block other tasks in queue like `TaskCompletion`.
The `JobSubmitted` event is time consuming depending on the nature of the job (Example: calculating parent stage dependencies, shuffle dependencies, partitions) and thus it blocks all the events to be processed.

Similarly in my cluster some jobs partition calculation is time consuming (Similar to stack at SPARK-2647) hence it slows down the spark `DAGSchedulerEventProcessLoop` which results in user jobs to slowdown, even if its tasks are finished within seconds, as `TaskCompletion` Events are processed at a slower rate due to blockage.

Refer: http://apache-spark-developers-list.1001551.n3.nabble.com/Spark-Scheduler-Spark-DAGScheduler-scheduling-performance-hindered-on-JobSubmitted-Event-td23562.html

I see multiple JIRA referring to this behavior
https://issues.apache.org/jira/browse/SPARK-2647
https://issues.apache.org/jira/browse/SPARK-4961

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
Added UT to reproduce and evaluate fix.",2020-01-16T09:31:53Z,2020-02-18T02:07:06Z,,,02f8dc180d9ec33a1e57d8ee2064492583e46b77,,[],[],[],"[{'id': 1406606875, 'node_id': 'MDU6TGFiZWwxNDA2NjA2ODc1', 'url': 'https://api.github.com/repos/apache/spark/labels/SCHEDULER', 'name': 'SCHEDULER', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27234/commits,https://api.github.com/repos/apache/spark/pulls/27234/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27234/comments,https://api.github.com/repos/apache/spark/statuses/8e8ed6334dc616349d4017e4be550d73446a5e3e,CONTRIBUTOR,spark,apache,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,ajithme:dagsche,dagsche,8e8ed6334dc616349d4017e4be550d73446a5e3e,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,124182301,MDEwOlJlcG9zaXRvcnkxMjQxODIzMDE=,spark,ajithme/spark,False,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,https://github.com/ajithme/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ajithme/spark,https://api.github.com/repos/ajithme/spark/forks,https://api.github.com/repos/ajithme/spark/keys{/key_id},https://api.github.com/repos/ajithme/spark/collaborators{/collaborator},https://api.github.com/repos/ajithme/spark/teams,https://api.github.com/repos/ajithme/spark/hooks,https://api.github.com/repos/ajithme/spark/issues/events{/number},https://api.github.com/repos/ajithme/spark/events,https://api.github.com/repos/ajithme/spark/assignees{/user},https://api.github.com/repos/ajithme/spark/branches{/branch},https://api.github.com/repos/ajithme/spark/tags,https://api.github.com/repos/ajithme/spark/git/blobs{/sha},https://api.github.com/repos/ajithme/spark/git/tags{/sha},https://api.github.com/repos/ajithme/spark/git/refs{/sha},https://api.github.com/repos/ajithme/spark/git/trees{/sha},https://api.github.com/repos/ajithme/spark/statuses/{sha},https://api.github.com/repos/ajithme/spark/languages,https://api.github.com/repos/ajithme/spark/stargazers,https://api.github.com/repos/ajithme/spark/contributors,https://api.github.com/repos/ajithme/spark/subscribers,https://api.github.com/repos/ajithme/spark/subscription,https://api.github.com/repos/ajithme/spark/commits{/sha},https://api.github.com/repos/ajithme/spark/git/commits{/sha},https://api.github.com/repos/ajithme/spark/comments{/number},https://api.github.com/repos/ajithme/spark/issues/comments{/number},https://api.github.com/repos/ajithme/spark/contents/{+path},https://api.github.com/repos/ajithme/spark/compare/{base}...{head},https://api.github.com/repos/ajithme/spark/merges,https://api.github.com/repos/ajithme/spark/{archive_format}{/ref},https://api.github.com/repos/ajithme/spark/downloads,https://api.github.com/repos/ajithme/spark/issues{/number},https://api.github.com/repos/ajithme/spark/pulls{/number},https://api.github.com/repos/ajithme/spark/milestones{/number},"https://api.github.com/repos/ajithme/spark/notifications{?since,all,participating}",https://api.github.com/repos/ajithme/spark/labels{/name},https://api.github.com/repos/ajithme/spark/releases{/id},https://api.github.com/repos/ajithme/spark/deployments,2018-03-07T05:08:43Z,2020-01-15T04:25:12Z,2020-02-18T15:06:53Z,git://github.com/ajithme/spark.git,git@github.com:ajithme/spark.git,https://github.com/ajithme/spark.git,https://github.com/ajithme/spark,,318153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,018bdcc53c925072b07956de0600452ad255b9c7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27234,https://github.com/apache/spark/pull/27234,https://api.github.com/repos/apache/spark/issues/27234,https://api.github.com/repos/apache/spark/issues/27234/comments,https://api.github.com/repos/apache/spark/pulls/27234/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27234/commits,https://api.github.com/repos/apache/spark/statuses/8e8ed6334dc616349d4017e4be550d73446a5e3e
144,https://api.github.com/repos/apache/spark/pulls/27233,363533004,MDExOlB1bGxSZXF1ZXN0MzYzNTMzMDA0,https://github.com/apache/spark/pull/27233,https://github.com/apache/spark/pull/27233.diff,https://github.com/apache/spark/pull/27233.patch,https://api.github.com/repos/apache/spark/issues/27233,27233,open,False,[SPARK-29701][SQL] Correct behaviours of group analytical queries when empty input given,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This PR intends to fix a bug when empty input given in group analytical queries (e.g., GROUPING SETS). For example, a query below with empty input has a different answer between Spark and PostgreSQL:
```
postgres=# create table gstest_empty (a integer, b integer, v integer);
CREATE TABLE
postgres=# select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),());
 a | b | sum | count 
---+---+-----+-------
   |   |     |     0
(1 row)

scala> sql(""""""select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),())"""""").show
+---+---+------+--------+
|  a|  b|sum(v)|count(1)|
+---+---+------+--------+
+---+---+------+--------+
```
In the case, we should follow the PostgreSQL answer. To fix this, this PR added a new optimizer rule to rewrite a resolved logical plan as an union query of aggregates with/without keys as follows;
```
scala> sql(""""""select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),())"""""").explain(true)
== Analyzed Logical Plan ==
a: int, b: int, sum(v): bigint, count(1): bigint
Aggregate [a#10, b#11, spark_grouping_id#7], [a#10, b#11, sum(cast(v#3 as bigint)) AS sum(v)#5L, count(1) AS count(1)#6L]
+- Expand [List(a#1, b#2, v#3, a#8, b#9, 0), List(a#1, b#2, v#3, null, null, 3)], [a#1, b#2, v#3, a#10, b#11, spark_grouping_id#7]
   +- Project [a#1, b#2, v#3, a#1 AS a#8, b#2 AS b#9]
      +- SubqueryAlias `default`.`gstest_empty`
         +- Relation[a#1,b#2,v#3] parquet

== Optimized Logical Plan ==
Union
:- Aggregate [a#10, b#11, spark_grouping_id#7], [a#10, b#11, sum(cast(v#3 as bigint)) AS sum(v)#5L, count(1) AS count(1)#6L]
:  +- Expand [List(v#3, a#1, b#2, 0)], [v#3, a#10, b#11, spark_grouping_id#7]
:     +- Project [v#3, a#1, b#2]
:        +- Relation[a#1,b#2,v#3] parquet
+- Aggregate [null AS a#10, null AS b#11, sum(cast(v#3 as bigint)) AS sum(v)#5L, count(1) AS count(1)#6L]
   +- Project [v#3]
      +- Relation[a#1,b#2,v#3] parquet
```

Behaviours of the other database-like systems:
```
// Presto
presto:db> select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),());
  a   |  b   | _col2 | _col3 
------+------+-------+-------
 NULL | NULL | NULL  |     0 
(1 row)

// MySQL does not have GROUPING SETS, so uses ROLLUP instead
mysql> select a, b, sum(v), count(*) from gstest_empty group by a, b with rollup;
Empty set (0.01 sec)

// Oracle & MS SQL Server have the same output
// https://github.com/apache/spark/pull/27233#issuecomment-577950755
SQL> select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),());
no rows selected
```

NOTE: This pr also updates the existing test in `OptimizeMetadataOnlyQuerySuite`; it has [the rollup query](https://github.com/apache/spark/pull/27233/files#diff-7d340edd739a1f59d51d5228113fd9edL120) and this PR transforms it into a `union(aggregate with keys, aggregate without keys)` form. The test checks that no metadata-only query happens there, but the `aggregate without keys` side can be optimized by the `OptimizeMetadataOnlyQuery` rule then `testNotMetadataOnly()` fails. To avoid this case, this PR replaces the rollup query with a grouping set one.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
For the correct SQL semantics.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
UTs added.",2020-01-16T09:08:41Z,2020-01-28T06:34:08Z,,,15c5b675bd2245b7a1d1edc0ab45ef67d82112e1,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27233/commits,https://api.github.com/repos/apache/spark/pulls/27233/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27233/comments,https://api.github.com/repos/apache/spark/statuses/44c681a9e1f1698c77eefcf43fa65519eeb1d3c5,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:SPARK-29701-2,SPARK-29701-2,44c681a9e1f1698c77eefcf43fa65519eeb1d3c5,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,43d9c7e7e57749ee611e0c97781a71a0645b5e9b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27233,https://github.com/apache/spark/pull/27233,https://api.github.com/repos/apache/spark/issues/27233,https://api.github.com/repos/apache/spark/issues/27233/comments,https://api.github.com/repos/apache/spark/pulls/27233/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27233/commits,https://api.github.com/repos/apache/spark/statuses/44c681a9e1f1698c77eefcf43fa65519eeb1d3c5
145,https://api.github.com/repos/apache/spark/pulls/27231,363484344,MDExOlB1bGxSZXF1ZXN0MzYzNDg0MzQ0,https://github.com/apache/spark/pull/27231,https://github.com/apache/spark/pull/27231.diff,https://github.com/apache/spark/pull/27231.patch,https://api.github.com/repos/apache/spark/issues/27231,27231,open,False,[SPARK-28478][SQL] Remove redundant null checks,"### What changes were proposed in this pull request?
The purpose of this pr is to remove explicit null checks if they are not needed in order to simplify the generated code. Here is one example: 

Expressions of this type
```
CASE WHEN isnull(title#5) THEN title#5 ELSE substring(title#5, 0, 3) END
```
are simplified to 
```
substring(title#5, 0, 3)
```
if the considered expression is null-intolerant.

<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
It simplifies expressions in the query plan which leads to potential optimization due to simplified codegen.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
New tests are added.
",2020-01-16T06:49:00Z,2020-02-10T09:42:02Z,,,9c9814aaf7c4cd2b7f92526de2936b8b01bb0774,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27231/commits,https://api.github.com/repos/apache/spark/pulls/27231/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27231/comments,https://api.github.com/repos/apache/spark/statuses/956413fca6ed683be56614756e79c30b56e70930,CONTRIBUTOR,spark,apache,davidvrba,45728981,MDQ6VXNlcjQ1NzI4OTgx,https://avatars1.githubusercontent.com/u/45728981?v=4,,https://api.github.com/users/davidvrba,https://github.com/davidvrba,https://api.github.com/users/davidvrba/followers,https://api.github.com/users/davidvrba/following{/other_user},https://api.github.com/users/davidvrba/gists{/gist_id},https://api.github.com/users/davidvrba/starred{/owner}{/repo},https://api.github.com/users/davidvrba/subscriptions,https://api.github.com/users/davidvrba/orgs,https://api.github.com/users/davidvrba/repos,https://api.github.com/users/davidvrba/events{/privacy},https://api.github.com/users/davidvrba/received_events,User,False,davidvrba:spark-28478_removeRedundantNullChecks,spark-28478_removeRedundantNullChecks,956413fca6ed683be56614756e79c30b56e70930,davidvrba,45728981,MDQ6VXNlcjQ1NzI4OTgx,https://avatars1.githubusercontent.com/u/45728981?v=4,,https://api.github.com/users/davidvrba,https://github.com/davidvrba,https://api.github.com/users/davidvrba/followers,https://api.github.com/users/davidvrba/following{/other_user},https://api.github.com/users/davidvrba/gists{/gist_id},https://api.github.com/users/davidvrba/starred{/owner}{/repo},https://api.github.com/users/davidvrba/subscriptions,https://api.github.com/users/davidvrba/orgs,https://api.github.com/users/davidvrba/repos,https://api.github.com/users/davidvrba/events{/privacy},https://api.github.com/users/davidvrba/received_events,User,False,161044419,MDEwOlJlcG9zaXRvcnkxNjEwNDQ0MTk=,spark,davidvrba/spark,False,davidvrba,45728981,MDQ6VXNlcjQ1NzI4OTgx,https://avatars1.githubusercontent.com/u/45728981?v=4,,https://api.github.com/users/davidvrba,https://github.com/davidvrba,https://api.github.com/users/davidvrba/followers,https://api.github.com/users/davidvrba/following{/other_user},https://api.github.com/users/davidvrba/gists{/gist_id},https://api.github.com/users/davidvrba/starred{/owner}{/repo},https://api.github.com/users/davidvrba/subscriptions,https://api.github.com/users/davidvrba/orgs,https://api.github.com/users/davidvrba/repos,https://api.github.com/users/davidvrba/events{/privacy},https://api.github.com/users/davidvrba/received_events,User,False,https://github.com/davidvrba/spark,Mirror of Apache Spark,True,https://api.github.com/repos/davidvrba/spark,https://api.github.com/repos/davidvrba/spark/forks,https://api.github.com/repos/davidvrba/spark/keys{/key_id},https://api.github.com/repos/davidvrba/spark/collaborators{/collaborator},https://api.github.com/repos/davidvrba/spark/teams,https://api.github.com/repos/davidvrba/spark/hooks,https://api.github.com/repos/davidvrba/spark/issues/events{/number},https://api.github.com/repos/davidvrba/spark/events,https://api.github.com/repos/davidvrba/spark/assignees{/user},https://api.github.com/repos/davidvrba/spark/branches{/branch},https://api.github.com/repos/davidvrba/spark/tags,https://api.github.com/repos/davidvrba/spark/git/blobs{/sha},https://api.github.com/repos/davidvrba/spark/git/tags{/sha},https://api.github.com/repos/davidvrba/spark/git/refs{/sha},https://api.github.com/repos/davidvrba/spark/git/trees{/sha},https://api.github.com/repos/davidvrba/spark/statuses/{sha},https://api.github.com/repos/davidvrba/spark/languages,https://api.github.com/repos/davidvrba/spark/stargazers,https://api.github.com/repos/davidvrba/spark/contributors,https://api.github.com/repos/davidvrba/spark/subscribers,https://api.github.com/repos/davidvrba/spark/subscription,https://api.github.com/repos/davidvrba/spark/commits{/sha},https://api.github.com/repos/davidvrba/spark/git/commits{/sha},https://api.github.com/repos/davidvrba/spark/comments{/number},https://api.github.com/repos/davidvrba/spark/issues/comments{/number},https://api.github.com/repos/davidvrba/spark/contents/{+path},https://api.github.com/repos/davidvrba/spark/compare/{base}...{head},https://api.github.com/repos/davidvrba/spark/merges,https://api.github.com/repos/davidvrba/spark/{archive_format}{/ref},https://api.github.com/repos/davidvrba/spark/downloads,https://api.github.com/repos/davidvrba/spark/issues{/number},https://api.github.com/repos/davidvrba/spark/pulls{/number},https://api.github.com/repos/davidvrba/spark/milestones{/number},"https://api.github.com/repos/davidvrba/spark/notifications{?since,all,participating}",https://api.github.com/repos/davidvrba/spark/labels{/name},https://api.github.com/repos/davidvrba/spark/releases{/id},https://api.github.com/repos/davidvrba/spark/deployments,2018-12-09T13:52:05Z,2020-01-16T06:24:53Z,2020-01-21T20:33:31Z,git://github.com/davidvrba/spark.git,git@github.com:davidvrba/spark.git,https://github.com/davidvrba/spark.git,https://github.com/davidvrba/spark,,314201,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,018bdcc53c925072b07956de0600452ad255b9c7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27231,https://github.com/apache/spark/pull/27231,https://api.github.com/repos/apache/spark/issues/27231,https://api.github.com/repos/apache/spark/issues/27231/comments,https://api.github.com/repos/apache/spark/pulls/27231/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27231/commits,https://api.github.com/repos/apache/spark/statuses/956413fca6ed683be56614756e79c30b56e70930
146,https://api.github.com/repos/apache/spark/pulls/27224,363374658,MDExOlB1bGxSZXF1ZXN0MzYzMzc0NjU4,https://github.com/apache/spark/pull/27224,https://github.com/apache/spark/pull/27224.diff,https://github.com/apache/spark/pull/27224.patch,https://api.github.com/repos/apache/spark/issues/27224,27224,open,False,[SPARK-30523][SQL] - Collapse nested aggregates,"~~Note to reviewers - I'm fixing some issues after moving this onto the master branch, it was developed on the 2.4 branch and some issues weren't caught during merge resolution.~~
Ready for review, the one automated lint check failure appears to be on other PRs, and I believe is unrelated to this changeset.

### What changes were proposed in this pull request?
Combines two adjacent Aggregate operators into one, if the first one is not necessary.

If we are referencing the outputs of aggregate functions in the inner aggregate from the outer
one, check if they are being used in outer aggregates in a way that can be collapsed into a
single aggregate. A sum of sums, or a max of max, or min of min are all collapsible.
avg over avg will not be collapsible because different number of raw rows will have contributed
to the partial averages of the inner aggregate.

Min an Max can be folded in the case described above, or if they are referencing
the group by columns from the inner aggregate, as they can safely be computed just
using the set of unique values.
```
SELECT sum(sumAgg) as a, year from (
      select sum(1) as sumAgg, course, year FROM courseSales GROUP BY course, year
) group by year

// can be collapsed to
SELECT sum(1) as `a`, year from courseSales group by year
```
```
SELECT sum(agg), min(a), b from (
     select sum(1) as agg, a, b FROM testData2 GROUP BY a, b
     ) group by b

// can be collapsed to
SELECT sum(1) as `sum(agg)`, min(a) as `min(a)`, b from testData2 group by b
```

### Why are the changes needed?
Improve performance of nested aggregation queries.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Lot's of tests added with the changeset.
",2020-01-15T22:51:53Z,2020-03-23T17:30:14Z,,,0909b4396e655f5f4333f174dae2025f25473ef8,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27224/commits,https://api.github.com/repos/apache/spark/pulls/27224/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27224/comments,https://api.github.com/repos/apache/spark/statuses/5773296dc92497ad2ee0014fed0ad4376109e7d0,NONE,spark,apache,jaltekruse,365366,MDQ6VXNlcjM2NTM2Ng==,https://avatars2.githubusercontent.com/u/365366?v=4,,https://api.github.com/users/jaltekruse,https://github.com/jaltekruse,https://api.github.com/users/jaltekruse/followers,https://api.github.com/users/jaltekruse/following{/other_user},https://api.github.com/users/jaltekruse/gists{/gist_id},https://api.github.com/users/jaltekruse/starred{/owner}{/repo},https://api.github.com/users/jaltekruse/subscriptions,https://api.github.com/users/jaltekruse/orgs,https://api.github.com/users/jaltekruse/repos,https://api.github.com/users/jaltekruse/events{/privacy},https://api.github.com/users/jaltekruse/received_events,User,False,jaltekruse:SPARK-30523-collapse-nested-aggregates,SPARK-30523-collapse-nested-aggregates,5773296dc92497ad2ee0014fed0ad4376109e7d0,jaltekruse,365366,MDQ6VXNlcjM2NTM2Ng==,https://avatars2.githubusercontent.com/u/365366?v=4,,https://api.github.com/users/jaltekruse,https://github.com/jaltekruse,https://api.github.com/users/jaltekruse/followers,https://api.github.com/users/jaltekruse/following{/other_user},https://api.github.com/users/jaltekruse/gists{/gist_id},https://api.github.com/users/jaltekruse/starred{/owner}{/repo},https://api.github.com/users/jaltekruse/subscriptions,https://api.github.com/users/jaltekruse/orgs,https://api.github.com/users/jaltekruse/repos,https://api.github.com/users/jaltekruse/events{/privacy},https://api.github.com/users/jaltekruse/received_events,User,False,227188750,MDEwOlJlcG9zaXRvcnkyMjcxODg3NTA=,spark,jaltekruse/spark,False,jaltekruse,365366,MDQ6VXNlcjM2NTM2Ng==,https://avatars2.githubusercontent.com/u/365366?v=4,,https://api.github.com/users/jaltekruse,https://github.com/jaltekruse,https://api.github.com/users/jaltekruse/followers,https://api.github.com/users/jaltekruse/following{/other_user},https://api.github.com/users/jaltekruse/gists{/gist_id},https://api.github.com/users/jaltekruse/starred{/owner}{/repo},https://api.github.com/users/jaltekruse/subscriptions,https://api.github.com/users/jaltekruse/orgs,https://api.github.com/users/jaltekruse/repos,https://api.github.com/users/jaltekruse/events{/privacy},https://api.github.com/users/jaltekruse/received_events,User,False,https://github.com/jaltekruse/spark,Apache Spark,True,https://api.github.com/repos/jaltekruse/spark,https://api.github.com/repos/jaltekruse/spark/forks,https://api.github.com/repos/jaltekruse/spark/keys{/key_id},https://api.github.com/repos/jaltekruse/spark/collaborators{/collaborator},https://api.github.com/repos/jaltekruse/spark/teams,https://api.github.com/repos/jaltekruse/spark/hooks,https://api.github.com/repos/jaltekruse/spark/issues/events{/number},https://api.github.com/repos/jaltekruse/spark/events,https://api.github.com/repos/jaltekruse/spark/assignees{/user},https://api.github.com/repos/jaltekruse/spark/branches{/branch},https://api.github.com/repos/jaltekruse/spark/tags,https://api.github.com/repos/jaltekruse/spark/git/blobs{/sha},https://api.github.com/repos/jaltekruse/spark/git/tags{/sha},https://api.github.com/repos/jaltekruse/spark/git/refs{/sha},https://api.github.com/repos/jaltekruse/spark/git/trees{/sha},https://api.github.com/repos/jaltekruse/spark/statuses/{sha},https://api.github.com/repos/jaltekruse/spark/languages,https://api.github.com/repos/jaltekruse/spark/stargazers,https://api.github.com/repos/jaltekruse/spark/contributors,https://api.github.com/repos/jaltekruse/spark/subscribers,https://api.github.com/repos/jaltekruse/spark/subscription,https://api.github.com/repos/jaltekruse/spark/commits{/sha},https://api.github.com/repos/jaltekruse/spark/git/commits{/sha},https://api.github.com/repos/jaltekruse/spark/comments{/number},https://api.github.com/repos/jaltekruse/spark/issues/comments{/number},https://api.github.com/repos/jaltekruse/spark/contents/{+path},https://api.github.com/repos/jaltekruse/spark/compare/{base}...{head},https://api.github.com/repos/jaltekruse/spark/merges,https://api.github.com/repos/jaltekruse/spark/{archive_format}{/ref},https://api.github.com/repos/jaltekruse/spark/downloads,https://api.github.com/repos/jaltekruse/spark/issues{/number},https://api.github.com/repos/jaltekruse/spark/pulls{/number},https://api.github.com/repos/jaltekruse/spark/milestones{/number},"https://api.github.com/repos/jaltekruse/spark/notifications{?since,all,participating}",https://api.github.com/repos/jaltekruse/spark/labels{/name},https://api.github.com/repos/jaltekruse/spark/releases{/id},https://api.github.com/repos/jaltekruse/spark/deployments,2019-12-10T18:26:34Z,2019-12-10T18:26:37Z,2020-01-23T23:36:06Z,git://github.com/jaltekruse/spark.git,git@github.com:jaltekruse/spark.git,https://github.com/jaltekruse/spark.git,https://github.com/jaltekruse/spark,,317964,0,0,,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,3f76bd40025181841de70a11e576d0ee948de5c0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27224,https://github.com/apache/spark/pull/27224,https://api.github.com/repos/apache/spark/issues/27224,https://api.github.com/repos/apache/spark/issues/27224/comments,https://api.github.com/repos/apache/spark/pulls/27224/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27224/commits,https://api.github.com/repos/apache/spark/statuses/5773296dc92497ad2ee0014fed0ad4376109e7d0
147,https://api.github.com/repos/apache/spark/pulls/27222,363162354,MDExOlB1bGxSZXF1ZXN0MzYzMTYyMzU0,https://github.com/apache/spark/pull/27222,https://github.com/apache/spark/pull/27222.diff,https://github.com/apache/spark/pull/27222.patch,https://api.github.com/repos/apache/spark/issues/27222,27222,open,False,[SPARK-30519][CORE] Use spark.executorEnv.HADOOP_USER_NAME to set executor's hadoop user,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Let executor can specify hadoop user by using spark.executorEnv.HADOOP_USER_NAME

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
We can use HADOOP_USER_NAME to specify hadoop user while submitting a job on driver, but invalid to set executor's hadoop user even by using spark.executorEnv.HADOOP_USER_NAME.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2020-01-15T14:23:07Z,2020-02-15T02:16:31Z,,,953b4d0a8ddaaf38514f41bcb9b944ddbdc707b4,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27222/commits,https://api.github.com/repos/apache/spark/pulls/27222/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27222/comments,https://api.github.com/repos/apache/spark/statuses/7c8d8e307750d1cf47b635302af845356cbf4d54,NONE,spark,apache,apeming,17539850,MDQ6VXNlcjE3NTM5ODUw,https://avatars2.githubusercontent.com/u/17539850?v=4,,https://api.github.com/users/apeming,https://github.com/apeming,https://api.github.com/users/apeming/followers,https://api.github.com/users/apeming/following{/other_user},https://api.github.com/users/apeming/gists{/gist_id},https://api.github.com/users/apeming/starred{/owner}{/repo},https://api.github.com/users/apeming/subscriptions,https://api.github.com/users/apeming/orgs,https://api.github.com/users/apeming/repos,https://api.github.com/users/apeming/events{/privacy},https://api.github.com/users/apeming/received_events,User,False,apeming:my_change,my_change,7c8d8e307750d1cf47b635302af845356cbf4d54,apeming,17539850,MDQ6VXNlcjE3NTM5ODUw,https://avatars2.githubusercontent.com/u/17539850?v=4,,https://api.github.com/users/apeming,https://github.com/apeming,https://api.github.com/users/apeming/followers,https://api.github.com/users/apeming/following{/other_user},https://api.github.com/users/apeming/gists{/gist_id},https://api.github.com/users/apeming/starred{/owner}{/repo},https://api.github.com/users/apeming/subscriptions,https://api.github.com/users/apeming/orgs,https://api.github.com/users/apeming/repos,https://api.github.com/users/apeming/events{/privacy},https://api.github.com/users/apeming/received_events,User,False,234027702,MDEwOlJlcG9zaXRvcnkyMzQwMjc3MDI=,spark,apeming/spark,False,apeming,17539850,MDQ6VXNlcjE3NTM5ODUw,https://avatars2.githubusercontent.com/u/17539850?v=4,,https://api.github.com/users/apeming,https://github.com/apeming,https://api.github.com/users/apeming/followers,https://api.github.com/users/apeming/following{/other_user},https://api.github.com/users/apeming/gists{/gist_id},https://api.github.com/users/apeming/starred{/owner}{/repo},https://api.github.com/users/apeming/subscriptions,https://api.github.com/users/apeming/orgs,https://api.github.com/users/apeming/repos,https://api.github.com/users/apeming/events{/privacy},https://api.github.com/users/apeming/received_events,User,False,https://github.com/apeming/spark,Apache Spark,True,https://api.github.com/repos/apeming/spark,https://api.github.com/repos/apeming/spark/forks,https://api.github.com/repos/apeming/spark/keys{/key_id},https://api.github.com/repos/apeming/spark/collaborators{/collaborator},https://api.github.com/repos/apeming/spark/teams,https://api.github.com/repos/apeming/spark/hooks,https://api.github.com/repos/apeming/spark/issues/events{/number},https://api.github.com/repos/apeming/spark/events,https://api.github.com/repos/apeming/spark/assignees{/user},https://api.github.com/repos/apeming/spark/branches{/branch},https://api.github.com/repos/apeming/spark/tags,https://api.github.com/repos/apeming/spark/git/blobs{/sha},https://api.github.com/repos/apeming/spark/git/tags{/sha},https://api.github.com/repos/apeming/spark/git/refs{/sha},https://api.github.com/repos/apeming/spark/git/trees{/sha},https://api.github.com/repos/apeming/spark/statuses/{sha},https://api.github.com/repos/apeming/spark/languages,https://api.github.com/repos/apeming/spark/stargazers,https://api.github.com/repos/apeming/spark/contributors,https://api.github.com/repos/apeming/spark/subscribers,https://api.github.com/repos/apeming/spark/subscription,https://api.github.com/repos/apeming/spark/commits{/sha},https://api.github.com/repos/apeming/spark/git/commits{/sha},https://api.github.com/repos/apeming/spark/comments{/number},https://api.github.com/repos/apeming/spark/issues/comments{/number},https://api.github.com/repos/apeming/spark/contents/{+path},https://api.github.com/repos/apeming/spark/compare/{base}...{head},https://api.github.com/repos/apeming/spark/merges,https://api.github.com/repos/apeming/spark/{archive_format}{/ref},https://api.github.com/repos/apeming/spark/downloads,https://api.github.com/repos/apeming/spark/issues{/number},https://api.github.com/repos/apeming/spark/pulls{/number},https://api.github.com/repos/apeming/spark/milestones{/number},"https://api.github.com/repos/apeming/spark/notifications{?since,all,participating}",https://api.github.com/repos/apeming/spark/labels{/name},https://api.github.com/repos/apeming/spark/releases{/id},https://api.github.com/repos/apeming/spark/deployments,2020-01-15T07:53:35Z,2020-01-15T07:53:37Z,2020-01-15T14:22:19Z,git://github.com/apeming/spark.git,git@github.com:apeming/spark.git,https://github.com/apeming/spark.git,https://github.com/apeming/spark,,322699,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,5f6cd61913bd8bcb149cc48ed10a9b71412c871f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27222,https://github.com/apache/spark/pull/27222,https://api.github.com/repos/apache/spark/issues/27222,https://api.github.com/repos/apache/spark/issues/27222/comments,https://api.github.com/repos/apache/spark/pulls/27222/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27222/commits,https://api.github.com/repos/apache/spark/statuses/7c8d8e307750d1cf47b635302af845356cbf4d54
148,https://api.github.com/repos/apache/spark/pulls/27215,363008926,MDExOlB1bGxSZXF1ZXN0MzYzMDA4OTI2,https://github.com/apache/spark/pull/27215,https://github.com/apache/spark/pull/27215.diff,https://github.com/apache/spark/pull/27215.patch,https://api.github.com/repos/apache/spark/issues/27215,27215,open,False,[SPARK-30514][K8S] add python environment support for JavaMainAppResource,"### What changes were proposed in this pull request?
If application is started with JavaMainAppResource, no python environment, such as PYSPARK_MAJOR_PYTHON_VERSION and PYSPARK_EXECUTOR_MEMORY, won't be available in Executor Pods. It make it not easy to work with Livy. In apache Livy, the program is first started with JavaMainAppResource, and then start the Python worker. At this time, the program needs to be able to pass Python environment variables.

In spark on yarn, we support this through spark.yarn.isPython. In k8s, we should also support this.


### Why are the changes needed?
To support Livy on spark with k8s, we need this config.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Add new unit tests and run all unit tests
",2020-01-15T08:13:02Z,2020-02-26T16:15:08Z,,,d432d2e51ed245f320125980987e5dc0b1f810be,,[],"[{'login': 'srowen', 'id': 822522, 'node_id': 'MDQ6VXNlcjgyMjUyMg==', 'avatar_url': 'https://avatars0.githubusercontent.com/u/822522?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/srowen', 'html_url': 'https://github.com/srowen', 'followers_url': 'https://api.github.com/users/srowen/followers', 'following_url': 'https://api.github.com/users/srowen/following{/other_user}', 'gists_url': 'https://api.github.com/users/srowen/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/srowen/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/srowen/subscriptions', 'organizations_url': 'https://api.github.com/users/srowen/orgs', 'repos_url': 'https://api.github.com/users/srowen/repos', 'events_url': 'https://api.github.com/users/srowen/events{/privacy}', 'received_events_url': 'https://api.github.com/users/srowen/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27215/commits,https://api.github.com/repos/apache/spark/pulls/27215/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27215/comments,https://api.github.com/repos/apache/spark/statuses/fc8b676dfc039708c99459eaa9fb7e01b1632a53,CONTRIBUTOR,spark,apache,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,stczwd:SPARK-30514,SPARK-30514,fc8b676dfc039708c99459eaa9fb7e01b1632a53,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,150664479,MDEwOlJlcG9zaXRvcnkxNTA2NjQ0Nzk=,spark,stczwd/spark,False,stczwd,10897625,MDQ6VXNlcjEwODk3NjI1,https://avatars0.githubusercontent.com/u/10897625?v=4,,https://api.github.com/users/stczwd,https://github.com/stczwd,https://api.github.com/users/stczwd/followers,https://api.github.com/users/stczwd/following{/other_user},https://api.github.com/users/stczwd/gists{/gist_id},https://api.github.com/users/stczwd/starred{/owner}{/repo},https://api.github.com/users/stczwd/subscriptions,https://api.github.com/users/stczwd/orgs,https://api.github.com/users/stczwd/repos,https://api.github.com/users/stczwd/events{/privacy},https://api.github.com/users/stczwd/received_events,User,False,https://github.com/stczwd/spark,Mirror of Apache Spark,True,https://api.github.com/repos/stczwd/spark,https://api.github.com/repos/stczwd/spark/forks,https://api.github.com/repos/stczwd/spark/keys{/key_id},https://api.github.com/repos/stczwd/spark/collaborators{/collaborator},https://api.github.com/repos/stczwd/spark/teams,https://api.github.com/repos/stczwd/spark/hooks,https://api.github.com/repos/stczwd/spark/issues/events{/number},https://api.github.com/repos/stczwd/spark/events,https://api.github.com/repos/stczwd/spark/assignees{/user},https://api.github.com/repos/stczwd/spark/branches{/branch},https://api.github.com/repos/stczwd/spark/tags,https://api.github.com/repos/stczwd/spark/git/blobs{/sha},https://api.github.com/repos/stczwd/spark/git/tags{/sha},https://api.github.com/repos/stczwd/spark/git/refs{/sha},https://api.github.com/repos/stczwd/spark/git/trees{/sha},https://api.github.com/repos/stczwd/spark/statuses/{sha},https://api.github.com/repos/stczwd/spark/languages,https://api.github.com/repos/stczwd/spark/stargazers,https://api.github.com/repos/stczwd/spark/contributors,https://api.github.com/repos/stczwd/spark/subscribers,https://api.github.com/repos/stczwd/spark/subscription,https://api.github.com/repos/stczwd/spark/commits{/sha},https://api.github.com/repos/stczwd/spark/git/commits{/sha},https://api.github.com/repos/stczwd/spark/comments{/number},https://api.github.com/repos/stczwd/spark/issues/comments{/number},https://api.github.com/repos/stczwd/spark/contents/{+path},https://api.github.com/repos/stczwd/spark/compare/{base}...{head},https://api.github.com/repos/stczwd/spark/merges,https://api.github.com/repos/stczwd/spark/{archive_format}{/ref},https://api.github.com/repos/stczwd/spark/downloads,https://api.github.com/repos/stczwd/spark/issues{/number},https://api.github.com/repos/stczwd/spark/pulls{/number},https://api.github.com/repos/stczwd/spark/milestones{/number},"https://api.github.com/repos/stczwd/spark/notifications{?since,all,participating}",https://api.github.com/repos/stczwd/spark/labels{/name},https://api.github.com/repos/stczwd/spark/releases{/id},https://api.github.com/repos/stczwd/spark/deployments,2018-09-28T00:44:20Z,2020-04-02T16:27:02Z,2020-04-06T01:47:26Z,git://github.com/stczwd/spark.git,git@github.com:stczwd/spark.git,https://github.com/stczwd/spark.git,https://github.com/stczwd/spark,,323667,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,28b8713036ff5ced4814d4d16d341f00b11ad3c3,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27215,https://github.com/apache/spark/pull/27215,https://api.github.com/repos/apache/spark/issues/27215,https://api.github.com/repos/apache/spark/issues/27215/comments,https://api.github.com/repos/apache/spark/pulls/27215/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27215/commits,https://api.github.com/repos/apache/spark/statuses/fc8b676dfc039708c99459eaa9fb7e01b1632a53
149,https://api.github.com/repos/apache/spark/pulls/27214,363007648,MDExOlB1bGxSZXF1ZXN0MzYzMDA3NjQ4,https://github.com/apache/spark/pull/27214,https://github.com/apache/spark/pull/27214.diff,https://github.com/apache/spark/pull/27214.patch,https://api.github.com/repos/apache/spark/issues/27214,27214,open,False,[SPARK-30517][SQL] Support SHOW TABLES EXTENDED,"### What changes were proposed in this pull request?
WIP 
Added a syntax for `SHOW TABLES EXTENDED` which can output a additional column compared to `SHOW TABLES` which prints the table type with possible values `MANAGED,EXTERNAL,VIEW`
Also to reduce complexity, this PR breaks `org.apache.spark.sql.execution.command.ShowTablesCommand` which was responsible for `SHOW TABLES` and `SHOW TABLE` command into separate classes

### Why are the changes needed?
Intention is to support show tables with a additional column 'type' where type can be `MANAGED,EXTERNAL,VIEW` using which user can query only tables of required types, like listing only views or only external tables (using a `where` clause over `type` column).

Usecase example:
Currently its not possible to list all the VIEWS, but other technologies like hive support it using `SHOW VIEWS`, mysql supports it using a more complex query `SHOW FULL TABLES WHERE table_type = 'VIEW;`

Decide to take mysql approach as it provides more flexibility for querying.

### Does this PR introduce any user-facing change?
Yes. New option `EXTENDED` for `SHOW TABLES` command


### How was this patch tested?


TODO: 
1. Add UTs
2. `where` clause support
3. V2 catalog support",2020-01-15T08:09:05Z,2020-01-20T03:29:47Z,,,a0161f537aeb1a22c4f3d6e5b6a6592b2d738e65,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27214/commits,https://api.github.com/repos/apache/spark/pulls/27214/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27214/comments,https://api.github.com/repos/apache/spark/statuses/b564e104466954c70c58770651ea5f645866165c,CONTRIBUTOR,spark,apache,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,ajithme:showextended,showextended,b564e104466954c70c58770651ea5f645866165c,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,124182301,MDEwOlJlcG9zaXRvcnkxMjQxODIzMDE=,spark,ajithme/spark,False,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,https://github.com/ajithme/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ajithme/spark,https://api.github.com/repos/ajithme/spark/forks,https://api.github.com/repos/ajithme/spark/keys{/key_id},https://api.github.com/repos/ajithme/spark/collaborators{/collaborator},https://api.github.com/repos/ajithme/spark/teams,https://api.github.com/repos/ajithme/spark/hooks,https://api.github.com/repos/ajithme/spark/issues/events{/number},https://api.github.com/repos/ajithme/spark/events,https://api.github.com/repos/ajithme/spark/assignees{/user},https://api.github.com/repos/ajithme/spark/branches{/branch},https://api.github.com/repos/ajithme/spark/tags,https://api.github.com/repos/ajithme/spark/git/blobs{/sha},https://api.github.com/repos/ajithme/spark/git/tags{/sha},https://api.github.com/repos/ajithme/spark/git/refs{/sha},https://api.github.com/repos/ajithme/spark/git/trees{/sha},https://api.github.com/repos/ajithme/spark/statuses/{sha},https://api.github.com/repos/ajithme/spark/languages,https://api.github.com/repos/ajithme/spark/stargazers,https://api.github.com/repos/ajithme/spark/contributors,https://api.github.com/repos/ajithme/spark/subscribers,https://api.github.com/repos/ajithme/spark/subscription,https://api.github.com/repos/ajithme/spark/commits{/sha},https://api.github.com/repos/ajithme/spark/git/commits{/sha},https://api.github.com/repos/ajithme/spark/comments{/number},https://api.github.com/repos/ajithme/spark/issues/comments{/number},https://api.github.com/repos/ajithme/spark/contents/{+path},https://api.github.com/repos/ajithme/spark/compare/{base}...{head},https://api.github.com/repos/ajithme/spark/merges,https://api.github.com/repos/ajithme/spark/{archive_format}{/ref},https://api.github.com/repos/ajithme/spark/downloads,https://api.github.com/repos/ajithme/spark/issues{/number},https://api.github.com/repos/ajithme/spark/pulls{/number},https://api.github.com/repos/ajithme/spark/milestones{/number},"https://api.github.com/repos/ajithme/spark/notifications{?since,all,participating}",https://api.github.com/repos/ajithme/spark/labels{/name},https://api.github.com/repos/ajithme/spark/releases{/id},https://api.github.com/repos/ajithme/spark/deployments,2018-03-07T05:08:43Z,2020-01-15T04:25:12Z,2020-02-18T15:06:53Z,git://github.com/ajithme/spark.git,git@github.com:ajithme/spark.git,https://github.com/ajithme/spark.git,https://github.com/ajithme/spark,,318153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,51d29175ab406e8ceac514af76f1d97d1f332ffa,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27214,https://github.com/apache/spark/pull/27214,https://api.github.com/repos/apache/spark/issues/27214,https://api.github.com/repos/apache/spark/issues/27214/comments,https://api.github.com/repos/apache/spark/pulls/27214/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27214/commits,https://api.github.com/repos/apache/spark/statuses/b564e104466954c70c58770651ea5f645866165c
150,https://api.github.com/repos/apache/spark/pulls/27213,362987199,MDExOlB1bGxSZXF1ZXN0MzYyOTg3MTk5,https://github.com/apache/spark/pull/27213,https://github.com/apache/spark/pull/27213.diff,https://github.com/apache/spark/pull/27213.patch,https://api.github.com/repos/apache/spark/issues/27213,27213,open,False,[SPARK-30516][SQL] involve partition filters in the statistic estimation of FileScan,"### What changes were proposed in this pull request?
Refine FileScan.estimateStatistics to take partitionFilters into account.

### Why are the changes needed?
Currently, FileScan.estimateStatistics does not take partitionFilters into account, which may lead to bigger sizeInBytes. It should be reasonable to change it to involve partitionFilters when estimating the statistics.

### Does this PR introduce any user-facing change?
no

### How was this patch tested?
existing unit tests.
",2020-01-15T07:02:35Z,2020-02-11T22:23:02Z,,,375b34c2bcd22368078130c9515e1ce66d8cd674,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27213/commits,https://api.github.com/repos/apache/spark/pulls/27213/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27213/comments,https://api.github.com/repos/apache/spark/statuses/2e210a092442bbc65ff92f97a2eb2c06aaf83376,CONTRIBUTOR,spark,apache,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,fuwhu:SPARK-30516,SPARK-30516,2e210a092442bbc65ff92f97a2eb2c06aaf83376,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,42981239,MDEwOlJlcG9zaXRvcnk0Mjk4MTIzOQ==,spark,fuwhu/spark,False,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,https://github.com/fuwhu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/fuwhu/spark,https://api.github.com/repos/fuwhu/spark/forks,https://api.github.com/repos/fuwhu/spark/keys{/key_id},https://api.github.com/repos/fuwhu/spark/collaborators{/collaborator},https://api.github.com/repos/fuwhu/spark/teams,https://api.github.com/repos/fuwhu/spark/hooks,https://api.github.com/repos/fuwhu/spark/issues/events{/number},https://api.github.com/repos/fuwhu/spark/events,https://api.github.com/repos/fuwhu/spark/assignees{/user},https://api.github.com/repos/fuwhu/spark/branches{/branch},https://api.github.com/repos/fuwhu/spark/tags,https://api.github.com/repos/fuwhu/spark/git/blobs{/sha},https://api.github.com/repos/fuwhu/spark/git/tags{/sha},https://api.github.com/repos/fuwhu/spark/git/refs{/sha},https://api.github.com/repos/fuwhu/spark/git/trees{/sha},https://api.github.com/repos/fuwhu/spark/statuses/{sha},https://api.github.com/repos/fuwhu/spark/languages,https://api.github.com/repos/fuwhu/spark/stargazers,https://api.github.com/repos/fuwhu/spark/contributors,https://api.github.com/repos/fuwhu/spark/subscribers,https://api.github.com/repos/fuwhu/spark/subscription,https://api.github.com/repos/fuwhu/spark/commits{/sha},https://api.github.com/repos/fuwhu/spark/git/commits{/sha},https://api.github.com/repos/fuwhu/spark/comments{/number},https://api.github.com/repos/fuwhu/spark/issues/comments{/number},https://api.github.com/repos/fuwhu/spark/contents/{+path},https://api.github.com/repos/fuwhu/spark/compare/{base}...{head},https://api.github.com/repos/fuwhu/spark/merges,https://api.github.com/repos/fuwhu/spark/{archive_format}{/ref},https://api.github.com/repos/fuwhu/spark/downloads,https://api.github.com/repos/fuwhu/spark/issues{/number},https://api.github.com/repos/fuwhu/spark/pulls{/number},https://api.github.com/repos/fuwhu/spark/milestones{/number},"https://api.github.com/repos/fuwhu/spark/notifications{?since,all,participating}",https://api.github.com/repos/fuwhu/spark/labels{/name},https://api.github.com/repos/fuwhu/spark/releases{/id},https://api.github.com/repos/fuwhu/spark/deployments,2015-09-23T05:56:07Z,2020-02-18T03:37:24Z,2020-02-18T03:37:19Z,git://github.com/fuwhu/spark.git,git@github.com:fuwhu/spark.git,https://github.com/fuwhu/spark.git,https://github.com/fuwhu/spark,,297828,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,58b9ca1e6f7768b23e752dabc30468c06d0e1c57,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27213,https://github.com/apache/spark/pull/27213,https://api.github.com/repos/apache/spark/issues/27213,https://api.github.com/repos/apache/spark/issues/27213/comments,https://api.github.com/repos/apache/spark/pulls/27213/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27213/commits,https://api.github.com/repos/apache/spark/statuses/2e210a092442bbc65ff92f97a2eb2c06aaf83376
151,https://api.github.com/repos/apache/spark/pulls/27202,362585810,MDExOlB1bGxSZXF1ZXN0MzYyNTg1ODEw,https://github.com/apache/spark/pull/27202,https://github.com/apache/spark/pull/27202.diff,https://github.com/apache/spark/pull/27202.patch,https://api.github.com/repos/apache/spark/issues/27202,27202,open,False,[SPARK-28670][SQL] Create function should thrown an exception if the resource is not found ,"
### What changes were proposed in this pull request?
Create temporary or permanent function it should throw AnalysisException if the resource is not found. Need to keep behaviour consistent across permanent and temporary functions.

### Why are the changes needed?
To keep behaviour conistent across temporary and permanent function creation

### Does this PR introduce any user-facing change?
yes, updated the migration guide


### How was this patch tested?

Added the UT

for hdfs schema tested in the local cluster
![hdfsTest](https://user-images.githubusercontent.com/35216143/72341000-3b685b80-36ef-11ea-8a39-e3c35f7dd8ef.png)

",2020-01-14T11:29:49Z,2020-02-05T18:06:04Z,,,f2244d5e62c11214ab0c7da16faa7277b284d409,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27202/commits,https://api.github.com/repos/apache/spark/pulls/27202/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27202/comments,https://api.github.com/repos/apache/spark/statuses/c991af8db9d6e780262393817e17f9c8e80aad67,CONTRIBUTOR,spark,apache,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,sandeep-katta:spark-28670,spark-28670,c991af8db9d6e780262393817e17f9c8e80aad67,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,116654613,MDEwOlJlcG9zaXRvcnkxMTY2NTQ2MTM=,spark,sandeep-katta/spark,False,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,https://github.com/sandeep-katta/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sandeep-katta/spark,https://api.github.com/repos/sandeep-katta/spark/forks,https://api.github.com/repos/sandeep-katta/spark/keys{/key_id},https://api.github.com/repos/sandeep-katta/spark/collaborators{/collaborator},https://api.github.com/repos/sandeep-katta/spark/teams,https://api.github.com/repos/sandeep-katta/spark/hooks,https://api.github.com/repos/sandeep-katta/spark/issues/events{/number},https://api.github.com/repos/sandeep-katta/spark/events,https://api.github.com/repos/sandeep-katta/spark/assignees{/user},https://api.github.com/repos/sandeep-katta/spark/branches{/branch},https://api.github.com/repos/sandeep-katta/spark/tags,https://api.github.com/repos/sandeep-katta/spark/git/blobs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/tags{/sha},https://api.github.com/repos/sandeep-katta/spark/git/refs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/trees{/sha},https://api.github.com/repos/sandeep-katta/spark/statuses/{sha},https://api.github.com/repos/sandeep-katta/spark/languages,https://api.github.com/repos/sandeep-katta/spark/stargazers,https://api.github.com/repos/sandeep-katta/spark/contributors,https://api.github.com/repos/sandeep-katta/spark/subscribers,https://api.github.com/repos/sandeep-katta/spark/subscription,https://api.github.com/repos/sandeep-katta/spark/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/git/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/comments{/number},https://api.github.com/repos/sandeep-katta/spark/issues/comments{/number},https://api.github.com/repos/sandeep-katta/spark/contents/{+path},https://api.github.com/repos/sandeep-katta/spark/compare/{base}...{head},https://api.github.com/repos/sandeep-katta/spark/merges,https://api.github.com/repos/sandeep-katta/spark/{archive_format}{/ref},https://api.github.com/repos/sandeep-katta/spark/downloads,https://api.github.com/repos/sandeep-katta/spark/issues{/number},https://api.github.com/repos/sandeep-katta/spark/pulls{/number},https://api.github.com/repos/sandeep-katta/spark/milestones{/number},"https://api.github.com/repos/sandeep-katta/spark/notifications{?since,all,participating}",https://api.github.com/repos/sandeep-katta/spark/labels{/name},https://api.github.com/repos/sandeep-katta/spark/releases{/id},https://api.github.com/repos/sandeep-katta/spark/deployments,2018-01-08T09:11:40Z,2019-12-08T02:36:49Z,2020-01-30T13:59:01Z,git://github.com/sandeep-katta/spark.git,git@github.com:sandeep-katta/spark.git,https://github.com/sandeep-katta/spark.git,https://github.com/sandeep-katta/spark,,317028,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2688faeea560dc41599352380d2d3cad361a1ab2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27202,https://github.com/apache/spark/pull/27202,https://api.github.com/repos/apache/spark/issues/27202,https://api.github.com/repos/apache/spark/issues/27202/comments,https://api.github.com/repos/apache/spark/pulls/27202/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27202/commits,https://api.github.com/repos/apache/spark/statuses/c991af8db9d6e780262393817e17f9c8e80aad67
152,https://api.github.com/repos/apache/spark/pulls/27192,362119019,MDExOlB1bGxSZXF1ZXN0MzYyMTE5MDE5,https://github.com/apache/spark/pull/27192,https://github.com/apache/spark/pull/27192.diff,https://github.com/apache/spark/pull/27192.patch,https://api.github.com/repos/apache/spark/issues/27192,27192,open,False,[SPARK-30136][Core] Removes the deleted jar from the executor ClassPath,"### What changes were proposed in this pull request?

if the executor finds the new jar(updated jar) it will delete the jar from urlClassLoader by recreating the ClassLoader. It is required to refresh the executor ClassPath for any change in the jar defination.

### Why are the changes needed?
This is fixed as a part of Umbrella jira [SPARK-30133](https://issues.apache.org/jira/browse/SPARK-30133). After this fix user can updated the jar definition without restarting the thrift Server.


### Does this PR introduce any user-facing change?
Not


### How was this patch tested?
Manually in spark-sql and beeline using below steps

// old definition returns 100*X
// new definition returns 10 *X

add jar 'file:/opt/BigdataTools/old/UdfTest.jar';
create function testUdf as 'com.spark.udftest.customUDF';
select testUdf(10),age from 2rec;
delete jar 'file:/opt/BigdataTools/old/UdfTest.jar';
add jar 'file:/opt/BigdataTools/new/UdfTest.jar';
select testUdf(10),age from 2rec;

![executorClassPath](https://user-images.githubusercontent.com/35216143/72259662-04cf0a00-3637-11ea-804d-d0b6fdccaa74.png)


",2020-01-13T13:31:57Z,2020-02-05T18:06:05Z,,,9c5e095f25b19a729bddb41c6ba72718a2f0becf,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27192/commits,https://api.github.com/repos/apache/spark/pulls/27192/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27192/comments,https://api.github.com/repos/apache/spark/statuses/f98293ccf3a811c8143061036ef83bca1a47fe45,CONTRIBUTOR,spark,apache,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,sandeep-katta:executorClassPath,executorClassPath,f98293ccf3a811c8143061036ef83bca1a47fe45,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,116654613,MDEwOlJlcG9zaXRvcnkxMTY2NTQ2MTM=,spark,sandeep-katta/spark,False,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,https://github.com/sandeep-katta/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sandeep-katta/spark,https://api.github.com/repos/sandeep-katta/spark/forks,https://api.github.com/repos/sandeep-katta/spark/keys{/key_id},https://api.github.com/repos/sandeep-katta/spark/collaborators{/collaborator},https://api.github.com/repos/sandeep-katta/spark/teams,https://api.github.com/repos/sandeep-katta/spark/hooks,https://api.github.com/repos/sandeep-katta/spark/issues/events{/number},https://api.github.com/repos/sandeep-katta/spark/events,https://api.github.com/repos/sandeep-katta/spark/assignees{/user},https://api.github.com/repos/sandeep-katta/spark/branches{/branch},https://api.github.com/repos/sandeep-katta/spark/tags,https://api.github.com/repos/sandeep-katta/spark/git/blobs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/tags{/sha},https://api.github.com/repos/sandeep-katta/spark/git/refs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/trees{/sha},https://api.github.com/repos/sandeep-katta/spark/statuses/{sha},https://api.github.com/repos/sandeep-katta/spark/languages,https://api.github.com/repos/sandeep-katta/spark/stargazers,https://api.github.com/repos/sandeep-katta/spark/contributors,https://api.github.com/repos/sandeep-katta/spark/subscribers,https://api.github.com/repos/sandeep-katta/spark/subscription,https://api.github.com/repos/sandeep-katta/spark/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/git/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/comments{/number},https://api.github.com/repos/sandeep-katta/spark/issues/comments{/number},https://api.github.com/repos/sandeep-katta/spark/contents/{+path},https://api.github.com/repos/sandeep-katta/spark/compare/{base}...{head},https://api.github.com/repos/sandeep-katta/spark/merges,https://api.github.com/repos/sandeep-katta/spark/{archive_format}{/ref},https://api.github.com/repos/sandeep-katta/spark/downloads,https://api.github.com/repos/sandeep-katta/spark/issues{/number},https://api.github.com/repos/sandeep-katta/spark/pulls{/number},https://api.github.com/repos/sandeep-katta/spark/milestones{/number},"https://api.github.com/repos/sandeep-katta/spark/notifications{?since,all,participating}",https://api.github.com/repos/sandeep-katta/spark/labels{/name},https://api.github.com/repos/sandeep-katta/spark/releases{/id},https://api.github.com/repos/sandeep-katta/spark/deployments,2018-01-08T09:11:40Z,2019-12-08T02:36:49Z,2020-01-30T13:59:01Z,git://github.com/sandeep-katta/spark.git,git@github.com:sandeep-katta/spark.git,https://github.com/sandeep-katta/spark.git,https://github.com/sandeep-katta/spark,,317028,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,6502c66025718bf45e0e2ee12398b7b92da41a0c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27192,https://github.com/apache/spark/pull/27192,https://api.github.com/repos/apache/spark/issues/27192,https://api.github.com/repos/apache/spark/issues/27192/comments,https://api.github.com/repos/apache/spark/pulls/27192/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27192/commits,https://api.github.com/repos/apache/spark/statuses/f98293ccf3a811c8143061036ef83bca1a47fe45
153,https://api.github.com/repos/apache/spark/pulls/27172,361663989,MDExOlB1bGxSZXF1ZXN0MzYxNjYzOTg5,https://github.com/apache/spark/pull/27172,https://github.com/apache/spark/pull/27172.diff,https://github.com/apache/spark/pull/27172.patch,https://api.github.com/repos/apache/spark/issues/27172,27172,open,False,[WIP] [SPARK-29644][SQL] Fixed ByteType JDBCUtils to map to TinyInt at write read and ShortType on read ,"### What changes were proposed in this pull request?
Fixed ByteType JDBCUtils to map to TinyInt at write read and ShortType on read  path. 
Fixed Unit test cases where applicable and added new E2E test cases in to test table read/write  ByteType.

Refer https://github.com/apache/spark/pull/26301 for details. The fix was reverted as it mapped even the read path to a ByteType and that would have resulted in truncations for some database that support 0 to 255 for tinyint while spark byteType range is -127 to +127 only.

#### Problems
- In master in JDBCUtils.scala line number 547 and 551 have a problem where ByteType are set as Integers.
```
case ByteType =>
(stmt: PreparedStatement, row: Row, pos: Int) =>
stmt.setInt(pos + 1, row.getByte(pos))
```
- Also at line JDBCUtils.scala 247 TinyInt is interpreted wrongly as IntergetType in getCatalystType()

``` case java.sql.Types.TINYINT       => IntegerType ```

### Why are the changes needed?
With the current mapping of ByteType as ""Byte"" when writting a table from JDBC connector fails.

### Does this PR introduce any user-facing change?
Yes
(Write path) Uses would now be able to create tables when data frame has ByteType.
(Read path) Spark dataframe that reads a table with a TINYINT will get mapped to ShortType rather than Integer
 
### How was this patch tested?
Corrected Unit test cases where applicable. 
Added a test case in MsSqlServerIntegrationSuite.scala. Validated by manual as follows.
```
./build/mvn install -DskipTests
./build/mvn test -Pdocker-integration-tests -pl :spark-docker-integration-tests_2.12
```
",2020-01-10T23:41:58Z,2020-02-25T02:25:07Z,,,61c5b73e6db88b0089676d2a9ecc35011065caff,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27172/commits,https://api.github.com/repos/apache/spark/pulls/27172/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27172/comments,https://api.github.com/repos/apache/spark/statuses/5ee7d5e7079e79222239484d05da903d1d2eade0,CONTRIBUTOR,spark,apache,shivsood,1579057,MDQ6VXNlcjE1NzkwNTc=,https://avatars2.githubusercontent.com/u/1579057?v=4,,https://api.github.com/users/shivsood,https://github.com/shivsood,https://api.github.com/users/shivsood/followers,https://api.github.com/users/shivsood/following{/other_user},https://api.github.com/users/shivsood/gists{/gist_id},https://api.github.com/users/shivsood/starred{/owner}{/repo},https://api.github.com/users/shivsood/subscriptions,https://api.github.com/users/shivsood/orgs,https://api.github.com/users/shivsood/repos,https://api.github.com/users/shivsood/events{/privacy},https://api.github.com/users/shivsood/received_events,User,False,shivsood:fix_ByteType_TinyInt_ShortType,fix_ByteType_TinyInt_ShortType,5ee7d5e7079e79222239484d05da903d1d2eade0,shivsood,1579057,MDQ6VXNlcjE1NzkwNTc=,https://avatars2.githubusercontent.com/u/1579057?v=4,,https://api.github.com/users/shivsood,https://github.com/shivsood,https://api.github.com/users/shivsood/followers,https://api.github.com/users/shivsood/following{/other_user},https://api.github.com/users/shivsood/gists{/gist_id},https://api.github.com/users/shivsood/starred{/owner}{/repo},https://api.github.com/users/shivsood/subscriptions,https://api.github.com/users/shivsood/orgs,https://api.github.com/users/shivsood/repos,https://api.github.com/users/shivsood/events{/privacy},https://api.github.com/users/shivsood/received_events,User,False,192983938,MDEwOlJlcG9zaXRvcnkxOTI5ODM5Mzg=,spark,shivsood/spark,False,shivsood,1579057,MDQ6VXNlcjE1NzkwNTc=,https://avatars2.githubusercontent.com/u/1579057?v=4,,https://api.github.com/users/shivsood,https://github.com/shivsood,https://api.github.com/users/shivsood/followers,https://api.github.com/users/shivsood/following{/other_user},https://api.github.com/users/shivsood/gists{/gist_id},https://api.github.com/users/shivsood/starred{/owner}{/repo},https://api.github.com/users/shivsood/subscriptions,https://api.github.com/users/shivsood/orgs,https://api.github.com/users/shivsood/repos,https://api.github.com/users/shivsood/events{/privacy},https://api.github.com/users/shivsood/received_events,User,False,https://github.com/shivsood/spark,Apache Spark,True,https://api.github.com/repos/shivsood/spark,https://api.github.com/repos/shivsood/spark/forks,https://api.github.com/repos/shivsood/spark/keys{/key_id},https://api.github.com/repos/shivsood/spark/collaborators{/collaborator},https://api.github.com/repos/shivsood/spark/teams,https://api.github.com/repos/shivsood/spark/hooks,https://api.github.com/repos/shivsood/spark/issues/events{/number},https://api.github.com/repos/shivsood/spark/events,https://api.github.com/repos/shivsood/spark/assignees{/user},https://api.github.com/repos/shivsood/spark/branches{/branch},https://api.github.com/repos/shivsood/spark/tags,https://api.github.com/repos/shivsood/spark/git/blobs{/sha},https://api.github.com/repos/shivsood/spark/git/tags{/sha},https://api.github.com/repos/shivsood/spark/git/refs{/sha},https://api.github.com/repos/shivsood/spark/git/trees{/sha},https://api.github.com/repos/shivsood/spark/statuses/{sha},https://api.github.com/repos/shivsood/spark/languages,https://api.github.com/repos/shivsood/spark/stargazers,https://api.github.com/repos/shivsood/spark/contributors,https://api.github.com/repos/shivsood/spark/subscribers,https://api.github.com/repos/shivsood/spark/subscription,https://api.github.com/repos/shivsood/spark/commits{/sha},https://api.github.com/repos/shivsood/spark/git/commits{/sha},https://api.github.com/repos/shivsood/spark/comments{/number},https://api.github.com/repos/shivsood/spark/issues/comments{/number},https://api.github.com/repos/shivsood/spark/contents/{+path},https://api.github.com/repos/shivsood/spark/compare/{base}...{head},https://api.github.com/repos/shivsood/spark/merges,https://api.github.com/repos/shivsood/spark/{archive_format}{/ref},https://api.github.com/repos/shivsood/spark/downloads,https://api.github.com/repos/shivsood/spark/issues{/number},https://api.github.com/repos/shivsood/spark/pulls{/number},https://api.github.com/repos/shivsood/spark/milestones{/number},"https://api.github.com/repos/shivsood/spark/notifications{?since,all,participating}",https://api.github.com/repos/shivsood/spark/labels{/name},https://api.github.com/repos/shivsood/spark/releases{/id},https://api.github.com/repos/shivsood/spark/deployments,2019-06-20T20:32:39Z,2019-07-20T16:13:38Z,2020-01-10T23:29:29Z,git://github.com/shivsood/spark.git,git@github.com:shivsood/spark.git,https://github.com/shivsood/spark.git,https://github.com/shivsood/spark,,321701,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f372d1cf4fff535bcd0b0be0736da18037457fde,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27172,https://github.com/apache/spark/pull/27172,https://api.github.com/repos/apache/spark/issues/27172,https://api.github.com/repos/apache/spark/issues/27172/comments,https://api.github.com/repos/apache/spark/pulls/27172/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27172/commits,https://api.github.com/repos/apache/spark/statuses/5ee7d5e7079e79222239484d05da903d1d2eade0
154,https://api.github.com/repos/apache/spark/pulls/27170,361648278,MDExOlB1bGxSZXF1ZXN0MzYxNjQ4Mjc4,https://github.com/apache/spark/pull/27170,https://github.com/apache/spark/pull/27170.diff,https://github.com/apache/spark/pull/27170.patch,https://api.github.com/repos/apache/spark/issues/27170,27170,open,False,[SPARK-26494][SQL] Support Oracle TIMESTAMP WITH LOCAL TIME ZONE JDBC…,"… type

Add support for TIMESTAMP WITH LOCAL TIME ZONE (i.e. oracle.sql.TIMESTAMPLTZ)

Add assertion to existing test for new type

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Adding support for Oracle's `TIMESTAMP WITH LOCAL TIME ZONE` type

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

There are many databases out there that have this type defined, particularly as a key column, so it would be useful if Spark could read it properly

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

No


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

`sql` tests run via `sbt`",2020-01-10T22:32:33Z,2020-02-05T18:06:08Z,,,26c36ecc507a73158caabe5737a6d177788c4181,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27170/commits,https://api.github.com/repos/apache/spark/pulls/27170/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27170/comments,https://api.github.com/repos/apache/spark/statuses/074f91094cfbaa361481aa99c4d463b49227269b,CONTRIBUTOR,spark,apache,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,jeff303:SPARK-26494,SPARK-26494,074f91094cfbaa361481aa99c4d463b49227269b,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,207907929,MDEwOlJlcG9zaXRvcnkyMDc5MDc5Mjk=,spark,jeff303/spark,False,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,https://github.com/jeff303/spark,Apache Spark,True,https://api.github.com/repos/jeff303/spark,https://api.github.com/repos/jeff303/spark/forks,https://api.github.com/repos/jeff303/spark/keys{/key_id},https://api.github.com/repos/jeff303/spark/collaborators{/collaborator},https://api.github.com/repos/jeff303/spark/teams,https://api.github.com/repos/jeff303/spark/hooks,https://api.github.com/repos/jeff303/spark/issues/events{/number},https://api.github.com/repos/jeff303/spark/events,https://api.github.com/repos/jeff303/spark/assignees{/user},https://api.github.com/repos/jeff303/spark/branches{/branch},https://api.github.com/repos/jeff303/spark/tags,https://api.github.com/repos/jeff303/spark/git/blobs{/sha},https://api.github.com/repos/jeff303/spark/git/tags{/sha},https://api.github.com/repos/jeff303/spark/git/refs{/sha},https://api.github.com/repos/jeff303/spark/git/trees{/sha},https://api.github.com/repos/jeff303/spark/statuses/{sha},https://api.github.com/repos/jeff303/spark/languages,https://api.github.com/repos/jeff303/spark/stargazers,https://api.github.com/repos/jeff303/spark/contributors,https://api.github.com/repos/jeff303/spark/subscribers,https://api.github.com/repos/jeff303/spark/subscription,https://api.github.com/repos/jeff303/spark/commits{/sha},https://api.github.com/repos/jeff303/spark/git/commits{/sha},https://api.github.com/repos/jeff303/spark/comments{/number},https://api.github.com/repos/jeff303/spark/issues/comments{/number},https://api.github.com/repos/jeff303/spark/contents/{+path},https://api.github.com/repos/jeff303/spark/compare/{base}...{head},https://api.github.com/repos/jeff303/spark/merges,https://api.github.com/repos/jeff303/spark/{archive_format}{/ref},https://api.github.com/repos/jeff303/spark/downloads,https://api.github.com/repos/jeff303/spark/issues{/number},https://api.github.com/repos/jeff303/spark/pulls{/number},https://api.github.com/repos/jeff303/spark/milestones{/number},"https://api.github.com/repos/jeff303/spark/notifications{?since,all,participating}",https://api.github.com/repos/jeff303/spark/labels{/name},https://api.github.com/repos/jeff303/spark/releases{/id},https://api.github.com/repos/jeff303/spark/deployments,2019-09-11T21:14:13Z,2020-02-07T22:23:18Z,2020-01-10T23:02:50Z,git://github.com/jeff303/spark.git,git@github.com:jeff303/spark.git,https://github.com/jeff303/spark.git,https://github.com/jeff303/spark,,321894,1,1,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,b5bc3e12a629e547e32e340ee0439bc53745d862,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27170,https://github.com/apache/spark/pull/27170,https://api.github.com/repos/apache/spark/issues/27170,https://api.github.com/repos/apache/spark/issues/27170/comments,https://api.github.com/repos/apache/spark/pulls/27170/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27170/commits,https://api.github.com/repos/apache/spark/statuses/074f91094cfbaa361481aa99c4d463b49227269b
155,https://api.github.com/repos/apache/spark/pulls/27153,361060308,MDExOlB1bGxSZXF1ZXN0MzYxMDYwMzA4,https://github.com/apache/spark/pull/27153,https://github.com/apache/spark/pull/27153.diff,https://github.com/apache/spark/pull/27153.patch,https://api.github.com/repos/apache/spark/issues/27153,27153,open,False,[SPARK-20384][SQL] Support value class in schema of Dataset (without breaking existing current projection),"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
- This PR revisits https://github.com/apache/spark/pull/22309, and [SPARK-20384](https://issues.apache.org/jira/browse/SPARK-20384) solving the original problem, but additionally will prevent backward-compat break on schema of top-level `AnyVal` value class.
- Why previous break? We currently support top-level value classes just as any other case class; field of the underlying type is present in schema. This means any dataframe SQL filtering on this expects the field name to be present. The previous PR changes this schema and would result in breaking current usage. See test `""schema for case class that is a value class""`. This PR keeps the schema.
- We actually currently support collection of value classes prior to this change, but not case class of nested value class. This means the schema of these classes shouldn't change to prevent breaking too. See the tests asserting schema before any changes in 0cdad3b
- However, what we can change, without breaking, is schema of nested value class, which will fails due to the compile problem, and thus its schema now isn't actually valid. After the change, the schema of this nested value class is now flattened: 
c7aaae8
- With this PR, there's flattening only for nested value class (new), but not for top-level and collection classes (existing behavior)


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
- Currently, nested value class isn't supported. This is because when the generated code treats `anyVal` class in its unwrapped form, but we encode the type to be the wrapped case class. This results in compile of generated code
For example, 
For a given `AnyVal` wrapper and its root-level class container
```
case class IntWrapper(i: Int) extends AnyVal
case class ComplexValueClassContainer(c: IntWrapper)
```
The problematic part of generated code:
```
    private InternalRow If_1(InternalRow i) {
        boolean isNull_42 = i.isNullAt(0);
        // 1) ******** The root-level case class we care
        org.apache.spark.sql.catalyst.encoders.ComplexValueClassContainer value_46 = isNull_42 ?
            null : ((org.apache.spark.sql.catalyst.encoders.ComplexValueClassContainer) i.get(0, null));
        if (isNull_42) {
            throw new NullPointerException(((java.lang.String) references[5] /* errMsg */ ));
        }
        boolean isNull_39 = true;
        // 2) ******** We specify its member to be unwrapped case class extending `AnyVal`
        org.apache.spark.sql.catalyst.encoders.IntWrapper value_43 = null;
        if (!false) {

            isNull_39 = false;
            if (!isNull_39) {
                // 3) ******** ERROR: `c()` compiled however is of type `int` and thus we see error
                value_43 = value_46.c();
            }
        }
```
We get this errror: Assignment conversion not possible from type ""int"" to type ""org.apache.spark.sql.catalyst.encoders.IntWrapper""
```
java.util.concurrent.ExecutionException: org.codehaus.commons.compiler.CompileException: 
File 'generated.java', Line 159, Column 1: failed to compile: org.codehaus.commons.compiler.CompileException: File 'generated.java', Line 159, Column 1: Assignment conversion not possible from type ""int"" to type ""org.apache.spark.sql.catalyst.encoders.IntWrapper""
```

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
- Yes, this will fix the bug.


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
- This PR ports all the tests from https://github.com/apache/spark/pull/22309 and added a few more.

cc @mt40 please let me know if i'm missing something from your previous PR
cc @joshrosen-stripe ",2020-01-09T16:54:25Z,2020-02-07T17:46:27Z,,,4a78beb0e4eb4601581ca65804245275629231d2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27153/commits,https://api.github.com/repos/apache/spark/pulls/27153/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27153/comments,https://api.github.com/repos/apache/spark/statuses/c23705d9715efa16d73491191143c9f802bdff51,CONTRIBUTOR,spark,apache,mickjermsurawong-stripe,42550941,MDQ6VXNlcjQyNTUwOTQx,https://avatars0.githubusercontent.com/u/42550941?v=4,,https://api.github.com/users/mickjermsurawong-stripe,https://github.com/mickjermsurawong-stripe,https://api.github.com/users/mickjermsurawong-stripe/followers,https://api.github.com/users/mickjermsurawong-stripe/following{/other_user},https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id},https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo},https://api.github.com/users/mickjermsurawong-stripe/subscriptions,https://api.github.com/users/mickjermsurawong-stripe/orgs,https://api.github.com/users/mickjermsurawong-stripe/repos,https://api.github.com/users/mickjermsurawong-stripe/events{/privacy},https://api.github.com/users/mickjermsurawong-stripe/received_events,User,False,mickjermsurawong-stripe:SPARK-20384,SPARK-20384,c23705d9715efa16d73491191143c9f802bdff51,mickjermsurawong-stripe,42550941,MDQ6VXNlcjQyNTUwOTQx,https://avatars0.githubusercontent.com/u/42550941?v=4,,https://api.github.com/users/mickjermsurawong-stripe,https://github.com/mickjermsurawong-stripe,https://api.github.com/users/mickjermsurawong-stripe/followers,https://api.github.com/users/mickjermsurawong-stripe/following{/other_user},https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id},https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo},https://api.github.com/users/mickjermsurawong-stripe/subscriptions,https://api.github.com/users/mickjermsurawong-stripe/orgs,https://api.github.com/users/mickjermsurawong-stripe/repos,https://api.github.com/users/mickjermsurawong-stripe/events{/privacy},https://api.github.com/users/mickjermsurawong-stripe/received_events,User,False,194156930,MDEwOlJlcG9zaXRvcnkxOTQxNTY5MzA=,spark,mickjermsurawong-stripe/spark,False,mickjermsurawong-stripe,42550941,MDQ6VXNlcjQyNTUwOTQx,https://avatars0.githubusercontent.com/u/42550941?v=4,,https://api.github.com/users/mickjermsurawong-stripe,https://github.com/mickjermsurawong-stripe,https://api.github.com/users/mickjermsurawong-stripe/followers,https://api.github.com/users/mickjermsurawong-stripe/following{/other_user},https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id},https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo},https://api.github.com/users/mickjermsurawong-stripe/subscriptions,https://api.github.com/users/mickjermsurawong-stripe/orgs,https://api.github.com/users/mickjermsurawong-stripe/repos,https://api.github.com/users/mickjermsurawong-stripe/events{/privacy},https://api.github.com/users/mickjermsurawong-stripe/received_events,User,False,https://github.com/mickjermsurawong-stripe/spark,Apache Spark,True,https://api.github.com/repos/mickjermsurawong-stripe/spark,https://api.github.com/repos/mickjermsurawong-stripe/spark/forks,https://api.github.com/repos/mickjermsurawong-stripe/spark/keys{/key_id},https://api.github.com/repos/mickjermsurawong-stripe/spark/collaborators{/collaborator},https://api.github.com/repos/mickjermsurawong-stripe/spark/teams,https://api.github.com/repos/mickjermsurawong-stripe/spark/hooks,https://api.github.com/repos/mickjermsurawong-stripe/spark/issues/events{/number},https://api.github.com/repos/mickjermsurawong-stripe/spark/events,https://api.github.com/repos/mickjermsurawong-stripe/spark/assignees{/user},https://api.github.com/repos/mickjermsurawong-stripe/spark/branches{/branch},https://api.github.com/repos/mickjermsurawong-stripe/spark/tags,https://api.github.com/repos/mickjermsurawong-stripe/spark/git/blobs{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/git/tags{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/git/refs{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/git/trees{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/statuses/{sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/languages,https://api.github.com/repos/mickjermsurawong-stripe/spark/stargazers,https://api.github.com/repos/mickjermsurawong-stripe/spark/contributors,https://api.github.com/repos/mickjermsurawong-stripe/spark/subscribers,https://api.github.com/repos/mickjermsurawong-stripe/spark/subscription,https://api.github.com/repos/mickjermsurawong-stripe/spark/commits{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/git/commits{/sha},https://api.github.com/repos/mickjermsurawong-stripe/spark/comments{/number},https://api.github.com/repos/mickjermsurawong-stripe/spark/issues/comments{/number},https://api.github.com/repos/mickjermsurawong-stripe/spark/contents/{+path},https://api.github.com/repos/mickjermsurawong-stripe/spark/compare/{base}...{head},https://api.github.com/repos/mickjermsurawong-stripe/spark/merges,https://api.github.com/repos/mickjermsurawong-stripe/spark/{archive_format}{/ref},https://api.github.com/repos/mickjermsurawong-stripe/spark/downloads,https://api.github.com/repos/mickjermsurawong-stripe/spark/issues{/number},https://api.github.com/repos/mickjermsurawong-stripe/spark/pulls{/number},https://api.github.com/repos/mickjermsurawong-stripe/spark/milestones{/number},"https://api.github.com/repos/mickjermsurawong-stripe/spark/notifications{?since,all,participating}",https://api.github.com/repos/mickjermsurawong-stripe/spark/labels{/name},https://api.github.com/repos/mickjermsurawong-stripe/spark/releases{/id},https://api.github.com/repos/mickjermsurawong-stripe/spark/deployments,2019-06-27T20:10:42Z,2020-01-09T08:04:14Z,2020-01-14T07:13:46Z,git://github.com/mickjermsurawong-stripe/spark.git,git@github.com:mickjermsurawong-stripe/spark.git,https://github.com/mickjermsurawong-stripe/spark.git,https://github.com/mickjermsurawong-stripe/spark,,320891,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c88124a2460149ba6129778a332878c552791fd5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27153,https://github.com/apache/spark/pull/27153,https://api.github.com/repos/apache/spark/issues/27153,https://api.github.com/repos/apache/spark/issues/27153/comments,https://api.github.com/repos/apache/spark/pulls/27153/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27153/commits,https://api.github.com/repos/apache/spark/statuses/c23705d9715efa16d73491191143c9f802bdff51
156,https://api.github.com/repos/apache/spark/pulls/27150,360914290,MDExOlB1bGxSZXF1ZXN0MzYwOTE0Mjkw,https://github.com/apache/spark/pull/27150,https://github.com/apache/spark/pull/27150.diff,https://github.com/apache/spark/pull/27150.patch,https://api.github.com/repos/apache/spark/issues/27150,27150,open,False,[SPARK-30471][SQL] Fix issue when comparing String and IntegerType,"### What changes were proposed in this pull request?

For StringType and IntegerType, such as Byte/Short/Int/Long, their common type should be DoubleType.
Other wise, the result may corrupted.
For example:

When we comparing a String Type and IntegerType:
'2147483648'(StringType, which exceed Int.MaxValue) > 0(IntegerType).

Now the result of findCommonTypeForBinaryComparison(StringType, IntegerType) is IntegerType.

But the value of string may exceed Int.MaxValue, then the result is corruputed.
In this PR, for StringType and IntegerType, return DoubleType as their common type for binary comparison.

### Why are the changes needed?

Result may be corrupted.


### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Added Unit test.
",2020-01-09T11:35:13Z,2020-04-07T21:14:42Z,,,c0809994ba6cbf5d7d582033f7ffc256cb796524,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27150/commits,https://api.github.com/repos/apache/spark/pulls/27150/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27150/comments,https://api.github.com/repos/apache/spark/statuses/cf6d9ec9c97454a22c02229bb338ef0789b1593f,CONTRIBUTOR,spark,apache,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,turboFei:SPARK-30471-compare-string-integer,SPARK-30471-compare-string-integer,cf6d9ec9c97454a22c02229bb338ef0789b1593f,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,77131854,MDEwOlJlcG9zaXRvcnk3NzEzMTg1NA==,spark,turboFei/spark,False,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,https://github.com/turboFei/spark,Mirror of Apache Spark,True,https://api.github.com/repos/turboFei/spark,https://api.github.com/repos/turboFei/spark/forks,https://api.github.com/repos/turboFei/spark/keys{/key_id},https://api.github.com/repos/turboFei/spark/collaborators{/collaborator},https://api.github.com/repos/turboFei/spark/teams,https://api.github.com/repos/turboFei/spark/hooks,https://api.github.com/repos/turboFei/spark/issues/events{/number},https://api.github.com/repos/turboFei/spark/events,https://api.github.com/repos/turboFei/spark/assignees{/user},https://api.github.com/repos/turboFei/spark/branches{/branch},https://api.github.com/repos/turboFei/spark/tags,https://api.github.com/repos/turboFei/spark/git/blobs{/sha},https://api.github.com/repos/turboFei/spark/git/tags{/sha},https://api.github.com/repos/turboFei/spark/git/refs{/sha},https://api.github.com/repos/turboFei/spark/git/trees{/sha},https://api.github.com/repos/turboFei/spark/statuses/{sha},https://api.github.com/repos/turboFei/spark/languages,https://api.github.com/repos/turboFei/spark/stargazers,https://api.github.com/repos/turboFei/spark/contributors,https://api.github.com/repos/turboFei/spark/subscribers,https://api.github.com/repos/turboFei/spark/subscription,https://api.github.com/repos/turboFei/spark/commits{/sha},https://api.github.com/repos/turboFei/spark/git/commits{/sha},https://api.github.com/repos/turboFei/spark/comments{/number},https://api.github.com/repos/turboFei/spark/issues/comments{/number},https://api.github.com/repos/turboFei/spark/contents/{+path},https://api.github.com/repos/turboFei/spark/compare/{base}...{head},https://api.github.com/repos/turboFei/spark/merges,https://api.github.com/repos/turboFei/spark/{archive_format}{/ref},https://api.github.com/repos/turboFei/spark/downloads,https://api.github.com/repos/turboFei/spark/issues{/number},https://api.github.com/repos/turboFei/spark/pulls{/number},https://api.github.com/repos/turboFei/spark/milestones{/number},"https://api.github.com/repos/turboFei/spark/notifications{?since,all,participating}",https://api.github.com/repos/turboFei/spark/labels{/name},https://api.github.com/repos/turboFei/spark/releases{/id},https://api.github.com/repos/turboFei/spark/deployments,2016-12-22T09:34:08Z,2019-10-25T09:06:55Z,2020-04-08T10:08:56Z,git://github.com/turboFei/spark.git,git@github.com:turboFei/spark.git,https://github.com/turboFei/spark.git,https://github.com/turboFei/spark,,322115,0,0,Scala,False,True,True,False,False,0,,False,False,4,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,4,0,master,apache:master,master,1f0300fb16ad8b2670a6194b5ba2d5f4d275e987,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27150,https://github.com/apache/spark/pull/27150,https://api.github.com/repos/apache/spark/issues/27150,https://api.github.com/repos/apache/spark/issues/27150/comments,https://api.github.com/repos/apache/spark/pulls/27150/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27150/commits,https://api.github.com/repos/apache/spark/statuses/cf6d9ec9c97454a22c02229bb338ef0789b1593f
157,https://api.github.com/repos/apache/spark/pulls/27148,360854871,MDExOlB1bGxSZXF1ZXN0MzYwODU0ODcx,https://github.com/apache/spark/pull/27148,https://github.com/apache/spark/pull/27148.diff,https://github.com/apache/spark/pull/27148.patch,https://api.github.com/repos/apache/spark/issues/27148,27148,open,False,[SPARK-30469][SQL][WIP] Partition columns should not be involved when calculating sizeInBytes of Project logical plan,"### What changes were proposed in this pull request?
 SizeInBytesOnlyStatsPlanVisitor.visitProject exclude partition columns when calculating sizeInBytes.

### Why are the changes needed?
When getting the statistics of a Project logical plan, if CBO not enabled, Spark will call SizeInBytesOnlyStatsPlanVisitor.visitUnaryNode to calculate the size in bytes, which will compute the ratio of the row size of the project plan and its child plan.
And the row size is computed based on the output attributes (columns). Currently, SizeInBytesOnlyStatsPlanVisitor.visitUnaryNode involve partition columns of hive table as well, which is not reasonable, because partition columns actually does not account for sizeInBytes.
This may make the sizeInBytes not accurate. This PR update to exclude partition columns in SizeInBytesOnlyStatsPlanVisitor.visitProject

### Does this PR introduce any user-facing change?
no

### How was this patch tested?
Existing unit test
",2020-01-09T09:23:47Z,2020-02-05T18:06:10Z,,,a95cb9452b29a92f6a3aa5dec80cc937073aa50f,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27148/commits,https://api.github.com/repos/apache/spark/pulls/27148/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27148/comments,https://api.github.com/repos/apache/spark/statuses/26c7ce3ddaf3dc4d0a46331ec2f54c9036c19923,CONTRIBUTOR,spark,apache,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,fuwhu:SPARK-30469,SPARK-30469,26c7ce3ddaf3dc4d0a46331ec2f54c9036c19923,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,42981239,MDEwOlJlcG9zaXRvcnk0Mjk4MTIzOQ==,spark,fuwhu/spark,False,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,https://github.com/fuwhu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/fuwhu/spark,https://api.github.com/repos/fuwhu/spark/forks,https://api.github.com/repos/fuwhu/spark/keys{/key_id},https://api.github.com/repos/fuwhu/spark/collaborators{/collaborator},https://api.github.com/repos/fuwhu/spark/teams,https://api.github.com/repos/fuwhu/spark/hooks,https://api.github.com/repos/fuwhu/spark/issues/events{/number},https://api.github.com/repos/fuwhu/spark/events,https://api.github.com/repos/fuwhu/spark/assignees{/user},https://api.github.com/repos/fuwhu/spark/branches{/branch},https://api.github.com/repos/fuwhu/spark/tags,https://api.github.com/repos/fuwhu/spark/git/blobs{/sha},https://api.github.com/repos/fuwhu/spark/git/tags{/sha},https://api.github.com/repos/fuwhu/spark/git/refs{/sha},https://api.github.com/repos/fuwhu/spark/git/trees{/sha},https://api.github.com/repos/fuwhu/spark/statuses/{sha},https://api.github.com/repos/fuwhu/spark/languages,https://api.github.com/repos/fuwhu/spark/stargazers,https://api.github.com/repos/fuwhu/spark/contributors,https://api.github.com/repos/fuwhu/spark/subscribers,https://api.github.com/repos/fuwhu/spark/subscription,https://api.github.com/repos/fuwhu/spark/commits{/sha},https://api.github.com/repos/fuwhu/spark/git/commits{/sha},https://api.github.com/repos/fuwhu/spark/comments{/number},https://api.github.com/repos/fuwhu/spark/issues/comments{/number},https://api.github.com/repos/fuwhu/spark/contents/{+path},https://api.github.com/repos/fuwhu/spark/compare/{base}...{head},https://api.github.com/repos/fuwhu/spark/merges,https://api.github.com/repos/fuwhu/spark/{archive_format}{/ref},https://api.github.com/repos/fuwhu/spark/downloads,https://api.github.com/repos/fuwhu/spark/issues{/number},https://api.github.com/repos/fuwhu/spark/pulls{/number},https://api.github.com/repos/fuwhu/spark/milestones{/number},"https://api.github.com/repos/fuwhu/spark/notifications{?since,all,participating}",https://api.github.com/repos/fuwhu/spark/labels{/name},https://api.github.com/repos/fuwhu/spark/releases{/id},https://api.github.com/repos/fuwhu/spark/deployments,2015-09-23T05:56:07Z,2020-02-18T03:37:24Z,2020-02-18T03:37:19Z,git://github.com/fuwhu/spark.git,git@github.com:fuwhu/spark.git,https://github.com/fuwhu/spark.git,https://github.com/fuwhu/spark,,297828,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,dcdc9a8be74c7fd6a5b2031bc4f96ca45f108e03,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27148,https://github.com/apache/spark/pull/27148,https://api.github.com/repos/apache/spark/issues/27148,https://api.github.com/repos/apache/spark/issues/27148/comments,https://api.github.com/repos/apache/spark/pulls/27148/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27148/commits,https://api.github.com/repos/apache/spark/statuses/26c7ce3ddaf3dc4d0a46331ec2f54c9036c19923
158,https://api.github.com/repos/apache/spark/pulls/27137,360541991,MDExOlB1bGxSZXF1ZXN0MzYwNTQxOTkx,https://github.com/apache/spark/pull/27137,https://github.com/apache/spark/pull/27137.diff,https://github.com/apache/spark/pull/27137.patch,https://api.github.com/repos/apache/spark/issues/27137,27137,open,False,[SPARK-30461][Web UI](+details) link when expanded should change the status from collapse to expand state(-details),"### What changes were proposed in this pull request?
(+details) link when expanded should change the status from collapse to expand state(-details)

### Why are the changes needed?
To improve end-user Web UI experience (It's good to change the state from +details to -details, during expanded operation) 

### Does this PR introduce any user-facing change?
Yes

![Screenshot 2020-01-08 at 9 50 54 PM](https://user-images.githubusercontent.com/8948111/71996023-83a3fb80-3261-11ea-8f27-a99b4bb79af4.png)

![Screenshot 2020-01-08 at 9 51 22 PM](https://user-images.githubusercontent.com/8948111/71996043-8acb0980-3261-11ea-90e0-5c048bf5f3c2.png)

### How was this patch tested?
Manual testing.
",2020-01-08T16:25:23Z,2020-02-05T18:06:11Z,,,c8c0b4882363f67d2f74543ffb386a02f0e7783d,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27137/commits,https://api.github.com/repos/apache/spark/pulls/27137/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27137/comments,https://api.github.com/repos/apache/spark/statuses/8e18c9d01743a75c77f731d35eba4459d9eb13b8,CONTRIBUTOR,spark,apache,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,07ARB:SPARK-30461,SPARK-30461,8e18c9d01743a75c77f731d35eba4459d9eb13b8,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,213365500,MDEwOlJlcG9zaXRvcnkyMTMzNjU1MDA=,spark,07ARB/spark,False,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,https://github.com/07ARB/spark,Apache Spark,True,https://api.github.com/repos/07ARB/spark,https://api.github.com/repos/07ARB/spark/forks,https://api.github.com/repos/07ARB/spark/keys{/key_id},https://api.github.com/repos/07ARB/spark/collaborators{/collaborator},https://api.github.com/repos/07ARB/spark/teams,https://api.github.com/repos/07ARB/spark/hooks,https://api.github.com/repos/07ARB/spark/issues/events{/number},https://api.github.com/repos/07ARB/spark/events,https://api.github.com/repos/07ARB/spark/assignees{/user},https://api.github.com/repos/07ARB/spark/branches{/branch},https://api.github.com/repos/07ARB/spark/tags,https://api.github.com/repos/07ARB/spark/git/blobs{/sha},https://api.github.com/repos/07ARB/spark/git/tags{/sha},https://api.github.com/repos/07ARB/spark/git/refs{/sha},https://api.github.com/repos/07ARB/spark/git/trees{/sha},https://api.github.com/repos/07ARB/spark/statuses/{sha},https://api.github.com/repos/07ARB/spark/languages,https://api.github.com/repos/07ARB/spark/stargazers,https://api.github.com/repos/07ARB/spark/contributors,https://api.github.com/repos/07ARB/spark/subscribers,https://api.github.com/repos/07ARB/spark/subscription,https://api.github.com/repos/07ARB/spark/commits{/sha},https://api.github.com/repos/07ARB/spark/git/commits{/sha},https://api.github.com/repos/07ARB/spark/comments{/number},https://api.github.com/repos/07ARB/spark/issues/comments{/number},https://api.github.com/repos/07ARB/spark/contents/{+path},https://api.github.com/repos/07ARB/spark/compare/{base}...{head},https://api.github.com/repos/07ARB/spark/merges,https://api.github.com/repos/07ARB/spark/{archive_format}{/ref},https://api.github.com/repos/07ARB/spark/downloads,https://api.github.com/repos/07ARB/spark/issues{/number},https://api.github.com/repos/07ARB/spark/pulls{/number},https://api.github.com/repos/07ARB/spark/milestones{/number},"https://api.github.com/repos/07ARB/spark/notifications{?since,all,participating}",https://api.github.com/repos/07ARB/spark/labels{/name},https://api.github.com/repos/07ARB/spark/releases{/id},https://api.github.com/repos/07ARB/spark/deployments,2019-10-07T11:28:14Z,2020-02-20T10:47:52Z,2020-01-13T14:40:24Z,git://github.com/07ARB/spark.git,git@github.com:07ARB/spark.git,https://github.com/07ARB/spark.git,https://github.com/07ARB/spark,,322245,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,f77dcfc55af968cdfb29ac798e21229fe7f6c063,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27137,https://github.com/apache/spark/pull/27137,https://api.github.com/repos/apache/spark/issues/27137,https://api.github.com/repos/apache/spark/issues/27137/comments,https://api.github.com/repos/apache/spark/pulls/27137/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27137/commits,https://api.github.com/repos/apache/spark/statuses/8e18c9d01743a75c77f731d35eba4459d9eb13b8
159,https://api.github.com/repos/apache/spark/pulls/27129,360291624,MDExOlB1bGxSZXF1ZXN0MzYwMjkxNjI0,https://github.com/apache/spark/pull/27129,https://github.com/apache/spark/pull/27129.diff,https://github.com/apache/spark/pull/27129.patch,https://api.github.com/repos/apache/spark/issues/27129,27129,open,False,[SPARK-30427][SQL] Add config item for limiting partition number when calculating statistics through File System,"### What changes were proposed in this pull request?
Add config ""spark.sql.statistics.fallBackToFs.maxPartitionNumber"" and use it to control whether calculate statistics through file system.

### Why are the changes needed?
Currently, when spark need to calculate the statistics (eg. sizeInBytes) of table partition through file system (eg. HDFS), it does not consider the number of partitions. Then if the the number of partitions is huge, it will cost much time to calculate the statistics which may be not be that useful.

It should be reasonable to add a config item to control the limit of partition number allowable to calculate statistics through file system.


### Does this PR introduce any user-facing change?
Yes, statistics of logical plan may be changed which may impact some spark strategies part, eg. JoinSelection.


### How was this patch tested?
Added new unit test.
",2020-01-08T05:43:59Z,2020-02-18T06:55:06Z,,,0fbad84d4a0c6e147dcecdb6a957edad9ea29072,,[],"[{'login': 'cloud-fan', 'id': 3182036, 'node_id': 'MDQ6VXNlcjMxODIwMzY=', 'avatar_url': 'https://avatars3.githubusercontent.com/u/3182036?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/cloud-fan', 'html_url': 'https://github.com/cloud-fan', 'followers_url': 'https://api.github.com/users/cloud-fan/followers', 'following_url': 'https://api.github.com/users/cloud-fan/following{/other_user}', 'gists_url': 'https://api.github.com/users/cloud-fan/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/cloud-fan/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/cloud-fan/subscriptions', 'organizations_url': 'https://api.github.com/users/cloud-fan/orgs', 'repos_url': 'https://api.github.com/users/cloud-fan/repos', 'events_url': 'https://api.github.com/users/cloud-fan/events{/privacy}', 'received_events_url': 'https://api.github.com/users/cloud-fan/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27129/commits,https://api.github.com/repos/apache/spark/pulls/27129/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27129/comments,https://api.github.com/repos/apache/spark/statuses/8b14ce4435dfa6fb5114385bb122ec9a86ca7213,CONTRIBUTOR,spark,apache,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,fuwhu:SPARK-30427,SPARK-30427,8b14ce4435dfa6fb5114385bb122ec9a86ca7213,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,42981239,MDEwOlJlcG9zaXRvcnk0Mjk4MTIzOQ==,spark,fuwhu/spark,False,fuwhu,12389745,MDQ6VXNlcjEyMzg5NzQ1,https://avatars2.githubusercontent.com/u/12389745?v=4,,https://api.github.com/users/fuwhu,https://github.com/fuwhu,https://api.github.com/users/fuwhu/followers,https://api.github.com/users/fuwhu/following{/other_user},https://api.github.com/users/fuwhu/gists{/gist_id},https://api.github.com/users/fuwhu/starred{/owner}{/repo},https://api.github.com/users/fuwhu/subscriptions,https://api.github.com/users/fuwhu/orgs,https://api.github.com/users/fuwhu/repos,https://api.github.com/users/fuwhu/events{/privacy},https://api.github.com/users/fuwhu/received_events,User,False,https://github.com/fuwhu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/fuwhu/spark,https://api.github.com/repos/fuwhu/spark/forks,https://api.github.com/repos/fuwhu/spark/keys{/key_id},https://api.github.com/repos/fuwhu/spark/collaborators{/collaborator},https://api.github.com/repos/fuwhu/spark/teams,https://api.github.com/repos/fuwhu/spark/hooks,https://api.github.com/repos/fuwhu/spark/issues/events{/number},https://api.github.com/repos/fuwhu/spark/events,https://api.github.com/repos/fuwhu/spark/assignees{/user},https://api.github.com/repos/fuwhu/spark/branches{/branch},https://api.github.com/repos/fuwhu/spark/tags,https://api.github.com/repos/fuwhu/spark/git/blobs{/sha},https://api.github.com/repos/fuwhu/spark/git/tags{/sha},https://api.github.com/repos/fuwhu/spark/git/refs{/sha},https://api.github.com/repos/fuwhu/spark/git/trees{/sha},https://api.github.com/repos/fuwhu/spark/statuses/{sha},https://api.github.com/repos/fuwhu/spark/languages,https://api.github.com/repos/fuwhu/spark/stargazers,https://api.github.com/repos/fuwhu/spark/contributors,https://api.github.com/repos/fuwhu/spark/subscribers,https://api.github.com/repos/fuwhu/spark/subscription,https://api.github.com/repos/fuwhu/spark/commits{/sha},https://api.github.com/repos/fuwhu/spark/git/commits{/sha},https://api.github.com/repos/fuwhu/spark/comments{/number},https://api.github.com/repos/fuwhu/spark/issues/comments{/number},https://api.github.com/repos/fuwhu/spark/contents/{+path},https://api.github.com/repos/fuwhu/spark/compare/{base}...{head},https://api.github.com/repos/fuwhu/spark/merges,https://api.github.com/repos/fuwhu/spark/{archive_format}{/ref},https://api.github.com/repos/fuwhu/spark/downloads,https://api.github.com/repos/fuwhu/spark/issues{/number},https://api.github.com/repos/fuwhu/spark/pulls{/number},https://api.github.com/repos/fuwhu/spark/milestones{/number},"https://api.github.com/repos/fuwhu/spark/notifications{?since,all,participating}",https://api.github.com/repos/fuwhu/spark/labels{/name},https://api.github.com/repos/fuwhu/spark/releases{/id},https://api.github.com/repos/fuwhu/spark/deployments,2015-09-23T05:56:07Z,2020-02-18T03:37:24Z,2020-02-18T03:37:19Z,git://github.com/fuwhu/spark.git,git@github.com:fuwhu/spark.git,https://github.com/fuwhu/spark.git,https://github.com/fuwhu/spark,,297828,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f56ba37d8bf618f2bef23d808e0fc5704261b139,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27129,https://github.com/apache/spark/pull/27129,https://api.github.com/repos/apache/spark/issues/27129,https://api.github.com/repos/apache/spark/issues/27129/comments,https://api.github.com/repos/apache/spark/pulls/27129/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27129/commits,https://api.github.com/repos/apache/spark/statuses/8b14ce4435dfa6fb5114385bb122ec9a86ca7213
160,https://api.github.com/repos/apache/spark/pulls/27113,359814271,MDExOlB1bGxSZXF1ZXN0MzU5ODE0Mjcx,https://github.com/apache/spark/pull/27113,https://github.com/apache/spark/pull/27113.diff,https://github.com/apache/spark/pull/27113.patch,https://api.github.com/repos/apache/spark/issues/27113,27113,open,False,[SPARK-30432][Graphx]reduce degree recomputation in StronglyConnectedComponents," i have done a small code proposal, because there is a problem when the pregel executions have done,  the degree no need to be recomputed.

and I created a branch in my fork: https://github.com/xs-li/spark/blob/master/graphx/src/main/scala/org/apache/spark/graphx/lib/StronglyConnectedComponents.scala

the computation happens every time in the do-while loop, the first time the outer while loop executes. although just once per do-while loop after,  but it does reduce a lot of recomputation；because every time it jump out of the do-while loop，there are no vertices have only out-degree or in-degree，so it's no need to recompute degree and tag the vertices true.

for example，the Email-EuAll  data set：http://snap.stanford.edu/data/email-EuAll.html

do-while loop execute 10 times，and the reduce logic happend 2 times；so it would be helpful when computing StronglyConnectedComponents to reduce degree computation.
",2020-01-07T04:07:45Z,2020-02-05T18:06:15Z,,,00272b97e058e01406bf8029d5e1876703994d66,,[],[],[],"[{'id': 1406607243, 'node_id': 'MDU6TGFiZWwxNDA2NjA3MjQz', 'url': 'https://api.github.com/repos/apache/spark/labels/GRAPHX', 'name': 'GRAPHX', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27113/commits,https://api.github.com/repos/apache/spark/pulls/27113/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27113/comments,https://api.github.com/repos/apache/spark/statuses/61402cba6865c34ea4fc474fcc05b406fa298bb1,NONE,spark,apache,xs-li,48080397,MDQ6VXNlcjQ4MDgwMzk3,https://avatars3.githubusercontent.com/u/48080397?v=4,,https://api.github.com/users/xs-li,https://github.com/xs-li,https://api.github.com/users/xs-li/followers,https://api.github.com/users/xs-li/following{/other_user},https://api.github.com/users/xs-li/gists{/gist_id},https://api.github.com/users/xs-li/starred{/owner}{/repo},https://api.github.com/users/xs-li/subscriptions,https://api.github.com/users/xs-li/orgs,https://api.github.com/users/xs-li/repos,https://api.github.com/users/xs-li/events{/privacy},https://api.github.com/users/xs-li/received_events,User,False,xs-li:master,master,61402cba6865c34ea4fc474fcc05b406fa298bb1,xs-li,48080397,MDQ6VXNlcjQ4MDgwMzk3,https://avatars3.githubusercontent.com/u/48080397?v=4,,https://api.github.com/users/xs-li,https://github.com/xs-li,https://api.github.com/users/xs-li/followers,https://api.github.com/users/xs-li/following{/other_user},https://api.github.com/users/xs-li/gists{/gist_id},https://api.github.com/users/xs-li/starred{/owner}{/repo},https://api.github.com/users/xs-li/subscriptions,https://api.github.com/users/xs-li/orgs,https://api.github.com/users/xs-li/repos,https://api.github.com/users/xs-li/events{/privacy},https://api.github.com/users/xs-li/received_events,User,False,185557637,MDEwOlJlcG9zaXRvcnkxODU1NTc2Mzc=,spark,xs-li/spark,False,xs-li,48080397,MDQ6VXNlcjQ4MDgwMzk3,https://avatars3.githubusercontent.com/u/48080397?v=4,,https://api.github.com/users/xs-li,https://github.com/xs-li,https://api.github.com/users/xs-li/followers,https://api.github.com/users/xs-li/following{/other_user},https://api.github.com/users/xs-li/gists{/gist_id},https://api.github.com/users/xs-li/starred{/owner}{/repo},https://api.github.com/users/xs-li/subscriptions,https://api.github.com/users/xs-li/orgs,https://api.github.com/users/xs-li/repos,https://api.github.com/users/xs-li/events{/privacy},https://api.github.com/users/xs-li/received_events,User,False,https://github.com/xs-li/spark,Apache Spark,True,https://api.github.com/repos/xs-li/spark,https://api.github.com/repos/xs-li/spark/forks,https://api.github.com/repos/xs-li/spark/keys{/key_id},https://api.github.com/repos/xs-li/spark/collaborators{/collaborator},https://api.github.com/repos/xs-li/spark/teams,https://api.github.com/repos/xs-li/spark/hooks,https://api.github.com/repos/xs-li/spark/issues/events{/number},https://api.github.com/repos/xs-li/spark/events,https://api.github.com/repos/xs-li/spark/assignees{/user},https://api.github.com/repos/xs-li/spark/branches{/branch},https://api.github.com/repos/xs-li/spark/tags,https://api.github.com/repos/xs-li/spark/git/blobs{/sha},https://api.github.com/repos/xs-li/spark/git/tags{/sha},https://api.github.com/repos/xs-li/spark/git/refs{/sha},https://api.github.com/repos/xs-li/spark/git/trees{/sha},https://api.github.com/repos/xs-li/spark/statuses/{sha},https://api.github.com/repos/xs-li/spark/languages,https://api.github.com/repos/xs-li/spark/stargazers,https://api.github.com/repos/xs-li/spark/contributors,https://api.github.com/repos/xs-li/spark/subscribers,https://api.github.com/repos/xs-li/spark/subscription,https://api.github.com/repos/xs-li/spark/commits{/sha},https://api.github.com/repos/xs-li/spark/git/commits{/sha},https://api.github.com/repos/xs-li/spark/comments{/number},https://api.github.com/repos/xs-li/spark/issues/comments{/number},https://api.github.com/repos/xs-li/spark/contents/{+path},https://api.github.com/repos/xs-li/spark/compare/{base}...{head},https://api.github.com/repos/xs-li/spark/merges,https://api.github.com/repos/xs-li/spark/{archive_format}{/ref},https://api.github.com/repos/xs-li/spark/downloads,https://api.github.com/repos/xs-li/spark/issues{/number},https://api.github.com/repos/xs-li/spark/pulls{/number},https://api.github.com/repos/xs-li/spark/milestones{/number},"https://api.github.com/repos/xs-li/spark/notifications{?since,all,participating}",https://api.github.com/repos/xs-li/spark/labels{/name},https://api.github.com/repos/xs-li/spark/releases{/id},https://api.github.com/repos/xs-li/spark/deployments,2019-05-08T07:45:18Z,2020-01-08T06:23:24Z,2020-01-07T05:39:57Z,git://github.com/xs-li/spark.git,git@github.com:xs-li/spark.git,https://github.com/xs-li/spark.git,https://github.com/xs-li/spark,,297558,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,da076153aa569cfedc7322332898ae7031044f25,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27113,https://github.com/apache/spark/pull/27113,https://api.github.com/repos/apache/spark/issues/27113,https://api.github.com/repos/apache/spark/issues/27113/comments,https://api.github.com/repos/apache/spark/pulls/27113/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27113/commits,https://api.github.com/repos/apache/spark/statuses/61402cba6865c34ea4fc474fcc05b406fa298bb1
161,https://api.github.com/repos/apache/spark/pulls/27111,359618865,MDExOlB1bGxSZXF1ZXN0MzU5NjE4ODY1,https://github.com/apache/spark/pull/27111,https://github.com/apache/spark/pull/27111.diff,https://github.com/apache/spark/pull/27111.patch,https://api.github.com/repos/apache/spark/issues/27111,27111,open,False,[SPARK-30441][Graphx]Improve the memory usage in StronglyConnectedComponents,"### What changes were proposed in this pull request?
Make the Graph/RDD as non-persistent for 'sccGraph' in 'do ... while' and 'pregel'.

The variable 'sccGraph' has been removed, use the variable 'sccVertexLabel' to collect the vertices to be removed in iteration.

### Why are the changes needed?
To improve the memory usage, mark the Graph/RDD as non-persistent in the iterative process timely.
figure1: before optimizing memory usage
![figure1](https://user-images.githubusercontent.com/43285458/71855828-18511100-311d-11ea-8abc-7adc669a89cb.png)

figure2: after optimizing memory usage
![figure2](https://user-images.githubusercontent.com/43285458/71855848-299a1d80-311d-11ea-91a3-ee3a53125921.png)

### Does this PR introduce any user-facing change?
no

### How was this patch tested?
existing tests",2020-01-06T16:40:18Z,2020-02-05T18:06:16Z,,,a606fa5343aca8f1f46fc413b8ee55f9aed1f648,,[],[],[],"[{'id': 1406607243, 'node_id': 'MDU6TGFiZWwxNDA2NjA3MjQz', 'url': 'https://api.github.com/repos/apache/spark/labels/GRAPHX', 'name': 'GRAPHX', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27111/commits,https://api.github.com/repos/apache/spark/pulls/27111/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27111/comments,https://api.github.com/repos/apache/spark/statuses/a72c157dad821d2f3662953f91707c7505eb3535,NONE,spark,apache,jmzhoulab,43285458,MDQ6VXNlcjQzMjg1NDU4,https://avatars2.githubusercontent.com/u/43285458?v=4,,https://api.github.com/users/jmzhoulab,https://github.com/jmzhoulab,https://api.github.com/users/jmzhoulab/followers,https://api.github.com/users/jmzhoulab/following{/other_user},https://api.github.com/users/jmzhoulab/gists{/gist_id},https://api.github.com/users/jmzhoulab/starred{/owner}{/repo},https://api.github.com/users/jmzhoulab/subscriptions,https://api.github.com/users/jmzhoulab/orgs,https://api.github.com/users/jmzhoulab/repos,https://api.github.com/users/jmzhoulab/events{/privacy},https://api.github.com/users/jmzhoulab/received_events,User,False,jmzhoulab:master,master,a72c157dad821d2f3662953f91707c7505eb3535,jmzhoulab,43285458,MDQ6VXNlcjQzMjg1NDU4,https://avatars2.githubusercontent.com/u/43285458?v=4,,https://api.github.com/users/jmzhoulab,https://github.com/jmzhoulab,https://api.github.com/users/jmzhoulab/followers,https://api.github.com/users/jmzhoulab/following{/other_user},https://api.github.com/users/jmzhoulab/gists{/gist_id},https://api.github.com/users/jmzhoulab/starred{/owner}{/repo},https://api.github.com/users/jmzhoulab/subscriptions,https://api.github.com/users/jmzhoulab/orgs,https://api.github.com/users/jmzhoulab/repos,https://api.github.com/users/jmzhoulab/events{/privacy},https://api.github.com/users/jmzhoulab/received_events,User,False,183725120,MDEwOlJlcG9zaXRvcnkxODM3MjUxMjA=,spark,jmzhoulab/spark,False,jmzhoulab,43285458,MDQ6VXNlcjQzMjg1NDU4,https://avatars2.githubusercontent.com/u/43285458?v=4,,https://api.github.com/users/jmzhoulab,https://github.com/jmzhoulab,https://api.github.com/users/jmzhoulab/followers,https://api.github.com/users/jmzhoulab/following{/other_user},https://api.github.com/users/jmzhoulab/gists{/gist_id},https://api.github.com/users/jmzhoulab/starred{/owner}{/repo},https://api.github.com/users/jmzhoulab/subscriptions,https://api.github.com/users/jmzhoulab/orgs,https://api.github.com/users/jmzhoulab/repos,https://api.github.com/users/jmzhoulab/events{/privacy},https://api.github.com/users/jmzhoulab/received_events,User,False,https://github.com/jmzhoulab/spark,Apache Spark,True,https://api.github.com/repos/jmzhoulab/spark,https://api.github.com/repos/jmzhoulab/spark/forks,https://api.github.com/repos/jmzhoulab/spark/keys{/key_id},https://api.github.com/repos/jmzhoulab/spark/collaborators{/collaborator},https://api.github.com/repos/jmzhoulab/spark/teams,https://api.github.com/repos/jmzhoulab/spark/hooks,https://api.github.com/repos/jmzhoulab/spark/issues/events{/number},https://api.github.com/repos/jmzhoulab/spark/events,https://api.github.com/repos/jmzhoulab/spark/assignees{/user},https://api.github.com/repos/jmzhoulab/spark/branches{/branch},https://api.github.com/repos/jmzhoulab/spark/tags,https://api.github.com/repos/jmzhoulab/spark/git/blobs{/sha},https://api.github.com/repos/jmzhoulab/spark/git/tags{/sha},https://api.github.com/repos/jmzhoulab/spark/git/refs{/sha},https://api.github.com/repos/jmzhoulab/spark/git/trees{/sha},https://api.github.com/repos/jmzhoulab/spark/statuses/{sha},https://api.github.com/repos/jmzhoulab/spark/languages,https://api.github.com/repos/jmzhoulab/spark/stargazers,https://api.github.com/repos/jmzhoulab/spark/contributors,https://api.github.com/repos/jmzhoulab/spark/subscribers,https://api.github.com/repos/jmzhoulab/spark/subscription,https://api.github.com/repos/jmzhoulab/spark/commits{/sha},https://api.github.com/repos/jmzhoulab/spark/git/commits{/sha},https://api.github.com/repos/jmzhoulab/spark/comments{/number},https://api.github.com/repos/jmzhoulab/spark/issues/comments{/number},https://api.github.com/repos/jmzhoulab/spark/contents/{+path},https://api.github.com/repos/jmzhoulab/spark/compare/{base}...{head},https://api.github.com/repos/jmzhoulab/spark/merges,https://api.github.com/repos/jmzhoulab/spark/{archive_format}{/ref},https://api.github.com/repos/jmzhoulab/spark/downloads,https://api.github.com/repos/jmzhoulab/spark/issues{/number},https://api.github.com/repos/jmzhoulab/spark/pulls{/number},https://api.github.com/repos/jmzhoulab/spark/milestones{/number},"https://api.github.com/repos/jmzhoulab/spark/notifications{?since,all,participating}",https://api.github.com/repos/jmzhoulab/spark/labels{/name},https://api.github.com/repos/jmzhoulab/spark/releases{/id},https://api.github.com/repos/jmzhoulab/spark/deployments,2019-04-27T03:47:30Z,2020-01-16T00:52:13Z,2020-01-16T00:52:02Z,git://github.com/jmzhoulab/spark.git,git@github.com:jmzhoulab/spark.git,https://github.com/jmzhoulab/spark.git,https://github.com/jmzhoulab/spark,,321500,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,604d6799df23329778bc384d429445cf52def4d4,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27111,https://github.com/apache/spark/pull/27111,https://api.github.com/repos/apache/spark/issues/27111,https://api.github.com/repos/apache/spark/issues/27111/comments,https://api.github.com/repos/apache/spark/pulls/27111/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27111/commits,https://api.github.com/repos/apache/spark/statuses/a72c157dad821d2f3662953f91707c7505eb3535
162,https://api.github.com/repos/apache/spark/pulls/27100,359422501,MDExOlB1bGxSZXF1ZXN0MzU5NDIyNTAx,https://github.com/apache/spark/pull/27100,https://github.com/apache/spark/pull/27100.diff,https://github.com/apache/spark/pull/27100.patch,https://api.github.com/repos/apache/spark/issues/27100,27100,open,False,[SPARK-29037][CORE][SQL] Fix the issue that spark gives duplicate result and support concurrent file source write operations write to different partitions in the same table.,"## What changes were proposed in this pull request?
For InsertIntoHadoopFsRelation operations.

Case A:
Application appA insert overwrite table table_a with static partition overwrite.
But it was killed when committing tasks, because one task is hang.
And parts of its committed tasks output is kept under /path/table_a/_temporary/0/.

Then we rerun appA. It will reuse the staging dir /path/table_a/_temporary/0/.
It executes successfully.
But it also commit the data reminded by killed application to destination dir.

Case B:

Application appA insert overwrite table table_a.

Application appB insert overwrite table table_a, too.

They execute concurrently, and they may all use /path/table_a/_temporary/0/ as workPath.

And their result may be corruptted.

In this PR, we set a staging output path for InsertIntoHadoopFsRelation operation.

The output path is a multi level path and is composed of specified partition key-value pairs formatted .spark-staging-${depth}/p1=v1/p2=v2/.../pn=vn.

We can detect the conflict by checking the existence of relative staging output path.

For example:

table_a(c1 string, a string, b string,...) partitioned by (a, b , ...)

When writing to partition a=1, we need to check the existence of

.spark-staging-0
.spark-staging-1/a=1
.spark-staging-2/a=1
...
.spark-staging-numPartitions/a=1
When we found relative staging output path is existed, an exception would be thrown.

Besides, we propose an operation liveness detection mechanism to automatically detect whether an operation is running based on hdfs lease mechanism.

Thanks @advancedxy for providing the prototype of solution and valuable suggestions.

## Why are the changes needed?
Data may be corrupted without this PR.

## Does this PR introduce any user-facing change?
User can see the exists of staging output path and may need clean up these path manually, when this path is belong to a killed application and has not been cleaned up gracefully.

## How was this patch tested?
Added unit test.",2020-01-06T07:17:56Z,2020-02-05T18:06:17Z,,,0db73ce5661b433f502196a57cc2488ea4b30af4,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27100/commits,https://api.github.com/repos/apache/spark/pulls/27100/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27100/comments,https://api.github.com/repos/apache/spark/statuses/9b85c85dff3c7f64f036ffe99eda2909cd78dee7,CONTRIBUTOR,spark,apache,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,turboFei:SPARK-29037-operation-livess-detection,SPARK-29037-operation-livess-detection,9b85c85dff3c7f64f036ffe99eda2909cd78dee7,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,77131854,MDEwOlJlcG9zaXRvcnk3NzEzMTg1NA==,spark,turboFei/spark,False,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,https://github.com/turboFei/spark,Mirror of Apache Spark,True,https://api.github.com/repos/turboFei/spark,https://api.github.com/repos/turboFei/spark/forks,https://api.github.com/repos/turboFei/spark/keys{/key_id},https://api.github.com/repos/turboFei/spark/collaborators{/collaborator},https://api.github.com/repos/turboFei/spark/teams,https://api.github.com/repos/turboFei/spark/hooks,https://api.github.com/repos/turboFei/spark/issues/events{/number},https://api.github.com/repos/turboFei/spark/events,https://api.github.com/repos/turboFei/spark/assignees{/user},https://api.github.com/repos/turboFei/spark/branches{/branch},https://api.github.com/repos/turboFei/spark/tags,https://api.github.com/repos/turboFei/spark/git/blobs{/sha},https://api.github.com/repos/turboFei/spark/git/tags{/sha},https://api.github.com/repos/turboFei/spark/git/refs{/sha},https://api.github.com/repos/turboFei/spark/git/trees{/sha},https://api.github.com/repos/turboFei/spark/statuses/{sha},https://api.github.com/repos/turboFei/spark/languages,https://api.github.com/repos/turboFei/spark/stargazers,https://api.github.com/repos/turboFei/spark/contributors,https://api.github.com/repos/turboFei/spark/subscribers,https://api.github.com/repos/turboFei/spark/subscription,https://api.github.com/repos/turboFei/spark/commits{/sha},https://api.github.com/repos/turboFei/spark/git/commits{/sha},https://api.github.com/repos/turboFei/spark/comments{/number},https://api.github.com/repos/turboFei/spark/issues/comments{/number},https://api.github.com/repos/turboFei/spark/contents/{+path},https://api.github.com/repos/turboFei/spark/compare/{base}...{head},https://api.github.com/repos/turboFei/spark/merges,https://api.github.com/repos/turboFei/spark/{archive_format}{/ref},https://api.github.com/repos/turboFei/spark/downloads,https://api.github.com/repos/turboFei/spark/issues{/number},https://api.github.com/repos/turboFei/spark/pulls{/number},https://api.github.com/repos/turboFei/spark/milestones{/number},"https://api.github.com/repos/turboFei/spark/notifications{?since,all,participating}",https://api.github.com/repos/turboFei/spark/labels{/name},https://api.github.com/repos/turboFei/spark/releases{/id},https://api.github.com/repos/turboFei/spark/deployments,2016-12-22T09:34:08Z,2019-10-25T09:06:55Z,2020-04-08T10:08:56Z,git://github.com/turboFei/spark.git,git@github.com:turboFei/spark.git,https://github.com/turboFei/spark.git,https://github.com/turboFei/spark,,322115,0,0,Scala,False,True,True,False,False,0,,False,False,4,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,4,0,master,apache:master,master,bc16bb1dd095c9e1c8deabf6ac0d528441a81d88,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27100,https://github.com/apache/spark/pull/27100,https://api.github.com/repos/apache/spark/issues/27100,https://api.github.com/repos/apache/spark/issues/27100/comments,https://api.github.com/repos/apache/spark/pulls/27100/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27100/commits,https://api.github.com/repos/apache/spark/statuses/9b85c85dff3c7f64f036ffe99eda2909cd78dee7
163,https://api.github.com/repos/apache/spark/pulls/27096,359266699,MDExOlB1bGxSZXF1ZXN0MzU5MjY2Njk5,https://github.com/apache/spark/pull/27096,https://github.com/apache/spark/pull/27096.diff,https://github.com/apache/spark/pull/27096.patch,https://api.github.com/repos/apache/spark/issues/27096,27096,open,False,[SPARK-28148][SQL] Repartition after join is not optimized away,"### What changes were proposed in this pull request?

Extra shuffling was not eliminated after inner joins because they produce PartitioningCollection Partitioning and the current logic only matched on HashPartitioning. 

Nothing was present in EnsureRequirements to eliminate parent sorting (within partitions) which was unnecessary when the same sort order was introduced by sortmergejoin

Copied from jira:
Partitioning & sorting is usually retained after join.
```
spark.conf.set('spark.sql.shuffle.partitions', '42')

df1 = spark.range(5000000, numPartitions=5)
df2 = spark.range(10000000, numPartitions=5)
df3 = spark.range(20000000, numPartitions=5)

# Reuse previous partitions & sort.
df1.join(df2, on='id').join(df3, on='id').explain()
# == Physical Plan ==
# *(8) Project [id#367L]
# +- *(8) SortMergeJoin [id#367L], [id#374L], Inner
#    :- *(5) Project [id#367L]
#    :  +- *(5) SortMergeJoin [id#367L], [id#369L], Inner
#    :     :- *(2) Sort [id#367L ASC NULLS FIRST], false, 0
#    :     :  +- Exchange hashpartitioning(id#367L, 42)
#    :     :     +- *(1) Range (0, 5000000, step=1, splits=5)
#    :     +- *(4) Sort [id#369L ASC NULLS FIRST], false, 0
#    :        +- Exchange hashpartitioning(id#369L, 42)
#    :           +- *(3) Range (0, 10000000, step=1, splits=5)
#    +- *(7) Sort [id#374L ASC NULLS FIRST], false, 0
#       +- Exchange hashpartitioning(id#374L, 42)
#          +- *(6) Range (0, 20000000, step=1, splits=5)
```

However here: Partitions persist through left join, sort doesn't.

```
df1.join(df2, on='id', how='left').repartition('id').sortWithinPartitions('id').explain()
# == Physical Plan ==
# *(5) Sort [id#367L ASC NULLS FIRST], false, 0
# +- *(5) Project [id#367L]
#    +- SortMergeJoin [id#367L], [id#369L], LeftOuter
#       :- *(2) Sort [id#367L ASC NULLS FIRST], false, 0
#       :  +- Exchange hashpartitioning(id#367L, 42)
#       :     +- *(1) Range (0, 5000000, step=1, splits=5)
#       +- *(4) Sort [id#369L ASC NULLS FIRST], false, 0
#          +- Exchange hashpartitioning(id#369L, 42)
#             +- *(3) Range (0, 10000000, step=1, splits=5)
```
Also here: Partitions do not persist though inner join.

```
df1.join(df2, on='id').repartition('id').sortWithinPartitions('id').explain()
# == Physical Plan ==
# *(6) Sort [id#367L ASC NULLS FIRST], false, 0
# +- Exchange hashpartitioning(id#367L, 42)
#    +- *(5) Project [id#367L]
#       +- *(5) SortMergeJoin [id#367L], [id#369L], Inner
#          :- *(2) Sort [id#367L ASC NULLS FIRST], false, 0
#          :  +- Exchange hashpartitioning(id#367L, 42)
#          :     +- *(1) Range (0, 5000000, step=1, splits=5)
#          +- *(4) Sort [id#369L ASC NULLS FIRST], false, 0
#             +- Exchange hashpartitioning(id#369L, 42)
#                +- *(3) Range (0, 10000000, step=1, splits=5)
```
",2020-01-05T03:02:29Z,2020-03-09T02:09:44Z,,,4e79243f0becce48b95505682311134c76ff1024,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27096/commits,https://api.github.com/repos/apache/spark/pulls/27096/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27096/comments,https://api.github.com/repos/apache/spark/statuses/bb794db82dcabfc9c9bb2a309fc70566b3da1ac0,CONTRIBUTOR,spark,apache,bmarcott,481161,MDQ6VXNlcjQ4MTE2MQ==,https://avatars2.githubusercontent.com/u/481161?v=4,,https://api.github.com/users/bmarcott,https://github.com/bmarcott,https://api.github.com/users/bmarcott/followers,https://api.github.com/users/bmarcott/following{/other_user},https://api.github.com/users/bmarcott/gists{/gist_id},https://api.github.com/users/bmarcott/starred{/owner}{/repo},https://api.github.com/users/bmarcott/subscriptions,https://api.github.com/users/bmarcott/orgs,https://api.github.com/users/bmarcott/repos,https://api.github.com/users/bmarcott/events{/privacy},https://api.github.com/users/bmarcott/received_events,User,False,bmarcott:nmarcott-reuse-sort-order,nmarcott-reuse-sort-order,bb794db82dcabfc9c9bb2a309fc70566b3da1ac0,bmarcott,481161,MDQ6VXNlcjQ4MTE2MQ==,https://avatars2.githubusercontent.com/u/481161?v=4,,https://api.github.com/users/bmarcott,https://github.com/bmarcott,https://api.github.com/users/bmarcott/followers,https://api.github.com/users/bmarcott/following{/other_user},https://api.github.com/users/bmarcott/gists{/gist_id},https://api.github.com/users/bmarcott/starred{/owner}{/repo},https://api.github.com/users/bmarcott/subscriptions,https://api.github.com/users/bmarcott/orgs,https://api.github.com/users/bmarcott/repos,https://api.github.com/users/bmarcott/events{/privacy},https://api.github.com/users/bmarcott/received_events,User,False,223107540,MDEwOlJlcG9zaXRvcnkyMjMxMDc1NDA=,spark,bmarcott/spark,False,bmarcott,481161,MDQ6VXNlcjQ4MTE2MQ==,https://avatars2.githubusercontent.com/u/481161?v=4,,https://api.github.com/users/bmarcott,https://github.com/bmarcott,https://api.github.com/users/bmarcott/followers,https://api.github.com/users/bmarcott/following{/other_user},https://api.github.com/users/bmarcott/gists{/gist_id},https://api.github.com/users/bmarcott/starred{/owner}{/repo},https://api.github.com/users/bmarcott/subscriptions,https://api.github.com/users/bmarcott/orgs,https://api.github.com/users/bmarcott/repos,https://api.github.com/users/bmarcott/events{/privacy},https://api.github.com/users/bmarcott/received_events,User,False,https://github.com/bmarcott/spark,Apache Spark,True,https://api.github.com/repos/bmarcott/spark,https://api.github.com/repos/bmarcott/spark/forks,https://api.github.com/repos/bmarcott/spark/keys{/key_id},https://api.github.com/repos/bmarcott/spark/collaborators{/collaborator},https://api.github.com/repos/bmarcott/spark/teams,https://api.github.com/repos/bmarcott/spark/hooks,https://api.github.com/repos/bmarcott/spark/issues/events{/number},https://api.github.com/repos/bmarcott/spark/events,https://api.github.com/repos/bmarcott/spark/assignees{/user},https://api.github.com/repos/bmarcott/spark/branches{/branch},https://api.github.com/repos/bmarcott/spark/tags,https://api.github.com/repos/bmarcott/spark/git/blobs{/sha},https://api.github.com/repos/bmarcott/spark/git/tags{/sha},https://api.github.com/repos/bmarcott/spark/git/refs{/sha},https://api.github.com/repos/bmarcott/spark/git/trees{/sha},https://api.github.com/repos/bmarcott/spark/statuses/{sha},https://api.github.com/repos/bmarcott/spark/languages,https://api.github.com/repos/bmarcott/spark/stargazers,https://api.github.com/repos/bmarcott/spark/contributors,https://api.github.com/repos/bmarcott/spark/subscribers,https://api.github.com/repos/bmarcott/spark/subscription,https://api.github.com/repos/bmarcott/spark/commits{/sha},https://api.github.com/repos/bmarcott/spark/git/commits{/sha},https://api.github.com/repos/bmarcott/spark/comments{/number},https://api.github.com/repos/bmarcott/spark/issues/comments{/number},https://api.github.com/repos/bmarcott/spark/contents/{+path},https://api.github.com/repos/bmarcott/spark/compare/{base}...{head},https://api.github.com/repos/bmarcott/spark/merges,https://api.github.com/repos/bmarcott/spark/{archive_format}{/ref},https://api.github.com/repos/bmarcott/spark/downloads,https://api.github.com/repos/bmarcott/spark/issues{/number},https://api.github.com/repos/bmarcott/spark/pulls{/number},https://api.github.com/repos/bmarcott/spark/milestones{/number},"https://api.github.com/repos/bmarcott/spark/notifications{?since,all,participating}",https://api.github.com/repos/bmarcott/spark/labels{/name},https://api.github.com/repos/bmarcott/spark/releases{/id},https://api.github.com/repos/bmarcott/spark/deployments,2019-11-21T06:49:09Z,2019-11-21T06:49:12Z,2020-04-03T05:29:19Z,git://github.com/bmarcott/spark.git,git@github.com:bmarcott/spark.git,https://github.com/bmarcott/spark.git,https://github.com/bmarcott/spark,,324443,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cfb1706eaa59848cfda88a2f3a6fd90262f55b3e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27096,https://github.com/apache/spark/pull/27096,https://api.github.com/repos/apache/spark/issues/27096,https://api.github.com/repos/apache/spark/issues/27096/comments,https://api.github.com/repos/apache/spark/pulls/27096/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27096/commits,https://api.github.com/repos/apache/spark/statuses/bb794db82dcabfc9c9bb2a309fc70566b3da1ac0
164,https://api.github.com/repos/apache/spark/pulls/27066,358539682,MDExOlB1bGxSZXF1ZXN0MzU4NTM5Njgy,https://github.com/apache/spark/pull/27066,https://github.com/apache/spark/pull/27066.diff,https://github.com/apache/spark/pull/27066.patch,https://api.github.com/repos/apache/spark/issues/27066,27066,open,False,[SPARK-31317][SQL] Add withField method to Column class,"### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Added a new `withField` method to the `Column` class. This method should allow users to add or replace a `StructField` in a `StructType` column (much like how the `withColumn` method on the `Dataset` class operates). 


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
Often Spark users have to work with deeply nested data e.g. to fix a data quality issue with an existing `StructField`. To do this with the existing Spark APIs, users have to rebuild the entire struct column. 

For example, let's say you have the following data which has a quality issue (`5` is missing): 
```
import org.apache.spark.sql._
import org.apache.spark.sql.functions._
import org.apache.spark.sql.types._

val data = spark.createDataFrame(sc.parallelize(
      Seq(Row(Row(Row(1, 2, 3), Row(Row(4, null, 6), Row(7, 8, 9), Row(10, 11, 12)), Row(13, 14, 15))))),
      StructType(Seq(
        StructField(""a"", StructType(Seq(
          StructField(""a"", StructType(Seq(
            StructField(""a"", IntegerType),
            StructField(""b"", IntegerType),
            StructField(""c"", IntegerType)))),
          StructField(""b"", StructType(Seq(
            StructField(""a"", StructType(Seq(
              StructField(""a"", IntegerType),
              StructField(""b"", IntegerType),
              StructField(""c"", IntegerType)))),
            StructField(""b"", StructType(Seq(
              StructField(""a"", IntegerType),
              StructField(""b"", IntegerType),
              StructField(""c"", IntegerType)))), 
            StructField(""c"", StructType(Seq(
              StructField(""a"", IntegerType),
              StructField(""b"", IntegerType),
              StructField(""c"", IntegerType))))
          ))), 
          StructField(""c"", StructType(Seq(
            StructField(""a"", IntegerType),
            StructField(""b"", IntegerType),
            StructField(""c"", IntegerType))))
        )))))).cache

data.show(false)
+---------------------------------+                                             
|a                                |
+---------------------------------+
|[[1, 2, 3], [[4,, 6], [7, 8, 9]]]|
+---------------------------------+
```
Currently, to replace the missing value users would have to do something like this: 
```
val result = data.withColumn(""a"", 
  struct(
    $""a.a"", 
    struct(
      struct(
        $""a.b.a.a"", 
        lit(5).as(""b""), 
        $""a.b.a.c""
      ).as(""a""), 
      $""a.b.b"", 
      $""a.b.c""
    ).as(""b""), 
    $""a.c""
  ))

result.show(false)
+---------------------------------------------------------------+
|a                                                              |
+---------------------------------------------------------------+
|[[1, 2, 3], [[4, 5, 6], [7, 8, 9], [10, 11, 12]], [13, 14, 15]]|
+---------------------------------------------------------------+
```
As you can see above, with the existing methods users must call the `struct` function and list all fields, including fields they don't want to manipulate. This is not ideal as: 
>this leads to complex, fragile code that cannot survive schema evolution. 
[SPARK-16483](https://issues.apache.org/jira/browse/SPARK-16483)

In contrast, with the methods added in this PR, a user could simply do something like this: 
```
val result = data.withColumn(""a"", 'a.withField(
  ""b"", $""a.b"".withField(
    ""a"", $""a.b.a"".withField(
      ""b"", lit(5)))))

result.show(false)
+-----------------------------------+
|a                                  |
+-----------------------------------+
|[[1, 2, 3], [[4, 5, 6], [7, 8, 9]]]|
+-----------------------------------+
```
This is shorter, and more importantly can survive schema evolution. You could even further condense this code with a simple utility function: 
```
```
This is the first of maybe a few methods that could be added to the `Column` class to make it easier to manipulate nested data. Other methods under discussion in [SPARK-22231](https://issues.apache.org/jira/browse/SPARK-22231) include `drop` and `renameField`. However, these should be added in a separate PR. 

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No. 

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
New unit tests were added. Jenkins must pass them. 

### Related JIRAs: 
- https://issues.apache.org/jira/browse/SPARK-22231
- https://issues.apache.org/jira/browse/SPARK-16483",2020-01-02T02:47:03Z,2020-04-06T19:03:12Z,,,922a248ccd9f4b09d7423d973e8cf49f32dab4de,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27066/commits,https://api.github.com/repos/apache/spark/pulls/27066/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27066/comments,https://api.github.com/repos/apache/spark/statuses/8a478331dea06799d6a5a97684327166d0344974,NONE,spark,apache,fqaiser94,20507243,MDQ6VXNlcjIwNTA3MjQz,https://avatars1.githubusercontent.com/u/20507243?v=4,,https://api.github.com/users/fqaiser94,https://github.com/fqaiser94,https://api.github.com/users/fqaiser94/followers,https://api.github.com/users/fqaiser94/following{/other_user},https://api.github.com/users/fqaiser94/gists{/gist_id},https://api.github.com/users/fqaiser94/starred{/owner}{/repo},https://api.github.com/users/fqaiser94/subscriptions,https://api.github.com/users/fqaiser94/orgs,https://api.github.com/users/fqaiser94/repos,https://api.github.com/users/fqaiser94/events{/privacy},https://api.github.com/users/fqaiser94/received_events,User,False,fqaiser94:SPARK-22231-withField,SPARK-22231-withField,8a478331dea06799d6a5a97684327166d0344974,fqaiser94,20507243,MDQ6VXNlcjIwNTA3MjQz,https://avatars1.githubusercontent.com/u/20507243?v=4,,https://api.github.com/users/fqaiser94,https://github.com/fqaiser94,https://api.github.com/users/fqaiser94/followers,https://api.github.com/users/fqaiser94/following{/other_user},https://api.github.com/users/fqaiser94/gists{/gist_id},https://api.github.com/users/fqaiser94/starred{/owner}{/repo},https://api.github.com/users/fqaiser94/subscriptions,https://api.github.com/users/fqaiser94/orgs,https://api.github.com/users/fqaiser94/repos,https://api.github.com/users/fqaiser94/events{/privacy},https://api.github.com/users/fqaiser94/received_events,User,False,230806999,MDEwOlJlcG9zaXRvcnkyMzA4MDY5OTk=,spark,fqaiser94/spark,False,fqaiser94,20507243,MDQ6VXNlcjIwNTA3MjQz,https://avatars1.githubusercontent.com/u/20507243?v=4,,https://api.github.com/users/fqaiser94,https://github.com/fqaiser94,https://api.github.com/users/fqaiser94/followers,https://api.github.com/users/fqaiser94/following{/other_user},https://api.github.com/users/fqaiser94/gists{/gist_id},https://api.github.com/users/fqaiser94/starred{/owner}{/repo},https://api.github.com/users/fqaiser94/subscriptions,https://api.github.com/users/fqaiser94/orgs,https://api.github.com/users/fqaiser94/repos,https://api.github.com/users/fqaiser94/events{/privacy},https://api.github.com/users/fqaiser94/received_events,User,False,https://github.com/fqaiser94/spark,Apache Spark,True,https://api.github.com/repos/fqaiser94/spark,https://api.github.com/repos/fqaiser94/spark/forks,https://api.github.com/repos/fqaiser94/spark/keys{/key_id},https://api.github.com/repos/fqaiser94/spark/collaborators{/collaborator},https://api.github.com/repos/fqaiser94/spark/teams,https://api.github.com/repos/fqaiser94/spark/hooks,https://api.github.com/repos/fqaiser94/spark/issues/events{/number},https://api.github.com/repos/fqaiser94/spark/events,https://api.github.com/repos/fqaiser94/spark/assignees{/user},https://api.github.com/repos/fqaiser94/spark/branches{/branch},https://api.github.com/repos/fqaiser94/spark/tags,https://api.github.com/repos/fqaiser94/spark/git/blobs{/sha},https://api.github.com/repos/fqaiser94/spark/git/tags{/sha},https://api.github.com/repos/fqaiser94/spark/git/refs{/sha},https://api.github.com/repos/fqaiser94/spark/git/trees{/sha},https://api.github.com/repos/fqaiser94/spark/statuses/{sha},https://api.github.com/repos/fqaiser94/spark/languages,https://api.github.com/repos/fqaiser94/spark/stargazers,https://api.github.com/repos/fqaiser94/spark/contributors,https://api.github.com/repos/fqaiser94/spark/subscribers,https://api.github.com/repos/fqaiser94/spark/subscription,https://api.github.com/repos/fqaiser94/spark/commits{/sha},https://api.github.com/repos/fqaiser94/spark/git/commits{/sha},https://api.github.com/repos/fqaiser94/spark/comments{/number},https://api.github.com/repos/fqaiser94/spark/issues/comments{/number},https://api.github.com/repos/fqaiser94/spark/contents/{+path},https://api.github.com/repos/fqaiser94/spark/compare/{base}...{head},https://api.github.com/repos/fqaiser94/spark/merges,https://api.github.com/repos/fqaiser94/spark/{archive_format}{/ref},https://api.github.com/repos/fqaiser94/spark/downloads,https://api.github.com/repos/fqaiser94/spark/issues{/number},https://api.github.com/repos/fqaiser94/spark/pulls{/number},https://api.github.com/repos/fqaiser94/spark/milestones{/number},"https://api.github.com/repos/fqaiser94/spark/notifications{?since,all,participating}",https://api.github.com/repos/fqaiser94/spark/labels{/name},https://api.github.com/repos/fqaiser94/spark/releases{/id},https://api.github.com/repos/fqaiser94/spark/deployments,2019-12-29T21:46:51Z,2019-12-29T21:46:54Z,2020-04-05T22:56:01Z,git://github.com/fqaiser94/spark.git,git@github.com:fqaiser94/spark.git,https://github.com/fqaiser94/spark.git,https://github.com/fqaiser94/spark,,324440,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,60dd1a690fed62b1d6442cdc8cf3f89ef4304d5a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27066,https://github.com/apache/spark/pull/27066,https://api.github.com/repos/apache/spark/issues/27066,https://api.github.com/repos/apache/spark/issues/27066/comments,https://api.github.com/repos/apache/spark/pulls/27066/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27066/commits,https://api.github.com/repos/apache/spark/statuses/8a478331dea06799d6a5a97684327166d0344974
165,https://api.github.com/repos/apache/spark/pulls/27055,358271650,MDExOlB1bGxSZXF1ZXN0MzU4MjcxNjUw,https://github.com/apache/spark/pull/27055,https://github.com/apache/spark/pull/27055.diff,https://github.com/apache/spark/pull/27055.patch,https://api.github.com/repos/apache/spark/issues/27055,27055,open,False,[SPARK-30394]Skip DetermineTableStats rule when hive table can be converted to datasource table,"### What changes were proposed in this pull request?
Currently,  the sizeInBytes of HiveTableRelation will be `defaultSizeInBytes`(Long.MaxValue) if `spark.sql.statistics.fallBackToHdfs` not enabled, and there are risks that Long type overflows when we set `spark.sql.sources.fileCompressionFactor` to a value greater than 1.

https://github.com/apache/spark/blob/cb9fc4bb6ffe542e526a6006582606eb709fb311/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/HadoopFsRelation.scala#L72

This PR will bring three major improvements:
1.  Skip `DetermineTableStats` rule when hive table can be converted to datasource table, and compute the stats on demand in HadoopFsRelation. This size estimation can be more accurate for columnar-based files like parquet.
2. It solves the overflows issue. 
3. It make the code path for sizeEstimation consistent. This will do the estimation on demand just like  what the `PruneFileSourcePartitions` may do.

### Why are the changes needed?
This PR fix potential bugs and bring some other benefits.

### Does this PR introduce any user-facing change?
No


### How was this patch tested?
UT & test on real clusters
",2019-12-31T04:23:10Z,2020-02-06T14:41:57Z,,,ae8b8da064cdf41e8791908b61105451fcef6729,,[],"[{'login': 'gatorsmile', 'id': 11567269, 'node_id': 'MDQ6VXNlcjExNTY3MjY5', 'avatar_url': 'https://avatars1.githubusercontent.com/u/11567269?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/gatorsmile', 'html_url': 'https://github.com/gatorsmile', 'followers_url': 'https://api.github.com/users/gatorsmile/followers', 'following_url': 'https://api.github.com/users/gatorsmile/following{/other_user}', 'gists_url': 'https://api.github.com/users/gatorsmile/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/gatorsmile/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/gatorsmile/subscriptions', 'organizations_url': 'https://api.github.com/users/gatorsmile/orgs', 'repos_url': 'https://api.github.com/users/gatorsmile/repos', 'events_url': 'https://api.github.com/users/gatorsmile/events{/privacy}', 'received_events_url': 'https://api.github.com/users/gatorsmile/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27055/commits,https://api.github.com/repos/apache/spark/pulls/27055/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27055/comments,https://api.github.com/repos/apache/spark/statuses/c5297d48fce32b584718c04b85dd06a293bc2c2b,NONE,spark,apache,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,liupc:SPARK-30394,SPARK-30394,c5297d48fce32b584718c04b85dd06a293bc2c2b,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,75380071,MDEwOlJlcG9zaXRvcnk3NTM4MDA3MQ==,spark,liupc/spark,False,liupc,6747355,MDQ6VXNlcjY3NDczNTU=,https://avatars2.githubusercontent.com/u/6747355?v=4,,https://api.github.com/users/liupc,https://github.com/liupc,https://api.github.com/users/liupc/followers,https://api.github.com/users/liupc/following{/other_user},https://api.github.com/users/liupc/gists{/gist_id},https://api.github.com/users/liupc/starred{/owner}{/repo},https://api.github.com/users/liupc/subscriptions,https://api.github.com/users/liupc/orgs,https://api.github.com/users/liupc/repos,https://api.github.com/users/liupc/events{/privacy},https://api.github.com/users/liupc/received_events,User,False,https://github.com/liupc/spark,Mirror of Apache Spark,True,https://api.github.com/repos/liupc/spark,https://api.github.com/repos/liupc/spark/forks,https://api.github.com/repos/liupc/spark/keys{/key_id},https://api.github.com/repos/liupc/spark/collaborators{/collaborator},https://api.github.com/repos/liupc/spark/teams,https://api.github.com/repos/liupc/spark/hooks,https://api.github.com/repos/liupc/spark/issues/events{/number},https://api.github.com/repos/liupc/spark/events,https://api.github.com/repos/liupc/spark/assignees{/user},https://api.github.com/repos/liupc/spark/branches{/branch},https://api.github.com/repos/liupc/spark/tags,https://api.github.com/repos/liupc/spark/git/blobs{/sha},https://api.github.com/repos/liupc/spark/git/tags{/sha},https://api.github.com/repos/liupc/spark/git/refs{/sha},https://api.github.com/repos/liupc/spark/git/trees{/sha},https://api.github.com/repos/liupc/spark/statuses/{sha},https://api.github.com/repos/liupc/spark/languages,https://api.github.com/repos/liupc/spark/stargazers,https://api.github.com/repos/liupc/spark/contributors,https://api.github.com/repos/liupc/spark/subscribers,https://api.github.com/repos/liupc/spark/subscription,https://api.github.com/repos/liupc/spark/commits{/sha},https://api.github.com/repos/liupc/spark/git/commits{/sha},https://api.github.com/repos/liupc/spark/comments{/number},https://api.github.com/repos/liupc/spark/issues/comments{/number},https://api.github.com/repos/liupc/spark/contents/{+path},https://api.github.com/repos/liupc/spark/compare/{base}...{head},https://api.github.com/repos/liupc/spark/merges,https://api.github.com/repos/liupc/spark/{archive_format}{/ref},https://api.github.com/repos/liupc/spark/downloads,https://api.github.com/repos/liupc/spark/issues{/number},https://api.github.com/repos/liupc/spark/pulls{/number},https://api.github.com/repos/liupc/spark/milestones{/number},"https://api.github.com/repos/liupc/spark/notifications{?since,all,participating}",https://api.github.com/repos/liupc/spark/labels{/name},https://api.github.com/repos/liupc/spark/releases{/id},https://api.github.com/repos/liupc/spark/deployments,2016-12-02T09:14:58Z,2019-07-01T03:12:23Z,2020-03-22T08:20:48Z,git://github.com/liupc/spark.git,git@github.com:liupc/spark.git,https://github.com/liupc/spark.git,https://github.com/liupc/spark,,311628,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9eff1186ae5d0ca15657c22c1ee4ada7ac850b4e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27055,https://github.com/apache/spark/pull/27055,https://api.github.com/repos/apache/spark/issues/27055,https://api.github.com/repos/apache/spark/issues/27055/comments,https://api.github.com/repos/apache/spark/pulls/27055/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27055/commits,https://api.github.com/repos/apache/spark/statuses/c5297d48fce32b584718c04b85dd06a293bc2c2b
166,https://api.github.com/repos/apache/spark/pulls/27053,358178432,MDExOlB1bGxSZXF1ZXN0MzU4MTc4NDMy,https://github.com/apache/spark/pull/27053,https://github.com/apache/spark/pull/27053.diff,https://github.com/apache/spark/pull/27053.patch,https://api.github.com/repos/apache/spark/issues/27053,27053,open,False,[WIP][SPARK-27495][Core][YARN][k8s] Stage Level Scheduling code for reference,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

This is all the code for stage level scheduling feature - except for documentation.

This is meant to be for a reference when reviewing as I'm splitting this into mulitple prs with the intention its easier to review.  Note that only YARN currently supports this and it requires dynamic allocation to be enabled because currently we get new executors that match the profile exactly. We do not try to fit tasks into executors that were acquired for a different profile.

At a high level in order to support having different stages with different ResourceProfiles the changes required include:

- Add a ResourceProfileManager that tracks the profiles and is used to map a Resource Profile Id to the actual Resource Profile. This allows us to pass around and store the id rather then the entire profile.
- Introduce the concept of a default profile. This is essentially the profile you get today without stage level scheduling from the application level configs. 
- ImmutableResourceProfile - this is the actual resource profile used internally to Spark that is immutable. This is to allow the user to create and change a ResourceProfile in their code but as soon as they associated the profile with an RDD then spark internally uses the Immutable version so that it doesn't change.
- YARN cluster manager updated to handle the profiles and request the correct containers from YARN.  I had to introduce using priorities here because YARN doesn't allow you to create containers with different resources within the same priority.  Now we have the priority = ResourceProfile Id and its easy to match the container we get from Yarn to what ResourceProfile we requested it for.
- ExecutorAllocationManager, ExecutorMonitor, CoarseGrainedExecutorBackend - Updated to handle tracking the executors per ResourceProfile.
- Scheduler - updated to handle the ResourceProfile associated with an RDD. It creates the Stage with the appropriate ResourceProfile. It has logic for handling conflicting ResourceProfiles when multiple RDD are put into the same stage that have different ResourceProfiles. The default behavior is to throw an exception, but there is a config that will allow the scheduler to merge the profiles using the max value of each resource.  The task scheduler was updated to make sure the resources of each executor meet the task resources for that profile and to assign them out properly.
- I updated all the locations that used the hardcoded task cpus or other global configs to use the ResourceProfile based configs.
- RDD api added and ResourceProfile, ExecutorResourceRequests, and TaskResourceRequests made public.

End user api looks like this:
val rpBuilder = new ResourceProfileBuilder()
val ereq = new ExecutorResourceRequests()
val treq = new TaskResourceRequests()

ereq.cores(2).memory(""6g"").memoryOverhead(""2g"").pysparkMemory(""2g"").resource(""gpu"", 2, ""/home/tgraves/getGpus"")
treq.cpus(2).resource(""gpu"", 2)
val resourceProfile = rpBuilder.require(ereq).require(treq).build
val rdd = sc.parallelize(1 to 1000, 6).withResources(resourceProfile).map(x => (x, x))



### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
Allow for different stages to use different executor/task resources

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes the RDD.withResources and ResourceProfile, ExecutorResourceRequest, TaskResourceRequest apis

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

Unit tests and manually.",2019-12-30T18:05:24Z,2020-03-05T13:05:06Z,,,64c6e27231864321a95ae45694117d505cf1aaad,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27053/commits,https://api.github.com/repos/apache/spark/pulls/27053/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27053/comments,https://api.github.com/repos/apache/spark/statuses/0738be02a4566d5a2f00e5a08ffeba644c683907,CONTRIBUTOR,spark,apache,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,tgravescs:SPARK-27495,SPARK-27495,0738be02a4566d5a2f00e5a08ffeba644c683907,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,17249522,MDEwOlJlcG9zaXRvcnkxNzI0OTUyMg==,spark,tgravescs/spark,False,tgravescs,4563792,MDQ6VXNlcjQ1NjM3OTI=,https://avatars2.githubusercontent.com/u/4563792?v=4,,https://api.github.com/users/tgravescs,https://github.com/tgravescs,https://api.github.com/users/tgravescs/followers,https://api.github.com/users/tgravescs/following{/other_user},https://api.github.com/users/tgravescs/gists{/gist_id},https://api.github.com/users/tgravescs/starred{/owner}{/repo},https://api.github.com/users/tgravescs/subscriptions,https://api.github.com/users/tgravescs/orgs,https://api.github.com/users/tgravescs/repos,https://api.github.com/users/tgravescs/events{/privacy},https://api.github.com/users/tgravescs/received_events,User,False,https://github.com/tgravescs/spark,Mirror of Apache Spark,True,https://api.github.com/repos/tgravescs/spark,https://api.github.com/repos/tgravescs/spark/forks,https://api.github.com/repos/tgravescs/spark/keys{/key_id},https://api.github.com/repos/tgravescs/spark/collaborators{/collaborator},https://api.github.com/repos/tgravescs/spark/teams,https://api.github.com/repos/tgravescs/spark/hooks,https://api.github.com/repos/tgravescs/spark/issues/events{/number},https://api.github.com/repos/tgravescs/spark/events,https://api.github.com/repos/tgravescs/spark/assignees{/user},https://api.github.com/repos/tgravescs/spark/branches{/branch},https://api.github.com/repos/tgravescs/spark/tags,https://api.github.com/repos/tgravescs/spark/git/blobs{/sha},https://api.github.com/repos/tgravescs/spark/git/tags{/sha},https://api.github.com/repos/tgravescs/spark/git/refs{/sha},https://api.github.com/repos/tgravescs/spark/git/trees{/sha},https://api.github.com/repos/tgravescs/spark/statuses/{sha},https://api.github.com/repos/tgravescs/spark/languages,https://api.github.com/repos/tgravescs/spark/stargazers,https://api.github.com/repos/tgravescs/spark/contributors,https://api.github.com/repos/tgravescs/spark/subscribers,https://api.github.com/repos/tgravescs/spark/subscription,https://api.github.com/repos/tgravescs/spark/commits{/sha},https://api.github.com/repos/tgravescs/spark/git/commits{/sha},https://api.github.com/repos/tgravescs/spark/comments{/number},https://api.github.com/repos/tgravescs/spark/issues/comments{/number},https://api.github.com/repos/tgravescs/spark/contents/{+path},https://api.github.com/repos/tgravescs/spark/compare/{base}...{head},https://api.github.com/repos/tgravescs/spark/merges,https://api.github.com/repos/tgravescs/spark/{archive_format}{/ref},https://api.github.com/repos/tgravescs/spark/downloads,https://api.github.com/repos/tgravescs/spark/issues{/number},https://api.github.com/repos/tgravescs/spark/pulls{/number},https://api.github.com/repos/tgravescs/spark/milestones{/number},"https://api.github.com/repos/tgravescs/spark/notifications{?since,all,participating}",https://api.github.com/repos/tgravescs/spark/labels{/name},https://api.github.com/repos/tgravescs/spark/releases{/id},https://api.github.com/repos/tgravescs/spark/deployments,2014-02-27T13:26:24Z,2019-12-12T03:01:23Z,2020-04-08T20:50:58Z,git://github.com/tgravescs/spark.git,git@github.com:tgravescs/spark.git,https://github.com/tgravescs/spark.git,https://github.com/tgravescs/spark,,302656,1,1,Scala,False,True,True,False,False,0,,False,False,2,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,2,1,master,apache:master,master,cfb1706eaa59848cfda88a2f3a6fd90262f55b3e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27053,https://github.com/apache/spark/pull/27053,https://api.github.com/repos/apache/spark/issues/27053,https://api.github.com/repos/apache/spark/issues/27053/comments,https://api.github.com/repos/apache/spark/pulls/27053/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27053/commits,https://api.github.com/repos/apache/spark/statuses/0738be02a4566d5a2f00e5a08ffeba644c683907
167,https://api.github.com/repos/apache/spark/pulls/27041,357638653,MDExOlB1bGxSZXF1ZXN0MzU3NjM4NjUz,https://github.com/apache/spark/pull/27041,https://github.com/apache/spark/pull/27041.diff,https://github.com/apache/spark/pull/27041.patch,https://api.github.com/repos/apache/spark/issues/27041,27041,open,False,[SPARK-25061][SQL] Precedence for ThriftServer hiveconf commandline parameter,"### What changes were proposed in this pull request?
In `HiveClientImpl.scala` when we create new SessionState, we prepare configuration and the options passed to `start-thriftserver.sh` via  `--hiveConf` need to take precedence when creating `HiveConf`  i.e  in order 
`hadoopConf < sparkConf < overrideProps(--hiveconf) < extraConfig`

### Why are the changes needed?
As per the documentation here, https://spark.apache.org/docs/latest/sql-distributed-sql-engine.html user can provide `--hiveconf` to override the hive configurations when using `start-thriftserver.sh` but as per the code, https://github.com/apache/spark/blob/master/sql/hive/src/main/scala/org/apache/spark/sql/hive/client/HiveClientImpl.scala#L182 here, the hive-site properties (part of hadoopConf) will override the configuration done from command line which is not as per expectation

### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Added UT along with Base UTs can Pass",2019-12-29T10:31:56Z,2020-02-19T09:57:08Z,,,72fbe6296863a0ee2c80049428854a3ef2cd4426,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27041/commits,https://api.github.com/repos/apache/spark/pulls/27041/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27041/comments,https://api.github.com/repos/apache/spark/statuses/3718df989c02641f864432b246313a158a11b9e6,CONTRIBUTOR,spark,apache,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,ajithme:hiveconf,hiveconf,3718df989c02641f864432b246313a158a11b9e6,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,124182301,MDEwOlJlcG9zaXRvcnkxMjQxODIzMDE=,spark,ajithme/spark,False,ajithme,22072336,MDQ6VXNlcjIyMDcyMzM2,https://avatars1.githubusercontent.com/u/22072336?v=4,,https://api.github.com/users/ajithme,https://github.com/ajithme,https://api.github.com/users/ajithme/followers,https://api.github.com/users/ajithme/following{/other_user},https://api.github.com/users/ajithme/gists{/gist_id},https://api.github.com/users/ajithme/starred{/owner}{/repo},https://api.github.com/users/ajithme/subscriptions,https://api.github.com/users/ajithme/orgs,https://api.github.com/users/ajithme/repos,https://api.github.com/users/ajithme/events{/privacy},https://api.github.com/users/ajithme/received_events,User,False,https://github.com/ajithme/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ajithme/spark,https://api.github.com/repos/ajithme/spark/forks,https://api.github.com/repos/ajithme/spark/keys{/key_id},https://api.github.com/repos/ajithme/spark/collaborators{/collaborator},https://api.github.com/repos/ajithme/spark/teams,https://api.github.com/repos/ajithme/spark/hooks,https://api.github.com/repos/ajithme/spark/issues/events{/number},https://api.github.com/repos/ajithme/spark/events,https://api.github.com/repos/ajithme/spark/assignees{/user},https://api.github.com/repos/ajithme/spark/branches{/branch},https://api.github.com/repos/ajithme/spark/tags,https://api.github.com/repos/ajithme/spark/git/blobs{/sha},https://api.github.com/repos/ajithme/spark/git/tags{/sha},https://api.github.com/repos/ajithme/spark/git/refs{/sha},https://api.github.com/repos/ajithme/spark/git/trees{/sha},https://api.github.com/repos/ajithme/spark/statuses/{sha},https://api.github.com/repos/ajithme/spark/languages,https://api.github.com/repos/ajithme/spark/stargazers,https://api.github.com/repos/ajithme/spark/contributors,https://api.github.com/repos/ajithme/spark/subscribers,https://api.github.com/repos/ajithme/spark/subscription,https://api.github.com/repos/ajithme/spark/commits{/sha},https://api.github.com/repos/ajithme/spark/git/commits{/sha},https://api.github.com/repos/ajithme/spark/comments{/number},https://api.github.com/repos/ajithme/spark/issues/comments{/number},https://api.github.com/repos/ajithme/spark/contents/{+path},https://api.github.com/repos/ajithme/spark/compare/{base}...{head},https://api.github.com/repos/ajithme/spark/merges,https://api.github.com/repos/ajithme/spark/{archive_format}{/ref},https://api.github.com/repos/ajithme/spark/downloads,https://api.github.com/repos/ajithme/spark/issues{/number},https://api.github.com/repos/ajithme/spark/pulls{/number},https://api.github.com/repos/ajithme/spark/milestones{/number},"https://api.github.com/repos/ajithme/spark/notifications{?since,all,participating}",https://api.github.com/repos/ajithme/spark/labels{/name},https://api.github.com/repos/ajithme/spark/releases{/id},https://api.github.com/repos/ajithme/spark/deployments,2018-03-07T05:08:43Z,2020-01-15T04:25:12Z,2020-02-18T15:06:53Z,git://github.com/ajithme/spark.git,git@github.com:ajithme/spark.git,https://github.com/ajithme/spark.git,https://github.com/ajithme/spark,,318153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,b389b8c5f0650a7e63098f18437fcaa29998732a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27041,https://github.com/apache/spark/pull/27041,https://api.github.com/repos/apache/spark/issues/27041,https://api.github.com/repos/apache/spark/issues/27041/comments,https://api.github.com/repos/apache/spark/pulls/27041/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27041/commits,https://api.github.com/repos/apache/spark/statuses/3718df989c02641f864432b246313a158a11b9e6
168,https://api.github.com/repos/apache/spark/pulls/27036,357609906,MDExOlB1bGxSZXF1ZXN0MzU3NjA5OTA2,https://github.com/apache/spark/pull/27036,https://github.com/apache/spark/pull/27036.diff,https://github.com/apache/spark/pull/27036.patch,https://api.github.com/repos/apache/spark/issues/27036,27036,open,False,[MLlib] Weighted Gini for random forest (Brieman Implementation),"
### What changes were proposed in this pull request?
<!--
Addition of a weighted Gini impurity for Random Forest Model. 
-->


### Why are the changes needed?
<!--
In the case of highly imbalanced data, the weighed gini will enhance the performance of the model as it treats the minority class with greater importance. 
-->


### Does this PR introduce any user-facing change?
<!--
No
-->
",2019-12-29T04:46:48Z,2020-02-05T18:11:42Z,,,644c67f1b2c25f0547f8959b81c0d4462c5fe293,,[],[],[],"[{'id': 1405803268, 'node_id': 'MDU6TGFiZWwxNDA1ODAzMjY4', 'url': 'https://api.github.com/repos/apache/spark/labels/MLLIB', 'name': 'MLLIB', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27036/commits,https://api.github.com/repos/apache/spark/pulls/27036/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27036/comments,https://api.github.com/repos/apache/spark/statuses/b0010aa90bf0e247772bace114caa79a4697def5,NONE,spark,apache,shreer1998,39053863,MDQ6VXNlcjM5MDUzODYz,https://avatars3.githubusercontent.com/u/39053863?v=4,,https://api.github.com/users/shreer1998,https://github.com/shreer1998,https://api.github.com/users/shreer1998/followers,https://api.github.com/users/shreer1998/following{/other_user},https://api.github.com/users/shreer1998/gists{/gist_id},https://api.github.com/users/shreer1998/starred{/owner}{/repo},https://api.github.com/users/shreer1998/subscriptions,https://api.github.com/users/shreer1998/orgs,https://api.github.com/users/shreer1998/repos,https://api.github.com/users/shreer1998/events{/privacy},https://api.github.com/users/shreer1998/received_events,User,False,shreer1998:add-weighted-gini,add-weighted-gini,b0010aa90bf0e247772bace114caa79a4697def5,shreer1998,39053863,MDQ6VXNlcjM5MDUzODYz,https://avatars3.githubusercontent.com/u/39053863?v=4,,https://api.github.com/users/shreer1998,https://github.com/shreer1998,https://api.github.com/users/shreer1998/followers,https://api.github.com/users/shreer1998/following{/other_user},https://api.github.com/users/shreer1998/gists{/gist_id},https://api.github.com/users/shreer1998/starred{/owner}{/repo},https://api.github.com/users/shreer1998/subscriptions,https://api.github.com/users/shreer1998/orgs,https://api.github.com/users/shreer1998/repos,https://api.github.com/users/shreer1998/events{/privacy},https://api.github.com/users/shreer1998/received_events,User,False,229097400,MDEwOlJlcG9zaXRvcnkyMjkwOTc0MDA=,spark,shreer1998/spark,False,shreer1998,39053863,MDQ6VXNlcjM5MDUzODYz,https://avatars3.githubusercontent.com/u/39053863?v=4,,https://api.github.com/users/shreer1998,https://github.com/shreer1998,https://api.github.com/users/shreer1998/followers,https://api.github.com/users/shreer1998/following{/other_user},https://api.github.com/users/shreer1998/gists{/gist_id},https://api.github.com/users/shreer1998/starred{/owner}{/repo},https://api.github.com/users/shreer1998/subscriptions,https://api.github.com/users/shreer1998/orgs,https://api.github.com/users/shreer1998/repos,https://api.github.com/users/shreer1998/events{/privacy},https://api.github.com/users/shreer1998/received_events,User,False,https://github.com/shreer1998/spark,Apache Spark,True,https://api.github.com/repos/shreer1998/spark,https://api.github.com/repos/shreer1998/spark/forks,https://api.github.com/repos/shreer1998/spark/keys{/key_id},https://api.github.com/repos/shreer1998/spark/collaborators{/collaborator},https://api.github.com/repos/shreer1998/spark/teams,https://api.github.com/repos/shreer1998/spark/hooks,https://api.github.com/repos/shreer1998/spark/issues/events{/number},https://api.github.com/repos/shreer1998/spark/events,https://api.github.com/repos/shreer1998/spark/assignees{/user},https://api.github.com/repos/shreer1998/spark/branches{/branch},https://api.github.com/repos/shreer1998/spark/tags,https://api.github.com/repos/shreer1998/spark/git/blobs{/sha},https://api.github.com/repos/shreer1998/spark/git/tags{/sha},https://api.github.com/repos/shreer1998/spark/git/refs{/sha},https://api.github.com/repos/shreer1998/spark/git/trees{/sha},https://api.github.com/repos/shreer1998/spark/statuses/{sha},https://api.github.com/repos/shreer1998/spark/languages,https://api.github.com/repos/shreer1998/spark/stargazers,https://api.github.com/repos/shreer1998/spark/contributors,https://api.github.com/repos/shreer1998/spark/subscribers,https://api.github.com/repos/shreer1998/spark/subscription,https://api.github.com/repos/shreer1998/spark/commits{/sha},https://api.github.com/repos/shreer1998/spark/git/commits{/sha},https://api.github.com/repos/shreer1998/spark/comments{/number},https://api.github.com/repos/shreer1998/spark/issues/comments{/number},https://api.github.com/repos/shreer1998/spark/contents/{+path},https://api.github.com/repos/shreer1998/spark/compare/{base}...{head},https://api.github.com/repos/shreer1998/spark/merges,https://api.github.com/repos/shreer1998/spark/{archive_format}{/ref},https://api.github.com/repos/shreer1998/spark/downloads,https://api.github.com/repos/shreer1998/spark/issues{/number},https://api.github.com/repos/shreer1998/spark/pulls{/number},https://api.github.com/repos/shreer1998/spark/milestones{/number},"https://api.github.com/repos/shreer1998/spark/notifications{?since,all,participating}",https://api.github.com/repos/shreer1998/spark/labels{/name},https://api.github.com/repos/shreer1998/spark/releases{/id},https://api.github.com/repos/shreer1998/spark/deployments,2019-12-19T16:39:44Z,2019-12-19T16:39:47Z,2019-12-27T11:51:46Z,git://github.com/shreer1998/spark.git,git@github.com:shreer1998/spark.git,https://github.com/shreer1998/spark.git,https://github.com/shreer1998/spark,,320998,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a719edcfd52f8018e3f086b8252893fd12e58b76,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27036,https://github.com/apache/spark/pull/27036,https://api.github.com/repos/apache/spark/issues/27036,https://api.github.com/repos/apache/spark/issues/27036/comments,https://api.github.com/repos/apache/spark/pulls/27036/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27036/commits,https://api.github.com/repos/apache/spark/statuses/b0010aa90bf0e247772bace114caa79a4697def5
169,https://api.github.com/repos/apache/spark/pulls/27030,357534499,MDExOlB1bGxSZXF1ZXN0MzU3NTM0NDk5,https://github.com/apache/spark/pull/27030,https://github.com/apache/spark/pull/27030.diff,https://github.com/apache/spark/pull/27030.patch,https://api.github.com/repos/apache/spark/issues/27030,27030,open,False,"[SPARK-30244][SQL] Emit pre/post events for ""Partition"" methods in ExternalCatalogWithListener","<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
Add events to CREATE, DROP, RENAME and ALTER partitions in `ExternalCatalogWithListener`.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
This changes needs for adding hooks for partitions in `ExternalCatalogWithListener`.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
This functionality is covered by unit tests.  ",2019-12-28T16:08:30Z,2020-03-09T19:27:01Z,,,b46379b3072ed0cf898816cc2bd0278fca72d999,,[],"[{'login': 'dongjoon-hyun', 'id': 9700541, 'node_id': 'MDQ6VXNlcjk3MDA1NDE=', 'avatar_url': 'https://avatars2.githubusercontent.com/u/9700541?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/dongjoon-hyun', 'html_url': 'https://github.com/dongjoon-hyun', 'followers_url': 'https://api.github.com/users/dongjoon-hyun/followers', 'following_url': 'https://api.github.com/users/dongjoon-hyun/following{/other_user}', 'gists_url': 'https://api.github.com/users/dongjoon-hyun/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/dongjoon-hyun/subscriptions', 'organizations_url': 'https://api.github.com/users/dongjoon-hyun/orgs', 'repos_url': 'https://api.github.com/users/dongjoon-hyun/repos', 'events_url': 'https://api.github.com/users/dongjoon-hyun/events{/privacy}', 'received_events_url': 'https://api.github.com/users/dongjoon-hyun/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27030/commits,https://api.github.com/repos/apache/spark/pulls/27030/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27030/comments,https://api.github.com/repos/apache/spark/statuses/30686b4a19edf7ceb13cd1d86838d4a1dd5c861b,CONTRIBUTOR,spark,apache,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,ayudovin:partition-events,partition-events,30686b4a19edf7ceb13cd1d86838d4a1dd5c861b,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,164214683,MDEwOlJlcG9zaXRvcnkxNjQyMTQ2ODM=,spark,ayudovin/spark,False,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,https://github.com/ayudovin/spark,Apache Spark,True,https://api.github.com/repos/ayudovin/spark,https://api.github.com/repos/ayudovin/spark/forks,https://api.github.com/repos/ayudovin/spark/keys{/key_id},https://api.github.com/repos/ayudovin/spark/collaborators{/collaborator},https://api.github.com/repos/ayudovin/spark/teams,https://api.github.com/repos/ayudovin/spark/hooks,https://api.github.com/repos/ayudovin/spark/issues/events{/number},https://api.github.com/repos/ayudovin/spark/events,https://api.github.com/repos/ayudovin/spark/assignees{/user},https://api.github.com/repos/ayudovin/spark/branches{/branch},https://api.github.com/repos/ayudovin/spark/tags,https://api.github.com/repos/ayudovin/spark/git/blobs{/sha},https://api.github.com/repos/ayudovin/spark/git/tags{/sha},https://api.github.com/repos/ayudovin/spark/git/refs{/sha},https://api.github.com/repos/ayudovin/spark/git/trees{/sha},https://api.github.com/repos/ayudovin/spark/statuses/{sha},https://api.github.com/repos/ayudovin/spark/languages,https://api.github.com/repos/ayudovin/spark/stargazers,https://api.github.com/repos/ayudovin/spark/contributors,https://api.github.com/repos/ayudovin/spark/subscribers,https://api.github.com/repos/ayudovin/spark/subscription,https://api.github.com/repos/ayudovin/spark/commits{/sha},https://api.github.com/repos/ayudovin/spark/git/commits{/sha},https://api.github.com/repos/ayudovin/spark/comments{/number},https://api.github.com/repos/ayudovin/spark/issues/comments{/number},https://api.github.com/repos/ayudovin/spark/contents/{+path},https://api.github.com/repos/ayudovin/spark/compare/{base}...{head},https://api.github.com/repos/ayudovin/spark/merges,https://api.github.com/repos/ayudovin/spark/{archive_format}{/ref},https://api.github.com/repos/ayudovin/spark/downloads,https://api.github.com/repos/ayudovin/spark/issues{/number},https://api.github.com/repos/ayudovin/spark/pulls{/number},https://api.github.com/repos/ayudovin/spark/milestones{/number},"https://api.github.com/repos/ayudovin/spark/notifications{?since,all,participating}",https://api.github.com/repos/ayudovin/spark/labels{/name},https://api.github.com/repos/ayudovin/spark/releases{/id},https://api.github.com/repos/ayudovin/spark/deployments,2019-01-05T12:53:03Z,2019-12-28T18:18:37Z,2020-02-02T14:05:29Z,git://github.com/ayudovin/spark.git,git@github.com:ayudovin/spark.git,https://github.com/ayudovin/spark.git,https://github.com/ayudovin/spark,,314562,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2a629e5d105461e12499503d2e4e95292d66a7fc,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27030,https://github.com/apache/spark/pull/27030,https://api.github.com/repos/apache/spark/issues/27030,https://api.github.com/repos/apache/spark/issues/27030/comments,https://api.github.com/repos/apache/spark/pulls/27030/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27030/commits,https://api.github.com/repos/apache/spark/statuses/30686b4a19edf7ceb13cd1d86838d4a1dd5c861b
170,https://api.github.com/repos/apache/spark/pulls/27026,357268748,MDExOlB1bGxSZXF1ZXN0MzU3MjY4NzQ4,https://github.com/apache/spark/pull/27026,https://github.com/apache/spark/pull/27026.diff,https://github.com/apache/spark/pull/27026.patch,https://api.github.com/repos/apache/spark/issues/27026,27026,open,False,[SPARK-29596][Web UI] Task duration not updating for running tasks,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Changed the source of web ui duration information
### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Task duration not updating for running tasks

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
no

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

cat web ui",2019-12-27T16:01:40Z,2020-02-16T10:05:38Z,,,0a7f99f77dc5eec70eed1b3bd444b6fb57678102,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27026/commits,https://api.github.com/repos/apache/spark/pulls/27026/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27026/comments,https://api.github.com/repos/apache/spark/statuses/a63a4bb4ac36e98e45dc999cb50dcbf4e5ea6794,NONE,spark,apache,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,MrDLontheway:branch-2.4,branch-2.4,a63a4bb4ac36e98e45dc999cb50dcbf4e5ea6794,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,170981390,MDEwOlJlcG9zaXRvcnkxNzA5ODEzOTA=,spark,MrDLontheway/spark,False,MrDLontheway,29403543,MDQ6VXNlcjI5NDAzNTQz,https://avatars2.githubusercontent.com/u/29403543?v=4,,https://api.github.com/users/MrDLontheway,https://github.com/MrDLontheway,https://api.github.com/users/MrDLontheway/followers,https://api.github.com/users/MrDLontheway/following{/other_user},https://api.github.com/users/MrDLontheway/gists{/gist_id},https://api.github.com/users/MrDLontheway/starred{/owner}{/repo},https://api.github.com/users/MrDLontheway/subscriptions,https://api.github.com/users/MrDLontheway/orgs,https://api.github.com/users/MrDLontheway/repos,https://api.github.com/users/MrDLontheway/events{/privacy},https://api.github.com/users/MrDLontheway/received_events,User,False,https://github.com/MrDLontheway/spark,Apache Spark,True,https://api.github.com/repos/MrDLontheway/spark,https://api.github.com/repos/MrDLontheway/spark/forks,https://api.github.com/repos/MrDLontheway/spark/keys{/key_id},https://api.github.com/repos/MrDLontheway/spark/collaborators{/collaborator},https://api.github.com/repos/MrDLontheway/spark/teams,https://api.github.com/repos/MrDLontheway/spark/hooks,https://api.github.com/repos/MrDLontheway/spark/issues/events{/number},https://api.github.com/repos/MrDLontheway/spark/events,https://api.github.com/repos/MrDLontheway/spark/assignees{/user},https://api.github.com/repos/MrDLontheway/spark/branches{/branch},https://api.github.com/repos/MrDLontheway/spark/tags,https://api.github.com/repos/MrDLontheway/spark/git/blobs{/sha},https://api.github.com/repos/MrDLontheway/spark/git/tags{/sha},https://api.github.com/repos/MrDLontheway/spark/git/refs{/sha},https://api.github.com/repos/MrDLontheway/spark/git/trees{/sha},https://api.github.com/repos/MrDLontheway/spark/statuses/{sha},https://api.github.com/repos/MrDLontheway/spark/languages,https://api.github.com/repos/MrDLontheway/spark/stargazers,https://api.github.com/repos/MrDLontheway/spark/contributors,https://api.github.com/repos/MrDLontheway/spark/subscribers,https://api.github.com/repos/MrDLontheway/spark/subscription,https://api.github.com/repos/MrDLontheway/spark/commits{/sha},https://api.github.com/repos/MrDLontheway/spark/git/commits{/sha},https://api.github.com/repos/MrDLontheway/spark/comments{/number},https://api.github.com/repos/MrDLontheway/spark/issues/comments{/number},https://api.github.com/repos/MrDLontheway/spark/contents/{+path},https://api.github.com/repos/MrDLontheway/spark/compare/{base}...{head},https://api.github.com/repos/MrDLontheway/spark/merges,https://api.github.com/repos/MrDLontheway/spark/{archive_format}{/ref},https://api.github.com/repos/MrDLontheway/spark/downloads,https://api.github.com/repos/MrDLontheway/spark/issues{/number},https://api.github.com/repos/MrDLontheway/spark/pulls{/number},https://api.github.com/repos/MrDLontheway/spark/milestones{/number},"https://api.github.com/repos/MrDLontheway/spark/notifications{?since,all,participating}",https://api.github.com/repos/MrDLontheway/spark/labels{/name},https://api.github.com/repos/MrDLontheway/spark/releases{/id},https://api.github.com/repos/MrDLontheway/spark/deployments,2019-02-16T08:37:47Z,2019-09-03T02:50:23Z,2020-04-06T09:26:14Z,git://github.com/MrDLontheway/spark.git,git@github.com:MrDLontheway/spark.git,https://github.com/MrDLontheway/spark.git,https://github.com/MrDLontheway/spark,,324323,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:branch-2.4,branch-2.4,fbd95b1605dec0b3cd0577252b6635835604d7cf,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27026,https://github.com/apache/spark/pull/27026,https://api.github.com/repos/apache/spark/issues/27026,https://api.github.com/repos/apache/spark/issues/27026/comments,https://api.github.com/repos/apache/spark/pulls/27026/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27026/commits,https://api.github.com/repos/apache/spark/statuses/a63a4bb4ac36e98e45dc999cb50dcbf4e5ea6794
171,https://api.github.com/repos/apache/spark/pulls/27024,357199542,MDExOlB1bGxSZXF1ZXN0MzU3MTk5NTQy,https://github.com/apache/spark/pull/27024,https://github.com/apache/spark/pull/27024.diff,https://github.com/apache/spark/pull/27024.patch,https://api.github.com/repos/apache/spark/issues/27024,27024,open,False,[SPARK-29854]lpad and rpad built in function should throw Error or Exception for invalid length value,"### What changes were proposed in this pull request?
lpad and rpad built in function should throw Error or Exception for invalid length value Instead of empty string.

### Why are the changes needed?
We should throw Error or Exception message, if user trying to perform LPAD/RPAD operation using invalid argument.

```
SELECT lpad('hi', 'ankit', '?') => """"   <previous behaviours>
SELECT lpad('hi', 'ankit', '?') => ""Error in query: Invalid argument, TypeCheckFailure(argument 2 requires int type, however, ''ankit'' is of string type.);""   <After this PR>

SELECT rpad('hi', 'raj', '?') => """"   <previous behaviours>
SELECT lpad('hi', 'raj', '?') => ""Error in query: Invalid argument, TypeCheckFailure(argument 2 requires int type, however, ''raj'' is of string type.);""   <After this PR>
```


### Does this PR introduce any user-facing change?
YES
![Screenshot 2019-12-27 at 4 09 46 PM](https://user-images.githubusercontent.com/8948111/71514275-e8577180-28c3-11ea-9d0b-9b4f3027ddeb.png)

![Screenshot 2019-12-27 at 4 15 55 PM](https://user-images.githubusercontent.com/8948111/71514356-37050b80-28c4-11ea-87ab-0406db6d720e.png)
![Screenshot 2019-12-27 at 4 16 52 PM](https://user-images.githubusercontent.com/8948111/71514395-674caa00-28c4-11ea-91dc-37c253f451b0.png)

![Screenshot 2019-12-27 at 4 17 05 PM](https://user-images.githubusercontent.com/8948111/71514392-5dc34200-28c4-11ea-94bd-70d439c5216f.png)


### How was this patch tested?
Added new test case to check invalid length value. 
",2019-12-27T10:52:17Z,2020-02-05T18:11:08Z,,,78513eab796e6277830e7ee03b71f4f3a6072c85,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27024/commits,https://api.github.com/repos/apache/spark/pulls/27024/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27024/comments,https://api.github.com/repos/apache/spark/statuses/2793ac6cf38f32ce8a7b12a6edcc23a65ff3cff3,CONTRIBUTOR,spark,apache,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,07ARB:SPARK-29854,SPARK-29854,2793ac6cf38f32ce8a7b12a6edcc23a65ff3cff3,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,213365500,MDEwOlJlcG9zaXRvcnkyMTMzNjU1MDA=,spark,07ARB/spark,False,07ARB,8948111,MDQ6VXNlcjg5NDgxMTE=,https://avatars0.githubusercontent.com/u/8948111?v=4,,https://api.github.com/users/07ARB,https://github.com/07ARB,https://api.github.com/users/07ARB/followers,https://api.github.com/users/07ARB/following{/other_user},https://api.github.com/users/07ARB/gists{/gist_id},https://api.github.com/users/07ARB/starred{/owner}{/repo},https://api.github.com/users/07ARB/subscriptions,https://api.github.com/users/07ARB/orgs,https://api.github.com/users/07ARB/repos,https://api.github.com/users/07ARB/events{/privacy},https://api.github.com/users/07ARB/received_events,User,False,https://github.com/07ARB/spark,Apache Spark,True,https://api.github.com/repos/07ARB/spark,https://api.github.com/repos/07ARB/spark/forks,https://api.github.com/repos/07ARB/spark/keys{/key_id},https://api.github.com/repos/07ARB/spark/collaborators{/collaborator},https://api.github.com/repos/07ARB/spark/teams,https://api.github.com/repos/07ARB/spark/hooks,https://api.github.com/repos/07ARB/spark/issues/events{/number},https://api.github.com/repos/07ARB/spark/events,https://api.github.com/repos/07ARB/spark/assignees{/user},https://api.github.com/repos/07ARB/spark/branches{/branch},https://api.github.com/repos/07ARB/spark/tags,https://api.github.com/repos/07ARB/spark/git/blobs{/sha},https://api.github.com/repos/07ARB/spark/git/tags{/sha},https://api.github.com/repos/07ARB/spark/git/refs{/sha},https://api.github.com/repos/07ARB/spark/git/trees{/sha},https://api.github.com/repos/07ARB/spark/statuses/{sha},https://api.github.com/repos/07ARB/spark/languages,https://api.github.com/repos/07ARB/spark/stargazers,https://api.github.com/repos/07ARB/spark/contributors,https://api.github.com/repos/07ARB/spark/subscribers,https://api.github.com/repos/07ARB/spark/subscription,https://api.github.com/repos/07ARB/spark/commits{/sha},https://api.github.com/repos/07ARB/spark/git/commits{/sha},https://api.github.com/repos/07ARB/spark/comments{/number},https://api.github.com/repos/07ARB/spark/issues/comments{/number},https://api.github.com/repos/07ARB/spark/contents/{+path},https://api.github.com/repos/07ARB/spark/compare/{base}...{head},https://api.github.com/repos/07ARB/spark/merges,https://api.github.com/repos/07ARB/spark/{archive_format}{/ref},https://api.github.com/repos/07ARB/spark/downloads,https://api.github.com/repos/07ARB/spark/issues{/number},https://api.github.com/repos/07ARB/spark/pulls{/number},https://api.github.com/repos/07ARB/spark/milestones{/number},"https://api.github.com/repos/07ARB/spark/notifications{?since,all,participating}",https://api.github.com/repos/07ARB/spark/labels{/name},https://api.github.com/repos/07ARB/spark/releases{/id},https://api.github.com/repos/07ARB/spark/deployments,2019-10-07T11:28:14Z,2020-02-20T10:47:52Z,2020-01-13T14:40:24Z,git://github.com/07ARB/spark.git,git@github.com:07ARB/spark.git,https://github.com/07ARB/spark.git,https://github.com/07ARB/spark,,322245,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,16e5e79877d9bad73f3f96688efe08c9a052340f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27024,https://github.com/apache/spark/pull/27024,https://api.github.com/repos/apache/spark/issues/27024,https://api.github.com/repos/apache/spark/issues/27024/comments,https://api.github.com/repos/apache/spark/pulls/27024/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27024/commits,https://api.github.com/repos/apache/spark/statuses/2793ac6cf38f32ce8a7b12a6edcc23a65ff3cff3
172,https://api.github.com/repos/apache/spark/pulls/27019,356973183,MDExOlB1bGxSZXF1ZXN0MzU2OTczMTgz,https://github.com/apache/spark/pull/27019,https://github.com/apache/spark/pull/27019.diff,https://github.com/apache/spark/pull/27019.patch,https://api.github.com/repos/apache/spark/issues/27019,27019,open,False,[SPARK-30027][SQL] Support codegen for aggregate filters in HashAggregateExec,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This pr intends to support code generation for `HashAggregateExec` with filters.

Quick benchmark results:
```
$ ./bin/spark-shell --master=local[1] --conf spark.driver.memory=8g --conf spark.sql.shuffle.partitions=1 -v

scala> spark.range(100000000).selectExpr(""id % 3 as k1"", ""id % 5 as k2"", ""rand() as v1"", ""rand() as v2"").write.saveAsTable(""t"")
scala> sql(""SELECT k1, k2, AVG(v1) FILTER (WHERE v2 > 0.5) FROM t GROUP BY k1, k2"").write.format(""noop"").mode(""overwrite"").save()

>> Before this PR
Elapsed time: 16.170697619s 

>> After this PR
Elapsed time: 6.7825313s  
```

The query above is compiled into code below;

```
...
/* 285 */   private void agg_doAggregate_avg_0(boolean agg_exprIsNull_2_0, org.apache.spark.sql.catalyst.InternalRow agg_unsafeRowAggBuffer_0, double agg_expr_2_0) throws java.io.IOException {
/* 286 */     // evaluate aggregate function for avg
/* 287 */     boolean agg_isNull_10 = true;
/* 288 */     double agg_value_12 = -1.0;
/* 289 */     boolean agg_isNull_11 = agg_unsafeRowAggBuffer_0.isNullAt(0);
/* 290 */     double agg_value_13 = agg_isNull_11 ?
/* 291 */     -1.0 : (agg_unsafeRowAggBuffer_0.getDouble(0));
/* 292 */     if (!agg_isNull_11) {
/* 293 */       agg_agg_isNull_12_0 = true;
/* 294 */       double agg_value_14 = -1.0;
/* 295 */       do {
/* 296 */         if (!agg_exprIsNull_2_0) {
/* 297 */           agg_agg_isNull_12_0 = false;
/* 298 */           agg_value_14 = agg_expr_2_0;
/* 299 */           continue;
/* 300 */         }
/* 301 */
/* 302 */         if (!false) {
/* 303 */           agg_agg_isNull_12_0 = false;
/* 304 */           agg_value_14 = 0.0D;
/* 305 */           continue;
/* 306 */         }
/* 307 */
/* 308 */       } while (false);
/* 309 */
/* 310 */       agg_isNull_10 = false; // resultCode could change nullability.
/* 311 */
/* 312 */       agg_value_12 = agg_value_13 + agg_value_14;
/* 313 */
/* 314 */     }
/* 315 */     boolean agg_isNull_15 = false;
/* 316 */     long agg_value_17 = -1L;
/* 317 */     if (!false && agg_exprIsNull_2_0) {
/* 318 */       boolean agg_isNull_18 = agg_unsafeRowAggBuffer_0.isNullAt(1);
/* 319 */       long agg_value_20 = agg_isNull_18 ?
/* 320 */       -1L : (agg_unsafeRowAggBuffer_0.getLong(1));
/* 321 */       agg_isNull_15 = agg_isNull_18;
/* 322 */       agg_value_17 = agg_value_20;
/* 323 */     } else {
/* 324 */       boolean agg_isNull_19 = true;
/* 325 */       long agg_value_21 = -1L;
/* 326 */       boolean agg_isNull_20 = agg_unsafeRowAggBuffer_0.isNullAt(1);
/* 327 */       long agg_value_22 = agg_isNull_20 ?
/* 328 */       -1L : (agg_unsafeRowAggBuffer_0.getLong(1));
/* 329 */       if (!agg_isNull_20) {
/* 330 */         agg_isNull_19 = false; // resultCode could change nullability.
/* 331 */
/* 332 */         agg_value_21 = agg_value_22 + 1L;
/* 333 */
/* 334 */       }
/* 335 */       agg_isNull_15 = agg_isNull_19;
/* 336 */       agg_value_17 = agg_value_21;
/* 337 */     }
/* 338 */     // update unsafe row buffer
/* 339 */     if (!agg_isNull_10) {
/* 340 */       agg_unsafeRowAggBuffer_0.setDouble(0, agg_value_12);
/* 341 */     } else {
/* 342 */       agg_unsafeRowAggBuffer_0.setNullAt(0);
/* 343 */     }
/* 344 */
/* 345 */     if (!agg_isNull_15) {
/* 346 */       agg_unsafeRowAggBuffer_0.setLong(1, agg_value_17);
/* 347 */     } else {
/* 348 */       agg_unsafeRowAggBuffer_0.setNullAt(1);
/* 349 */     }
/* 350 */   }
...
```

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
For high performance.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Existing tests.",2019-12-26T13:35:43Z,2020-04-03T06:50:08Z,,,ad2c5b9ce8be72dd9ed70f6f8f92ee789d4f029c,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27019/commits,https://api.github.com/repos/apache/spark/pulls/27019/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27019/comments,https://api.github.com/repos/apache/spark/statuses/d303b2fe2bc1ddc0b1e98c2028fb92322a0bb976,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:AggregateFilterCodegen,AggregateFilterCodegen,d303b2fe2bc1ddc0b1e98c2028fb92322a0bb976,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,08bdc9c9b2e44e066e44d35733e0f3b450d24052,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27019,https://github.com/apache/spark/pull/27019,https://api.github.com/repos/apache/spark/issues/27019,https://api.github.com/repos/apache/spark/issues/27019/comments,https://api.github.com/repos/apache/spark/pulls/27019/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27019/commits,https://api.github.com/repos/apache/spark/statuses/d303b2fe2bc1ddc0b1e98c2028fb92322a0bb976
173,https://api.github.com/repos/apache/spark/pulls/27006,356770366,MDExOlB1bGxSZXF1ZXN0MzU2NzcwMzY2,https://github.com/apache/spark/pull/27006,https://github.com/apache/spark/pull/27006.diff,https://github.com/apache/spark/pull/27006.patch,https://api.github.com/repos/apache/spark/issues/27006,27006,open,False,[SPARK-30352][SQL] DataSourceV2: Add CURRENT_CATALOG function,"### What changes were proposed in this pull request?

As we support multiple catalogs with DataSourceV2, we may need the `CURRENT_CATALOG` value expression from the SQL standard.

`CURRENT_CATALOG` is a general value specification in the SQL Standard, described as:

> The value specified by CURRENT_CATALOG is the character string that represents the current default catalog name.


### Why are the changes needed?
improve catalog v2 with ANSI SQL standard.


### Does this PR introduce any user-facing change?
yes, add a new function `current_catalog()` to point the current active catalog


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
add ut",2019-12-25T09:13:08Z,2020-02-05T18:11:08Z,,,9dc136fd5a33d9e8cb0122ca2b4b4d9d0013da52,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/27006/commits,https://api.github.com/repos/apache/spark/pulls/27006/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/27006/comments,https://api.github.com/repos/apache/spark/statuses/180fe0a14409043e22d2eb51c17b60a27f678eb7,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:SPARK-30352,SPARK-30352,180fe0a14409043e22d2eb51c17b60a27f678eb7,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,8f07839e743889bbffe91302f31388ab892bf08a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/27006,https://github.com/apache/spark/pull/27006,https://api.github.com/repos/apache/spark/issues/27006,https://api.github.com/repos/apache/spark/issues/27006/comments,https://api.github.com/repos/apache/spark/pulls/27006/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/27006/commits,https://api.github.com/repos/apache/spark/statuses/180fe0a14409043e22d2eb51c17b60a27f678eb7
174,https://api.github.com/repos/apache/spark/pulls/26987,356400591,MDExOlB1bGxSZXF1ZXN0MzU2NDAwNTkx,https://github.com/apache/spark/pull/26987,https://github.com/apache/spark/pull/26987.diff,https://github.com/apache/spark/pull/26987.patch,https://api.github.com/repos/apache/spark/issues/26987,26987,open,False,[SPARK-30334][SQL] Introduce as_json for marking a column as JSON data,"### What changes were proposed in this pull request?

Semi-structured data is used widely in the data industry for reporting events in a wide variety of formats. Click events in product analytics can be stored as json. Some application logs can be in the form of delimited key=value text. Some data may be in xml.

The goal of this project is to be able to signal Spark that such a column exists. This will then enable Spark to ""auto-parse"" these columns on the fly. The proposal is to store this information as part of the column metadata, in the fields:
 - format: The format of the semi-structured column, e.g. json, xml, avro
 - options: Options for parsing these columns

This PR introduces the function ""as_json"", which accomplishes this for JSON columns.

### Why are the changes needed?

Simplify the handling of semi-structured columns in Spark, initially for JSON data.

### Does this PR introduce any user-facing change?

Introduces a new function called as_json

### How was this patch tested?

Unit tests",2019-12-23T17:25:20Z,2020-02-05T18:11:07Z,,,a56bf735a73dcf663db0a00563b37cc005a2a105,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26987/commits,https://api.github.com/repos/apache/spark/pulls/26987/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26987/comments,https://api.github.com/repos/apache/spark/statuses/576af9125fca69202d7e009cf7495c230e852a58,CONTRIBUTOR,spark,apache,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,brkyvz:asJson,asJson,576af9125fca69202d7e009cf7495c230e852a58,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,21919521,MDEwOlJlcG9zaXRvcnkyMTkxOTUyMQ==,spark,brkyvz/spark,False,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,https://github.com/brkyvz/spark,Mirror of Apache Spark,True,https://api.github.com/repos/brkyvz/spark,https://api.github.com/repos/brkyvz/spark/forks,https://api.github.com/repos/brkyvz/spark/keys{/key_id},https://api.github.com/repos/brkyvz/spark/collaborators{/collaborator},https://api.github.com/repos/brkyvz/spark/teams,https://api.github.com/repos/brkyvz/spark/hooks,https://api.github.com/repos/brkyvz/spark/issues/events{/number},https://api.github.com/repos/brkyvz/spark/events,https://api.github.com/repos/brkyvz/spark/assignees{/user},https://api.github.com/repos/brkyvz/spark/branches{/branch},https://api.github.com/repos/brkyvz/spark/tags,https://api.github.com/repos/brkyvz/spark/git/blobs{/sha},https://api.github.com/repos/brkyvz/spark/git/tags{/sha},https://api.github.com/repos/brkyvz/spark/git/refs{/sha},https://api.github.com/repos/brkyvz/spark/git/trees{/sha},https://api.github.com/repos/brkyvz/spark/statuses/{sha},https://api.github.com/repos/brkyvz/spark/languages,https://api.github.com/repos/brkyvz/spark/stargazers,https://api.github.com/repos/brkyvz/spark/contributors,https://api.github.com/repos/brkyvz/spark/subscribers,https://api.github.com/repos/brkyvz/spark/subscription,https://api.github.com/repos/brkyvz/spark/commits{/sha},https://api.github.com/repos/brkyvz/spark/git/commits{/sha},https://api.github.com/repos/brkyvz/spark/comments{/number},https://api.github.com/repos/brkyvz/spark/issues/comments{/number},https://api.github.com/repos/brkyvz/spark/contents/{+path},https://api.github.com/repos/brkyvz/spark/compare/{base}...{head},https://api.github.com/repos/brkyvz/spark/merges,https://api.github.com/repos/brkyvz/spark/{archive_format}{/ref},https://api.github.com/repos/brkyvz/spark/downloads,https://api.github.com/repos/brkyvz/spark/issues{/number},https://api.github.com/repos/brkyvz/spark/pulls{/number},https://api.github.com/repos/brkyvz/spark/milestones{/number},"https://api.github.com/repos/brkyvz/spark/notifications{?since,all,participating}",https://api.github.com/repos/brkyvz/spark/labels{/name},https://api.github.com/repos/brkyvz/spark/releases{/id},https://api.github.com/repos/brkyvz/spark/deployments,2014-07-16T21:51:06Z,2020-02-01T00:21:30Z,2020-04-07T18:33:41Z,git://github.com/brkyvz/spark.git,git@github.com:brkyvz/spark.git,https://github.com/brkyvz/spark.git,https://github.com/brkyvz/spark,,293142,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c6ab7165dd11a0a7b8aea4c805409088e9a41a74,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26987,https://github.com/apache/spark/pull/26987,https://api.github.com/repos/apache/spark/issues/26987,https://api.github.com/repos/apache/spark/issues/26987/comments,https://api.github.com/repos/apache/spark/pulls/26987/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26987/commits,https://api.github.com/repos/apache/spark/statuses/576af9125fca69202d7e009cf7495c230e852a58
175,https://api.github.com/repos/apache/spark/pulls/26984,356269519,MDExOlB1bGxSZXF1ZXN0MzU2MjY5NTE5,https://github.com/apache/spark/pull/26984,https://github.com/apache/spark/pull/26984.diff,https://github.com/apache/spark/pull/26984.patch,https://api.github.com/repos/apache/spark/issues/26984,26984,open,False,[SPARK-27641][CORE] Fix MetricsSystem to remove metrics of the specific source by exactly match,"## What changes were proposed in this pull request?

* Only remove the registered metrics  of the specific source when perform `MetricsSystem.removeSource`

## How was this patch tested?
* add new unit tests",2019-12-23T10:17:31Z,2020-02-13T23:35:50Z,,,e8891c8499ef7b2bb669dd22e7c7a34b21cf784e,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26984/commits,https://api.github.com/repos/apache/spark/pulls/26984/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26984/comments,https://api.github.com/repos/apache/spark/statuses/b0b751a60b635c3998fb0395a37008e56e7e13d3,NONE,spark,apache,chummyhe89,2225583,MDQ6VXNlcjIyMjU1ODM=,https://avatars3.githubusercontent.com/u/2225583?v=4,,https://api.github.com/users/chummyhe89,https://github.com/chummyhe89,https://api.github.com/users/chummyhe89/followers,https://api.github.com/users/chummyhe89/following{/other_user},https://api.github.com/users/chummyhe89/gists{/gist_id},https://api.github.com/users/chummyhe89/starred{/owner}{/repo},https://api.github.com/users/chummyhe89/subscriptions,https://api.github.com/users/chummyhe89/orgs,https://api.github.com/users/chummyhe89/repos,https://api.github.com/users/chummyhe89/events{/privacy},https://api.github.com/users/chummyhe89/received_events,User,False,chummyhe89:spark27641,spark27641,b0b751a60b635c3998fb0395a37008e56e7e13d3,chummyhe89,2225583,MDQ6VXNlcjIyMjU1ODM=,https://avatars3.githubusercontent.com/u/2225583?v=4,,https://api.github.com/users/chummyhe89,https://github.com/chummyhe89,https://api.github.com/users/chummyhe89/followers,https://api.github.com/users/chummyhe89/following{/other_user},https://api.github.com/users/chummyhe89/gists{/gist_id},https://api.github.com/users/chummyhe89/starred{/owner}{/repo},https://api.github.com/users/chummyhe89/subscriptions,https://api.github.com/users/chummyhe89/orgs,https://api.github.com/users/chummyhe89/repos,https://api.github.com/users/chummyhe89/events{/privacy},https://api.github.com/users/chummyhe89/received_events,User,False,41920457,MDEwOlJlcG9zaXRvcnk0MTkyMDQ1Nw==,spark,chummyhe89/spark,False,chummyhe89,2225583,MDQ6VXNlcjIyMjU1ODM=,https://avatars3.githubusercontent.com/u/2225583?v=4,,https://api.github.com/users/chummyhe89,https://github.com/chummyhe89,https://api.github.com/users/chummyhe89/followers,https://api.github.com/users/chummyhe89/following{/other_user},https://api.github.com/users/chummyhe89/gists{/gist_id},https://api.github.com/users/chummyhe89/starred{/owner}{/repo},https://api.github.com/users/chummyhe89/subscriptions,https://api.github.com/users/chummyhe89/orgs,https://api.github.com/users/chummyhe89/repos,https://api.github.com/users/chummyhe89/events{/privacy},https://api.github.com/users/chummyhe89/received_events,User,False,https://github.com/chummyhe89/spark,Mirror of Apache Spark,True,https://api.github.com/repos/chummyhe89/spark,https://api.github.com/repos/chummyhe89/spark/forks,https://api.github.com/repos/chummyhe89/spark/keys{/key_id},https://api.github.com/repos/chummyhe89/spark/collaborators{/collaborator},https://api.github.com/repos/chummyhe89/spark/teams,https://api.github.com/repos/chummyhe89/spark/hooks,https://api.github.com/repos/chummyhe89/spark/issues/events{/number},https://api.github.com/repos/chummyhe89/spark/events,https://api.github.com/repos/chummyhe89/spark/assignees{/user},https://api.github.com/repos/chummyhe89/spark/branches{/branch},https://api.github.com/repos/chummyhe89/spark/tags,https://api.github.com/repos/chummyhe89/spark/git/blobs{/sha},https://api.github.com/repos/chummyhe89/spark/git/tags{/sha},https://api.github.com/repos/chummyhe89/spark/git/refs{/sha},https://api.github.com/repos/chummyhe89/spark/git/trees{/sha},https://api.github.com/repos/chummyhe89/spark/statuses/{sha},https://api.github.com/repos/chummyhe89/spark/languages,https://api.github.com/repos/chummyhe89/spark/stargazers,https://api.github.com/repos/chummyhe89/spark/contributors,https://api.github.com/repos/chummyhe89/spark/subscribers,https://api.github.com/repos/chummyhe89/spark/subscription,https://api.github.com/repos/chummyhe89/spark/commits{/sha},https://api.github.com/repos/chummyhe89/spark/git/commits{/sha},https://api.github.com/repos/chummyhe89/spark/comments{/number},https://api.github.com/repos/chummyhe89/spark/issues/comments{/number},https://api.github.com/repos/chummyhe89/spark/contents/{+path},https://api.github.com/repos/chummyhe89/spark/compare/{base}...{head},https://api.github.com/repos/chummyhe89/spark/merges,https://api.github.com/repos/chummyhe89/spark/{archive_format}{/ref},https://api.github.com/repos/chummyhe89/spark/downloads,https://api.github.com/repos/chummyhe89/spark/issues{/number},https://api.github.com/repos/chummyhe89/spark/pulls{/number},https://api.github.com/repos/chummyhe89/spark/milestones{/number},"https://api.github.com/repos/chummyhe89/spark/notifications{?since,all,participating}",https://api.github.com/repos/chummyhe89/spark/labels{/name},https://api.github.com/repos/chummyhe89/spark/releases{/id},https://api.github.com/repos/chummyhe89/spark/deployments,2015-09-04T14:33:28Z,2019-12-23T10:43:03Z,2020-02-13T04:53:38Z,git://github.com/chummyhe89/spark.git,git@github.com:chummyhe89/spark.git,https://github.com/chummyhe89/spark.git,https://github.com/chummyhe89/spark,,292662,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,640dcc435b3136035adb8b6320b29efa59f7f65e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26984,https://github.com/apache/spark/pull/26984,https://api.github.com/repos/apache/spark/issues/26984,https://api.github.com/repos/apache/spark/issues/26984/comments,https://api.github.com/repos/apache/spark/pulls/26984/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26984/commits,https://api.github.com/repos/apache/spark/statuses/b0b751a60b635c3998fb0395a37008e56e7e13d3
176,https://api.github.com/repos/apache/spark/pulls/26974,355868237,MDExOlB1bGxSZXF1ZXN0MzU1ODY4MjM3,https://github.com/apache/spark/pull/26974,https://github.com/apache/spark/pull/26974.diff,https://github.com/apache/spark/pull/26974.patch,https://api.github.com/repos/apache/spark/issues/26974,26974,open,False,[SPARK-30324][SQL] Simplify JSON field access through dot notation,"### What changes were proposed in this pull request?

Allows JSON strings to be parsed through dot and bracket notation instead of having to write ""get_json_object"". We add a feature flag to control this behavior.

The column needs to be a JSON object for this to work. JSON arrays are not supported and would return nulls. If a column is a JSON array, e.g. `[{""a"":1},{""a"":2},...]`, `explode(from_json(colName, expr(""array<string>"")))` can be used to first explode the array into the JSON objects.

While the JSON column can be resolved case insensitively, the JSON fields are case sensitive.
For example, imagine the column `foo`:
```
{""a"":""bar"", ""b"":{""field1"":""v1""}}
```

`foo.b.field1`, `FOO.b.field1` would work, but `foo.B.FIELD1` would return a null value.

### Why are the changes needed?

get_json_object is a hard to use and verbose API. This API would greatly help data engineers store their data as raw json columns, and data analysts access the fields that they care about, without having to deal with complicated UDFs, and JSON parsing code.

### Does this PR introduce any user-facing change?

Yes, StringType fields that contain JSON now will be accessible through dot notation.


### How was this patch tested?

Unit tests",2019-12-20T19:24:24Z,2020-02-05T18:11:06Z,,,d7abebec4784534ec4b658e825e6716f22bc3ba1,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26974/commits,https://api.github.com/repos/apache/spark/pulls/26974/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26974/comments,https://api.github.com/repos/apache/spark/statuses/a21ff181efa59b67a66f1e8612e4e3117dbaffbb,CONTRIBUTOR,spark,apache,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,brkyvz:json,json,a21ff181efa59b67a66f1e8612e4e3117dbaffbb,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,21919521,MDEwOlJlcG9zaXRvcnkyMTkxOTUyMQ==,spark,brkyvz/spark,False,brkyvz,5243515,MDQ6VXNlcjUyNDM1MTU=,https://avatars1.githubusercontent.com/u/5243515?v=4,,https://api.github.com/users/brkyvz,https://github.com/brkyvz,https://api.github.com/users/brkyvz/followers,https://api.github.com/users/brkyvz/following{/other_user},https://api.github.com/users/brkyvz/gists{/gist_id},https://api.github.com/users/brkyvz/starred{/owner}{/repo},https://api.github.com/users/brkyvz/subscriptions,https://api.github.com/users/brkyvz/orgs,https://api.github.com/users/brkyvz/repos,https://api.github.com/users/brkyvz/events{/privacy},https://api.github.com/users/brkyvz/received_events,User,False,https://github.com/brkyvz/spark,Mirror of Apache Spark,True,https://api.github.com/repos/brkyvz/spark,https://api.github.com/repos/brkyvz/spark/forks,https://api.github.com/repos/brkyvz/spark/keys{/key_id},https://api.github.com/repos/brkyvz/spark/collaborators{/collaborator},https://api.github.com/repos/brkyvz/spark/teams,https://api.github.com/repos/brkyvz/spark/hooks,https://api.github.com/repos/brkyvz/spark/issues/events{/number},https://api.github.com/repos/brkyvz/spark/events,https://api.github.com/repos/brkyvz/spark/assignees{/user},https://api.github.com/repos/brkyvz/spark/branches{/branch},https://api.github.com/repos/brkyvz/spark/tags,https://api.github.com/repos/brkyvz/spark/git/blobs{/sha},https://api.github.com/repos/brkyvz/spark/git/tags{/sha},https://api.github.com/repos/brkyvz/spark/git/refs{/sha},https://api.github.com/repos/brkyvz/spark/git/trees{/sha},https://api.github.com/repos/brkyvz/spark/statuses/{sha},https://api.github.com/repos/brkyvz/spark/languages,https://api.github.com/repos/brkyvz/spark/stargazers,https://api.github.com/repos/brkyvz/spark/contributors,https://api.github.com/repos/brkyvz/spark/subscribers,https://api.github.com/repos/brkyvz/spark/subscription,https://api.github.com/repos/brkyvz/spark/commits{/sha},https://api.github.com/repos/brkyvz/spark/git/commits{/sha},https://api.github.com/repos/brkyvz/spark/comments{/number},https://api.github.com/repos/brkyvz/spark/issues/comments{/number},https://api.github.com/repos/brkyvz/spark/contents/{+path},https://api.github.com/repos/brkyvz/spark/compare/{base}...{head},https://api.github.com/repos/brkyvz/spark/merges,https://api.github.com/repos/brkyvz/spark/{archive_format}{/ref},https://api.github.com/repos/brkyvz/spark/downloads,https://api.github.com/repos/brkyvz/spark/issues{/number},https://api.github.com/repos/brkyvz/spark/pulls{/number},https://api.github.com/repos/brkyvz/spark/milestones{/number},"https://api.github.com/repos/brkyvz/spark/notifications{?since,all,participating}",https://api.github.com/repos/brkyvz/spark/labels{/name},https://api.github.com/repos/brkyvz/spark/releases{/id},https://api.github.com/repos/brkyvz/spark/deployments,2014-07-16T21:51:06Z,2020-02-01T00:21:30Z,2020-04-07T18:33:41Z,git://github.com/brkyvz/spark.git,git@github.com:brkyvz/spark.git,https://github.com/brkyvz/spark.git,https://github.com/brkyvz/spark,,293142,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c72f88b0ba20727e831ba9755d9628d0347ee3cb,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26974,https://github.com/apache/spark/pull/26974,https://api.github.com/repos/apache/spark/issues/26974,https://api.github.com/repos/apache/spark/issues/26974/comments,https://api.github.com/repos/apache/spark/pulls/26974/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26974/commits,https://api.github.com/repos/apache/spark/statuses/a21ff181efa59b67a66f1e8612e4e3117dbaffbb
177,https://api.github.com/repos/apache/spark/pulls/26971,355792306,MDExOlB1bGxSZXF1ZXN0MzU1NzkyMzA2,https://github.com/apache/spark/pull/26971,https://github.com/apache/spark/pull/26971.diff,https://github.com/apache/spark/pull/26971.patch,https://api.github.com/repos/apache/spark/issues/26971,26971,open,False,[SPARK-30320][SQL] Fix insert overwrite to DataSource table with dynamic partition error,"### What changes were proposed in this pull request?
This PR fix insert overwrite table error when running multiple speculative task. This PR introduces task attempt id appended to dynamic partition staging dir to identify different speculative task output dir rather than all speculative tasks use same output dir. CommitTask in HadoopMapReduceCommitProtocol carries attempt id in TaskCommitMessage

### Why are the changes needed?
This PR fix insert overwrite to DataSource table with dynamic partition error when running multiple task attempts. Suppose there are one task attempt and one speculative task attempt, the speculative would raise FileAlreadyExistsException because of same staging dir attempt tasks commit

### Does this PR introduce any user-facing change?

### How was this patch tested?
Added UT
",2019-12-20T16:06:29Z,2020-04-06T20:06:47Z,,,a71a473cbad64bd80e88694b48617a21466d4d35,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26971/commits,https://api.github.com/repos/apache/spark/pulls/26971/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26971/comments,https://api.github.com/repos/apache/spark/statuses/2c873dbae136904f086a23290c29a5559ce8d14f,NONE,spark,apache,WinkerDu,11454734,MDQ6VXNlcjExNDU0NzM0,https://avatars0.githubusercontent.com/u/11454734?v=4,,https://api.github.com/users/WinkerDu,https://github.com/WinkerDu,https://api.github.com/users/WinkerDu/followers,https://api.github.com/users/WinkerDu/following{/other_user},https://api.github.com/users/WinkerDu/gists{/gist_id},https://api.github.com/users/WinkerDu/starred{/owner}{/repo},https://api.github.com/users/WinkerDu/subscriptions,https://api.github.com/users/WinkerDu/orgs,https://api.github.com/users/WinkerDu/repos,https://api.github.com/users/WinkerDu/events{/privacy},https://api.github.com/users/WinkerDu/received_events,User,False,WinkerDu:master,master,2c873dbae136904f086a23290c29a5559ce8d14f,WinkerDu,11454734,MDQ6VXNlcjExNDU0NzM0,https://avatars0.githubusercontent.com/u/11454734?v=4,,https://api.github.com/users/WinkerDu,https://github.com/WinkerDu,https://api.github.com/users/WinkerDu/followers,https://api.github.com/users/WinkerDu/following{/other_user},https://api.github.com/users/WinkerDu/gists{/gist_id},https://api.github.com/users/WinkerDu/starred{/owner}{/repo},https://api.github.com/users/WinkerDu/subscriptions,https://api.github.com/users/WinkerDu/orgs,https://api.github.com/users/WinkerDu/repos,https://api.github.com/users/WinkerDu/events{/privacy},https://api.github.com/users/WinkerDu/received_events,User,False,229284757,MDEwOlJlcG9zaXRvcnkyMjkyODQ3NTc=,spark,WinkerDu/spark,False,WinkerDu,11454734,MDQ6VXNlcjExNDU0NzM0,https://avatars0.githubusercontent.com/u/11454734?v=4,,https://api.github.com/users/WinkerDu,https://github.com/WinkerDu,https://api.github.com/users/WinkerDu/followers,https://api.github.com/users/WinkerDu/following{/other_user},https://api.github.com/users/WinkerDu/gists{/gist_id},https://api.github.com/users/WinkerDu/starred{/owner}{/repo},https://api.github.com/users/WinkerDu/subscriptions,https://api.github.com/users/WinkerDu/orgs,https://api.github.com/users/WinkerDu/repos,https://api.github.com/users/WinkerDu/events{/privacy},https://api.github.com/users/WinkerDu/received_events,User,False,https://github.com/WinkerDu/spark,Apache Spark,True,https://api.github.com/repos/WinkerDu/spark,https://api.github.com/repos/WinkerDu/spark/forks,https://api.github.com/repos/WinkerDu/spark/keys{/key_id},https://api.github.com/repos/WinkerDu/spark/collaborators{/collaborator},https://api.github.com/repos/WinkerDu/spark/teams,https://api.github.com/repos/WinkerDu/spark/hooks,https://api.github.com/repos/WinkerDu/spark/issues/events{/number},https://api.github.com/repos/WinkerDu/spark/events,https://api.github.com/repos/WinkerDu/spark/assignees{/user},https://api.github.com/repos/WinkerDu/spark/branches{/branch},https://api.github.com/repos/WinkerDu/spark/tags,https://api.github.com/repos/WinkerDu/spark/git/blobs{/sha},https://api.github.com/repos/WinkerDu/spark/git/tags{/sha},https://api.github.com/repos/WinkerDu/spark/git/refs{/sha},https://api.github.com/repos/WinkerDu/spark/git/trees{/sha},https://api.github.com/repos/WinkerDu/spark/statuses/{sha},https://api.github.com/repos/WinkerDu/spark/languages,https://api.github.com/repos/WinkerDu/spark/stargazers,https://api.github.com/repos/WinkerDu/spark/contributors,https://api.github.com/repos/WinkerDu/spark/subscribers,https://api.github.com/repos/WinkerDu/spark/subscription,https://api.github.com/repos/WinkerDu/spark/commits{/sha},https://api.github.com/repos/WinkerDu/spark/git/commits{/sha},https://api.github.com/repos/WinkerDu/spark/comments{/number},https://api.github.com/repos/WinkerDu/spark/issues/comments{/number},https://api.github.com/repos/WinkerDu/spark/contents/{+path},https://api.github.com/repos/WinkerDu/spark/compare/{base}...{head},https://api.github.com/repos/WinkerDu/spark/merges,https://api.github.com/repos/WinkerDu/spark/{archive_format}{/ref},https://api.github.com/repos/WinkerDu/spark/downloads,https://api.github.com/repos/WinkerDu/spark/issues{/number},https://api.github.com/repos/WinkerDu/spark/pulls{/number},https://api.github.com/repos/WinkerDu/spark/milestones{/number},"https://api.github.com/repos/WinkerDu/spark/notifications{?since,all,participating}",https://api.github.com/repos/WinkerDu/spark/labels{/name},https://api.github.com/repos/WinkerDu/spark/releases{/id},https://api.github.com/repos/WinkerDu/spark/deployments,2019-12-20T15:00:27Z,2020-02-21T20:08:43Z,2020-02-21T20:07:39Z,git://github.com/WinkerDu/spark.git,git@github.com:WinkerDu/spark.git,https://github.com/WinkerDu/spark.git,https://github.com/WinkerDu/spark,,321469,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,274b328f57a626bb770c9831ae81034d060a7e1e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26971,https://github.com/apache/spark/pull/26971,https://api.github.com/repos/apache/spark/issues/26971,https://api.github.com/repos/apache/spark/issues/26971/comments,https://api.github.com/repos/apache/spark/pulls/26971/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26971/commits,https://api.github.com/repos/apache/spark/statuses/2c873dbae136904f086a23290c29a5559ce8d14f
178,https://api.github.com/repos/apache/spark/pulls/26969,355773729,MDExOlB1bGxSZXF1ZXN0MzU1NzczNzI5,https://github.com/apache/spark/pull/26969,https://github.com/apache/spark/pull/26969.diff,https://github.com/apache/spark/pull/26969.patch,https://api.github.com/repos/apache/spark/issues/26969,26969,open,False,[SPARK-30319][SQL] Add a stricter version of `as[T]`,"### What changes were proposed in this pull request?
Some aspects of `as[T]` are not intuitive and expected behaviour is not provided elsewhere:
* Extra columns that are not part of the type `T` are not dropped.
* Order of columns is not aligned with schema of `T`.

**This PR adds a stricter version of `as[T]` to `Dataset`.** 

### Why are the changes needed?
The behaviour of `as[T]` is not intuitive when you read code like `df.as[T].write.csv(""data.csv"")`. The result depends on the actual schema of `df`, where `def as[T](): Dataset[T]` should be agnostic to the schema of `df`.

A method that enforces schema of `T` on a given Dataset would be very convenient and allows to articulate and guarantee above assumptions about your data with the native Spark Dataset API. This method plays a more explicit and enforcing role than `as[T]` with respect to columns and column order.

### Does this PR introduce any user-facing change?
Yes, it adds a new method to `Dataset`. It does not touch the existing `as[T]`.

Possible naming of a stricter version of `as[T]`:
* `as[T](strict = true)`
* `toDS[T]` (as in `toDF`)
* `selectAs[T]` (as this is merely selecting the columns of schema `T`)

This PR chooses the `toDS[T]` naming.

### How was this patch tested?
Existing tests for `as[T]` have been extended to assert the actual schema and emphasize the differences between `as[T]` and `toDS[T]`. Tests for `toDS[T]` are based on the `as[T]` tests.",2019-12-20T15:19:42Z,2020-02-24T13:56:22Z,,,463ced78f2c862defd66914395baab8358601c1b,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26969/commits,https://api.github.com/repos/apache/spark/pulls/26969/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26969/comments,https://api.github.com/repos/apache/spark/statuses/e3658ba5247b61c6ad713545d8b85b2e93b94ba6,CONTRIBUTOR,spark,apache,EnricoMi,44700269,MDQ6VXNlcjQ0NzAwMjY5,https://avatars1.githubusercontent.com/u/44700269?v=4,,https://api.github.com/users/EnricoMi,https://github.com/EnricoMi,https://api.github.com/users/EnricoMi/followers,https://api.github.com/users/EnricoMi/following{/other_user},https://api.github.com/users/EnricoMi/gists{/gist_id},https://api.github.com/users/EnricoMi/starred{/owner}{/repo},https://api.github.com/users/EnricoMi/subscriptions,https://api.github.com/users/EnricoMi/orgs,https://api.github.com/users/EnricoMi/repos,https://api.github.com/users/EnricoMi/events{/privacy},https://api.github.com/users/EnricoMi/received_events,User,False,G-Research:branch-stricter-as,branch-stricter-as,e3658ba5247b61c6ad713545d8b85b2e93b94ba6,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,214350064,MDEwOlJlcG9zaXRvcnkyMTQzNTAwNjQ=,spark,G-Research/spark,False,G-Research,21341965,MDEyOk9yZ2FuaXphdGlvbjIxMzQxOTY1,https://avatars0.githubusercontent.com/u/21341965?v=4,,https://api.github.com/users/G-Research,https://github.com/G-Research,https://api.github.com/users/G-Research/followers,https://api.github.com/users/G-Research/following{/other_user},https://api.github.com/users/G-Research/gists{/gist_id},https://api.github.com/users/G-Research/starred{/owner}{/repo},https://api.github.com/users/G-Research/subscriptions,https://api.github.com/users/G-Research/orgs,https://api.github.com/users/G-Research/repos,https://api.github.com/users/G-Research/events{/privacy},https://api.github.com/users/G-Research/received_events,Organization,False,https://github.com/G-Research/spark,Apache Spark,True,https://api.github.com/repos/G-Research/spark,https://api.github.com/repos/G-Research/spark/forks,https://api.github.com/repos/G-Research/spark/keys{/key_id},https://api.github.com/repos/G-Research/spark/collaborators{/collaborator},https://api.github.com/repos/G-Research/spark/teams,https://api.github.com/repos/G-Research/spark/hooks,https://api.github.com/repos/G-Research/spark/issues/events{/number},https://api.github.com/repos/G-Research/spark/events,https://api.github.com/repos/G-Research/spark/assignees{/user},https://api.github.com/repos/G-Research/spark/branches{/branch},https://api.github.com/repos/G-Research/spark/tags,https://api.github.com/repos/G-Research/spark/git/blobs{/sha},https://api.github.com/repos/G-Research/spark/git/tags{/sha},https://api.github.com/repos/G-Research/spark/git/refs{/sha},https://api.github.com/repos/G-Research/spark/git/trees{/sha},https://api.github.com/repos/G-Research/spark/statuses/{sha},https://api.github.com/repos/G-Research/spark/languages,https://api.github.com/repos/G-Research/spark/stargazers,https://api.github.com/repos/G-Research/spark/contributors,https://api.github.com/repos/G-Research/spark/subscribers,https://api.github.com/repos/G-Research/spark/subscription,https://api.github.com/repos/G-Research/spark/commits{/sha},https://api.github.com/repos/G-Research/spark/git/commits{/sha},https://api.github.com/repos/G-Research/spark/comments{/number},https://api.github.com/repos/G-Research/spark/issues/comments{/number},https://api.github.com/repos/G-Research/spark/contents/{+path},https://api.github.com/repos/G-Research/spark/compare/{base}...{head},https://api.github.com/repos/G-Research/spark/merges,https://api.github.com/repos/G-Research/spark/{archive_format}{/ref},https://api.github.com/repos/G-Research/spark/downloads,https://api.github.com/repos/G-Research/spark/issues{/number},https://api.github.com/repos/G-Research/spark/pulls{/number},https://api.github.com/repos/G-Research/spark/milestones{/number},"https://api.github.com/repos/G-Research/spark/notifications{?since,all,participating}",https://api.github.com/repos/G-Research/spark/labels{/name},https://api.github.com/repos/G-Research/spark/releases{/id},https://api.github.com/repos/G-Research/spark/deployments,2019-10-11T05:23:46Z,2020-02-11T16:12:31Z,2020-03-05T09:46:15Z,git://github.com/G-Research/spark.git,git@github.com:G-Research/spark.git,https://github.com/G-Research/spark.git,https://github.com/G-Research/spark,,322153,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2330a5682d376c21b73dbdf5ea10e253941e8cc8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26969,https://github.com/apache/spark/pull/26969,https://api.github.com/repos/apache/spark/issues/26969,https://api.github.com/repos/apache/spark/issues/26969/comments,https://api.github.com/repos/apache/spark/pulls/26969/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26969/commits,https://api.github.com/repos/apache/spark/statuses/e3658ba5247b61c6ad713545d8b85b2e93b94ba6
179,https://api.github.com/repos/apache/spark/pulls/26953,355197161,MDExOlB1bGxSZXF1ZXN0MzU1MTk3MTYx,https://github.com/apache/spark/pull/26953,https://github.com/apache/spark/pull/26953.diff,https://github.com/apache/spark/pull/26953.patch,https://api.github.com/repos/apache/spark/issues/26953,26953,open,False,[SPARK-30306][CORE][PYTHON] Instrument Python UDF execution time and throughput metrics using Spark Metrics system,"### What changes were proposed in this pull request?
This proposes to extend Spark instrumentation to add metrics aimed at drilling down on the performance of Python code called by Spark: via UDF, Pandas UDF or with MapPartittions. Relevant performance counters, notably exuction time, are exposed using the Spark Metrics System (based on the Dropwizard library).

### Why are the changes needed?
This allows to easily consume the metrics produced by executors, for example using a performance dashboard (this references to previous work as discucssed in https://db-blog.web.cern.ch/blog/luca-canali/2019-02-performance-dashboard-apache-spark ).
See also the screenshot that compares the existing state (no Python UDF time instrumentation) to the proposed new functionality ![](https://issues.apache.org/jira/secure/attachment/12989201/PandasUDF_Time_Instrumentation_Annotated.png)

### Does this PR introduce any user-facing change?
This PR adds the PythonMetrics source to the Spark Metrics system. The list of the implemented metrics has been added to the Monitoring documentation.

### How was this patch tested?
Added relevant tests
+ manually tested end-to-end on a YARN cluster and using an existing Spark dashboard extended with the metrics proposed here.",2019-12-19T15:16:26Z,2020-03-25T12:28:45Z,,,85296a7983b38e0404761c7041551cfd6ab37fa0,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26953/commits,https://api.github.com/repos/apache/spark/pulls/26953/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26953/comments,https://api.github.com/repos/apache/spark/statuses/989dba136ef6dc3d12a64765f524b19fe89af0ce,CONTRIBUTOR,spark,apache,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,LucaCanali:PythonUDFInstrumentation,PythonUDFInstrumentation,989dba136ef6dc3d12a64765f524b19fe89af0ce,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,145986175,MDEwOlJlcG9zaXRvcnkxNDU5ODYxNzU=,spark,LucaCanali/spark,False,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,https://github.com/LucaCanali/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LucaCanali/spark,https://api.github.com/repos/LucaCanali/spark/forks,https://api.github.com/repos/LucaCanali/spark/keys{/key_id},https://api.github.com/repos/LucaCanali/spark/collaborators{/collaborator},https://api.github.com/repos/LucaCanali/spark/teams,https://api.github.com/repos/LucaCanali/spark/hooks,https://api.github.com/repos/LucaCanali/spark/issues/events{/number},https://api.github.com/repos/LucaCanali/spark/events,https://api.github.com/repos/LucaCanali/spark/assignees{/user},https://api.github.com/repos/LucaCanali/spark/branches{/branch},https://api.github.com/repos/LucaCanali/spark/tags,https://api.github.com/repos/LucaCanali/spark/git/blobs{/sha},https://api.github.com/repos/LucaCanali/spark/git/tags{/sha},https://api.github.com/repos/LucaCanali/spark/git/refs{/sha},https://api.github.com/repos/LucaCanali/spark/git/trees{/sha},https://api.github.com/repos/LucaCanali/spark/statuses/{sha},https://api.github.com/repos/LucaCanali/spark/languages,https://api.github.com/repos/LucaCanali/spark/stargazers,https://api.github.com/repos/LucaCanali/spark/contributors,https://api.github.com/repos/LucaCanali/spark/subscribers,https://api.github.com/repos/LucaCanali/spark/subscription,https://api.github.com/repos/LucaCanali/spark/commits{/sha},https://api.github.com/repos/LucaCanali/spark/git/commits{/sha},https://api.github.com/repos/LucaCanali/spark/comments{/number},https://api.github.com/repos/LucaCanali/spark/issues/comments{/number},https://api.github.com/repos/LucaCanali/spark/contents/{+path},https://api.github.com/repos/LucaCanali/spark/compare/{base}...{head},https://api.github.com/repos/LucaCanali/spark/merges,https://api.github.com/repos/LucaCanali/spark/{archive_format}{/ref},https://api.github.com/repos/LucaCanali/spark/downloads,https://api.github.com/repos/LucaCanali/spark/issues{/number},https://api.github.com/repos/LucaCanali/spark/pulls{/number},https://api.github.com/repos/LucaCanali/spark/milestones{/number},"https://api.github.com/repos/LucaCanali/spark/notifications{?since,all,participating}",https://api.github.com/repos/LucaCanali/spark/labels{/name},https://api.github.com/repos/LucaCanali/spark/releases{/id},https://api.github.com/repos/LucaCanali/spark/deployments,2018-08-24T12:02:34Z,2020-03-30T12:48:12Z,2020-03-30T13:53:50Z,git://github.com/LucaCanali/spark.git,git@github.com:LucaCanali/spark.git,https://github.com/LucaCanali/spark.git,https://github.com/LucaCanali/spark,,319411,0,0,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,0,master,apache:master,master,7db0af578585ecaeee9fd23f8189292289b52a97,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26953,https://github.com/apache/spark/pull/26953,https://api.github.com/repos/apache/spark/issues/26953,https://api.github.com/repos/apache/spark/issues/26953/comments,https://api.github.com/repos/apache/spark/pulls/26953/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26953/commits,https://api.github.com/repos/apache/spark/statuses/989dba136ef6dc3d12a64765f524b19fe89af0ce
180,https://api.github.com/repos/apache/spark/pulls/26935,354503859,MDExOlB1bGxSZXF1ZXN0MzU0NTAzODU5,https://github.com/apache/spark/pull/26935,https://github.com/apache/spark/pull/26935.diff,https://github.com/apache/spark/pull/26935.patch,https://api.github.com/repos/apache/spark/issues/26935,26935,open,False,[SPARK-30294][SS] Explicitly defines read-only StateStore and optimize for HDFSBackedStateStore,"### What changes were proposed in this pull request?

There's a concept of 'read-only' and 'read+write' state store in Spark which is defined ""implicitly"". Spark doesn't prevent write for 'read-only' state store; Spark just assumes read-only stateful operator will not modify the state store. Given it's not defined explicitly, the instance of state store has to be implemented as 'read+write' even it's being used as 'read-only', which sometimes brings confusion.

For example, abort() in HDFSBackedStateStore - https://github.com/apache/spark/blob/d38f8167483d4d79e8360f24a8c0bffd51460659/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/state/HDFSBackedStateStoreProvider.scala#L143-L155

The comment sounds as if statement works differently between 'read-only' and 'read+write', but that's not true as both state store has state initialized as UPDATING (no difference). So 'read-only' state also creates the temporary file, initializes output streams to write to temporary file, closes output streams, and finally deletes the temporary file. This unnecessary operations are being done per batch/partition.

This patch explicitly defines 'read-only' StateStore, and enables state store provider to create 'read-only' StateStore instance if requested. Relevant code paths are modified, as well as 'read-only' StateStore implementation for HDFSBackedStateStore is introduced. The new implementation gets rid of unnecessary operations explained above.

In point of backward-compatibility view, the only thing being changed in public API side is `StateStoreProvider`. The trait `StateStoreProvider` has to be changed to allow requesting 'read-only' StateStore; this patch adds default implementation which leverages 'read+write' StateStore but wrapping with 'write-protected' StateStore instance, so that custom providers don't need to change their code to reflect the change. But if the providers can optimize for read-only workload, they'll be happy to make a change.

Please note that this patch makes ReadOnlyStateStore extend StateStore and being referred as StateStore, as StateStore is being used in so many places and it's not easy to support both traits if we differentiate them. So unfortunately these write methods are still exposed for read-only state; it just throws UnsupportedOperationException.

### Why are the changes needed?

The new API opens the chance to optimize read-only state store instance compared with read+write state store instance. HDFSBackedStateStoreProvider is modified to provide read-only version of state store which doesn't deal with temporary file as well as state machine.

### Does this PR introduce any user-facing change?

Clearly ""no"" for most end users, and also ""no"" for custom state store providers as it doesn't touch trait `StateStore` as well as provides default implementation for added method in trait `StateStoreProvider`.

### How was this patch tested?

Modified UT. Existing UTs ensure the change doesn't break anything.",2019-12-18T09:08:07Z,2020-03-31T13:10:05Z,,,3d61b2127bc83d42b1023567ea681d19b2e8a0ba,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26935/commits,https://api.github.com/repos/apache/spark/pulls/26935/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26935/comments,https://api.github.com/repos/apache/spark/statuses/895fe068bd3b32ed70ef84cc68e3352306099214,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-30294,SPARK-30294,895fe068bd3b32ed70ef84cc68e3352306099214,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,d38f8167483d4d79e8360f24a8c0bffd51460659,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26935,https://github.com/apache/spark/pull/26935,https://api.github.com/repos/apache/spark/issues/26935,https://api.github.com/repos/apache/spark/issues/26935/comments,https://api.github.com/repos/apache/spark/pulls/26935/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26935/commits,https://api.github.com/repos/apache/spark/statuses/895fe068bd3b32ed70ef84cc68e3352306099214
181,https://api.github.com/repos/apache/spark/pulls/26912,353740375,MDExOlB1bGxSZXF1ZXN0MzUzNzQwMzc1,https://github.com/apache/spark/pull/26912,https://github.com/apache/spark/pull/26912.diff,https://github.com/apache/spark/pull/26912.patch,https://api.github.com/repos/apache/spark/issues/26912,26912,open,False,[SPARK-30273] [PySpark] Add melt() function,"### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

- Adds `melt()` functionality common to Pandas


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

- It's common for users to copy and paste code from [this](https://issues.apache.org/jira/browse/SPARK-30273) answer into their own systems.  This method belongs in the PySpark API

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
- Exposes a new `melt()` method in the DataFrame class


### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
- As from [SO response](https://stackoverflow.com/a/41673644/12474509)

https://issues.apache.org/jira/browse/SPARK-30273
",2019-12-16T20:10:23Z,2020-02-05T18:13:55Z,,,d3b02e662b99901ff3639c316643b287376c4680,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26912/commits,https://api.github.com/repos/apache/spark/pulls/26912/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26912/comments,https://api.github.com/repos/apache/spark/statuses/dbab2a651053c34bf3913ca29e243384ffda364e,NONE,spark,apache,vanhooser,6209145,MDQ6VXNlcjYyMDkxNDU=,https://avatars0.githubusercontent.com/u/6209145?v=4,,https://api.github.com/users/vanhooser,https://github.com/vanhooser,https://api.github.com/users/vanhooser/followers,https://api.github.com/users/vanhooser/following{/other_user},https://api.github.com/users/vanhooser/gists{/gist_id},https://api.github.com/users/vanhooser/starred{/owner}{/repo},https://api.github.com/users/vanhooser/subscriptions,https://api.github.com/users/vanhooser/orgs,https://api.github.com/users/vanhooser/repos,https://api.github.com/users/vanhooser/events{/privacy},https://api.github.com/users/vanhooser/received_events,User,False,vanhooser:patch-2,patch-2,dbab2a651053c34bf3913ca29e243384ffda364e,vanhooser,6209145,MDQ6VXNlcjYyMDkxNDU=,https://avatars0.githubusercontent.com/u/6209145?v=4,,https://api.github.com/users/vanhooser,https://github.com/vanhooser,https://api.github.com/users/vanhooser/followers,https://api.github.com/users/vanhooser/following{/other_user},https://api.github.com/users/vanhooser/gists{/gist_id},https://api.github.com/users/vanhooser/starred{/owner}{/repo},https://api.github.com/users/vanhooser/subscriptions,https://api.github.com/users/vanhooser/orgs,https://api.github.com/users/vanhooser/repos,https://api.github.com/users/vanhooser/events{/privacy},https://api.github.com/users/vanhooser/received_events,User,False,227902080,MDEwOlJlcG9zaXRvcnkyMjc5MDIwODA=,spark,vanhooser/spark,False,vanhooser,6209145,MDQ6VXNlcjYyMDkxNDU=,https://avatars0.githubusercontent.com/u/6209145?v=4,,https://api.github.com/users/vanhooser,https://github.com/vanhooser,https://api.github.com/users/vanhooser/followers,https://api.github.com/users/vanhooser/following{/other_user},https://api.github.com/users/vanhooser/gists{/gist_id},https://api.github.com/users/vanhooser/starred{/owner}{/repo},https://api.github.com/users/vanhooser/subscriptions,https://api.github.com/users/vanhooser/orgs,https://api.github.com/users/vanhooser/repos,https://api.github.com/users/vanhooser/events{/privacy},https://api.github.com/users/vanhooser/received_events,User,False,https://github.com/vanhooser/spark,Apache Spark,True,https://api.github.com/repos/vanhooser/spark,https://api.github.com/repos/vanhooser/spark/forks,https://api.github.com/repos/vanhooser/spark/keys{/key_id},https://api.github.com/repos/vanhooser/spark/collaborators{/collaborator},https://api.github.com/repos/vanhooser/spark/teams,https://api.github.com/repos/vanhooser/spark/hooks,https://api.github.com/repos/vanhooser/spark/issues/events{/number},https://api.github.com/repos/vanhooser/spark/events,https://api.github.com/repos/vanhooser/spark/assignees{/user},https://api.github.com/repos/vanhooser/spark/branches{/branch},https://api.github.com/repos/vanhooser/spark/tags,https://api.github.com/repos/vanhooser/spark/git/blobs{/sha},https://api.github.com/repos/vanhooser/spark/git/tags{/sha},https://api.github.com/repos/vanhooser/spark/git/refs{/sha},https://api.github.com/repos/vanhooser/spark/git/trees{/sha},https://api.github.com/repos/vanhooser/spark/statuses/{sha},https://api.github.com/repos/vanhooser/spark/languages,https://api.github.com/repos/vanhooser/spark/stargazers,https://api.github.com/repos/vanhooser/spark/contributors,https://api.github.com/repos/vanhooser/spark/subscribers,https://api.github.com/repos/vanhooser/spark/subscription,https://api.github.com/repos/vanhooser/spark/commits{/sha},https://api.github.com/repos/vanhooser/spark/git/commits{/sha},https://api.github.com/repos/vanhooser/spark/comments{/number},https://api.github.com/repos/vanhooser/spark/issues/comments{/number},https://api.github.com/repos/vanhooser/spark/contents/{+path},https://api.github.com/repos/vanhooser/spark/compare/{base}...{head},https://api.github.com/repos/vanhooser/spark/merges,https://api.github.com/repos/vanhooser/spark/{archive_format}{/ref},https://api.github.com/repos/vanhooser/spark/downloads,https://api.github.com/repos/vanhooser/spark/issues{/number},https://api.github.com/repos/vanhooser/spark/pulls{/number},https://api.github.com/repos/vanhooser/spark/milestones{/number},"https://api.github.com/repos/vanhooser/spark/notifications{?since,all,participating}",https://api.github.com/repos/vanhooser/spark/labels{/name},https://api.github.com/repos/vanhooser/spark/releases{/id},https://api.github.com/repos/vanhooser/spark/deployments,2019-12-13T18:46:08Z,2019-12-13T18:46:11Z,2019-12-16T21:12:18Z,git://github.com/vanhooser/spark.git,git@github.com:vanhooser/spark.git,https://github.com/vanhooser/spark.git,https://github.com/vanhooser/spark,,320904,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,b573f23ed18a19e5ca2b51e3a452d2d5f716729d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26912,https://github.com/apache/spark/pull/26912,https://api.github.com/repos/apache/spark/issues/26912,https://api.github.com/repos/apache/spark/issues/26912/comments,https://api.github.com/repos/apache/spark/pulls/26912/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26912/commits,https://api.github.com/repos/apache/spark/statuses/dbab2a651053c34bf3913ca29e243384ffda364e
182,https://api.github.com/repos/apache/spark/pulls/26901,353350283,MDExOlB1bGxSZXF1ZXN0MzUzMzUwMjgz,https://github.com/apache/spark/pull/26901,https://github.com/apache/spark/pull/26901.diff,https://github.com/apache/spark/pull/26901.patch,https://api.github.com/repos/apache/spark/issues/26901,26901,open,False,[SPARK-29152][CORE][2.4] Executor Plugin shutdown when dynamic allocation is enabled,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
Before Killing executors, added a call to those executors to stop themselves. 
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?
`ExecutorAllocationManager` calls `removeExecutors` which kills executors without calling the stop() of executors. Due to this executor plugin's shutdown is never called. 
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No.
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?

Manually
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
",2019-12-16T02:41:31Z,2020-04-09T17:53:06Z,,,97dce337f682ada3ebb1e0e16825648e8944d3a2,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26901/commits,https://api.github.com/repos/apache/spark/pulls/26901/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26901/comments,https://api.github.com/repos/apache/spark/statuses/c7e969abe4c85bc3948ff9cc247ef3fc32044043,CONTRIBUTOR,spark,apache,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,iRakson:SPARK-29152_2.4,SPARK-29152_2.4,c7e969abe4c85bc3948ff9cc247ef3fc32044043,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,205127207,MDEwOlJlcG9zaXRvcnkyMDUxMjcyMDc=,spark,iRakson/spark,False,iRakson,15366835,MDQ6VXNlcjE1MzY2ODM1,https://avatars2.githubusercontent.com/u/15366835?v=4,,https://api.github.com/users/iRakson,https://github.com/iRakson,https://api.github.com/users/iRakson/followers,https://api.github.com/users/iRakson/following{/other_user},https://api.github.com/users/iRakson/gists{/gist_id},https://api.github.com/users/iRakson/starred{/owner}{/repo},https://api.github.com/users/iRakson/subscriptions,https://api.github.com/users/iRakson/orgs,https://api.github.com/users/iRakson/repos,https://api.github.com/users/iRakson/events{/privacy},https://api.github.com/users/iRakson/received_events,User,False,https://github.com/iRakson/spark,Apache Spark,True,https://api.github.com/repos/iRakson/spark,https://api.github.com/repos/iRakson/spark/forks,https://api.github.com/repos/iRakson/spark/keys{/key_id},https://api.github.com/repos/iRakson/spark/collaborators{/collaborator},https://api.github.com/repos/iRakson/spark/teams,https://api.github.com/repos/iRakson/spark/hooks,https://api.github.com/repos/iRakson/spark/issues/events{/number},https://api.github.com/repos/iRakson/spark/events,https://api.github.com/repos/iRakson/spark/assignees{/user},https://api.github.com/repos/iRakson/spark/branches{/branch},https://api.github.com/repos/iRakson/spark/tags,https://api.github.com/repos/iRakson/spark/git/blobs{/sha},https://api.github.com/repos/iRakson/spark/git/tags{/sha},https://api.github.com/repos/iRakson/spark/git/refs{/sha},https://api.github.com/repos/iRakson/spark/git/trees{/sha},https://api.github.com/repos/iRakson/spark/statuses/{sha},https://api.github.com/repos/iRakson/spark/languages,https://api.github.com/repos/iRakson/spark/stargazers,https://api.github.com/repos/iRakson/spark/contributors,https://api.github.com/repos/iRakson/spark/subscribers,https://api.github.com/repos/iRakson/spark/subscription,https://api.github.com/repos/iRakson/spark/commits{/sha},https://api.github.com/repos/iRakson/spark/git/commits{/sha},https://api.github.com/repos/iRakson/spark/comments{/number},https://api.github.com/repos/iRakson/spark/issues/comments{/number},https://api.github.com/repos/iRakson/spark/contents/{+path},https://api.github.com/repos/iRakson/spark/compare/{base}...{head},https://api.github.com/repos/iRakson/spark/merges,https://api.github.com/repos/iRakson/spark/{archive_format}{/ref},https://api.github.com/repos/iRakson/spark/downloads,https://api.github.com/repos/iRakson/spark/issues{/number},https://api.github.com/repos/iRakson/spark/pulls{/number},https://api.github.com/repos/iRakson/spark/milestones{/number},"https://api.github.com/repos/iRakson/spark/notifications{?since,all,participating}",https://api.github.com/repos/iRakson/spark/labels{/name},https://api.github.com/repos/iRakson/spark/releases{/id},https://api.github.com/repos/iRakson/spark/deployments,2019-08-29T09:22:50Z,2019-10-23T11:47:43Z,2020-04-10T09:12:57Z,git://github.com/iRakson/spark.git,git@github.com:iRakson/spark.git,https://github.com/iRakson/spark.git,https://github.com/iRakson/spark,,325766,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:branch-2.4,branch-2.4,965757572bd4bfd04d6f547a6094d9b2891b34d6,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26901,https://github.com/apache/spark/pull/26901,https://api.github.com/repos/apache/spark/issues/26901,https://api.github.com/repos/apache/spark/issues/26901/comments,https://api.github.com/repos/apache/spark/pulls/26901/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26901/commits,https://api.github.com/repos/apache/spark/statuses/c7e969abe4c85bc3948ff9cc247ef3fc32044043
183,https://api.github.com/repos/apache/spark/pulls/26870,352554017,MDExOlB1bGxSZXF1ZXN0MzUyNTU0MDE3,https://github.com/apache/spark/pull/26870,https://github.com/apache/spark/pull/26870.diff,https://github.com/apache/spark/pull/26870.patch,https://api.github.com/repos/apache/spark/issues/26870,26870,open,False,[SPARK-30137][CORE] Support delete file feature in spark,"
### What changes were proposed in this pull request?

Support Delete File semantics which will delete the given path from the `addedFiles` of sparkContext.


### Why are the changes needed?
User can delete the file if it is not required, so that for the next TaskSet this file won't be available. 


### Does this PR introduce any user-facing change?
Yes, new feature will be introduced to the user. Same will be updated in documentation as per the jira SPARK-30135


### How was this patch tested?
Added UT and also tested manually in the local cluster
",2019-12-12T18:34:54Z,2020-01-07T14:44:07Z,,,71936fcddfca17caa27becd07b3b67eb02a00c74,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26870/commits,https://api.github.com/repos/apache/spark/pulls/26870/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26870/comments,https://api.github.com/repos/apache/spark/statuses/f8175e3a7cbb59a3ac43c9b76fe01aafadd7fe50,CONTRIBUTOR,spark,apache,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,sandeep-katta:deleteFileSupport,deleteFileSupport,f8175e3a7cbb59a3ac43c9b76fe01aafadd7fe50,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,116654613,MDEwOlJlcG9zaXRvcnkxMTY2NTQ2MTM=,spark,sandeep-katta/spark,False,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,https://github.com/sandeep-katta/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sandeep-katta/spark,https://api.github.com/repos/sandeep-katta/spark/forks,https://api.github.com/repos/sandeep-katta/spark/keys{/key_id},https://api.github.com/repos/sandeep-katta/spark/collaborators{/collaborator},https://api.github.com/repos/sandeep-katta/spark/teams,https://api.github.com/repos/sandeep-katta/spark/hooks,https://api.github.com/repos/sandeep-katta/spark/issues/events{/number},https://api.github.com/repos/sandeep-katta/spark/events,https://api.github.com/repos/sandeep-katta/spark/assignees{/user},https://api.github.com/repos/sandeep-katta/spark/branches{/branch},https://api.github.com/repos/sandeep-katta/spark/tags,https://api.github.com/repos/sandeep-katta/spark/git/blobs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/tags{/sha},https://api.github.com/repos/sandeep-katta/spark/git/refs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/trees{/sha},https://api.github.com/repos/sandeep-katta/spark/statuses/{sha},https://api.github.com/repos/sandeep-katta/spark/languages,https://api.github.com/repos/sandeep-katta/spark/stargazers,https://api.github.com/repos/sandeep-katta/spark/contributors,https://api.github.com/repos/sandeep-katta/spark/subscribers,https://api.github.com/repos/sandeep-katta/spark/subscription,https://api.github.com/repos/sandeep-katta/spark/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/git/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/comments{/number},https://api.github.com/repos/sandeep-katta/spark/issues/comments{/number},https://api.github.com/repos/sandeep-katta/spark/contents/{+path},https://api.github.com/repos/sandeep-katta/spark/compare/{base}...{head},https://api.github.com/repos/sandeep-katta/spark/merges,https://api.github.com/repos/sandeep-katta/spark/{archive_format}{/ref},https://api.github.com/repos/sandeep-katta/spark/downloads,https://api.github.com/repos/sandeep-katta/spark/issues{/number},https://api.github.com/repos/sandeep-katta/spark/pulls{/number},https://api.github.com/repos/sandeep-katta/spark/milestones{/number},"https://api.github.com/repos/sandeep-katta/spark/notifications{?since,all,participating}",https://api.github.com/repos/sandeep-katta/spark/labels{/name},https://api.github.com/repos/sandeep-katta/spark/releases{/id},https://api.github.com/repos/sandeep-katta/spark/deployments,2018-01-08T09:11:40Z,2019-12-08T02:36:49Z,2020-01-30T13:59:01Z,git://github.com/sandeep-katta/spark.git,git@github.com:sandeep-katta/spark.git,https://github.com/sandeep-katta/spark.git,https://github.com/sandeep-katta/spark,,317028,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cada5beef72530fa699b5ec13d67261be37730e4,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26870,https://github.com/apache/spark/pull/26870,https://api.github.com/repos/apache/spark/issues/26870,https://api.github.com/repos/apache/spark/issues/26870/comments,https://api.github.com/repos/apache/spark/pulls/26870/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26870/commits,https://api.github.com/repos/apache/spark/statuses/f8175e3a7cbb59a3ac43c9b76fe01aafadd7fe50
184,https://api.github.com/repos/apache/spark/pulls/26832,351335625,MDExOlB1bGxSZXF1ZXN0MzUxMzM1NjI1,https://github.com/apache/spark/pull/26832,https://github.com/apache/spark/pull/26832.diff,https://github.com/apache/spark/pull/26832.patch,https://api.github.com/repos/apache/spark/issues/26832,26832,open,False,[SPARK-30202][ML][PYSPARK] impl QuantileTransform,"### What changes were proposed in this pull request?
Impl QuantileTransform, a non-parametric transformation to map the data to another
distribution
The impl followed scikit-learn' s impl, however there still are sereral differences:
1, use `QuantileSummaries` for approximation, no matter the size of dataset;
2, use linear interpolate, the logic is similar to existing `IsotonicRegression`, while scikit-learn use a bi-directional interpolate (the two methods only differ on a special case that  values are repeated in the features);
3, treat sparse vectors just like dense ones, while scikit-learn have two different logics for sparse and dense datasets.

### Why are the changes needed?
1, it is common to map the data to another desired distribution, and was already impled in scikit-learn
2, it is easy for parallelism

### Does this PR introduce any user-facing change?
Yes, a new model


### How was this patch tested?
added testsuites
",2019-12-10T11:18:40Z,2020-01-17T15:37:09Z,,,ef7aa5e51506548043ca38a2e0d48fd762936a63,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26832/commits,https://api.github.com/repos/apache/spark/pulls/26832/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26832/comments,https://api.github.com/repos/apache/spark/statuses/5545e1e066d8727406b511b4891fe86831353c30,CONTRIBUTOR,spark,apache,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,zhengruifeng:quantile_transform,quantile_transform,5545e1e066d8727406b511b4891fe86831353c30,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,51584791,MDEwOlJlcG9zaXRvcnk1MTU4NDc5MQ==,spark,zhengruifeng/spark,False,zhengruifeng,7322292,MDQ6VXNlcjczMjIyOTI=,https://avatars1.githubusercontent.com/u/7322292?v=4,,https://api.github.com/users/zhengruifeng,https://github.com/zhengruifeng,https://api.github.com/users/zhengruifeng/followers,https://api.github.com/users/zhengruifeng/following{/other_user},https://api.github.com/users/zhengruifeng/gists{/gist_id},https://api.github.com/users/zhengruifeng/starred{/owner}{/repo},https://api.github.com/users/zhengruifeng/subscriptions,https://api.github.com/users/zhengruifeng/orgs,https://api.github.com/users/zhengruifeng/repos,https://api.github.com/users/zhengruifeng/events{/privacy},https://api.github.com/users/zhengruifeng/received_events,User,False,https://github.com/zhengruifeng/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zhengruifeng/spark,https://api.github.com/repos/zhengruifeng/spark/forks,https://api.github.com/repos/zhengruifeng/spark/keys{/key_id},https://api.github.com/repos/zhengruifeng/spark/collaborators{/collaborator},https://api.github.com/repos/zhengruifeng/spark/teams,https://api.github.com/repos/zhengruifeng/spark/hooks,https://api.github.com/repos/zhengruifeng/spark/issues/events{/number},https://api.github.com/repos/zhengruifeng/spark/events,https://api.github.com/repos/zhengruifeng/spark/assignees{/user},https://api.github.com/repos/zhengruifeng/spark/branches{/branch},https://api.github.com/repos/zhengruifeng/spark/tags,https://api.github.com/repos/zhengruifeng/spark/git/blobs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/tags{/sha},https://api.github.com/repos/zhengruifeng/spark/git/refs{/sha},https://api.github.com/repos/zhengruifeng/spark/git/trees{/sha},https://api.github.com/repos/zhengruifeng/spark/statuses/{sha},https://api.github.com/repos/zhengruifeng/spark/languages,https://api.github.com/repos/zhengruifeng/spark/stargazers,https://api.github.com/repos/zhengruifeng/spark/contributors,https://api.github.com/repos/zhengruifeng/spark/subscribers,https://api.github.com/repos/zhengruifeng/spark/subscription,https://api.github.com/repos/zhengruifeng/spark/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/git/commits{/sha},https://api.github.com/repos/zhengruifeng/spark/comments{/number},https://api.github.com/repos/zhengruifeng/spark/issues/comments{/number},https://api.github.com/repos/zhengruifeng/spark/contents/{+path},https://api.github.com/repos/zhengruifeng/spark/compare/{base}...{head},https://api.github.com/repos/zhengruifeng/spark/merges,https://api.github.com/repos/zhengruifeng/spark/{archive_format}{/ref},https://api.github.com/repos/zhengruifeng/spark/downloads,https://api.github.com/repos/zhengruifeng/spark/issues{/number},https://api.github.com/repos/zhengruifeng/spark/pulls{/number},https://api.github.com/repos/zhengruifeng/spark/milestones{/number},"https://api.github.com/repos/zhengruifeng/spark/notifications{?since,all,participating}",https://api.github.com/repos/zhengruifeng/spark/labels{/name},https://api.github.com/repos/zhengruifeng/spark/releases{/id},https://api.github.com/repos/zhengruifeng/spark/deployments,2016-02-12T11:58:00Z,2020-02-07T03:38:20Z,2020-04-10T12:55:52Z,git://github.com/zhengruifeng/spark.git,git@github.com:zhengruifeng/spark.git,https://github.com/zhengruifeng/spark.git,https://github.com/zhengruifeng/spark,,305206,1,1,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,64fe192fef9bd2fd3c0fca536e569a8d5dfa78f8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26832,https://github.com/apache/spark/pull/26832,https://api.github.com/repos/apache/spark/issues/26832,https://api.github.com/repos/apache/spark/issues/26832/comments,https://api.github.com/repos/apache/spark/pulls/26832/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26832/commits,https://api.github.com/repos/apache/spark/statuses/5545e1e066d8727406b511b4891fe86831353c30
185,https://api.github.com/repos/apache/spark/pulls/26821,350908960,MDExOlB1bGxSZXF1ZXN0MzUwOTA4OTYw,https://github.com/apache/spark/pull/26821,https://github.com/apache/spark/pull/26821.diff,https://github.com/apache/spark/pull/26821.patch,https://api.github.com/repos/apache/spark/issues/26821,26821,open,False,[SPARK-20656][CORE]Support Incremental parsing of event logs in SHS,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
Currently loading application page from history server is time consuming, if the eventlog size is high. (Eg: ~47 minutes for a 18GB eventlog file). Currently, when there is any changes in event log, history server parses the entire eventLog even for smaller changes in eventLog. In this PR, we are supporting incremental parsing of event log by storing the in memory store to a hash map and will not close the store until it is valid.


### Why are the changes needed?
To speed up loading history server page
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
No
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?
Added UT, Manual tests and existing tests.

Created an eventLog of size ~2GB. Added a few more events. Loading time without the PR is ~1 minute and after the PR, it is around 2 secs.
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->",2019-12-09T19:03:13Z,2020-03-27T07:44:06Z,,,4124466c4cd8c9f66f58fbc1af929ddda05259ff,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26821/commits,https://api.github.com/repos/apache/spark/pulls/26821/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26821/comments,https://api.github.com/repos/apache/spark/statuses/b6b2c5a3cc46d25595bfa7e187846187dd5ac806,CONTRIBUTOR,spark,apache,shahidki31,23054875,MDQ6VXNlcjIzMDU0ODc1,https://avatars0.githubusercontent.com/u/23054875?v=4,,https://api.github.com/users/shahidki31,https://github.com/shahidki31,https://api.github.com/users/shahidki31/followers,https://api.github.com/users/shahidki31/following{/other_user},https://api.github.com/users/shahidki31/gists{/gist_id},https://api.github.com/users/shahidki31/starred{/owner}{/repo},https://api.github.com/users/shahidki31/subscriptions,https://api.github.com/users/shahidki31/orgs,https://api.github.com/users/shahidki31/repos,https://api.github.com/users/shahidki31/events{/privacy},https://api.github.com/users/shahidki31/received_events,User,False,shahidki31:incrimentalParsing,incrimentalParsing,b6b2c5a3cc46d25595bfa7e187846187dd5ac806,shahidki31,23054875,MDQ6VXNlcjIzMDU0ODc1,https://avatars0.githubusercontent.com/u/23054875?v=4,,https://api.github.com/users/shahidki31,https://github.com/shahidki31,https://api.github.com/users/shahidki31/followers,https://api.github.com/users/shahidki31/following{/other_user},https://api.github.com/users/shahidki31/gists{/gist_id},https://api.github.com/users/shahidki31/starred{/owner}{/repo},https://api.github.com/users/shahidki31/subscriptions,https://api.github.com/users/shahidki31/orgs,https://api.github.com/users/shahidki31/repos,https://api.github.com/users/shahidki31/events{/privacy},https://api.github.com/users/shahidki31/received_events,User,False,104183844,MDEwOlJlcG9zaXRvcnkxMDQxODM4NDQ=,spark,shahidki31/spark,False,shahidki31,23054875,MDQ6VXNlcjIzMDU0ODc1,https://avatars0.githubusercontent.com/u/23054875?v=4,,https://api.github.com/users/shahidki31,https://github.com/shahidki31,https://api.github.com/users/shahidki31/followers,https://api.github.com/users/shahidki31/following{/other_user},https://api.github.com/users/shahidki31/gists{/gist_id},https://api.github.com/users/shahidki31/starred{/owner}{/repo},https://api.github.com/users/shahidki31/subscriptions,https://api.github.com/users/shahidki31/orgs,https://api.github.com/users/shahidki31/repos,https://api.github.com/users/shahidki31/events{/privacy},https://api.github.com/users/shahidki31/received_events,User,False,https://github.com/shahidki31/spark,Mirror of Apache Spark,True,https://api.github.com/repos/shahidki31/spark,https://api.github.com/repos/shahidki31/spark/forks,https://api.github.com/repos/shahidki31/spark/keys{/key_id},https://api.github.com/repos/shahidki31/spark/collaborators{/collaborator},https://api.github.com/repos/shahidki31/spark/teams,https://api.github.com/repos/shahidki31/spark/hooks,https://api.github.com/repos/shahidki31/spark/issues/events{/number},https://api.github.com/repos/shahidki31/spark/events,https://api.github.com/repos/shahidki31/spark/assignees{/user},https://api.github.com/repos/shahidki31/spark/branches{/branch},https://api.github.com/repos/shahidki31/spark/tags,https://api.github.com/repos/shahidki31/spark/git/blobs{/sha},https://api.github.com/repos/shahidki31/spark/git/tags{/sha},https://api.github.com/repos/shahidki31/spark/git/refs{/sha},https://api.github.com/repos/shahidki31/spark/git/trees{/sha},https://api.github.com/repos/shahidki31/spark/statuses/{sha},https://api.github.com/repos/shahidki31/spark/languages,https://api.github.com/repos/shahidki31/spark/stargazers,https://api.github.com/repos/shahidki31/spark/contributors,https://api.github.com/repos/shahidki31/spark/subscribers,https://api.github.com/repos/shahidki31/spark/subscription,https://api.github.com/repos/shahidki31/spark/commits{/sha},https://api.github.com/repos/shahidki31/spark/git/commits{/sha},https://api.github.com/repos/shahidki31/spark/comments{/number},https://api.github.com/repos/shahidki31/spark/issues/comments{/number},https://api.github.com/repos/shahidki31/spark/contents/{+path},https://api.github.com/repos/shahidki31/spark/compare/{base}...{head},https://api.github.com/repos/shahidki31/spark/merges,https://api.github.com/repos/shahidki31/spark/{archive_format}{/ref},https://api.github.com/repos/shahidki31/spark/downloads,https://api.github.com/repos/shahidki31/spark/issues{/number},https://api.github.com/repos/shahidki31/spark/pulls{/number},https://api.github.com/repos/shahidki31/spark/milestones{/number},"https://api.github.com/repos/shahidki31/spark/notifications{?since,all,participating}",https://api.github.com/repos/shahidki31/spark/labels{/name},https://api.github.com/repos/shahidki31/spark/releases{/id},https://api.github.com/repos/shahidki31/spark/deployments,2017-09-20T07:51:04Z,2019-08-16T03:38:24Z,2019-12-16T19:28:34Z,git://github.com/shahidki31/spark.git,git@github.com:shahidki31/spark.git,https://github.com/shahidki31/spark.git,https://github.com/shahidki31/spark,,317568,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,36fa1980c24c5c697982b107c8f9714f3eb57f36,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26821,https://github.com/apache/spark/pull/26821,https://api.github.com/repos/apache/spark/issues/26821,https://api.github.com/repos/apache/spark/issues/26821/comments,https://api.github.com/repos/apache/spark/pulls/26821/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26821/commits,https://api.github.com/repos/apache/spark/statuses/b6b2c5a3cc46d25595bfa7e187846187dd5ac806
186,https://api.github.com/repos/apache/spark/pulls/26816,350734962,MDExOlB1bGxSZXF1ZXN0MzUwNzM0OTYy,https://github.com/apache/spark/pull/26816,https://github.com/apache/spark/pull/26816.diff,https://github.com/apache/spark/pull/26816.patch,https://api.github.com/repos/apache/spark/issues/26816,26816,open,False,[SPARK-30191][YARN] optimize yarn allocator,"### What changes were proposed in this pull request?
add the factor `numExecutorsExiting` in YarnAllocator's method `updateResourceRequests` 

### Why are the changes needed?
when driver lost its executors because of machine hardware problem and all of service includes nodemanager, executor on the node has been killed,  it means that Resourcemanager can't update the containers info on the node until Resourcemanager try to remove the node,   but it always takes 10 mins or longger, and in the meantime, AM doesn't add the new resource request and driver missing executors. 
so maybe AM should add the factor `numExecutorsExiting` in YarnAllocator's method `updateResourceRequests`  to optimize it.


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No


### How was this patch tested?
add test(""lost executor removed from driver"") 
",2019-12-09T14:09:30Z,2020-03-16T13:33:14Z,,,c52e0d4b90b60d2f8aeba01aab399af93bc25192,,[],[],[],"[{'id': 1427970157, 'node_id': 'MDU6TGFiZWwxNDI3OTcwMTU3', 'url': 'https://api.github.com/repos/apache/spark/labels/YARN', 'name': 'YARN', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26816/commits,https://api.github.com/repos/apache/spark/pulls/26816/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26816/comments,https://api.github.com/repos/apache/spark/statuses/e4ae23caf4b96ab04eda25643af7febf0320c6fe,NONE,spark,apache,Neilxzn,10757009,MDQ6VXNlcjEwNzU3MDA5,https://avatars1.githubusercontent.com/u/10757009?v=4,,https://api.github.com/users/Neilxzn,https://github.com/Neilxzn,https://api.github.com/users/Neilxzn/followers,https://api.github.com/users/Neilxzn/following{/other_user},https://api.github.com/users/Neilxzn/gists{/gist_id},https://api.github.com/users/Neilxzn/starred{/owner}{/repo},https://api.github.com/users/Neilxzn/subscriptions,https://api.github.com/users/Neilxzn/orgs,https://api.github.com/users/Neilxzn/repos,https://api.github.com/users/Neilxzn/events{/privacy},https://api.github.com/users/Neilxzn/received_events,User,False,Neilxzn:fix_yarn_allocator,fix_yarn_allocator,e4ae23caf4b96ab04eda25643af7febf0320c6fe,Neilxzn,10757009,MDQ6VXNlcjEwNzU3MDA5,https://avatars1.githubusercontent.com/u/10757009?v=4,,https://api.github.com/users/Neilxzn,https://github.com/Neilxzn,https://api.github.com/users/Neilxzn/followers,https://api.github.com/users/Neilxzn/following{/other_user},https://api.github.com/users/Neilxzn/gists{/gist_id},https://api.github.com/users/Neilxzn/starred{/owner}{/repo},https://api.github.com/users/Neilxzn/subscriptions,https://api.github.com/users/Neilxzn/orgs,https://api.github.com/users/Neilxzn/repos,https://api.github.com/users/Neilxzn/events{/privacy},https://api.github.com/users/Neilxzn/received_events,User,False,170803565,MDEwOlJlcG9zaXRvcnkxNzA4MDM1NjU=,spark,Neilxzn/spark,False,Neilxzn,10757009,MDQ6VXNlcjEwNzU3MDA5,https://avatars1.githubusercontent.com/u/10757009?v=4,,https://api.github.com/users/Neilxzn,https://github.com/Neilxzn,https://api.github.com/users/Neilxzn/followers,https://api.github.com/users/Neilxzn/following{/other_user},https://api.github.com/users/Neilxzn/gists{/gist_id},https://api.github.com/users/Neilxzn/starred{/owner}{/repo},https://api.github.com/users/Neilxzn/subscriptions,https://api.github.com/users/Neilxzn/orgs,https://api.github.com/users/Neilxzn/repos,https://api.github.com/users/Neilxzn/events{/privacy},https://api.github.com/users/Neilxzn/received_events,User,False,https://github.com/Neilxzn/spark,Apache Spark,True,https://api.github.com/repos/Neilxzn/spark,https://api.github.com/repos/Neilxzn/spark/forks,https://api.github.com/repos/Neilxzn/spark/keys{/key_id},https://api.github.com/repos/Neilxzn/spark/collaborators{/collaborator},https://api.github.com/repos/Neilxzn/spark/teams,https://api.github.com/repos/Neilxzn/spark/hooks,https://api.github.com/repos/Neilxzn/spark/issues/events{/number},https://api.github.com/repos/Neilxzn/spark/events,https://api.github.com/repos/Neilxzn/spark/assignees{/user},https://api.github.com/repos/Neilxzn/spark/branches{/branch},https://api.github.com/repos/Neilxzn/spark/tags,https://api.github.com/repos/Neilxzn/spark/git/blobs{/sha},https://api.github.com/repos/Neilxzn/spark/git/tags{/sha},https://api.github.com/repos/Neilxzn/spark/git/refs{/sha},https://api.github.com/repos/Neilxzn/spark/git/trees{/sha},https://api.github.com/repos/Neilxzn/spark/statuses/{sha},https://api.github.com/repos/Neilxzn/spark/languages,https://api.github.com/repos/Neilxzn/spark/stargazers,https://api.github.com/repos/Neilxzn/spark/contributors,https://api.github.com/repos/Neilxzn/spark/subscribers,https://api.github.com/repos/Neilxzn/spark/subscription,https://api.github.com/repos/Neilxzn/spark/commits{/sha},https://api.github.com/repos/Neilxzn/spark/git/commits{/sha},https://api.github.com/repos/Neilxzn/spark/comments{/number},https://api.github.com/repos/Neilxzn/spark/issues/comments{/number},https://api.github.com/repos/Neilxzn/spark/contents/{+path},https://api.github.com/repos/Neilxzn/spark/compare/{base}...{head},https://api.github.com/repos/Neilxzn/spark/merges,https://api.github.com/repos/Neilxzn/spark/{archive_format}{/ref},https://api.github.com/repos/Neilxzn/spark/downloads,https://api.github.com/repos/Neilxzn/spark/issues{/number},https://api.github.com/repos/Neilxzn/spark/pulls{/number},https://api.github.com/repos/Neilxzn/spark/milestones{/number},"https://api.github.com/repos/Neilxzn/spark/notifications{?since,all,participating}",https://api.github.com/repos/Neilxzn/spark/labels{/name},https://api.github.com/repos/Neilxzn/spark/releases{/id},https://api.github.com/repos/Neilxzn/spark/deployments,2019-02-15T04:50:31Z,2019-02-19T14:24:01Z,2019-12-10T05:08:37Z,git://github.com/Neilxzn/spark.git,git@github.com:Neilxzn/spark.git,https://github.com/Neilxzn/spark.git,https://github.com/Neilxzn/spark,,317771,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a717d219a66d0e7b18b8ff392e1e03cd2781c457,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26816,https://github.com/apache/spark/pull/26816,https://api.github.com/repos/apache/spark/issues/26816,https://api.github.com/repos/apache/spark/issues/26816/comments,https://api.github.com/repos/apache/spark/pulls/26816/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26816/commits,https://api.github.com/repos/apache/spark/statuses/e4ae23caf4b96ab04eda25643af7febf0320c6fe
187,https://api.github.com/repos/apache/spark/pulls/26804,350549090,MDExOlB1bGxSZXF1ZXN0MzUwNTQ5MDkw,https://github.com/apache/spark/pull/26804,https://github.com/apache/spark/pull/26804.diff,https://github.com/apache/spark/pull/26804.patch,https://api.github.com/repos/apache/spark/issues/26804,26804,open,False,[WIP][SPARK-26346][BUILD][SQL] Upgrade parquet to 1.11.0,"### What changes were proposed in this pull request?

This PR upgrade parquet to 1.11.0.

Note that:
I just verify that all tests passed now. I will do a benchmark later.


### Why are the changes needed?



### Does this PR introduce any user-facing change?
Unknown


### How was this patch tested?

",2019-12-09T06:49:13Z,2020-01-28T21:29:29Z,,,e5deb2092c875e5f99be57419d0ae0ca4e9f4fc6,,[],"[{'login': 'rdblue', 'id': 87915, 'node_id': 'MDQ6VXNlcjg3OTE1', 'avatar_url': 'https://avatars1.githubusercontent.com/u/87915?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/rdblue', 'html_url': 'https://github.com/rdblue', 'followers_url': 'https://api.github.com/users/rdblue/followers', 'following_url': 'https://api.github.com/users/rdblue/following{/other_user}', 'gists_url': 'https://api.github.com/users/rdblue/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/rdblue/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/rdblue/subscriptions', 'organizations_url': 'https://api.github.com/users/rdblue/orgs', 'repos_url': 'https://api.github.com/users/rdblue/repos', 'events_url': 'https://api.github.com/users/rdblue/events{/privacy}', 'received_events_url': 'https://api.github.com/users/rdblue/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406627200, 'node_id': 'MDU6TGFiZWwxNDA2NjI3MjAw', 'url': 'https://api.github.com/repos/apache/spark/labels/BUILD', 'name': 'BUILD', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26804/commits,https://api.github.com/repos/apache/spark/pulls/26804/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26804/comments,https://api.github.com/repos/apache/spark/statuses/15d9f96528057874fc77f936dfc73a08f798ce77,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-26346,SPARK-26346,15d9f96528057874fc77f936dfc73a08f798ce77,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,f399d655c4f960646701d6feda578ee97705de99,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26804,https://github.com/apache/spark/pull/26804,https://api.github.com/repos/apache/spark/issues/26804,https://api.github.com/repos/apache/spark/issues/26804/comments,https://api.github.com/repos/apache/spark/pulls/26804/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26804/commits,https://api.github.com/repos/apache/spark/statuses/15d9f96528057874fc77f936dfc73a08f798ce77
188,https://api.github.com/repos/apache/spark/pulls/26783,350089066,MDExOlB1bGxSZXF1ZXN0MzUwMDg5MDY2,https://github.com/apache/spark/pull/26783,https://github.com/apache/spark/pull/26783.diff,https://github.com/apache/spark/pull/26783.patch,https://api.github.com/repos/apache/spark/issues/26783,26783,open,False,[SPARK-30153][PYTHON][WIP] Extend data exchange options for vectorized UDF functions with vanilla Arrow serialization,"### What changes were proposed in this pull request?
This proposes to extend data exchange options for vectorized UDF functions, by introducing the possibility to have plain Arrow serialization without conversions to Pandas. 
This PR proposes to introduce SCALAR_ARROW pandas_udf type as a step in that direction. As detailed in the test case below, the performance results are quite promising, in particular when processing data sets with numerical arrays, showing a speedup of 3x in the test case.

### Why are the changes needed?
Having the possibility to deploy vectorized Python UDFs that bypass the conversion to_pandas, can provide performance improvements (see test below) and extended flexibility (as the Arrow type system is broader than Pandas's) for operating data manipulation, in particular this is relevant for data sets including numerical arrays, possibly of variable length. While conversion to Pandas covers many cases already for vectorized Python UDF in a satisfying manner, the proposed improvement applies to certain special cases, notably of interested for scientific computing (such as in high energy physics), where performant processing of arrays of variable length is of paramount importance.

A test case shows a measured increase of performance of about 3x using the proposed approach, compared to the equivalent processing with pandas_udf (details below in the test section).  Processing of Arrow data in the test case was done via the ""awkward arrays"" library (https://github.com/scikit-hep/awkward-array).
In general, we can imagine that more specialized libraries using Arrow for data exchange can appear in the future to address computational needs in specific domains, possibly covering also cases of ML and DL libraries. It can be advantageous for Apache Spark to add the possibility to hook to such libraries, as proposed in the PR or with similar methods, for gains in performance and extra flexibility.

### Does this PR introduce any user-facing change?
This PR introduces an extension of pandas_udf types with a new SCALAR_ARROW type.

### How was this patch tested?
1. Manually tested:  a proposed ""SCALAR_ARROW"" pandas_udf test, detailed below, runs in 21 seconds vs. 62 seconds of the corresponding version with standard ""pandas_udf SCALAR"" code. This is close to a 3x speedup. The test is implemented using the awkward array library https://pypi.org/project/awkward/ for data processing, in alternative to Pandas:
```
bin/pyspark --master local[2]

df = sql(""select cast(1.0 as double) col1, rand(42) col2, Array(rand(),rand(),rand()) col3 from range(1e8)"")
df.printSchema()

root
 |-- col1: double (nullable = false)
 |-- col2: double (nullable = false)
 |-- col3: array (nullable = false)
 |    |-- element: double (containsNull = false)


from pyspark.sql.functions import pandas_udf, PandasUDFType
from pyspark.sql.types import *
import awkward

@pandas_udf(ArrayType(DoubleType()), PandasUDFType.SCALAR_ARROW)
def test_arrow(col1):
    b = awkward.fromarrow(col1.chunk(0))
    c = awkward.toarrow(b * b)
    return c 

// Note: following SPARK-28264 this can also be written as:
import pyarrow as pa
@pandas_udf(ArrayType(DoubleType()))
def test_arrow(col1: pa.ChunkedArray) -> pa.Array:
    b = awkward.fromarrow(col1.chunk(0))
    c = awkward.toarrow(b * b)
    return c 

import time
start = time.time()
df.withColumn('test', test_arrow(df.col3)).write.format(""noop"").mode(""overwrite"").save()
end = time.time()
print(end - start)
```

2. This is the reference code with pandas_udf SCALAR (this runs in 62 seconds vs. 21 seconds of the code above with SCALAR_ARROW implementation):
```
@pandas_udf(ArrayType(DoubleType()), PandasUDFType.SCALAR)
def test_pandas(col1):
  return col1*col1

import time
start = time.time()
df.withColumn('test', test_pandas(df.col3)).write.format(""noop"").mode(""overwrite"").save()
end = time.time()
print(end - start)
```

3. This is how the test workload can be implemented using Spark SQL (with higher order SQL functions). This test rund in 11 seconds
```
import time
start = time.time()
df.selectExpr(""col1"", ""col2"", ""col3"", ""transform(col3, x -> x * x) as test"").write.format(""noop"").mode(""overwrite"").save()
end = time.time()
print(end - start)
```

In conclusion the test workload runs 6x slower than Spark SQL with pandas_udf of type SCALAR, and 2x slower than Spark SQL with the proposed arrow-only serialization with SCALAR_PYARROW pandas_udf.

----
In addition, we collected and compared Flamegraph profiling of the Python code execution on the Python daemons, in the 2 Python UDF cases tested (SCALAR UDF and nthe proposed SCALAR_ARROW type). Results show that in the SCALAR case **an important amount of time is spent in the to_pandas conversion** operations and in array processing, the SCALAR_ARROW case optimizes processing of array data and avoid conversion to Pandas for array data, thus saving considerable time. 

This is a Flamegraph of workload on the Python daemon when running the pandas_udf SCALAR_ARROW:
![](https://issues.apache.org/jira/secure/attachment/12987761/Flamegraph_test_pandas_udf_SCALAR_ARROW.png)

This is a Flamegraph of workload on the Python daemon when running the pandas_udf SCALAR:
![](https://issues.apache.org/jira/secure/attachment/12987760/Flamegraph_test_pandas_udf_SCALAR.png)

Co-authors of this work:
Luca Canali @LucaCanali 
Lindsey Gray @lgray
Jim Pivarski @jpivarski
",2019-12-06T16:36:59Z,2020-03-31T07:25:31Z,,,4e7a498f0594118a0df67c31565ac0dc91b1fa1c,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26783/commits,https://api.github.com/repos/apache/spark/pulls/26783/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26783/comments,https://api.github.com/repos/apache/spark/statuses/83119ed7b8ba26efa6e65043254bdcfc20aeb480,CONTRIBUTOR,spark,apache,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,LucaCanali:addArrowUdf,addArrowUdf,83119ed7b8ba26efa6e65043254bdcfc20aeb480,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,145986175,MDEwOlJlcG9zaXRvcnkxNDU5ODYxNzU=,spark,LucaCanali/spark,False,LucaCanali,5243162,MDQ6VXNlcjUyNDMxNjI=,https://avatars2.githubusercontent.com/u/5243162?v=4,,https://api.github.com/users/LucaCanali,https://github.com/LucaCanali,https://api.github.com/users/LucaCanali/followers,https://api.github.com/users/LucaCanali/following{/other_user},https://api.github.com/users/LucaCanali/gists{/gist_id},https://api.github.com/users/LucaCanali/starred{/owner}{/repo},https://api.github.com/users/LucaCanali/subscriptions,https://api.github.com/users/LucaCanali/orgs,https://api.github.com/users/LucaCanali/repos,https://api.github.com/users/LucaCanali/events{/privacy},https://api.github.com/users/LucaCanali/received_events,User,False,https://github.com/LucaCanali/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LucaCanali/spark,https://api.github.com/repos/LucaCanali/spark/forks,https://api.github.com/repos/LucaCanali/spark/keys{/key_id},https://api.github.com/repos/LucaCanali/spark/collaborators{/collaborator},https://api.github.com/repos/LucaCanali/spark/teams,https://api.github.com/repos/LucaCanali/spark/hooks,https://api.github.com/repos/LucaCanali/spark/issues/events{/number},https://api.github.com/repos/LucaCanali/spark/events,https://api.github.com/repos/LucaCanali/spark/assignees{/user},https://api.github.com/repos/LucaCanali/spark/branches{/branch},https://api.github.com/repos/LucaCanali/spark/tags,https://api.github.com/repos/LucaCanali/spark/git/blobs{/sha},https://api.github.com/repos/LucaCanali/spark/git/tags{/sha},https://api.github.com/repos/LucaCanali/spark/git/refs{/sha},https://api.github.com/repos/LucaCanali/spark/git/trees{/sha},https://api.github.com/repos/LucaCanali/spark/statuses/{sha},https://api.github.com/repos/LucaCanali/spark/languages,https://api.github.com/repos/LucaCanali/spark/stargazers,https://api.github.com/repos/LucaCanali/spark/contributors,https://api.github.com/repos/LucaCanali/spark/subscribers,https://api.github.com/repos/LucaCanali/spark/subscription,https://api.github.com/repos/LucaCanali/spark/commits{/sha},https://api.github.com/repos/LucaCanali/spark/git/commits{/sha},https://api.github.com/repos/LucaCanali/spark/comments{/number},https://api.github.com/repos/LucaCanali/spark/issues/comments{/number},https://api.github.com/repos/LucaCanali/spark/contents/{+path},https://api.github.com/repos/LucaCanali/spark/compare/{base}...{head},https://api.github.com/repos/LucaCanali/spark/merges,https://api.github.com/repos/LucaCanali/spark/{archive_format}{/ref},https://api.github.com/repos/LucaCanali/spark/downloads,https://api.github.com/repos/LucaCanali/spark/issues{/number},https://api.github.com/repos/LucaCanali/spark/pulls{/number},https://api.github.com/repos/LucaCanali/spark/milestones{/number},"https://api.github.com/repos/LucaCanali/spark/notifications{?since,all,participating}",https://api.github.com/repos/LucaCanali/spark/labels{/name},https://api.github.com/repos/LucaCanali/spark/releases{/id},https://api.github.com/repos/LucaCanali/spark/deployments,2018-08-24T12:02:34Z,2020-03-30T12:48:12Z,2020-03-30T13:53:50Z,git://github.com/LucaCanali/spark.git,git@github.com:LucaCanali/spark.git,https://github.com/LucaCanali/spark.git,https://github.com/LucaCanali/spark,,319411,0,0,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,0,master,apache:master,master,8aebc80e0e67bcb1aa300b8c8b1a209159237632,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26783,https://github.com/apache/spark/pull/26783,https://api.github.com/repos/apache/spark/issues/26783,https://api.github.com/repos/apache/spark/issues/26783/comments,https://api.github.com/repos/apache/spark/pulls/26783/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26783/commits,https://api.github.com/repos/apache/spark/statuses/83119ed7b8ba26efa6e65043254bdcfc20aeb480
189,https://api.github.com/repos/apache/spark/pulls/26777,349829162,MDExOlB1bGxSZXF1ZXN0MzQ5ODI5MTYy,https://github.com/apache/spark/pull/26777,https://github.com/apache/spark/pull/26777.diff,https://github.com/apache/spark/pull/26777.patch,https://api.github.com/repos/apache/spark/issues/26777,26777,open,False,[SPARK-30134][SQL]  Support DELETE JAR feature in SPARK,"### What changes were proposed in this pull request?
 
Support DELETE JAR functionality in spark. On deletion the jar will be removed from the `IsolatedClientLoader` classpath and from `SharedState` classpath. It also removes the jar from `addedJars` map, so that next set of taskSet won't get these jars

**Sequence Diagram**

![DeleteJarFlow](https://user-images.githubusercontent.com/35216143/70412690-61a93480-1a7b-11ea-9e1d-81d7fc60b8f4.png)

`IsolatedClientLoader.deleteJar` Deletes the jar from `hiveClassLoader` and recreates the classLaoder
`SparkContext.deleteJar` removes the jar from `addedJars` list
`SharedState.deleteJar` Removes the jar from the sessionState class Loader


### Why are the changes needed?
If the jar definition is changed, use can delete the jar and add new one. This process does not require service to be restarted. Even Hive supports the DELETE jar feature.

### Does this PR introduce any user-facing change?
Yes, new feature will be introduced to the user. Same will be updated in documentation as per the jira SPARK-30135
### How was this patch tested?

Added UT and also tested maually with the following testcases
1. Tested in spark-shell,spark-sql and beeline
2. With no schema like /opt/somepath/somejar.jar, hdfs
3.  With fullpath or only with jarname
4.  dropping invalid jar
5. Tested with Hive-2.3.6 

",2019-12-06T08:46:06Z,2020-03-05T19:07:08Z,,,9ef2f1d97a3d8e0268c1229c88770f0bd10e0068,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26777/commits,https://api.github.com/repos/apache/spark/pulls/26777/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26777/comments,https://api.github.com/repos/apache/spark/statuses/68e7330434a088cc4c669601aa4b97002136f5b5,CONTRIBUTOR,spark,apache,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,sandeep-katta:deleteJarSupport,deleteJarSupport,68e7330434a088cc4c669601aa4b97002136f5b5,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,116654613,MDEwOlJlcG9zaXRvcnkxMTY2NTQ2MTM=,spark,sandeep-katta/spark,False,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,https://github.com/sandeep-katta/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sandeep-katta/spark,https://api.github.com/repos/sandeep-katta/spark/forks,https://api.github.com/repos/sandeep-katta/spark/keys{/key_id},https://api.github.com/repos/sandeep-katta/spark/collaborators{/collaborator},https://api.github.com/repos/sandeep-katta/spark/teams,https://api.github.com/repos/sandeep-katta/spark/hooks,https://api.github.com/repos/sandeep-katta/spark/issues/events{/number},https://api.github.com/repos/sandeep-katta/spark/events,https://api.github.com/repos/sandeep-katta/spark/assignees{/user},https://api.github.com/repos/sandeep-katta/spark/branches{/branch},https://api.github.com/repos/sandeep-katta/spark/tags,https://api.github.com/repos/sandeep-katta/spark/git/blobs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/tags{/sha},https://api.github.com/repos/sandeep-katta/spark/git/refs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/trees{/sha},https://api.github.com/repos/sandeep-katta/spark/statuses/{sha},https://api.github.com/repos/sandeep-katta/spark/languages,https://api.github.com/repos/sandeep-katta/spark/stargazers,https://api.github.com/repos/sandeep-katta/spark/contributors,https://api.github.com/repos/sandeep-katta/spark/subscribers,https://api.github.com/repos/sandeep-katta/spark/subscription,https://api.github.com/repos/sandeep-katta/spark/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/git/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/comments{/number},https://api.github.com/repos/sandeep-katta/spark/issues/comments{/number},https://api.github.com/repos/sandeep-katta/spark/contents/{+path},https://api.github.com/repos/sandeep-katta/spark/compare/{base}...{head},https://api.github.com/repos/sandeep-katta/spark/merges,https://api.github.com/repos/sandeep-katta/spark/{archive_format}{/ref},https://api.github.com/repos/sandeep-katta/spark/downloads,https://api.github.com/repos/sandeep-katta/spark/issues{/number},https://api.github.com/repos/sandeep-katta/spark/pulls{/number},https://api.github.com/repos/sandeep-katta/spark/milestones{/number},"https://api.github.com/repos/sandeep-katta/spark/notifications{?since,all,participating}",https://api.github.com/repos/sandeep-katta/spark/labels{/name},https://api.github.com/repos/sandeep-katta/spark/releases{/id},https://api.github.com/repos/sandeep-katta/spark/deployments,2018-01-08T09:11:40Z,2019-12-08T02:36:49Z,2020-01-30T13:59:01Z,git://github.com/sandeep-katta/spark.git,git@github.com:sandeep-katta/spark.git,https://github.com/sandeep-katta/spark.git,https://github.com/sandeep-katta/spark,,317028,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cada5beef72530fa699b5ec13d67261be37730e4,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26777,https://github.com/apache/spark/pull/26777,https://api.github.com/repos/apache/spark/issues/26777,https://api.github.com/repos/apache/spark/issues/26777/comments,https://api.github.com/repos/apache/spark/pulls/26777/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26777/commits,https://api.github.com/repos/apache/spark/statuses/68e7330434a088cc4c669601aa4b97002136f5b5
190,https://api.github.com/repos/apache/spark/pulls/26727,347344389,MDExOlB1bGxSZXF1ZXN0MzQ3MzQ0Mzg5,https://github.com/apache/spark/pull/26727,https://github.com/apache/spark/pull/26727.diff,https://github.com/apache/spark/pull/26727.patch,https://api.github.com/repos/apache/spark/issues/26727,26727,open,False,[SPARK-30087][CORE] Enhanced implementation of JmxSink on RMI remote calls,"### What changes were proposed in this pull request?
Enhanced implementation of JmxSink on RMI remote calls.
E.g:
service: jmx:rmi://127.0.0.1:1986/jndi/rmi://127.0.0.1:1986/jmxrmi to connect


### Why are the changes needed?
JMX supports RMI remote which can be more suitable for production use.

### Does this PR introduce any user-facing change?
Added JMX RMI remote port connection method.

### How was this patch tested?
`JmxSinkSuite.scala`
",2019-12-01T16:08:40Z,2020-02-28T19:05:07Z,,,bed8b2df89f58c0b4fbbe525f9a9f72550554a25,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26727/commits,https://api.github.com/repos/apache/spark/pulls/26727/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26727/comments,https://api.github.com/repos/apache/spark/statuses/1354ac6a057ab6e70a3098f32c72dd8162bfe2f7,NONE,spark,apache,XuQianJin-Stars,10494131,MDQ6VXNlcjEwNDk0MTMx,https://avatars2.githubusercontent.com/u/10494131?v=4,,https://api.github.com/users/XuQianJin-Stars,https://github.com/XuQianJin-Stars,https://api.github.com/users/XuQianJin-Stars/followers,https://api.github.com/users/XuQianJin-Stars/following{/other_user},https://api.github.com/users/XuQianJin-Stars/gists{/gist_id},https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo},https://api.github.com/users/XuQianJin-Stars/subscriptions,https://api.github.com/users/XuQianJin-Stars/orgs,https://api.github.com/users/XuQianJin-Stars/repos,https://api.github.com/users/XuQianJin-Stars/events{/privacy},https://api.github.com/users/XuQianJin-Stars/received_events,User,False,XuQianJin-Stars:SPARK-30087,SPARK-30087,1354ac6a057ab6e70a3098f32c72dd8162bfe2f7,XuQianJin-Stars,10494131,MDQ6VXNlcjEwNDk0MTMx,https://avatars2.githubusercontent.com/u/10494131?v=4,,https://api.github.com/users/XuQianJin-Stars,https://github.com/XuQianJin-Stars,https://api.github.com/users/XuQianJin-Stars/followers,https://api.github.com/users/XuQianJin-Stars/following{/other_user},https://api.github.com/users/XuQianJin-Stars/gists{/gist_id},https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo},https://api.github.com/users/XuQianJin-Stars/subscriptions,https://api.github.com/users/XuQianJin-Stars/orgs,https://api.github.com/users/XuQianJin-Stars/repos,https://api.github.com/users/XuQianJin-Stars/events{/privacy},https://api.github.com/users/XuQianJin-Stars/received_events,User,False,197025486,MDEwOlJlcG9zaXRvcnkxOTcwMjU0ODY=,spark,XuQianJin-Stars/spark,False,XuQianJin-Stars,10494131,MDQ6VXNlcjEwNDk0MTMx,https://avatars2.githubusercontent.com/u/10494131?v=4,,https://api.github.com/users/XuQianJin-Stars,https://github.com/XuQianJin-Stars,https://api.github.com/users/XuQianJin-Stars/followers,https://api.github.com/users/XuQianJin-Stars/following{/other_user},https://api.github.com/users/XuQianJin-Stars/gists{/gist_id},https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo},https://api.github.com/users/XuQianJin-Stars/subscriptions,https://api.github.com/users/XuQianJin-Stars/orgs,https://api.github.com/users/XuQianJin-Stars/repos,https://api.github.com/users/XuQianJin-Stars/events{/privacy},https://api.github.com/users/XuQianJin-Stars/received_events,User,False,https://github.com/XuQianJin-Stars/spark,Apache Spark,True,https://api.github.com/repos/XuQianJin-Stars/spark,https://api.github.com/repos/XuQianJin-Stars/spark/forks,https://api.github.com/repos/XuQianJin-Stars/spark/keys{/key_id},https://api.github.com/repos/XuQianJin-Stars/spark/collaborators{/collaborator},https://api.github.com/repos/XuQianJin-Stars/spark/teams,https://api.github.com/repos/XuQianJin-Stars/spark/hooks,https://api.github.com/repos/XuQianJin-Stars/spark/issues/events{/number},https://api.github.com/repos/XuQianJin-Stars/spark/events,https://api.github.com/repos/XuQianJin-Stars/spark/assignees{/user},https://api.github.com/repos/XuQianJin-Stars/spark/branches{/branch},https://api.github.com/repos/XuQianJin-Stars/spark/tags,https://api.github.com/repos/XuQianJin-Stars/spark/git/blobs{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/git/tags{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/git/refs{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/git/trees{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/statuses/{sha},https://api.github.com/repos/XuQianJin-Stars/spark/languages,https://api.github.com/repos/XuQianJin-Stars/spark/stargazers,https://api.github.com/repos/XuQianJin-Stars/spark/contributors,https://api.github.com/repos/XuQianJin-Stars/spark/subscribers,https://api.github.com/repos/XuQianJin-Stars/spark/subscription,https://api.github.com/repos/XuQianJin-Stars/spark/commits{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/git/commits{/sha},https://api.github.com/repos/XuQianJin-Stars/spark/comments{/number},https://api.github.com/repos/XuQianJin-Stars/spark/issues/comments{/number},https://api.github.com/repos/XuQianJin-Stars/spark/contents/{+path},https://api.github.com/repos/XuQianJin-Stars/spark/compare/{base}...{head},https://api.github.com/repos/XuQianJin-Stars/spark/merges,https://api.github.com/repos/XuQianJin-Stars/spark/{archive_format}{/ref},https://api.github.com/repos/XuQianJin-Stars/spark/downloads,https://api.github.com/repos/XuQianJin-Stars/spark/issues{/number},https://api.github.com/repos/XuQianJin-Stars/spark/pulls{/number},https://api.github.com/repos/XuQianJin-Stars/spark/milestones{/number},"https://api.github.com/repos/XuQianJin-Stars/spark/notifications{?since,all,participating}",https://api.github.com/repos/XuQianJin-Stars/spark/labels{/name},https://api.github.com/repos/XuQianJin-Stars/spark/releases{/id},https://api.github.com/repos/XuQianJin-Stars/spark/deployments,2019-07-15T15:29:12Z,2019-07-15T15:29:41Z,2019-12-12T02:53:13Z,git://github.com/XuQianJin-Stars/spark.git,git@github.com:XuQianJin-Stars/spark.git,https://github.com/XuQianJin-Stars/spark.git,https://github.com/XuQianJin-Stars/spark,,319257,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f32ca4b2799d028620d010f8c9c4f7c09f4ad864,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26727,https://github.com/apache/spark/pull/26727,https://api.github.com/repos/apache/spark/issues/26727,https://api.github.com/repos/apache/spark/issues/26727/comments,https://api.github.com/repos/apache/spark/pulls/26727/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26727/commits,https://api.github.com/repos/apache/spark/statuses/1354ac6a057ab6e70a3098f32c72dd8162bfe2f7
191,https://api.github.com/repos/apache/spark/pulls/26724,347269321,MDExOlB1bGxSZXF1ZXN0MzQ3MjY5MzIx,https://github.com/apache/spark/pull/26724,https://github.com/apache/spark/pull/26724.diff,https://github.com/apache/spark/pull/26724.patch,https://api.github.com/repos/apache/spark/issues/26724,26724,open,False,return tightest common type when inferring schema,Allows inferring schema when writing rdd despite having multiple types present. This roughly mirrors what occurs in the Scala api.,2019-11-30T23:32:34Z,2020-02-05T18:14:39Z,,,37ff85d41f0b85e409ce66b55328403952c3c3d4,,[],[],[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26724/commits,https://api.github.com/repos/apache/spark/pulls/26724/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26724/comments,https://api.github.com/repos/apache/spark/statuses/a1b8e36bacb09322460f73ee7c6ed01e00837ab8,NONE,spark,apache,potatochip,10922120,MDQ6VXNlcjEwOTIyMTIw,https://avatars1.githubusercontent.com/u/10922120?v=4,,https://api.github.com/users/potatochip,https://github.com/potatochip,https://api.github.com/users/potatochip/followers,https://api.github.com/users/potatochip/following{/other_user},https://api.github.com/users/potatochip/gists{/gist_id},https://api.github.com/users/potatochip/starred{/owner}{/repo},https://api.github.com/users/potatochip/subscriptions,https://api.github.com/users/potatochip/orgs,https://api.github.com/users/potatochip/repos,https://api.github.com/users/potatochip/events{/privacy},https://api.github.com/users/potatochip/received_events,User,False,potatochip:infer-schema-merge-types,infer-schema-merge-types,a1b8e36bacb09322460f73ee7c6ed01e00837ab8,potatochip,10922120,MDQ6VXNlcjEwOTIyMTIw,https://avatars1.githubusercontent.com/u/10922120?v=4,,https://api.github.com/users/potatochip,https://github.com/potatochip,https://api.github.com/users/potatochip/followers,https://api.github.com/users/potatochip/following{/other_user},https://api.github.com/users/potatochip/gists{/gist_id},https://api.github.com/users/potatochip/starred{/owner}{/repo},https://api.github.com/users/potatochip/subscriptions,https://api.github.com/users/potatochip/orgs,https://api.github.com/users/potatochip/repos,https://api.github.com/users/potatochip/events{/privacy},https://api.github.com/users/potatochip/received_events,User,False,225082326,MDEwOlJlcG9zaXRvcnkyMjUwODIzMjY=,spark,potatochip/spark,False,potatochip,10922120,MDQ6VXNlcjEwOTIyMTIw,https://avatars1.githubusercontent.com/u/10922120?v=4,,https://api.github.com/users/potatochip,https://github.com/potatochip,https://api.github.com/users/potatochip/followers,https://api.github.com/users/potatochip/following{/other_user},https://api.github.com/users/potatochip/gists{/gist_id},https://api.github.com/users/potatochip/starred{/owner}{/repo},https://api.github.com/users/potatochip/subscriptions,https://api.github.com/users/potatochip/orgs,https://api.github.com/users/potatochip/repos,https://api.github.com/users/potatochip/events{/privacy},https://api.github.com/users/potatochip/received_events,User,False,https://github.com/potatochip/spark,Apache Spark,True,https://api.github.com/repos/potatochip/spark,https://api.github.com/repos/potatochip/spark/forks,https://api.github.com/repos/potatochip/spark/keys{/key_id},https://api.github.com/repos/potatochip/spark/collaborators{/collaborator},https://api.github.com/repos/potatochip/spark/teams,https://api.github.com/repos/potatochip/spark/hooks,https://api.github.com/repos/potatochip/spark/issues/events{/number},https://api.github.com/repos/potatochip/spark/events,https://api.github.com/repos/potatochip/spark/assignees{/user},https://api.github.com/repos/potatochip/spark/branches{/branch},https://api.github.com/repos/potatochip/spark/tags,https://api.github.com/repos/potatochip/spark/git/blobs{/sha},https://api.github.com/repos/potatochip/spark/git/tags{/sha},https://api.github.com/repos/potatochip/spark/git/refs{/sha},https://api.github.com/repos/potatochip/spark/git/trees{/sha},https://api.github.com/repos/potatochip/spark/statuses/{sha},https://api.github.com/repos/potatochip/spark/languages,https://api.github.com/repos/potatochip/spark/stargazers,https://api.github.com/repos/potatochip/spark/contributors,https://api.github.com/repos/potatochip/spark/subscribers,https://api.github.com/repos/potatochip/spark/subscription,https://api.github.com/repos/potatochip/spark/commits{/sha},https://api.github.com/repos/potatochip/spark/git/commits{/sha},https://api.github.com/repos/potatochip/spark/comments{/number},https://api.github.com/repos/potatochip/spark/issues/comments{/number},https://api.github.com/repos/potatochip/spark/contents/{+path},https://api.github.com/repos/potatochip/spark/compare/{base}...{head},https://api.github.com/repos/potatochip/spark/merges,https://api.github.com/repos/potatochip/spark/{archive_format}{/ref},https://api.github.com/repos/potatochip/spark/downloads,https://api.github.com/repos/potatochip/spark/issues{/number},https://api.github.com/repos/potatochip/spark/pulls{/number},https://api.github.com/repos/potatochip/spark/milestones{/number},"https://api.github.com/repos/potatochip/spark/notifications{?since,all,participating}",https://api.github.com/repos/potatochip/spark/labels{/name},https://api.github.com/repos/potatochip/spark/releases{/id},https://api.github.com/repos/potatochip/spark/deployments,2019-11-30T23:25:08Z,2019-11-30T23:25:11Z,2019-11-30T23:29:36Z,git://github.com/potatochip/spark.git,git@github.com:potatochip/spark.git,https://github.com/potatochip/spark.git,https://github.com/potatochip/spark,,319482,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f32ca4b2799d028620d010f8c9c4f7c09f4ad864,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26724,https://github.com/apache/spark/pull/26724,https://api.github.com/repos/apache/spark/issues/26724,https://api.github.com/repos/apache/spark/issues/26724/comments,https://api.github.com/repos/apache/spark/pulls/26724/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26724/commits,https://api.github.com/repos/apache/spark/statuses/a1b8e36bacb09322460f73ee7c6ed01e00837ab8
192,https://api.github.com/repos/apache/spark/pulls/26723,347218890,MDExOlB1bGxSZXF1ZXN0MzQ3MjE4ODkw,https://github.com/apache/spark/pull/26723,https://github.com/apache/spark/pull/26723.diff,https://github.com/apache/spark/pull/26723.patch,https://api.github.com/repos/apache/spark/issues/26723,26723,open,False,[SPARK-27523][CORE] - Resolve scheme-less event log directory relative to default filesystem,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
`evenlog.dir` is resolved with respect to the default filesystem.


### Why are the changes needed?
These changes needed for resolved `evelog.dir` when `defaultFS` is specified. 


### Does this PR introduce any user-facing change?
no


### How was this patch tested?
this patch was tested manually and covered by the unit test. 
",2019-11-30T12:04:09Z,2020-01-11T21:29:06Z,,,71cdef40622bcfef7e1e2bf246ce2441bff534f2,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26723/commits,https://api.github.com/repos/apache/spark/pulls/26723/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26723/comments,https://api.github.com/repos/apache/spark/statuses/622f90ddb4758633032492620bdfe57687352785,CONTRIBUTOR,spark,apache,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,ayudovin:log-directory,log-directory,622f90ddb4758633032492620bdfe57687352785,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,164214683,MDEwOlJlcG9zaXRvcnkxNjQyMTQ2ODM=,spark,ayudovin/spark,False,ayudovin,34862741,MDQ6VXNlcjM0ODYyNzQx,https://avatars1.githubusercontent.com/u/34862741?v=4,,https://api.github.com/users/ayudovin,https://github.com/ayudovin,https://api.github.com/users/ayudovin/followers,https://api.github.com/users/ayudovin/following{/other_user},https://api.github.com/users/ayudovin/gists{/gist_id},https://api.github.com/users/ayudovin/starred{/owner}{/repo},https://api.github.com/users/ayudovin/subscriptions,https://api.github.com/users/ayudovin/orgs,https://api.github.com/users/ayudovin/repos,https://api.github.com/users/ayudovin/events{/privacy},https://api.github.com/users/ayudovin/received_events,User,False,https://github.com/ayudovin/spark,Apache Spark,True,https://api.github.com/repos/ayudovin/spark,https://api.github.com/repos/ayudovin/spark/forks,https://api.github.com/repos/ayudovin/spark/keys{/key_id},https://api.github.com/repos/ayudovin/spark/collaborators{/collaborator},https://api.github.com/repos/ayudovin/spark/teams,https://api.github.com/repos/ayudovin/spark/hooks,https://api.github.com/repos/ayudovin/spark/issues/events{/number},https://api.github.com/repos/ayudovin/spark/events,https://api.github.com/repos/ayudovin/spark/assignees{/user},https://api.github.com/repos/ayudovin/spark/branches{/branch},https://api.github.com/repos/ayudovin/spark/tags,https://api.github.com/repos/ayudovin/spark/git/blobs{/sha},https://api.github.com/repos/ayudovin/spark/git/tags{/sha},https://api.github.com/repos/ayudovin/spark/git/refs{/sha},https://api.github.com/repos/ayudovin/spark/git/trees{/sha},https://api.github.com/repos/ayudovin/spark/statuses/{sha},https://api.github.com/repos/ayudovin/spark/languages,https://api.github.com/repos/ayudovin/spark/stargazers,https://api.github.com/repos/ayudovin/spark/contributors,https://api.github.com/repos/ayudovin/spark/subscribers,https://api.github.com/repos/ayudovin/spark/subscription,https://api.github.com/repos/ayudovin/spark/commits{/sha},https://api.github.com/repos/ayudovin/spark/git/commits{/sha},https://api.github.com/repos/ayudovin/spark/comments{/number},https://api.github.com/repos/ayudovin/spark/issues/comments{/number},https://api.github.com/repos/ayudovin/spark/contents/{+path},https://api.github.com/repos/ayudovin/spark/compare/{base}...{head},https://api.github.com/repos/ayudovin/spark/merges,https://api.github.com/repos/ayudovin/spark/{archive_format}{/ref},https://api.github.com/repos/ayudovin/spark/downloads,https://api.github.com/repos/ayudovin/spark/issues{/number},https://api.github.com/repos/ayudovin/spark/pulls{/number},https://api.github.com/repos/ayudovin/spark/milestones{/number},"https://api.github.com/repos/ayudovin/spark/notifications{?since,all,participating}",https://api.github.com/repos/ayudovin/spark/labels{/name},https://api.github.com/repos/ayudovin/spark/releases{/id},https://api.github.com/repos/ayudovin/spark/deployments,2019-01-05T12:53:03Z,2019-12-28T18:18:37Z,2020-02-02T14:05:29Z,git://github.com/ayudovin/spark.git,git@github.com:ayudovin/spark.git,https://github.com/ayudovin/spark.git,https://github.com/ayudovin/spark,,314562,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,91b83de4173839d559bee582f5569dc9857ab648,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26723,https://github.com/apache/spark/pull/26723,https://api.github.com/repos/apache/spark/issues/26723,https://api.github.com/repos/apache/spark/issues/26723/comments,https://api.github.com/repos/apache/spark/pulls/26723/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26723/commits,https://api.github.com/repos/apache/spark/statuses/622f90ddb4758633032492620bdfe57687352785
193,https://api.github.com/repos/apache/spark/pulls/26711,346951991,MDExOlB1bGxSZXF1ZXN0MzQ2OTUxOTkx,https://github.com/apache/spark/pull/26711,https://github.com/apache/spark/pull/26711.diff,https://github.com/apache/spark/pull/26711.patch,https://api.github.com/repos/apache/spark/issues/26711,26711,open,False,[SPARK-30069][CORE][YARN] Clean up non-shuffle disk block manager files following executor exists on YARN,"### What changes were proposed in this pull request?
Currently we only clean up the local directories on application removed. However, when executors die and restart repeatedly, many temp files are left untouched in the local directories, which is undesired behavior and could cause disk space used up gradually. Especially, in long running service like Spark thrift-server with dynamic resource allocation disabled, it's very easy causes local disk full.
#21390 fixed the same problem on Standalone mode. On YARN, this issue still exists.

From https://github.com/apache/spark/pull/21390#issuecomment-391695376, YARN only cleans container local dirs when container (executor) is exited. But these files are not in container local dirs.
<img width=""1527"" alt=""Screen Shot 2019-11-29 at 4 52 56 PM"" src=""https://user-images.githubusercontent.com/1853780/69856506-c66cce00-12c8-11ea-9e62-058aa2d3c12e.png"">

So this patch is very straightforward:
We create these ""temp_xxx "" files under the container dirs when the executor is running in YARN container.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?
Add an UT and manually test.
",2019-11-29T08:58:20Z,2020-03-16T13:23:22Z,,,b7b79b8e04a26ff3dee53536208ac214d97f77ac,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1427970157, 'node_id': 'MDU6TGFiZWwxNDI3OTcwMTU3', 'url': 'https://api.github.com/repos/apache/spark/labels/YARN', 'name': 'YARN', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26711/commits,https://api.github.com/repos/apache/spark/pulls/26711/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26711/comments,https://api.github.com/repos/apache/spark/statuses/c226dd6b8798b1b0009aa09d02b64510bd3cb025,CONTRIBUTOR,spark,apache,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,LantaoJin:SPARK-30069,SPARK-30069,c226dd6b8798b1b0009aa09d02b64510bd3cb025,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,90969496,MDEwOlJlcG9zaXRvcnk5MDk2OTQ5Ng==,spark,LantaoJin/spark,False,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,https://github.com/LantaoJin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LantaoJin/spark,https://api.github.com/repos/LantaoJin/spark/forks,https://api.github.com/repos/LantaoJin/spark/keys{/key_id},https://api.github.com/repos/LantaoJin/spark/collaborators{/collaborator},https://api.github.com/repos/LantaoJin/spark/teams,https://api.github.com/repos/LantaoJin/spark/hooks,https://api.github.com/repos/LantaoJin/spark/issues/events{/number},https://api.github.com/repos/LantaoJin/spark/events,https://api.github.com/repos/LantaoJin/spark/assignees{/user},https://api.github.com/repos/LantaoJin/spark/branches{/branch},https://api.github.com/repos/LantaoJin/spark/tags,https://api.github.com/repos/LantaoJin/spark/git/blobs{/sha},https://api.github.com/repos/LantaoJin/spark/git/tags{/sha},https://api.github.com/repos/LantaoJin/spark/git/refs{/sha},https://api.github.com/repos/LantaoJin/spark/git/trees{/sha},https://api.github.com/repos/LantaoJin/spark/statuses/{sha},https://api.github.com/repos/LantaoJin/spark/languages,https://api.github.com/repos/LantaoJin/spark/stargazers,https://api.github.com/repos/LantaoJin/spark/contributors,https://api.github.com/repos/LantaoJin/spark/subscribers,https://api.github.com/repos/LantaoJin/spark/subscription,https://api.github.com/repos/LantaoJin/spark/commits{/sha},https://api.github.com/repos/LantaoJin/spark/git/commits{/sha},https://api.github.com/repos/LantaoJin/spark/comments{/number},https://api.github.com/repos/LantaoJin/spark/issues/comments{/number},https://api.github.com/repos/LantaoJin/spark/contents/{+path},https://api.github.com/repos/LantaoJin/spark/compare/{base}...{head},https://api.github.com/repos/LantaoJin/spark/merges,https://api.github.com/repos/LantaoJin/spark/{archive_format}{/ref},https://api.github.com/repos/LantaoJin/spark/downloads,https://api.github.com/repos/LantaoJin/spark/issues{/number},https://api.github.com/repos/LantaoJin/spark/pulls{/number},https://api.github.com/repos/LantaoJin/spark/milestones{/number},"https://api.github.com/repos/LantaoJin/spark/notifications{?since,all,participating}",https://api.github.com/repos/LantaoJin/spark/labels{/name},https://api.github.com/repos/LantaoJin/spark/releases{/id},https://api.github.com/repos/LantaoJin/spark/deployments,2017-05-11T10:58:27Z,2019-06-03T02:33:56Z,2020-03-24T09:02:44Z,git://github.com/LantaoJin/spark.git,git@github.com:LantaoJin/spark.git,https://github.com/LantaoJin/spark.git,https://github.com/LantaoJin/spark,,323789,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,9351e3e76fb11e9fdaf39aef5aea86fdeccd6f28,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26711,https://github.com/apache/spark/pull/26711,https://api.github.com/repos/apache/spark/issues/26711,https://api.github.com/repos/apache/spark/issues/26711/comments,https://api.github.com/repos/apache/spark/pulls/26711/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26711/commits,https://api.github.com/repos/apache/spark/statuses/c226dd6b8798b1b0009aa09d02b64510bd3cb025
194,https://api.github.com/repos/apache/spark/pulls/26687,345995261,MDExOlB1bGxSZXF1ZXN0MzQ1OTk1MjYx,https://github.com/apache/spark/pull/26687,https://github.com/apache/spark/pull/26687.diff,https://github.com/apache/spark/pull/26687.patch,https://api.github.com/repos/apache/spark/issues/26687,26687,open,False,[SPARK-30055][k8s] Allow configuration of restart policy for Kubernetes pods,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This allows the configuration of the restart policy for drivers and executors running on Kubernetes.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
The current restart policies are hard-coded to ""Never"". Restarting a failed application requires deleting and rescheduling all of its pods, which is very slow, requires external management, and drops any cache that exists in memory or container filesystem. The driver will still reschedule evicted executors.

There is also no way, with the current lack of sidecar support, to run a long-running streaming application with injected sidecar containers that need to restart on failure (sidecar containers will not affect the pod phase). This PR solves that by allowing streaming applications to set ""Always"" for all pods.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
New configuration properties `spark.kubernetes.driver.restartPolicy` and `spark.kubernetes.executor.restartPolicy` were added.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
I manually verified the changes worked and ran the test script. I didn't add unit tests because it didn't seem like the tests would prove anything useful. Should I? 🤷‍♂ ",2019-11-27T00:28:59Z,2020-03-12T21:24:57Z,,,dacecdcdf3fa6299c4e7244288de37f10e7a63d0,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26687/commits,https://api.github.com/repos/apache/spark/pulls/26687/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26687/comments,https://api.github.com/repos/apache/spark/statuses/cf16ccb248efd1e04698198a388e008ceb2f8f0d,NONE,spark,apache,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,khogeland:restart-policy,restart-policy,cf16ccb248efd1e04698198a388e008ceb2f8f0d,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,195895859,MDEwOlJlcG9zaXRvcnkxOTU4OTU4NTk=,spark,khogeland/spark,False,khogeland,1495099,MDQ6VXNlcjE0OTUwOTk=,https://avatars3.githubusercontent.com/u/1495099?v=4,,https://api.github.com/users/khogeland,https://github.com/khogeland,https://api.github.com/users/khogeland/followers,https://api.github.com/users/khogeland/following{/other_user},https://api.github.com/users/khogeland/gists{/gist_id},https://api.github.com/users/khogeland/starred{/owner}{/repo},https://api.github.com/users/khogeland/subscriptions,https://api.github.com/users/khogeland/orgs,https://api.github.com/users/khogeland/repos,https://api.github.com/users/khogeland/events{/privacy},https://api.github.com/users/khogeland/received_events,User,False,https://github.com/khogeland/spark,Apache Spark,True,https://api.github.com/repos/khogeland/spark,https://api.github.com/repos/khogeland/spark/forks,https://api.github.com/repos/khogeland/spark/keys{/key_id},https://api.github.com/repos/khogeland/spark/collaborators{/collaborator},https://api.github.com/repos/khogeland/spark/teams,https://api.github.com/repos/khogeland/spark/hooks,https://api.github.com/repos/khogeland/spark/issues/events{/number},https://api.github.com/repos/khogeland/spark/events,https://api.github.com/repos/khogeland/spark/assignees{/user},https://api.github.com/repos/khogeland/spark/branches{/branch},https://api.github.com/repos/khogeland/spark/tags,https://api.github.com/repos/khogeland/spark/git/blobs{/sha},https://api.github.com/repos/khogeland/spark/git/tags{/sha},https://api.github.com/repos/khogeland/spark/git/refs{/sha},https://api.github.com/repos/khogeland/spark/git/trees{/sha},https://api.github.com/repos/khogeland/spark/statuses/{sha},https://api.github.com/repos/khogeland/spark/languages,https://api.github.com/repos/khogeland/spark/stargazers,https://api.github.com/repos/khogeland/spark/contributors,https://api.github.com/repos/khogeland/spark/subscribers,https://api.github.com/repos/khogeland/spark/subscription,https://api.github.com/repos/khogeland/spark/commits{/sha},https://api.github.com/repos/khogeland/spark/git/commits{/sha},https://api.github.com/repos/khogeland/spark/comments{/number},https://api.github.com/repos/khogeland/spark/issues/comments{/number},https://api.github.com/repos/khogeland/spark/contents/{+path},https://api.github.com/repos/khogeland/spark/compare/{base}...{head},https://api.github.com/repos/khogeland/spark/merges,https://api.github.com/repos/khogeland/spark/{archive_format}{/ref},https://api.github.com/repos/khogeland/spark/downloads,https://api.github.com/repos/khogeland/spark/issues{/number},https://api.github.com/repos/khogeland/spark/pulls{/number},https://api.github.com/repos/khogeland/spark/milestones{/number},"https://api.github.com/repos/khogeland/spark/notifications{?since,all,participating}",https://api.github.com/repos/khogeland/spark/labels{/name},https://api.github.com/repos/khogeland/spark/releases{/id},https://api.github.com/repos/khogeland/spark/deployments,2019-07-08T22:47:12Z,2019-11-11T21:36:32Z,2020-03-12T21:35:07Z,git://github.com/khogeland/spark.git,git@github.com:khogeland/spark.git,https://github.com/khogeland/spark.git,https://github.com/khogeland/spark,,319499,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,74cd46eb691be5dc1cb1c496eeeaa2614945bd98,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26687,https://github.com/apache/spark/pull/26687,https://api.github.com/repos/apache/spark/issues/26687,https://api.github.com/repos/apache/spark/issues/26687/comments,https://api.github.com/repos/apache/spark/pulls/26687/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26687/commits,https://api.github.com/repos/apache/spark/statuses/cf16ccb248efd1e04698198a388e008ceb2f8f0d
195,https://api.github.com/repos/apache/spark/pulls/26674,345580704,MDExOlB1bGxSZXF1ZXN0MzQ1NTgwNzA0,https://github.com/apache/spark/pull/26674,https://github.com/apache/spark/pull/26674.diff,https://github.com/apache/spark/pull/26674.patch,https://api.github.com/repos/apache/spark/issues/26674,26674,open,False,[SPARK-30059][CORE]Stop AsyncEventQueue when interrupted in dispatch,"### What changes were proposed in this pull request?
PR #21356  stop `AsyncEventQueue` when interrupted in `postToAll`. 
However, if it's interrupted in `AsyncEventQueue#dispatch`,  SparkContext would be stopped.
This PR proposes to stop `AsyncEventQueue` when interrupted in dispatch, rather than stop the SparkContext.

### Why are the changes needed?
Avoid stopping the SparkContext when interrupted in `AsyncEventQueue#dispatch`.

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
New UT.
",2019-11-26T07:23:16Z,2020-04-02T13:28:06Z,,,5decf080b342402eea9ff7aabf4aee547049b8a0,,[],[],[],"[{'id': 1406606875, 'node_id': 'MDU6TGFiZWwxNDA2NjA2ODc1', 'url': 'https://api.github.com/repos/apache/spark/labels/SCHEDULER', 'name': 'SCHEDULER', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26674/commits,https://api.github.com/repos/apache/spark/pulls/26674/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26674/comments,https://api.github.com/repos/apache/spark/statuses/8df4c88bee983f09d13bffae5bb971fd82193b97,CONTRIBUTOR,spark,apache,wangshuo128,4003322,MDQ6VXNlcjQwMDMzMjI=,https://avatars0.githubusercontent.com/u/4003322?v=4,,https://api.github.com/users/wangshuo128,https://github.com/wangshuo128,https://api.github.com/users/wangshuo128/followers,https://api.github.com/users/wangshuo128/following{/other_user},https://api.github.com/users/wangshuo128/gists{/gist_id},https://api.github.com/users/wangshuo128/starred{/owner}{/repo},https://api.github.com/users/wangshuo128/subscriptions,https://api.github.com/users/wangshuo128/orgs,https://api.github.com/users/wangshuo128/repos,https://api.github.com/users/wangshuo128/events{/privacy},https://api.github.com/users/wangshuo128/received_events,User,False,wangshuo128:event-queue,event-queue,8df4c88bee983f09d13bffae5bb971fd82193b97,wangshuo128,4003322,MDQ6VXNlcjQwMDMzMjI=,https://avatars0.githubusercontent.com/u/4003322?v=4,,https://api.github.com/users/wangshuo128,https://github.com/wangshuo128,https://api.github.com/users/wangshuo128/followers,https://api.github.com/users/wangshuo128/following{/other_user},https://api.github.com/users/wangshuo128/gists{/gist_id},https://api.github.com/users/wangshuo128/starred{/owner}{/repo},https://api.github.com/users/wangshuo128/subscriptions,https://api.github.com/users/wangshuo128/orgs,https://api.github.com/users/wangshuo128/repos,https://api.github.com/users/wangshuo128/events{/privacy},https://api.github.com/users/wangshuo128/received_events,User,False,133767975,MDEwOlJlcG9zaXRvcnkxMzM3Njc5NzU=,spark,wangshuo128/spark,False,wangshuo128,4003322,MDQ6VXNlcjQwMDMzMjI=,https://avatars0.githubusercontent.com/u/4003322?v=4,,https://api.github.com/users/wangshuo128,https://github.com/wangshuo128,https://api.github.com/users/wangshuo128/followers,https://api.github.com/users/wangshuo128/following{/other_user},https://api.github.com/users/wangshuo128/gists{/gist_id},https://api.github.com/users/wangshuo128/starred{/owner}{/repo},https://api.github.com/users/wangshuo128/subscriptions,https://api.github.com/users/wangshuo128/orgs,https://api.github.com/users/wangshuo128/repos,https://api.github.com/users/wangshuo128/events{/privacy},https://api.github.com/users/wangshuo128/received_events,User,False,https://github.com/wangshuo128/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangshuo128/spark,https://api.github.com/repos/wangshuo128/spark/forks,https://api.github.com/repos/wangshuo128/spark/keys{/key_id},https://api.github.com/repos/wangshuo128/spark/collaborators{/collaborator},https://api.github.com/repos/wangshuo128/spark/teams,https://api.github.com/repos/wangshuo128/spark/hooks,https://api.github.com/repos/wangshuo128/spark/issues/events{/number},https://api.github.com/repos/wangshuo128/spark/events,https://api.github.com/repos/wangshuo128/spark/assignees{/user},https://api.github.com/repos/wangshuo128/spark/branches{/branch},https://api.github.com/repos/wangshuo128/spark/tags,https://api.github.com/repos/wangshuo128/spark/git/blobs{/sha},https://api.github.com/repos/wangshuo128/spark/git/tags{/sha},https://api.github.com/repos/wangshuo128/spark/git/refs{/sha},https://api.github.com/repos/wangshuo128/spark/git/trees{/sha},https://api.github.com/repos/wangshuo128/spark/statuses/{sha},https://api.github.com/repos/wangshuo128/spark/languages,https://api.github.com/repos/wangshuo128/spark/stargazers,https://api.github.com/repos/wangshuo128/spark/contributors,https://api.github.com/repos/wangshuo128/spark/subscribers,https://api.github.com/repos/wangshuo128/spark/subscription,https://api.github.com/repos/wangshuo128/spark/commits{/sha},https://api.github.com/repos/wangshuo128/spark/git/commits{/sha},https://api.github.com/repos/wangshuo128/spark/comments{/number},https://api.github.com/repos/wangshuo128/spark/issues/comments{/number},https://api.github.com/repos/wangshuo128/spark/contents/{+path},https://api.github.com/repos/wangshuo128/spark/compare/{base}...{head},https://api.github.com/repos/wangshuo128/spark/merges,https://api.github.com/repos/wangshuo128/spark/{archive_format}{/ref},https://api.github.com/repos/wangshuo128/spark/downloads,https://api.github.com/repos/wangshuo128/spark/issues{/number},https://api.github.com/repos/wangshuo128/spark/pulls{/number},https://api.github.com/repos/wangshuo128/spark/milestones{/number},"https://api.github.com/repos/wangshuo128/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangshuo128/spark/labels{/name},https://api.github.com/repos/wangshuo128/spark/releases{/id},https://api.github.com/repos/wangshuo128/spark/deployments,2018-05-17T06:19:52Z,2019-03-18T08:02:01Z,2019-12-21T07:35:31Z,git://github.com/wangshuo128/spark.git,git@github.com:wangshuo128/spark.git,https://github.com/wangshuo128/spark.git,https://github.com/wangshuo128/spark,,314939,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,373c2c3f44f693f86ef60224697cf80b639e655e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26674,https://github.com/apache/spark/pull/26674,https://api.github.com/repos/apache/spark/issues/26674,https://api.github.com/repos/apache/spark/issues/26674/comments,https://api.github.com/repos/apache/spark/pulls/26674/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26674/commits,https://api.github.com/repos/apache/spark/statuses/8df4c88bee983f09d13bffae5bb971fd82193b97
196,https://api.github.com/repos/apache/spark/pulls/26670,345482981,MDExOlB1bGxSZXF1ZXN0MzQ1NDgyOTgx,https://github.com/apache/spark/pull/26670,https://github.com/apache/spark/pull/26670.diff,https://github.com/apache/spark/pull/26670.patch,https://api.github.com/repos/apache/spark/issues/26670,26670,open,False,[SPARK-30033][core] Manage shuffle IO plugins using Spark's plugin system.,"SPARK-25299 is introducing a new plugin interface for shuffle IO; currently,
parts of that API provide lifecycle methods that are already covered by the
plugin API that was added in SPARK-29396.

This change makes some modifications so that:

- The driver and executor components of the shuffle plugin extend their
  respective counterparts in the generic plugin API.
- The shuffle IO plugin is managed by the same code that manages other
  generic plugins.

This simplifies and reuses similar code that exists in both implementations,
and also provides more functionality to shuffle plugins: not only do they have
more contextual information (without having to query APIs like SparkEnv) but
they also have access to other functionality in the plugin API that would
otherwise require touching internal Spark APIs.

There is a small change to the generic plugin API to avoid registering an
RPC endpoint and starting threads when not needed; plugins now must explicitly
say they want to handle RPC messages for the endpoint to be created. This is
done because the default shuffle plugin is now loaded by the plugin system,
and does not need the RPC functionality. (This API hasn't been released yet
so it's ok to make the change.)

The only downside is that initialization of the SortShuffleManager in executors
is a bit weird, because of the order in which things are initialized: the
shuffle manager is initialized by SparkEnv, and plugin initialization happens
after that. In any case, all initialization is done before any tasks are
allowed to run..

Currently, the shuffle plugin is always loaded, regardless of whether the sort
shuffle manager is being used; this was already the case in the driver, but
now is also the case in the executors. It shouldn't be hard to fix that if
needed.

Tested with existing and updated unit tests.
",2019-11-26T00:32:18Z,2020-01-28T01:19:29Z,,,19919279ad99ea584eb19086866ee8644a33028b,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26670/commits,https://api.github.com/repos/apache/spark/pulls/26670/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26670/comments,https://api.github.com/repos/apache/spark/statuses/6bba5ef609f4944bfff5eb48b3361fa2d023eca2,NONE,spark,apache,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,vanzin:SPARK-30033,SPARK-30033,6bba5ef609f4944bfff5eb48b3361fa2d023eca2,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,18302272,MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==,spark,vanzin/spark,False,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,https://github.com/vanzin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/vanzin/spark,https://api.github.com/repos/vanzin/spark/forks,https://api.github.com/repos/vanzin/spark/keys{/key_id},https://api.github.com/repos/vanzin/spark/collaborators{/collaborator},https://api.github.com/repos/vanzin/spark/teams,https://api.github.com/repos/vanzin/spark/hooks,https://api.github.com/repos/vanzin/spark/issues/events{/number},https://api.github.com/repos/vanzin/spark/events,https://api.github.com/repos/vanzin/spark/assignees{/user},https://api.github.com/repos/vanzin/spark/branches{/branch},https://api.github.com/repos/vanzin/spark/tags,https://api.github.com/repos/vanzin/spark/git/blobs{/sha},https://api.github.com/repos/vanzin/spark/git/tags{/sha},https://api.github.com/repos/vanzin/spark/git/refs{/sha},https://api.github.com/repos/vanzin/spark/git/trees{/sha},https://api.github.com/repos/vanzin/spark/statuses/{sha},https://api.github.com/repos/vanzin/spark/languages,https://api.github.com/repos/vanzin/spark/stargazers,https://api.github.com/repos/vanzin/spark/contributors,https://api.github.com/repos/vanzin/spark/subscribers,https://api.github.com/repos/vanzin/spark/subscription,https://api.github.com/repos/vanzin/spark/commits{/sha},https://api.github.com/repos/vanzin/spark/git/commits{/sha},https://api.github.com/repos/vanzin/spark/comments{/number},https://api.github.com/repos/vanzin/spark/issues/comments{/number},https://api.github.com/repos/vanzin/spark/contents/{+path},https://api.github.com/repos/vanzin/spark/compare/{base}...{head},https://api.github.com/repos/vanzin/spark/merges,https://api.github.com/repos/vanzin/spark/{archive_format}{/ref},https://api.github.com/repos/vanzin/spark/downloads,https://api.github.com/repos/vanzin/spark/issues{/number},https://api.github.com/repos/vanzin/spark/pulls{/number},https://api.github.com/repos/vanzin/spark/milestones{/number},"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}",https://api.github.com/repos/vanzin/spark/labels{/name},https://api.github.com/repos/vanzin/spark/releases{/id},https://api.github.com/repos/vanzin/spark/deployments,2014-03-31T17:49:25Z,2018-01-06T03:57:54Z,2020-01-24T16:55:58Z,git://github.com/vanzin/spark.git,git@github.com:vanzin/spark.git,https://github.com/vanzin/spark.git,https://github.com/vanzin/spark,,287134,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,ed44926117d81aa5fa8bd823d401efd235260872,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26670,https://github.com/apache/spark/pull/26670,https://api.github.com/repos/apache/spark/issues/26670,https://api.github.com/repos/apache/spark/issues/26670/comments,https://api.github.com/repos/apache/spark/pulls/26670/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26670/commits,https://api.github.com/repos/apache/spark/statuses/6bba5ef609f4944bfff5eb48b3361fa2d023eca2
197,https://api.github.com/repos/apache/spark/pulls/26644,344820444,MDExOlB1bGxSZXF1ZXN0MzQ0ODIwNDQ0,https://github.com/apache/spark/pull/26644,https://github.com/apache/spark/pull/26644.diff,https://github.com/apache/spark/pull/26644.patch,https://api.github.com/repos/apache/spark/issues/26644,26644,open,False,[SPARK-30004][SQL] Allow merge UserDefinedType into a native DataType,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?

In case you write a UDT, you always need to read it with the UDT registered. In many cases, you want to write it, and then convert it into a native DataType.

In the case of Delta or when appending a partition, you can write to the same table and then it needs to be able to convert merge the UDT into the native type again.
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->


### Why are the changes needed?

When appending data to the table, I get the exception:

```
Failed to merge fields 'START_DATE_MAINTENANCE_FLPL' and 'START_DATE_MAINTENANCE_FLPL'.
Failed to merge incompatible data types TimestampType and org.apache.spark.sql.types.CustomXMLGregorianCalendarType@5ff12345;;
```
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->


### How was this patch tested?

* Add a unit test to the DataTypeSuite.scala
* Add an integration test to UserDefinedTypeSuite.scala
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

https://jira.apache.org/jira/browse/SPARK-30004",2019-11-23T15:59:45Z,2020-01-06T01:08:57Z,,,0a67063472fea7803b402dddedb0cbfb7f19faf4,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26644/commits,https://api.github.com/repos/apache/spark/pulls/26644/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26644/comments,https://api.github.com/repos/apache/spark/statuses/dd3c913f0c552c975cd96cde554ba90f99b85bab,CONTRIBUTOR,spark,apache,Fokko,1134248,MDQ6VXNlcjExMzQyNDg=,https://avatars0.githubusercontent.com/u/1134248?v=4,,https://api.github.com/users/Fokko,https://github.com/Fokko,https://api.github.com/users/Fokko/followers,https://api.github.com/users/Fokko/following{/other_user},https://api.github.com/users/Fokko/gists{/gist_id},https://api.github.com/users/Fokko/starred{/owner}{/repo},https://api.github.com/users/Fokko/subscriptions,https://api.github.com/users/Fokko/orgs,https://api.github.com/users/Fokko/repos,https://api.github.com/users/Fokko/events{/privacy},https://api.github.com/users/Fokko/received_events,User,False,Fokko:SPARK-30004,SPARK-30004,dd3c913f0c552c975cd96cde554ba90f99b85bab,Fokko,1134248,MDQ6VXNlcjExMzQyNDg=,https://avatars0.githubusercontent.com/u/1134248?v=4,,https://api.github.com/users/Fokko,https://github.com/Fokko,https://api.github.com/users/Fokko/followers,https://api.github.com/users/Fokko/following{/other_user},https://api.github.com/users/Fokko/gists{/gist_id},https://api.github.com/users/Fokko/starred{/owner}{/repo},https://api.github.com/users/Fokko/subscriptions,https://api.github.com/users/Fokko/orgs,https://api.github.com/users/Fokko/repos,https://api.github.com/users/Fokko/events{/privacy},https://api.github.com/users/Fokko/received_events,User,False,49888791,MDEwOlJlcG9zaXRvcnk0OTg4ODc5MQ==,spark,Fokko/spark,False,Fokko,1134248,MDQ6VXNlcjExMzQyNDg=,https://avatars0.githubusercontent.com/u/1134248?v=4,,https://api.github.com/users/Fokko,https://github.com/Fokko,https://api.github.com/users/Fokko/followers,https://api.github.com/users/Fokko/following{/other_user},https://api.github.com/users/Fokko/gists{/gist_id},https://api.github.com/users/Fokko/starred{/owner}{/repo},https://api.github.com/users/Fokko/subscriptions,https://api.github.com/users/Fokko/orgs,https://api.github.com/users/Fokko/repos,https://api.github.com/users/Fokko/events{/privacy},https://api.github.com/users/Fokko/received_events,User,False,https://github.com/Fokko/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Fokko/spark,https://api.github.com/repos/Fokko/spark/forks,https://api.github.com/repos/Fokko/spark/keys{/key_id},https://api.github.com/repos/Fokko/spark/collaborators{/collaborator},https://api.github.com/repos/Fokko/spark/teams,https://api.github.com/repos/Fokko/spark/hooks,https://api.github.com/repos/Fokko/spark/issues/events{/number},https://api.github.com/repos/Fokko/spark/events,https://api.github.com/repos/Fokko/spark/assignees{/user},https://api.github.com/repos/Fokko/spark/branches{/branch},https://api.github.com/repos/Fokko/spark/tags,https://api.github.com/repos/Fokko/spark/git/blobs{/sha},https://api.github.com/repos/Fokko/spark/git/tags{/sha},https://api.github.com/repos/Fokko/spark/git/refs{/sha},https://api.github.com/repos/Fokko/spark/git/trees{/sha},https://api.github.com/repos/Fokko/spark/statuses/{sha},https://api.github.com/repos/Fokko/spark/languages,https://api.github.com/repos/Fokko/spark/stargazers,https://api.github.com/repos/Fokko/spark/contributors,https://api.github.com/repos/Fokko/spark/subscribers,https://api.github.com/repos/Fokko/spark/subscription,https://api.github.com/repos/Fokko/spark/commits{/sha},https://api.github.com/repos/Fokko/spark/git/commits{/sha},https://api.github.com/repos/Fokko/spark/comments{/number},https://api.github.com/repos/Fokko/spark/issues/comments{/number},https://api.github.com/repos/Fokko/spark/contents/{+path},https://api.github.com/repos/Fokko/spark/compare/{base}...{head},https://api.github.com/repos/Fokko/spark/merges,https://api.github.com/repos/Fokko/spark/{archive_format}{/ref},https://api.github.com/repos/Fokko/spark/downloads,https://api.github.com/repos/Fokko/spark/issues{/number},https://api.github.com/repos/Fokko/spark/pulls{/number},https://api.github.com/repos/Fokko/spark/milestones{/number},"https://api.github.com/repos/Fokko/spark/notifications{?since,all,participating}",https://api.github.com/repos/Fokko/spark/labels{/name},https://api.github.com/repos/Fokko/spark/releases{/id},https://api.github.com/repos/Fokko/spark/deployments,2016-01-18T16:21:33Z,2020-01-17T12:27:54Z,2020-03-19T04:55:45Z,git://github.com/Fokko/spark.git,git@github.com:Fokko/spark.git,https://github.com/Fokko/spark.git,https://github.com/Fokko/spark,,298688,0,0,Scala,False,True,True,False,False,0,,False,False,10,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,10,0,master,apache:master,master,a8bf5d823b1884688fa3319644111c3ea5a59036,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26644,https://github.com/apache/spark/pull/26644,https://api.github.com/repos/apache/spark/issues/26644,https://api.github.com/repos/apache/spark/issues/26644/comments,https://api.github.com/repos/apache/spark/pulls/26644/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26644/commits,https://api.github.com/repos/apache/spark/statuses/dd3c913f0c552c975cd96cde554ba90f99b85bab
198,https://api.github.com/repos/apache/spark/pulls/26630,344238187,MDExOlB1bGxSZXF1ZXN0MzQ0MjM4MTg3,https://github.com/apache/spark/pull/26630,https://github.com/apache/spark/pull/26630.diff,https://github.com/apache/spark/pull/26630.patch,https://api.github.com/repos/apache/spark/issues/26630,26630,open,False,[SPARK-29965][core] Ensure that killed executors don't re-register with driver.,"There are 3 different issues that cause the same underlying problem: an executor
that the driver has killed during downscaling registers back with the block
manager in the driver, and the block manager from that point on keeps trying
to contact the dead executor.

The first one is that the heartbeat receiver was asking unknown executors to
re-register when receiving a heartbeat. That code path only really happens
when the executor dies because of a driver killing it, so there's no reason
to re-register.

The second one is a race between the heartbeat receiver and the DAG scheduler.
Both received notifications of an executor's addition and removal
asynchronously (the first one via the listener bus *and* an async local RPC,
the second via its own separate internal message queue). This led to
situations where they disagreed about which executors were really alive; the
change makes it so the heartbeat receiver is updated first, and once that's
done, then the DAG scheduler can update itself. This ensures the hearbeat
receiver knows which executors not to ask to re-register.

The third one is because the block manager couldn't differentiate between
an unknown executor (like one that's been removed) and an executor that needs
to re-register (like one the scheduler decided to unregister because of
too many fetch failures). The change adds code in the block manager master to
track which executors have been removed, so that instead of asking them to
re-register, it just ignores them.

While there I simplified the executor shutdown a bit since it was doing
some stuff unnecessarily.

Tested with existing unit tests, and by repeatedly running workloads on k8s
with dynamic allocation; previously I'd hit these different issues somewhat
often, with the fixes I'm not able to reproduce them.",2019-11-21T21:18:34Z,2020-04-02T01:12:07Z,,,3a917cf6df76b22cb47e310a95feed04cc3e69ca,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26630/commits,https://api.github.com/repos/apache/spark/pulls/26630/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26630/comments,https://api.github.com/repos/apache/spark/statuses/ed0b6e97f1e3a964b661b08046d0267d2e18b0c3,NONE,spark,apache,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,vanzin:SPARK-29965,SPARK-29965,ed0b6e97f1e3a964b661b08046d0267d2e18b0c3,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,18302272,MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==,spark,vanzin/spark,False,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,https://github.com/vanzin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/vanzin/spark,https://api.github.com/repos/vanzin/spark/forks,https://api.github.com/repos/vanzin/spark/keys{/key_id},https://api.github.com/repos/vanzin/spark/collaborators{/collaborator},https://api.github.com/repos/vanzin/spark/teams,https://api.github.com/repos/vanzin/spark/hooks,https://api.github.com/repos/vanzin/spark/issues/events{/number},https://api.github.com/repos/vanzin/spark/events,https://api.github.com/repos/vanzin/spark/assignees{/user},https://api.github.com/repos/vanzin/spark/branches{/branch},https://api.github.com/repos/vanzin/spark/tags,https://api.github.com/repos/vanzin/spark/git/blobs{/sha},https://api.github.com/repos/vanzin/spark/git/tags{/sha},https://api.github.com/repos/vanzin/spark/git/refs{/sha},https://api.github.com/repos/vanzin/spark/git/trees{/sha},https://api.github.com/repos/vanzin/spark/statuses/{sha},https://api.github.com/repos/vanzin/spark/languages,https://api.github.com/repos/vanzin/spark/stargazers,https://api.github.com/repos/vanzin/spark/contributors,https://api.github.com/repos/vanzin/spark/subscribers,https://api.github.com/repos/vanzin/spark/subscription,https://api.github.com/repos/vanzin/spark/commits{/sha},https://api.github.com/repos/vanzin/spark/git/commits{/sha},https://api.github.com/repos/vanzin/spark/comments{/number},https://api.github.com/repos/vanzin/spark/issues/comments{/number},https://api.github.com/repos/vanzin/spark/contents/{+path},https://api.github.com/repos/vanzin/spark/compare/{base}...{head},https://api.github.com/repos/vanzin/spark/merges,https://api.github.com/repos/vanzin/spark/{archive_format}{/ref},https://api.github.com/repos/vanzin/spark/downloads,https://api.github.com/repos/vanzin/spark/issues{/number},https://api.github.com/repos/vanzin/spark/pulls{/number},https://api.github.com/repos/vanzin/spark/milestones{/number},"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}",https://api.github.com/repos/vanzin/spark/labels{/name},https://api.github.com/repos/vanzin/spark/releases{/id},https://api.github.com/repos/vanzin/spark/deployments,2014-03-31T17:49:25Z,2018-01-06T03:57:54Z,2020-01-24T16:55:58Z,git://github.com/vanzin/spark.git,git@github.com:vanzin/spark.git,https://github.com/vanzin/spark.git,https://github.com/vanzin/spark,,287134,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,ed44926117d81aa5fa8bd823d401efd235260872,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26630,https://github.com/apache/spark/pull/26630,https://api.github.com/repos/apache/spark/issues/26630,https://api.github.com/repos/apache/spark/issues/26630/comments,https://api.github.com/repos/apache/spark/pulls/26630/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26630/commits,https://api.github.com/repos/apache/spark/statuses/ed0b6e97f1e3a964b661b08046d0267d2e18b0c3
199,https://api.github.com/repos/apache/spark/pulls/26624,343943046,MDExOlB1bGxSZXF1ZXN0MzQzOTQzMDQ2,https://github.com/apache/spark/pull/26624,https://github.com/apache/spark/pull/26624.diff,https://github.com/apache/spark/pull/26624.patch,https://api.github.com/repos/apache/spark/issues/26624,26624,open,False,[SPARK-8981][core] Add MDC support in Executor ,"### What changes were proposed in this pull request?
Added MDC support in all thread pulls
TheardUtils create new pools that pass over MDC.

### Why are the changes needed?
In many cases, it is very hard to understand from which actions the logs in the executor come from.
when you are doing multi-thread work in the driver and send actions in parallel.

### Does this PR introduce any user-facing change?
No


### How was this patch tested?
No test added because no new functionality added it is thread pull change and all current tests pass. 
",2019-11-21T10:04:23Z,2020-01-02T08:24:46Z,,,ccd2ba8fc39d708b33c9e6d0a1136592f547ea01,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26624/commits,https://api.github.com/repos/apache/spark/pulls/26624/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26624/comments,https://api.github.com/repos/apache/spark/statuses/6c2d27d35f70d8705ba359ff6cb68ead2fbad32d,NONE,spark,apache,igreenfield,5586356,MDQ6VXNlcjU1ODYzNTY=,https://avatars0.githubusercontent.com/u/5586356?v=4,,https://api.github.com/users/igreenfield,https://github.com/igreenfield,https://api.github.com/users/igreenfield/followers,https://api.github.com/users/igreenfield/following{/other_user},https://api.github.com/users/igreenfield/gists{/gist_id},https://api.github.com/users/igreenfield/starred{/owner}{/repo},https://api.github.com/users/igreenfield/subscriptions,https://api.github.com/users/igreenfield/orgs,https://api.github.com/users/igreenfield/repos,https://api.github.com/users/igreenfield/events{/privacy},https://api.github.com/users/igreenfield/received_events,User,False,igreenfield:master,master,6c2d27d35f70d8705ba359ff6cb68ead2fbad32d,igreenfield,5586356,MDQ6VXNlcjU1ODYzNTY=,https://avatars0.githubusercontent.com/u/5586356?v=4,,https://api.github.com/users/igreenfield,https://github.com/igreenfield,https://api.github.com/users/igreenfield/followers,https://api.github.com/users/igreenfield/following{/other_user},https://api.github.com/users/igreenfield/gists{/gist_id},https://api.github.com/users/igreenfield/starred{/owner}{/repo},https://api.github.com/users/igreenfield/subscriptions,https://api.github.com/users/igreenfield/orgs,https://api.github.com/users/igreenfield/repos,https://api.github.com/users/igreenfield/events{/privacy},https://api.github.com/users/igreenfield/received_events,User,False,223125334,MDEwOlJlcG9zaXRvcnkyMjMxMjUzMzQ=,spark,igreenfield/spark,False,igreenfield,5586356,MDQ6VXNlcjU1ODYzNTY=,https://avatars0.githubusercontent.com/u/5586356?v=4,,https://api.github.com/users/igreenfield,https://github.com/igreenfield,https://api.github.com/users/igreenfield/followers,https://api.github.com/users/igreenfield/following{/other_user},https://api.github.com/users/igreenfield/gists{/gist_id},https://api.github.com/users/igreenfield/starred{/owner}{/repo},https://api.github.com/users/igreenfield/subscriptions,https://api.github.com/users/igreenfield/orgs,https://api.github.com/users/igreenfield/repos,https://api.github.com/users/igreenfield/events{/privacy},https://api.github.com/users/igreenfield/received_events,User,False,https://github.com/igreenfield/spark,Apache Spark,True,https://api.github.com/repos/igreenfield/spark,https://api.github.com/repos/igreenfield/spark/forks,https://api.github.com/repos/igreenfield/spark/keys{/key_id},https://api.github.com/repos/igreenfield/spark/collaborators{/collaborator},https://api.github.com/repos/igreenfield/spark/teams,https://api.github.com/repos/igreenfield/spark/hooks,https://api.github.com/repos/igreenfield/spark/issues/events{/number},https://api.github.com/repos/igreenfield/spark/events,https://api.github.com/repos/igreenfield/spark/assignees{/user},https://api.github.com/repos/igreenfield/spark/branches{/branch},https://api.github.com/repos/igreenfield/spark/tags,https://api.github.com/repos/igreenfield/spark/git/blobs{/sha},https://api.github.com/repos/igreenfield/spark/git/tags{/sha},https://api.github.com/repos/igreenfield/spark/git/refs{/sha},https://api.github.com/repos/igreenfield/spark/git/trees{/sha},https://api.github.com/repos/igreenfield/spark/statuses/{sha},https://api.github.com/repos/igreenfield/spark/languages,https://api.github.com/repos/igreenfield/spark/stargazers,https://api.github.com/repos/igreenfield/spark/contributors,https://api.github.com/repos/igreenfield/spark/subscribers,https://api.github.com/repos/igreenfield/spark/subscription,https://api.github.com/repos/igreenfield/spark/commits{/sha},https://api.github.com/repos/igreenfield/spark/git/commits{/sha},https://api.github.com/repos/igreenfield/spark/comments{/number},https://api.github.com/repos/igreenfield/spark/issues/comments{/number},https://api.github.com/repos/igreenfield/spark/contents/{+path},https://api.github.com/repos/igreenfield/spark/compare/{base}...{head},https://api.github.com/repos/igreenfield/spark/merges,https://api.github.com/repos/igreenfield/spark/{archive_format}{/ref},https://api.github.com/repos/igreenfield/spark/downloads,https://api.github.com/repos/igreenfield/spark/issues{/number},https://api.github.com/repos/igreenfield/spark/pulls{/number},https://api.github.com/repos/igreenfield/spark/milestones{/number},"https://api.github.com/repos/igreenfield/spark/notifications{?since,all,participating}",https://api.github.com/repos/igreenfield/spark/labels{/name},https://api.github.com/repos/igreenfield/spark/releases{/id},https://api.github.com/repos/igreenfield/spark/deployments,2019-11-21T08:29:31Z,2019-12-29T14:33:35Z,2019-12-29T14:33:26Z,git://github.com/igreenfield/spark.git,git@github.com:igreenfield/spark.git,https://github.com/igreenfield/spark.git,https://github.com/igreenfield/spark,,321395,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f72db40080785d4d386f8bb9d946a247d94d2d1c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26624,https://github.com/apache/spark/pull/26624,https://api.github.com/repos/apache/spark/issues/26624,https://api.github.com/repos/apache/spark/issues/26624/comments,https://api.github.com/repos/apache/spark/pulls/26624/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26624/commits,https://api.github.com/repos/apache/spark/statuses/6c2d27d35f70d8705ba359ff6cb68ead2fbad32d
200,https://api.github.com/repos/apache/spark/pulls/26585,342399292,MDExOlB1bGxSZXF1ZXN0MzQyMzk5Mjky,https://github.com/apache/spark/pull/26585,https://github.com/apache/spark/pull/26585.diff,https://github.com/apache/spark/pull/26585.patch,https://api.github.com/repos/apache/spark/issues/26585,26585,open,False,[WIP][SPARK-25351][SQL][Python] Handle Pandas category type when converting from Python with Arrow,"Handle Pandas category type while converting from python with Arrow vector

### Does this PR introduce any user-facing change?
No

### How was this patch tested?
- Manual Testing
```
Using Python version 2.7.16 (default, Sep  2 2019 11:59:44)
SparkSession available as 'spark'.
>>> import pandas as pd
>>> pdf = pd.DataFrame({""A"":[u""a"",u""b"",u""c"",u""a""]})
>>> pdf[""B""] = pdf[""A""].astype('category')
>>> pdf
   A  B
0  a  a
1  b  b
2  c  c
3  a  a
>>> pdf.dtypes
A      object
B    category
dtype: object
>>> spark.conf.set(""spark.sql.execution.arrow.enabled"", False)
>>> df = spark.createDataFrame(pdf)
>>> df.printSchema()
root
 |-- A: string (nullable = true)
 |-- B: string (nullable = true)

>>> df.show()
+---+---+
|  A|  B|
+---+---+
|  a|  a|
|  b|  b|
|  c|  c|
|  a|  a|
+---+---+

>>> spark.conf.set(""spark.sql.execution.arrow.enabled"", True)
>>> df = spark.createDataFrame(pdf)
>>> df.printSchema()
root
 |-- A: string (nullable = true)
 |-- B: string (nullable = true)

>>> df.show()
+---+---+
|  A|  B|
+---+---+
|  a|  a|
|  b|  b|
|  c|  c|
|  a|  a|
+---+---+

>>>
```
",2019-11-18T22:46:07Z,2020-04-01T19:28:12Z,,,823a4ba73ac6f5849933f922d9e20b5014061223,,[],"[{'login': 'HyukjinKwon', 'id': 6477701, 'node_id': 'MDQ6VXNlcjY0Nzc3MDE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/6477701?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/HyukjinKwon', 'html_url': 'https://github.com/HyukjinKwon', 'followers_url': 'https://api.github.com/users/HyukjinKwon/followers', 'following_url': 'https://api.github.com/users/HyukjinKwon/following{/other_user}', 'gists_url': 'https://api.github.com/users/HyukjinKwon/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/HyukjinKwon/subscriptions', 'organizations_url': 'https://api.github.com/users/HyukjinKwon/orgs', 'repos_url': 'https://api.github.com/users/HyukjinKwon/repos', 'events_url': 'https://api.github.com/users/HyukjinKwon/events{/privacy}', 'received_events_url': 'https://api.github.com/users/HyukjinKwon/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26585/commits,https://api.github.com/repos/apache/spark/pulls/26585/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26585/comments,https://api.github.com/repos/apache/spark/statuses/1a2447be5484fa651ac2fb4a1ce68ad836c37e61,NONE,spark,apache,jalpan-randeri,5408989,MDQ6VXNlcjU0MDg5ODk=,https://avatars1.githubusercontent.com/u/5408989?v=4,,https://api.github.com/users/jalpan-randeri,https://github.com/jalpan-randeri,https://api.github.com/users/jalpan-randeri/followers,https://api.github.com/users/jalpan-randeri/following{/other_user},https://api.github.com/users/jalpan-randeri/gists{/gist_id},https://api.github.com/users/jalpan-randeri/starred{/owner}{/repo},https://api.github.com/users/jalpan-randeri/subscriptions,https://api.github.com/users/jalpan-randeri/orgs,https://api.github.com/users/jalpan-randeri/repos,https://api.github.com/users/jalpan-randeri/events{/privacy},https://api.github.com/users/jalpan-randeri/received_events,User,False,jalpan-randeri:feature-pyarrow-dictionary-type,feature-pyarrow-dictionary-type,1a2447be5484fa651ac2fb4a1ce68ad836c37e61,jalpan-randeri,5408989,MDQ6VXNlcjU0MDg5ODk=,https://avatars1.githubusercontent.com/u/5408989?v=4,,https://api.github.com/users/jalpan-randeri,https://github.com/jalpan-randeri,https://api.github.com/users/jalpan-randeri/followers,https://api.github.com/users/jalpan-randeri/following{/other_user},https://api.github.com/users/jalpan-randeri/gists{/gist_id},https://api.github.com/users/jalpan-randeri/starred{/owner}{/repo},https://api.github.com/users/jalpan-randeri/subscriptions,https://api.github.com/users/jalpan-randeri/orgs,https://api.github.com/users/jalpan-randeri/repos,https://api.github.com/users/jalpan-randeri/events{/privacy},https://api.github.com/users/jalpan-randeri/received_events,User,False,221611476,MDEwOlJlcG9zaXRvcnkyMjE2MTE0NzY=,spark,jalpan-randeri/spark,False,jalpan-randeri,5408989,MDQ6VXNlcjU0MDg5ODk=,https://avatars1.githubusercontent.com/u/5408989?v=4,,https://api.github.com/users/jalpan-randeri,https://github.com/jalpan-randeri,https://api.github.com/users/jalpan-randeri/followers,https://api.github.com/users/jalpan-randeri/following{/other_user},https://api.github.com/users/jalpan-randeri/gists{/gist_id},https://api.github.com/users/jalpan-randeri/starred{/owner}{/repo},https://api.github.com/users/jalpan-randeri/subscriptions,https://api.github.com/users/jalpan-randeri/orgs,https://api.github.com/users/jalpan-randeri/repos,https://api.github.com/users/jalpan-randeri/events{/privacy},https://api.github.com/users/jalpan-randeri/received_events,User,False,https://github.com/jalpan-randeri/spark,Apache Spark,True,https://api.github.com/repos/jalpan-randeri/spark,https://api.github.com/repos/jalpan-randeri/spark/forks,https://api.github.com/repos/jalpan-randeri/spark/keys{/key_id},https://api.github.com/repos/jalpan-randeri/spark/collaborators{/collaborator},https://api.github.com/repos/jalpan-randeri/spark/teams,https://api.github.com/repos/jalpan-randeri/spark/hooks,https://api.github.com/repos/jalpan-randeri/spark/issues/events{/number},https://api.github.com/repos/jalpan-randeri/spark/events,https://api.github.com/repos/jalpan-randeri/spark/assignees{/user},https://api.github.com/repos/jalpan-randeri/spark/branches{/branch},https://api.github.com/repos/jalpan-randeri/spark/tags,https://api.github.com/repos/jalpan-randeri/spark/git/blobs{/sha},https://api.github.com/repos/jalpan-randeri/spark/git/tags{/sha},https://api.github.com/repos/jalpan-randeri/spark/git/refs{/sha},https://api.github.com/repos/jalpan-randeri/spark/git/trees{/sha},https://api.github.com/repos/jalpan-randeri/spark/statuses/{sha},https://api.github.com/repos/jalpan-randeri/spark/languages,https://api.github.com/repos/jalpan-randeri/spark/stargazers,https://api.github.com/repos/jalpan-randeri/spark/contributors,https://api.github.com/repos/jalpan-randeri/spark/subscribers,https://api.github.com/repos/jalpan-randeri/spark/subscription,https://api.github.com/repos/jalpan-randeri/spark/commits{/sha},https://api.github.com/repos/jalpan-randeri/spark/git/commits{/sha},https://api.github.com/repos/jalpan-randeri/spark/comments{/number},https://api.github.com/repos/jalpan-randeri/spark/issues/comments{/number},https://api.github.com/repos/jalpan-randeri/spark/contents/{+path},https://api.github.com/repos/jalpan-randeri/spark/compare/{base}...{head},https://api.github.com/repos/jalpan-randeri/spark/merges,https://api.github.com/repos/jalpan-randeri/spark/{archive_format}{/ref},https://api.github.com/repos/jalpan-randeri/spark/downloads,https://api.github.com/repos/jalpan-randeri/spark/issues{/number},https://api.github.com/repos/jalpan-randeri/spark/pulls{/number},https://api.github.com/repos/jalpan-randeri/spark/milestones{/number},"https://api.github.com/repos/jalpan-randeri/spark/notifications{?since,all,participating}",https://api.github.com/repos/jalpan-randeri/spark/labels{/name},https://api.github.com/repos/jalpan-randeri/spark/releases{/id},https://api.github.com/repos/jalpan-randeri/spark/deployments,2019-11-14T04:28:09Z,2019-11-14T04:28:13Z,2020-02-03T21:28:33Z,git://github.com/jalpan-randeri/spark.git,git@github.com:jalpan-randeri/spark.git,https://github.com/jalpan-randeri/spark.git,https://github.com/jalpan-randeri/spark,,319596,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2d4b5eaee4bdaea692a08e2edd1b3a63ce77d5b9,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26585,https://github.com/apache/spark/pull/26585,https://api.github.com/repos/apache/spark/issues/26585,https://api.github.com/repos/apache/spark/issues/26585/comments,https://api.github.com/repos/apache/spark/pulls/26585/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26585/commits,https://api.github.com/repos/apache/spark/statuses/1a2447be5484fa651ac2fb4a1ce68ad836c37e61
201,https://api.github.com/repos/apache/spark/pulls/26541,341321590,MDExOlB1bGxSZXF1ZXN0MzQxMzIxNTkw,https://github.com/apache/spark/pull/26541,https://github.com/apache/spark/pull/26541.diff,https://github.com/apache/spark/pull/26541.patch,https://api.github.com/repos/apache/spark/issues/26541,26541,open,False,[SPARK-29910][SQL] Optimize speculation performance by adding minimum runtime limit,"### What changes were proposed in this pull request?
The minimum runtime to speculation used to be a fixed value 100ms.  It means tasks finished in seconds will also be speculated and more executors will be required.
To improve this situation, we add `spark.speculation.minRuntime` to control the minimum runtime limit of speculation.
We can reduce normal tasks to be speculated by adjusting `spark.speculation.minRuntime`.

_**Example:**_
Tasks that don't need to be speculated:
![image](https://user-images.githubusercontent.com/25916266/68921759-b62afe00-07b4-11ea-8786-d50ef0d20ea0.png)
and
![image](https://user-images.githubusercontent.com/25916266/68921795-d3f86300-07b4-11ea-8ebf-27cf2a0fa493.png)

Tasks are more likely to go wrong and need to be speculated:
(especially those shuffle tasks with large amount of data and will cost minutes even hours)
![image](https://user-images.githubusercontent.com/25916266/68921934-39e4ea80-07b5-11ea-84b2-6e115c3960b0.png)


### Why are the changes needed?
To improve speculation performance by reducing speculated tasks which don't need to be speculated actually.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Unit tests.
",2019-11-15T06:44:36Z,2020-01-15T14:52:08Z,,,9907aaf56a182fc46660fb578673d6d9600973c6,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26541/commits,https://api.github.com/repos/apache/spark/pulls/26541/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26541/comments,https://api.github.com/repos/apache/spark/statuses/fbf0f0cec3ee363f43d621d239513e1d4d195645,CONTRIBUTOR,spark,apache,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,Deegue:add_conf_speculation_min_time,add_conf_speculation_min_time,fbf0f0cec3ee363f43d621d239513e1d4d195645,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,194640910,MDEwOlJlcG9zaXRvcnkxOTQ2NDA5MTA=,spark,Deegue/spark,False,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,https://github.com/Deegue/spark,Apache Spark,True,https://api.github.com/repos/Deegue/spark,https://api.github.com/repos/Deegue/spark/forks,https://api.github.com/repos/Deegue/spark/keys{/key_id},https://api.github.com/repos/Deegue/spark/collaborators{/collaborator},https://api.github.com/repos/Deegue/spark/teams,https://api.github.com/repos/Deegue/spark/hooks,https://api.github.com/repos/Deegue/spark/issues/events{/number},https://api.github.com/repos/Deegue/spark/events,https://api.github.com/repos/Deegue/spark/assignees{/user},https://api.github.com/repos/Deegue/spark/branches{/branch},https://api.github.com/repos/Deegue/spark/tags,https://api.github.com/repos/Deegue/spark/git/blobs{/sha},https://api.github.com/repos/Deegue/spark/git/tags{/sha},https://api.github.com/repos/Deegue/spark/git/refs{/sha},https://api.github.com/repos/Deegue/spark/git/trees{/sha},https://api.github.com/repos/Deegue/spark/statuses/{sha},https://api.github.com/repos/Deegue/spark/languages,https://api.github.com/repos/Deegue/spark/stargazers,https://api.github.com/repos/Deegue/spark/contributors,https://api.github.com/repos/Deegue/spark/subscribers,https://api.github.com/repos/Deegue/spark/subscription,https://api.github.com/repos/Deegue/spark/commits{/sha},https://api.github.com/repos/Deegue/spark/git/commits{/sha},https://api.github.com/repos/Deegue/spark/comments{/number},https://api.github.com/repos/Deegue/spark/issues/comments{/number},https://api.github.com/repos/Deegue/spark/contents/{+path},https://api.github.com/repos/Deegue/spark/compare/{base}...{head},https://api.github.com/repos/Deegue/spark/merges,https://api.github.com/repos/Deegue/spark/{archive_format}{/ref},https://api.github.com/repos/Deegue/spark/downloads,https://api.github.com/repos/Deegue/spark/issues{/number},https://api.github.com/repos/Deegue/spark/pulls{/number},https://api.github.com/repos/Deegue/spark/milestones{/number},"https://api.github.com/repos/Deegue/spark/notifications{?since,all,participating}",https://api.github.com/repos/Deegue/spark/labels{/name},https://api.github.com/repos/Deegue/spark/releases{/id},https://api.github.com/repos/Deegue/spark/deployments,2019-07-01T09:20:59Z,2019-11-19T03:54:24Z,2020-03-27T07:30:23Z,git://github.com/Deegue/spark.git,git@github.com:Deegue/spark.git,https://github.com/Deegue/spark.git,https://github.com/Deegue/spark,,313023,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,0c68578fa9d03002a2d1708762c3010fd28430c5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26541,https://github.com/apache/spark/pull/26541,https://api.github.com/repos/apache/spark/issues/26541,https://api.github.com/repos/apache/spark/issues/26541/comments,https://api.github.com/repos/apache/spark/pulls/26541/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26541/commits,https://api.github.com/repos/apache/spark/statuses/fbf0f0cec3ee363f43d621d239513e1d4d195645
202,https://api.github.com/repos/apache/spark/pulls/26535,341260775,MDExOlB1bGxSZXF1ZXN0MzQxMjYwNzc1,https://github.com/apache/spark/pull/26535,https://github.com/apache/spark/pull/26535.diff,https://github.com/apache/spark/pull/26535.patch,https://api.github.com/repos/apache/spark/issues/26535,26535,open,False,[SPARK-29905][k8s] Improve pod lifecycle manager behavior with dynamic allocation.,"This issue mainly shows up when you enable dynamic allocation:
because there are many executor state changes (because of executors
being requested and starting to run, and later stopped), the lifecycle
manager class could end up logging information about the same executor
multiple times, since the different events would cause the same
executor update to be present in multiple pod snapshots. On top of that,
it could end up making multiple redundant calls into the API server
for the same pod.

Another issue was when the config was set to not delete executor
pods; with dynamic allocation, that means pods keep accumulating
in the API server, and every time the full sync is done by the
polling source, all executors, even the finished ones that Spark
technically does not care about anymore, would be processed.

The change modifies the lifecycle monitor so that it:

- logs executor updates a single time, even if it shows up in
  multiple snapshots, by checking whether the state change
  happened before.
- marks finished-but-not-deleted-in-k8s executors with a label
  so that they can be easily filtered out.

This reduces the amount of logging done by the lifecycle manager,
which is a minor thing in general since the logs are at debug level.
But it also reduces the amount of data that needs to be fetched
from the API server under certain configurations, and overall
reduces interaction with the API server when dynamic allocation is on.

There's also a change in the snapshot store to ensure that the
same subscriber is not called concurrently. That is kind of a bug,
since it means subscribers could be processing snapshots out of order,
or even that they could block multiple threads (e.g. the allocator
callback was synchronized). I actually ran into the ""concurrent calls""
situation in the lifecycle manager during testing, and while it did not
seem to cause problems, it did make for some head scratching while
looking at the logs. It seemed safer to fix that.

Unit tests were updated to check for the changes. Also tested in real
cluster with dynamic allocation on.",2019-11-15T02:11:05Z,2020-03-13T22:04:06Z,,,d7f866587bde8d39e6cbb0f187664dbf9157755e,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26535/commits,https://api.github.com/repos/apache/spark/pulls/26535/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26535/comments,https://api.github.com/repos/apache/spark/statuses/08e8d8267e78979b4637368cca27a0be1e9f08df,NONE,spark,apache,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,vanzin:SPARK-29905,SPARK-29905,08e8d8267e78979b4637368cca27a0be1e9f08df,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,18302272,MDEwOlJlcG9zaXRvcnkxODMwMjI3Mg==,spark,vanzin/spark,False,vanzin,1694083,MDQ6VXNlcjE2OTQwODM=,https://avatars0.githubusercontent.com/u/1694083?v=4,,https://api.github.com/users/vanzin,https://github.com/vanzin,https://api.github.com/users/vanzin/followers,https://api.github.com/users/vanzin/following{/other_user},https://api.github.com/users/vanzin/gists{/gist_id},https://api.github.com/users/vanzin/starred{/owner}{/repo},https://api.github.com/users/vanzin/subscriptions,https://api.github.com/users/vanzin/orgs,https://api.github.com/users/vanzin/repos,https://api.github.com/users/vanzin/events{/privacy},https://api.github.com/users/vanzin/received_events,User,False,https://github.com/vanzin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/vanzin/spark,https://api.github.com/repos/vanzin/spark/forks,https://api.github.com/repos/vanzin/spark/keys{/key_id},https://api.github.com/repos/vanzin/spark/collaborators{/collaborator},https://api.github.com/repos/vanzin/spark/teams,https://api.github.com/repos/vanzin/spark/hooks,https://api.github.com/repos/vanzin/spark/issues/events{/number},https://api.github.com/repos/vanzin/spark/events,https://api.github.com/repos/vanzin/spark/assignees{/user},https://api.github.com/repos/vanzin/spark/branches{/branch},https://api.github.com/repos/vanzin/spark/tags,https://api.github.com/repos/vanzin/spark/git/blobs{/sha},https://api.github.com/repos/vanzin/spark/git/tags{/sha},https://api.github.com/repos/vanzin/spark/git/refs{/sha},https://api.github.com/repos/vanzin/spark/git/trees{/sha},https://api.github.com/repos/vanzin/spark/statuses/{sha},https://api.github.com/repos/vanzin/spark/languages,https://api.github.com/repos/vanzin/spark/stargazers,https://api.github.com/repos/vanzin/spark/contributors,https://api.github.com/repos/vanzin/spark/subscribers,https://api.github.com/repos/vanzin/spark/subscription,https://api.github.com/repos/vanzin/spark/commits{/sha},https://api.github.com/repos/vanzin/spark/git/commits{/sha},https://api.github.com/repos/vanzin/spark/comments{/number},https://api.github.com/repos/vanzin/spark/issues/comments{/number},https://api.github.com/repos/vanzin/spark/contents/{+path},https://api.github.com/repos/vanzin/spark/compare/{base}...{head},https://api.github.com/repos/vanzin/spark/merges,https://api.github.com/repos/vanzin/spark/{archive_format}{/ref},https://api.github.com/repos/vanzin/spark/downloads,https://api.github.com/repos/vanzin/spark/issues{/number},https://api.github.com/repos/vanzin/spark/pulls{/number},https://api.github.com/repos/vanzin/spark/milestones{/number},"https://api.github.com/repos/vanzin/spark/notifications{?since,all,participating}",https://api.github.com/repos/vanzin/spark/labels{/name},https://api.github.com/repos/vanzin/spark/releases{/id},https://api.github.com/repos/vanzin/spark/deployments,2014-03-31T17:49:25Z,2018-01-06T03:57:54Z,2020-01-24T16:55:58Z,git://github.com/vanzin/spark.git,git@github.com:vanzin/spark.git,https://github.com/vanzin/spark.git,https://github.com/vanzin/spark,,287134,1,1,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,1,master,apache:master,master,ed44926117d81aa5fa8bd823d401efd235260872,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26535,https://github.com/apache/spark/pull/26535,https://api.github.com/repos/apache/spark/issues/26535,https://api.github.com/repos/apache/spark/issues/26535/comments,https://api.github.com/repos/apache/spark/pulls/26535/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26535/commits,https://api.github.com/repos/apache/spark/statuses/08e8d8267e78979b4637368cca27a0be1e9f08df
203,https://api.github.com/repos/apache/spark/pulls/26503,340454472,MDExOlB1bGxSZXF1ZXN0MzQwNDU0NDcy,https://github.com/apache/spark/pull/26503,https://github.com/apache/spark/pull/26503.diff,https://github.com/apache/spark/pull/26503.patch,https://api.github.com/repos/apache/spark/issues/26503,26503,open,False,[SPARK-29880][CORE][YARN] Handle submit exception when submit to federation cluster,"When we submit application to federation yarn cluster. Since getYarnClusterMetrics is not implemented. The submission will exit with failure.

    ResourceRequestHelper.validateResources(sparkConf)
    var appId: ApplicationId = null
    try {
      launcherBackend.connect()
      yarnClient.init(hadoopConf)
      yarnClient.start()

     logInfo(""Requesting a new application from cluster with %d NodeManagers""
          .format(yarnClient.getYarnClusterMetrics.getNumNodeManagers))`
### Why are the changes needed?
Since hadoop federation cluster was deployed, spark application will submit with failure if we do not handle the exception.
### How was this patch tested?
UT
",2019-11-13T13:11:15Z,2020-02-11T18:24:27Z,,,3ec281b9466e9773313185a1a176536680efdd25,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26503/commits,https://api.github.com/repos/apache/spark/pulls/26503/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26503/comments,https://api.github.com/repos/apache/spark/statuses/8920a1886c9bd4749ae7ac2db5f92fd266c36d93,CONTRIBUTOR,spark,apache,caneGuy,26762018,MDQ6VXNlcjI2NzYyMDE4,https://avatars2.githubusercontent.com/u/26762018?v=4,,https://api.github.com/users/caneGuy,https://github.com/caneGuy,https://api.github.com/users/caneGuy/followers,https://api.github.com/users/caneGuy/following{/other_user},https://api.github.com/users/caneGuy/gists{/gist_id},https://api.github.com/users/caneGuy/starred{/owner}{/repo},https://api.github.com/users/caneGuy/subscriptions,https://api.github.com/users/caneGuy/orgs,https://api.github.com/users/caneGuy/repos,https://api.github.com/users/caneGuy/events{/privacy},https://api.github.com/users/caneGuy/received_events,User,False,caneGuy:zhoukang/SARK-29880,zhoukang/SARK-29880,8920a1886c9bd4749ae7ac2db5f92fd266c36d93,caneGuy,26762018,MDQ6VXNlcjI2NzYyMDE4,https://avatars2.githubusercontent.com/u/26762018?v=4,,https://api.github.com/users/caneGuy,https://github.com/caneGuy,https://api.github.com/users/caneGuy/followers,https://api.github.com/users/caneGuy/following{/other_user},https://api.github.com/users/caneGuy/gists{/gist_id},https://api.github.com/users/caneGuy/starred{/owner}{/repo},https://api.github.com/users/caneGuy/subscriptions,https://api.github.com/users/caneGuy/orgs,https://api.github.com/users/caneGuy/repos,https://api.github.com/users/caneGuy/events{/privacy},https://api.github.com/users/caneGuy/received_events,User,False,96277831,MDEwOlJlcG9zaXRvcnk5NjI3NzgzMQ==,spark,caneGuy/spark,False,caneGuy,26762018,MDQ6VXNlcjI2NzYyMDE4,https://avatars2.githubusercontent.com/u/26762018?v=4,,https://api.github.com/users/caneGuy,https://github.com/caneGuy,https://api.github.com/users/caneGuy/followers,https://api.github.com/users/caneGuy/following{/other_user},https://api.github.com/users/caneGuy/gists{/gist_id},https://api.github.com/users/caneGuy/starred{/owner}{/repo},https://api.github.com/users/caneGuy/subscriptions,https://api.github.com/users/caneGuy/orgs,https://api.github.com/users/caneGuy/repos,https://api.github.com/users/caneGuy/events{/privacy},https://api.github.com/users/caneGuy/received_events,User,False,https://github.com/caneGuy/spark,Mirror of Apache Spark,True,https://api.github.com/repos/caneGuy/spark,https://api.github.com/repos/caneGuy/spark/forks,https://api.github.com/repos/caneGuy/spark/keys{/key_id},https://api.github.com/repos/caneGuy/spark/collaborators{/collaborator},https://api.github.com/repos/caneGuy/spark/teams,https://api.github.com/repos/caneGuy/spark/hooks,https://api.github.com/repos/caneGuy/spark/issues/events{/number},https://api.github.com/repos/caneGuy/spark/events,https://api.github.com/repos/caneGuy/spark/assignees{/user},https://api.github.com/repos/caneGuy/spark/branches{/branch},https://api.github.com/repos/caneGuy/spark/tags,https://api.github.com/repos/caneGuy/spark/git/blobs{/sha},https://api.github.com/repos/caneGuy/spark/git/tags{/sha},https://api.github.com/repos/caneGuy/spark/git/refs{/sha},https://api.github.com/repos/caneGuy/spark/git/trees{/sha},https://api.github.com/repos/caneGuy/spark/statuses/{sha},https://api.github.com/repos/caneGuy/spark/languages,https://api.github.com/repos/caneGuy/spark/stargazers,https://api.github.com/repos/caneGuy/spark/contributors,https://api.github.com/repos/caneGuy/spark/subscribers,https://api.github.com/repos/caneGuy/spark/subscription,https://api.github.com/repos/caneGuy/spark/commits{/sha},https://api.github.com/repos/caneGuy/spark/git/commits{/sha},https://api.github.com/repos/caneGuy/spark/comments{/number},https://api.github.com/repos/caneGuy/spark/issues/comments{/number},https://api.github.com/repos/caneGuy/spark/contents/{+path},https://api.github.com/repos/caneGuy/spark/compare/{base}...{head},https://api.github.com/repos/caneGuy/spark/merges,https://api.github.com/repos/caneGuy/spark/{archive_format}{/ref},https://api.github.com/repos/caneGuy/spark/downloads,https://api.github.com/repos/caneGuy/spark/issues{/number},https://api.github.com/repos/caneGuy/spark/pulls{/number},https://api.github.com/repos/caneGuy/spark/milestones{/number},"https://api.github.com/repos/caneGuy/spark/notifications{?since,all,participating}",https://api.github.com/repos/caneGuy/spark/labels{/name},https://api.github.com/repos/caneGuy/spark/releases{/id},https://api.github.com/repos/caneGuy/spark/deployments,2017-07-05T04:50:34Z,2019-11-13T13:03:25Z,2019-11-13T13:09:13Z,git://github.com/caneGuy/spark.git,git@github.com:caneGuy/spark.git,https://github.com/caneGuy/spark.git,https://github.com/caneGuy/spark,,309196,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2beca777b691cdcc7e46ee64628f67e5b7834ae5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26503,https://github.com/apache/spark/pull/26503,https://api.github.com/repos/apache/spark/issues/26503,https://api.github.com/repos/apache/spark/issues/26503/comments,https://api.github.com/repos/apache/spark/pulls/26503/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26503/commits,https://api.github.com/repos/apache/spark/statuses/8920a1886c9bd4749ae7ac2db5f92fd266c36d93
204,https://api.github.com/repos/apache/spark/pulls/26422,337900097,MDExOlB1bGxSZXF1ZXN0MzM3OTAwMDk3,https://github.com/apache/spark/pull/26422,https://github.com/apache/spark/pull/26422.diff,https://github.com/apache/spark/pull/26422.patch,https://api.github.com/repos/apache/spark/issues/26422,26422,open,False,[SPARK-29786][SQL] Fix MetaException when dropping a partition not exists on HDFS,"### What changes were proposed in this pull request?
When we drop a partition which exist on Hive meta and doesn't exist on HDFS, it should be dropped successfully instead of throwing MetaException.

Hive also deals with this case by this method.

Example:
Before this patch:
```
spark-sql > alter table test.tmp drop partition(stat_day=20190516);
Error: Error running query: MetaException(message:File does not exist: /user/hive/warehouse/test.db/tmp/stat_day=20190516
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.getContentSummary(FSDirectory.java:2414)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getContentSummary(FSNamesystem.java:4719)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getContentSummary(NameNodeRpcServer.java:1237)
	at org.apache.hadoop.hdfs.server.namenode.AuthorizationProviderProxyClientProtocol.getContentSummary(AuthorizationProviderProxyClientProtocol.java:568)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getContentSummary(ClientNamenodeProtocolServerSideTranslatorPB.java:896)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:617)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1073)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2278)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2274)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1924)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2274)
) (state=,code=0)
```

After this patch:
```
spark-sql > alter table test.tmp drop partition(stat_day=20190516);
+---------+--+
| Result  |
+---------+--+
+---------+--+
No rows selected (0.521 seconds)
```

### Why are the changes needed?
When we drop a partition which exist on Hive meta and doesn't exist on HDFS, we will receive MetaException. But actually, this partition has been dropped. It's quite confusing and in this case, no Exception should be thrown.

### Does this PR introduce any user-facing change?
No.

### How was this patch tested?
Unit tests.
",2019-11-07T07:43:52Z,2020-03-27T10:17:06Z,,,08b7c3d1b1bf180531bdacccd45546033d29c298,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26422/commits,https://api.github.com/repos/apache/spark/pulls/26422/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26422/comments,https://api.github.com/repos/apache/spark/statuses/7cf7c6b991ba6a997476384ec703656e28505fbf,CONTRIBUTOR,spark,apache,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,Deegue:fix_empty_partition_InvalidInputException,fix_empty_partition_InvalidInputException,7cf7c6b991ba6a997476384ec703656e28505fbf,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,194640910,MDEwOlJlcG9zaXRvcnkxOTQ2NDA5MTA=,spark,Deegue/spark,False,Deegue,25916266,MDQ6VXNlcjI1OTE2MjY2,https://avatars3.githubusercontent.com/u/25916266?v=4,,https://api.github.com/users/Deegue,https://github.com/Deegue,https://api.github.com/users/Deegue/followers,https://api.github.com/users/Deegue/following{/other_user},https://api.github.com/users/Deegue/gists{/gist_id},https://api.github.com/users/Deegue/starred{/owner}{/repo},https://api.github.com/users/Deegue/subscriptions,https://api.github.com/users/Deegue/orgs,https://api.github.com/users/Deegue/repos,https://api.github.com/users/Deegue/events{/privacy},https://api.github.com/users/Deegue/received_events,User,False,https://github.com/Deegue/spark,Apache Spark,True,https://api.github.com/repos/Deegue/spark,https://api.github.com/repos/Deegue/spark/forks,https://api.github.com/repos/Deegue/spark/keys{/key_id},https://api.github.com/repos/Deegue/spark/collaborators{/collaborator},https://api.github.com/repos/Deegue/spark/teams,https://api.github.com/repos/Deegue/spark/hooks,https://api.github.com/repos/Deegue/spark/issues/events{/number},https://api.github.com/repos/Deegue/spark/events,https://api.github.com/repos/Deegue/spark/assignees{/user},https://api.github.com/repos/Deegue/spark/branches{/branch},https://api.github.com/repos/Deegue/spark/tags,https://api.github.com/repos/Deegue/spark/git/blobs{/sha},https://api.github.com/repos/Deegue/spark/git/tags{/sha},https://api.github.com/repos/Deegue/spark/git/refs{/sha},https://api.github.com/repos/Deegue/spark/git/trees{/sha},https://api.github.com/repos/Deegue/spark/statuses/{sha},https://api.github.com/repos/Deegue/spark/languages,https://api.github.com/repos/Deegue/spark/stargazers,https://api.github.com/repos/Deegue/spark/contributors,https://api.github.com/repos/Deegue/spark/subscribers,https://api.github.com/repos/Deegue/spark/subscription,https://api.github.com/repos/Deegue/spark/commits{/sha},https://api.github.com/repos/Deegue/spark/git/commits{/sha},https://api.github.com/repos/Deegue/spark/comments{/number},https://api.github.com/repos/Deegue/spark/issues/comments{/number},https://api.github.com/repos/Deegue/spark/contents/{+path},https://api.github.com/repos/Deegue/spark/compare/{base}...{head},https://api.github.com/repos/Deegue/spark/merges,https://api.github.com/repos/Deegue/spark/{archive_format}{/ref},https://api.github.com/repos/Deegue/spark/downloads,https://api.github.com/repos/Deegue/spark/issues{/number},https://api.github.com/repos/Deegue/spark/pulls{/number},https://api.github.com/repos/Deegue/spark/milestones{/number},"https://api.github.com/repos/Deegue/spark/notifications{?since,all,participating}",https://api.github.com/repos/Deegue/spark/labels{/name},https://api.github.com/repos/Deegue/spark/releases{/id},https://api.github.com/repos/Deegue/spark/deployments,2019-07-01T09:20:59Z,2019-11-19T03:54:24Z,2020-03-27T07:30:23Z,git://github.com/Deegue/spark.git,git@github.com:Deegue/spark.git,https://github.com/Deegue/spark.git,https://github.com/Deegue/spark,,313023,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,29dc59ac29361b30d59ae9bd8aa06bd031169600,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26422,https://github.com/apache/spark/pull/26422,https://api.github.com/repos/apache/spark/issues/26422,https://api.github.com/repos/apache/spark/issues/26422/comments,https://api.github.com/repos/apache/spark/pulls/26422/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26422/commits,https://api.github.com/repos/apache/spark/statuses/7cf7c6b991ba6a997476384ec703656e28505fbf
205,https://api.github.com/repos/apache/spark/pulls/26404,336967512,MDExOlB1bGxSZXF1ZXN0MzM2OTY3NTEy,https://github.com/apache/spark/pull/26404,https://github.com/apache/spark/pull/26404.diff,https://github.com/apache/spark/pull/26404.patch,https://api.github.com/repos/apache/spark/issues/26404,26404,open,False,[SPARK-24442][SQL] Added parameters to control dataset show defaults,"It's been a while.  I've finally had time to polish up this pull request.  See previous comments for issues I've addressed.

https://github.com/apache/spark/pull/22162


### What changes were proposed in this pull request?
https://issues.apache.org/jira/browse/SPARK-24442

### How was this patch tested?
Unit tests plus local testing. This change is designed to not modify default behavior unless a user set the following configs...

""spark.sql.show.defaultNumRows"" ->default 20 (as it was before)

""spark.sql.show.truncateMaxCharsPerColumn"" -> default 30 (as it was before)",2019-11-05T20:17:46Z,2020-02-05T18:11:05Z,,,57c2cdc1700059ccb0a118194a3da70643b8683e,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26404/commits,https://api.github.com/repos/apache/spark/pulls/26404/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26404/comments,https://api.github.com/repos/apache/spark/statuses/b455a16383b9a028a0695277b5c3351e322d8a74,NONE,spark,apache,AndrewKL,2659018,MDQ6VXNlcjI2NTkwMTg=,https://avatars1.githubusercontent.com/u/2659018?v=4,,https://api.github.com/users/AndrewKL,https://github.com/AndrewKL,https://api.github.com/users/AndrewKL/followers,https://api.github.com/users/AndrewKL/following{/other_user},https://api.github.com/users/AndrewKL/gists{/gist_id},https://api.github.com/users/AndrewKL/starred{/owner}{/repo},https://api.github.com/users/AndrewKL/subscriptions,https://api.github.com/users/AndrewKL/orgs,https://api.github.com/users/AndrewKL/repos,https://api.github.com/users/AndrewKL/events{/privacy},https://api.github.com/users/AndrewKL/received_events,User,False,AndrewKL:spark-24442,spark-24442,b455a16383b9a028a0695277b5c3351e322d8a74,AndrewKL,2659018,MDQ6VXNlcjI2NTkwMTg=,https://avatars1.githubusercontent.com/u/2659018?v=4,,https://api.github.com/users/AndrewKL,https://github.com/AndrewKL,https://api.github.com/users/AndrewKL/followers,https://api.github.com/users/AndrewKL/following{/other_user},https://api.github.com/users/AndrewKL/gists{/gist_id},https://api.github.com/users/AndrewKL/starred{/owner}{/repo},https://api.github.com/users/AndrewKL/subscriptions,https://api.github.com/users/AndrewKL/orgs,https://api.github.com/users/AndrewKL/repos,https://api.github.com/users/AndrewKL/events{/privacy},https://api.github.com/users/AndrewKL/received_events,User,False,145471794,MDEwOlJlcG9zaXRvcnkxNDU0NzE3OTQ=,spark,AndrewKL/spark,False,AndrewKL,2659018,MDQ6VXNlcjI2NTkwMTg=,https://avatars1.githubusercontent.com/u/2659018?v=4,,https://api.github.com/users/AndrewKL,https://github.com/AndrewKL,https://api.github.com/users/AndrewKL/followers,https://api.github.com/users/AndrewKL/following{/other_user},https://api.github.com/users/AndrewKL/gists{/gist_id},https://api.github.com/users/AndrewKL/starred{/owner}{/repo},https://api.github.com/users/AndrewKL/subscriptions,https://api.github.com/users/AndrewKL/orgs,https://api.github.com/users/AndrewKL/repos,https://api.github.com/users/AndrewKL/events{/privacy},https://api.github.com/users/AndrewKL/received_events,User,False,https://github.com/AndrewKL/spark,Mirror of Apache Spark,True,https://api.github.com/repos/AndrewKL/spark,https://api.github.com/repos/AndrewKL/spark/forks,https://api.github.com/repos/AndrewKL/spark/keys{/key_id},https://api.github.com/repos/AndrewKL/spark/collaborators{/collaborator},https://api.github.com/repos/AndrewKL/spark/teams,https://api.github.com/repos/AndrewKL/spark/hooks,https://api.github.com/repos/AndrewKL/spark/issues/events{/number},https://api.github.com/repos/AndrewKL/spark/events,https://api.github.com/repos/AndrewKL/spark/assignees{/user},https://api.github.com/repos/AndrewKL/spark/branches{/branch},https://api.github.com/repos/AndrewKL/spark/tags,https://api.github.com/repos/AndrewKL/spark/git/blobs{/sha},https://api.github.com/repos/AndrewKL/spark/git/tags{/sha},https://api.github.com/repos/AndrewKL/spark/git/refs{/sha},https://api.github.com/repos/AndrewKL/spark/git/trees{/sha},https://api.github.com/repos/AndrewKL/spark/statuses/{sha},https://api.github.com/repos/AndrewKL/spark/languages,https://api.github.com/repos/AndrewKL/spark/stargazers,https://api.github.com/repos/AndrewKL/spark/contributors,https://api.github.com/repos/AndrewKL/spark/subscribers,https://api.github.com/repos/AndrewKL/spark/subscription,https://api.github.com/repos/AndrewKL/spark/commits{/sha},https://api.github.com/repos/AndrewKL/spark/git/commits{/sha},https://api.github.com/repos/AndrewKL/spark/comments{/number},https://api.github.com/repos/AndrewKL/spark/issues/comments{/number},https://api.github.com/repos/AndrewKL/spark/contents/{+path},https://api.github.com/repos/AndrewKL/spark/compare/{base}...{head},https://api.github.com/repos/AndrewKL/spark/merges,https://api.github.com/repos/AndrewKL/spark/{archive_format}{/ref},https://api.github.com/repos/AndrewKL/spark/downloads,https://api.github.com/repos/AndrewKL/spark/issues{/number},https://api.github.com/repos/AndrewKL/spark/pulls{/number},https://api.github.com/repos/AndrewKL/spark/milestones{/number},"https://api.github.com/repos/AndrewKL/spark/notifications{?since,all,participating}",https://api.github.com/repos/AndrewKL/spark/labels{/name},https://api.github.com/repos/AndrewKL/spark/releases{/id},https://api.github.com/repos/AndrewKL/spark/deployments,2018-08-20T21:21:10Z,2019-11-26T22:35:49Z,2019-12-03T00:09:07Z,git://github.com/AndrewKL/spark.git,git@github.com:AndrewKL/spark.git,https://github.com/AndrewKL/spark.git,https://github.com/AndrewKL/spark,,314247,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,4c53ac18221cbd630bc16352e126d6fc56143239,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26404,https://github.com/apache/spark/pull/26404,https://api.github.com/repos/apache/spark/issues/26404,https://api.github.com/repos/apache/spark/issues/26404/comments,https://api.github.com/repos/apache/spark/pulls/26404/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26404/commits,https://api.github.com/repos/apache/spark/statuses/b455a16383b9a028a0695277b5c3351e322d8a74
206,https://api.github.com/repos/apache/spark/pulls/26343,334777843,MDExOlB1bGxSZXF1ZXN0MzM0Nzc3ODQz,https://github.com/apache/spark/pull/26343,https://github.com/apache/spark/pull/26343.diff,https://github.com/apache/spark/pull/26343.patch,https://api.github.com/repos/apache/spark/issues/26343,26343,open,False,[SPARK-29683][YARN] Job will fail due to executor failures all available nodes are blacklisted,"### What changes were proposed in this pull request?

- Check the nodes in `spark.yarn.exclude.nodes` if exists in Yarn cluster.
- Loosen condition of checking if all node blacklisted: give a waiting time before job failed.

### Why are the changes needed?

My streaming job will fail due to executor failures all available nodes are blacklisted. This exception is thrown only when all node is blacklisted:
```
def isAllNodeBlacklisted: Boolean = currentBlacklistedYarnNodes.size >= numClusterNodes

val allBlacklistedNodes = excludeNodes ++ schedulerBlacklist ++ allocatorBlacklist.keySet
```
After diving into the code, I found some critical conditions not be handle properly:
- unchecked `excludeNodes`: it comes from user config. If not set properly, it may lead to ""currentBlacklistedYarnNodes.size >= numClusterNodes"". For example, we may set some nodes not in Yarn cluster.
```
excludeNodes = (invalid1, invalid2, invalid3)
clusterNodes = (valid1, valid2)
```
- `numClusterNodes` may equals 0: When HA Yarn failover, it will take some time for all NodeManagers to register ResourceManager again. In this case, `numClusterNode` may equals 0 or some other number, and Spark driver failed.
- too strong condition check: Spark driver will fail as long as `""currentBlacklistedYarnNodes.size >= numClusterNodes""`. This condition should not indicate a unrecovered fatal. For example, there are some NodeManagers restarting. So we can give some waiting time before job failed.


### Does this PR introduce any user-facing change?
No


### How was this patch tested?

- Add new UT and update current UTs.
- manual test
",2019-10-31T09:46:16Z,2020-04-07T03:50:10Z,,,ee999e386e609ab32db18f10565de4e5a98d1357,,[],"[{'login': 'vanzin', 'id': 1694083, 'node_id': 'MDQ6VXNlcjE2OTQwODM=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/1694083?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/vanzin', 'html_url': 'https://github.com/vanzin', 'followers_url': 'https://api.github.com/users/vanzin/followers', 'following_url': 'https://api.github.com/users/vanzin/following{/other_user}', 'gists_url': 'https://api.github.com/users/vanzin/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/vanzin/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/vanzin/subscriptions', 'organizations_url': 'https://api.github.com/users/vanzin/orgs', 'repos_url': 'https://api.github.com/users/vanzin/repos', 'events_url': 'https://api.github.com/users/vanzin/events{/privacy}', 'received_events_url': 'https://api.github.com/users/vanzin/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1427970157, 'node_id': 'MDU6TGFiZWwxNDI3OTcwMTU3', 'url': 'https://api.github.com/repos/apache/spark/labels/YARN', 'name': 'YARN', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26343/commits,https://api.github.com/repos/apache/spark/pulls/26343/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26343/comments,https://api.github.com/repos/apache/spark/statuses/dcb7dcd1770fa288794e1d7c46bb2093af991074,CONTRIBUTOR,spark,apache,uncleGen,7402327,MDQ6VXNlcjc0MDIzMjc=,https://avatars1.githubusercontent.com/u/7402327?v=4,,https://api.github.com/users/uncleGen,https://github.com/uncleGen,https://api.github.com/users/uncleGen/followers,https://api.github.com/users/uncleGen/following{/other_user},https://api.github.com/users/uncleGen/gists{/gist_id},https://api.github.com/users/uncleGen/starred{/owner}{/repo},https://api.github.com/users/uncleGen/subscriptions,https://api.github.com/users/uncleGen/orgs,https://api.github.com/users/uncleGen/repos,https://api.github.com/users/uncleGen/events{/privacy},https://api.github.com/users/uncleGen/received_events,User,False,uncleGen:SPARK-29683,SPARK-29683,dcb7dcd1770fa288794e1d7c46bb2093af991074,uncleGen,7402327,MDQ6VXNlcjc0MDIzMjc=,https://avatars1.githubusercontent.com/u/7402327?v=4,,https://api.github.com/users/uncleGen,https://github.com/uncleGen,https://api.github.com/users/uncleGen/followers,https://api.github.com/users/uncleGen/following{/other_user},https://api.github.com/users/uncleGen/gists{/gist_id},https://api.github.com/users/uncleGen/starred{/owner}{/repo},https://api.github.com/users/uncleGen/subscriptions,https://api.github.com/users/uncleGen/orgs,https://api.github.com/users/uncleGen/repos,https://api.github.com/users/uncleGen/events{/privacy},https://api.github.com/users/uncleGen/received_events,User,False,23988410,MDEwOlJlcG9zaXRvcnkyMzk4ODQxMA==,spark,uncleGen/spark,False,uncleGen,7402327,MDQ6VXNlcjc0MDIzMjc=,https://avatars1.githubusercontent.com/u/7402327?v=4,,https://api.github.com/users/uncleGen,https://github.com/uncleGen,https://api.github.com/users/uncleGen/followers,https://api.github.com/users/uncleGen/following{/other_user},https://api.github.com/users/uncleGen/gists{/gist_id},https://api.github.com/users/uncleGen/starred{/owner}{/repo},https://api.github.com/users/uncleGen/subscriptions,https://api.github.com/users/uncleGen/orgs,https://api.github.com/users/uncleGen/repos,https://api.github.com/users/uncleGen/events{/privacy},https://api.github.com/users/uncleGen/received_events,User,False,https://github.com/uncleGen/spark,Mirror of Apache Spark,True,https://api.github.com/repos/uncleGen/spark,https://api.github.com/repos/uncleGen/spark/forks,https://api.github.com/repos/uncleGen/spark/keys{/key_id},https://api.github.com/repos/uncleGen/spark/collaborators{/collaborator},https://api.github.com/repos/uncleGen/spark/teams,https://api.github.com/repos/uncleGen/spark/hooks,https://api.github.com/repos/uncleGen/spark/issues/events{/number},https://api.github.com/repos/uncleGen/spark/events,https://api.github.com/repos/uncleGen/spark/assignees{/user},https://api.github.com/repos/uncleGen/spark/branches{/branch},https://api.github.com/repos/uncleGen/spark/tags,https://api.github.com/repos/uncleGen/spark/git/blobs{/sha},https://api.github.com/repos/uncleGen/spark/git/tags{/sha},https://api.github.com/repos/uncleGen/spark/git/refs{/sha},https://api.github.com/repos/uncleGen/spark/git/trees{/sha},https://api.github.com/repos/uncleGen/spark/statuses/{sha},https://api.github.com/repos/uncleGen/spark/languages,https://api.github.com/repos/uncleGen/spark/stargazers,https://api.github.com/repos/uncleGen/spark/contributors,https://api.github.com/repos/uncleGen/spark/subscribers,https://api.github.com/repos/uncleGen/spark/subscription,https://api.github.com/repos/uncleGen/spark/commits{/sha},https://api.github.com/repos/uncleGen/spark/git/commits{/sha},https://api.github.com/repos/uncleGen/spark/comments{/number},https://api.github.com/repos/uncleGen/spark/issues/comments{/number},https://api.github.com/repos/uncleGen/spark/contents/{+path},https://api.github.com/repos/uncleGen/spark/compare/{base}...{head},https://api.github.com/repos/uncleGen/spark/merges,https://api.github.com/repos/uncleGen/spark/{archive_format}{/ref},https://api.github.com/repos/uncleGen/spark/downloads,https://api.github.com/repos/uncleGen/spark/issues{/number},https://api.github.com/repos/uncleGen/spark/pulls{/number},https://api.github.com/repos/uncleGen/spark/milestones{/number},"https://api.github.com/repos/uncleGen/spark/notifications{?since,all,participating}",https://api.github.com/repos/uncleGen/spark/labels{/name},https://api.github.com/repos/uncleGen/spark/releases{/id},https://api.github.com/repos/uncleGen/spark/deployments,2014-09-13T07:16:52Z,2015-03-24T04:21:04Z,2020-01-27T08:02:15Z,git://github.com/uncleGen/spark.git,git@github.com:uncleGen/spark.git,https://github.com/uncleGen/spark.git,https://github.com/uncleGen/spark,,296537,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,4d302cb7ed8a9bf3253c45db12642a709a5ece6b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26343,https://github.com/apache/spark/pull/26343,https://api.github.com/repos/apache/spark/issues/26343,https://api.github.com/repos/apache/spark/issues/26343/comments,https://api.github.com/repos/apache/spark/pulls/26343/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26343/commits,https://api.github.com/repos/apache/spark/statuses/dcb7dcd1770fa288794e1d7c46bb2093af991074
207,https://api.github.com/repos/apache/spark/pulls/26339,334735813,MDExOlB1bGxSZXF1ZXN0MzM0NzM1ODEz,https://github.com/apache/spark/pull/26339,https://github.com/apache/spark/pull/26339.diff,https://github.com/apache/spark/pull/26339.patch,https://api.github.com/repos/apache/spark/issues/26339,26339,open,False,[SPARK-27194][SPARK-29302][SQL] Fix the issue that for dynamic partition overwrite a task would conflict with its speculative task,"### What changes were proposed in this pull request?
As described in https://issues.apache.org/jira/browse/SPARK-27194 and https://issues.apache.org/jira/browse/SPARK-29302,  there is an issue for dynamic partition overwrite.

Based on the proposal by @advancedxy (see details in https://github.com/apache/spark/pull/24142#issuecomment-516723747), I implement this PR.

1. set a working path under staging dir named partitionPath-attemptId.
2. after task completed, rename partitionPath-attemptId/fileName to partitionPath/fileName


### Why are the changes needed?

For dynamic partition overwrite, a task may conflict with its speculative task.


### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Added UT.
",2019-10-31T08:14:09Z,2020-04-08T13:37:08Z,,,c79c41e522f11d2813f6bb72612be5e18cd2c5f3,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26339/commits,https://api.github.com/repos/apache/spark/pulls/26339/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26339/comments,https://api.github.com/repos/apache/spark/statuses/dd321f4acceef2da8b6898e810500e42284210a3,CONTRIBUTOR,spark,apache,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,turboFei:SPARK-27194-dynamic-cleanUp,SPARK-27194-dynamic-cleanUp,dd321f4acceef2da8b6898e810500e42284210a3,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,77131854,MDEwOlJlcG9zaXRvcnk3NzEzMTg1NA==,spark,turboFei/spark,False,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,https://github.com/turboFei/spark,Mirror of Apache Spark,True,https://api.github.com/repos/turboFei/spark,https://api.github.com/repos/turboFei/spark/forks,https://api.github.com/repos/turboFei/spark/keys{/key_id},https://api.github.com/repos/turboFei/spark/collaborators{/collaborator},https://api.github.com/repos/turboFei/spark/teams,https://api.github.com/repos/turboFei/spark/hooks,https://api.github.com/repos/turboFei/spark/issues/events{/number},https://api.github.com/repos/turboFei/spark/events,https://api.github.com/repos/turboFei/spark/assignees{/user},https://api.github.com/repos/turboFei/spark/branches{/branch},https://api.github.com/repos/turboFei/spark/tags,https://api.github.com/repos/turboFei/spark/git/blobs{/sha},https://api.github.com/repos/turboFei/spark/git/tags{/sha},https://api.github.com/repos/turboFei/spark/git/refs{/sha},https://api.github.com/repos/turboFei/spark/git/trees{/sha},https://api.github.com/repos/turboFei/spark/statuses/{sha},https://api.github.com/repos/turboFei/spark/languages,https://api.github.com/repos/turboFei/spark/stargazers,https://api.github.com/repos/turboFei/spark/contributors,https://api.github.com/repos/turboFei/spark/subscribers,https://api.github.com/repos/turboFei/spark/subscription,https://api.github.com/repos/turboFei/spark/commits{/sha},https://api.github.com/repos/turboFei/spark/git/commits{/sha},https://api.github.com/repos/turboFei/spark/comments{/number},https://api.github.com/repos/turboFei/spark/issues/comments{/number},https://api.github.com/repos/turboFei/spark/contents/{+path},https://api.github.com/repos/turboFei/spark/compare/{base}...{head},https://api.github.com/repos/turboFei/spark/merges,https://api.github.com/repos/turboFei/spark/{archive_format}{/ref},https://api.github.com/repos/turboFei/spark/downloads,https://api.github.com/repos/turboFei/spark/issues{/number},https://api.github.com/repos/turboFei/spark/pulls{/number},https://api.github.com/repos/turboFei/spark/milestones{/number},"https://api.github.com/repos/turboFei/spark/notifications{?since,all,participating}",https://api.github.com/repos/turboFei/spark/labels{/name},https://api.github.com/repos/turboFei/spark/releases{/id},https://api.github.com/repos/turboFei/spark/deployments,2016-12-22T09:34:08Z,2019-10-25T09:06:55Z,2020-04-08T10:08:56Z,git://github.com/turboFei/spark.git,git@github.com:turboFei/spark.git,https://github.com/turboFei/spark.git,https://github.com/turboFei/spark,,322115,0,0,Scala,False,True,True,False,False,0,,False,False,4,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,4,0,master,apache:master,master,a3d83948b81cb5c47f6e084801373443f54747d8,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26339,https://github.com/apache/spark/pull/26339,https://api.github.com/repos/apache/spark/issues/26339,https://api.github.com/repos/apache/spark/issues/26339/comments,https://api.github.com/repos/apache/spark/pulls/26339/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26339/commits,https://api.github.com/repos/apache/spark/statuses/dd321f4acceef2da8b6898e810500e42284210a3
208,https://api.github.com/repos/apache/spark/pulls/26319,334127458,MDExOlB1bGxSZXF1ZXN0MzM0MTI3NDU4,https://github.com/apache/spark/pull/26319,https://github.com/apache/spark/pull/26319.diff,https://github.com/apache/spark/pull/26319.patch,https://api.github.com/repos/apache/spark/issues/26319,26319,open,False,[SPARK-29594][SQL] Create a Dataset from a Sequence of Case class where…,"… a field name started with a number: improved exception handling.

Added test.

### What changes were proposed in this pull request?

This pr is to fix a bug discovered by me, [SPARK-29594], when creating a Dataset using .toDS() in a sequence of a case class that had a field name starting with a number.
The exception was improved, now explains why it breaks, and gives a work around of the problem.

### Why are the changes needed?

Bug fix

### Does this PR introduce any user-facing change?

No

### How was this patch tested?

~~Tests were added, sql/core/src/test/scala/org/apache/spark/sql/DatasetSuite.scala~~

EDIT:

The tests could not be added because the documentation generation is in Java and doesn't allow to create a class with a variable starting with a number.

**How to reproduce this test:**

case class InvalidInJavaForNumber(`1something`: String)

 test(""SPARK-29594 better error message when use java field name starting with a number"") {
     val e = intercept[UnsupportedOperationException] {
       Seq(InvalidInJavaForNumber(""HelloWorld!"")).toDS()
     }
     assert(e.getMessage.contains(
       ""`1something` is a word that starts with a number and cannot be used as field name""))
   }

   test(""Dataset should support flat input object to be null"") {
     checkDataset(Seq(""a"", null).toDS(), ""a"", null)
   }",2019-10-30T09:46:37Z,2020-03-18T22:47:07Z,,,6bd9a09980edd5f7e865d2c6a5751d3b91092736,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26319/commits,https://api.github.com/repos/apache/spark/pulls/26319/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26319/comments,https://api.github.com/repos/apache/spark/statuses/7016815ae276ca329cd9a007f318e682745f8652,NONE,spark,apache,PedroCorreiaLuis,44203579,MDQ6VXNlcjQ0MjAzNTc5,https://avatars1.githubusercontent.com/u/44203579?v=4,,https://api.github.com/users/PedroCorreiaLuis,https://github.com/PedroCorreiaLuis,https://api.github.com/users/PedroCorreiaLuis/followers,https://api.github.com/users/PedroCorreiaLuis/following{/other_user},https://api.github.com/users/PedroCorreiaLuis/gists{/gist_id},https://api.github.com/users/PedroCorreiaLuis/starred{/owner}{/repo},https://api.github.com/users/PedroCorreiaLuis/subscriptions,https://api.github.com/users/PedroCorreiaLuis/orgs,https://api.github.com/users/PedroCorreiaLuis/repos,https://api.github.com/users/PedroCorreiaLuis/events{/privacy},https://api.github.com/users/PedroCorreiaLuis/received_events,User,False,PedroCorreiaLuis:master,master,7016815ae276ca329cd9a007f318e682745f8652,PedroCorreiaLuis,44203579,MDQ6VXNlcjQ0MjAzNTc5,https://avatars1.githubusercontent.com/u/44203579?v=4,,https://api.github.com/users/PedroCorreiaLuis,https://github.com/PedroCorreiaLuis,https://api.github.com/users/PedroCorreiaLuis/followers,https://api.github.com/users/PedroCorreiaLuis/following{/other_user},https://api.github.com/users/PedroCorreiaLuis/gists{/gist_id},https://api.github.com/users/PedroCorreiaLuis/starred{/owner}{/repo},https://api.github.com/users/PedroCorreiaLuis/subscriptions,https://api.github.com/users/PedroCorreiaLuis/orgs,https://api.github.com/users/PedroCorreiaLuis/repos,https://api.github.com/users/PedroCorreiaLuis/events{/privacy},https://api.github.com/users/PedroCorreiaLuis/received_events,User,False,218416204,MDEwOlJlcG9zaXRvcnkyMTg0MTYyMDQ=,spark,PedroCorreiaLuis/spark,False,PedroCorreiaLuis,44203579,MDQ6VXNlcjQ0MjAzNTc5,https://avatars1.githubusercontent.com/u/44203579?v=4,,https://api.github.com/users/PedroCorreiaLuis,https://github.com/PedroCorreiaLuis,https://api.github.com/users/PedroCorreiaLuis/followers,https://api.github.com/users/PedroCorreiaLuis/following{/other_user},https://api.github.com/users/PedroCorreiaLuis/gists{/gist_id},https://api.github.com/users/PedroCorreiaLuis/starred{/owner}{/repo},https://api.github.com/users/PedroCorreiaLuis/subscriptions,https://api.github.com/users/PedroCorreiaLuis/orgs,https://api.github.com/users/PedroCorreiaLuis/repos,https://api.github.com/users/PedroCorreiaLuis/events{/privacy},https://api.github.com/users/PedroCorreiaLuis/received_events,User,False,https://github.com/PedroCorreiaLuis/spark,Apache Spark,True,https://api.github.com/repos/PedroCorreiaLuis/spark,https://api.github.com/repos/PedroCorreiaLuis/spark/forks,https://api.github.com/repos/PedroCorreiaLuis/spark/keys{/key_id},https://api.github.com/repos/PedroCorreiaLuis/spark/collaborators{/collaborator},https://api.github.com/repos/PedroCorreiaLuis/spark/teams,https://api.github.com/repos/PedroCorreiaLuis/spark/hooks,https://api.github.com/repos/PedroCorreiaLuis/spark/issues/events{/number},https://api.github.com/repos/PedroCorreiaLuis/spark/events,https://api.github.com/repos/PedroCorreiaLuis/spark/assignees{/user},https://api.github.com/repos/PedroCorreiaLuis/spark/branches{/branch},https://api.github.com/repos/PedroCorreiaLuis/spark/tags,https://api.github.com/repos/PedroCorreiaLuis/spark/git/blobs{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/git/tags{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/git/refs{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/git/trees{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/statuses/{sha},https://api.github.com/repos/PedroCorreiaLuis/spark/languages,https://api.github.com/repos/PedroCorreiaLuis/spark/stargazers,https://api.github.com/repos/PedroCorreiaLuis/spark/contributors,https://api.github.com/repos/PedroCorreiaLuis/spark/subscribers,https://api.github.com/repos/PedroCorreiaLuis/spark/subscription,https://api.github.com/repos/PedroCorreiaLuis/spark/commits{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/git/commits{/sha},https://api.github.com/repos/PedroCorreiaLuis/spark/comments{/number},https://api.github.com/repos/PedroCorreiaLuis/spark/issues/comments{/number},https://api.github.com/repos/PedroCorreiaLuis/spark/contents/{+path},https://api.github.com/repos/PedroCorreiaLuis/spark/compare/{base}...{head},https://api.github.com/repos/PedroCorreiaLuis/spark/merges,https://api.github.com/repos/PedroCorreiaLuis/spark/{archive_format}{/ref},https://api.github.com/repos/PedroCorreiaLuis/spark/downloads,https://api.github.com/repos/PedroCorreiaLuis/spark/issues{/number},https://api.github.com/repos/PedroCorreiaLuis/spark/pulls{/number},https://api.github.com/repos/PedroCorreiaLuis/spark/milestones{/number},"https://api.github.com/repos/PedroCorreiaLuis/spark/notifications{?since,all,participating}",https://api.github.com/repos/PedroCorreiaLuis/spark/labels{/name},https://api.github.com/repos/PedroCorreiaLuis/spark/releases{/id},https://api.github.com/repos/PedroCorreiaLuis/spark/deployments,2019-10-30T01:20:05Z,2020-03-18T18:10:38Z,2020-03-18T18:10:29Z,git://github.com/PedroCorreiaLuis/spark.git,git@github.com:PedroCorreiaLuis/spark.git,https://github.com/PedroCorreiaLuis/spark.git,https://github.com/PedroCorreiaLuis/spark,,312497,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,44a27bdccdc39d5394ee95d935455eb7ff4b84c2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26319,https://github.com/apache/spark/pull/26319,https://api.github.com/repos/apache/spark/issues/26319,https://api.github.com/repos/apache/spark/issues/26319/comments,https://api.github.com/repos/apache/spark/pulls/26319/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26319/commits,https://api.github.com/repos/apache/spark/statuses/7016815ae276ca329cd9a007f318e682745f8652
209,https://api.github.com/repos/apache/spark/pulls/26286,333335336,MDExOlB1bGxSZXF1ZXN0MzMzMzM1MzM2,https://github.com/apache/spark/pull/26286,https://github.com/apache/spark/pull/26286.diff,https://github.com/apache/spark/pull/26286.patch,https://api.github.com/repos/apache/spark/issues/26286,26286,open,False,[SPARK-26739][SQL] Standardized Join Types for DataFrames,"Adding overloads for all join methods that take the JoinType parameter instead of string

Testing @deprecated marking for string version

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Adding overloaded versions of all `join` methods in `Dataset` that take the strongly-typed `JoinType` as the `joinType` parameter, instead of `String`.

Keeping `String` versions, marking deprecated, and simply calling the new versions.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

To make the `DataFrame` API easier to use.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

Yes, there are new join method overloads available that take `JoinType`.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

`sql` sbt tests were run.
",2019-10-28T21:36:20Z,2020-01-10T00:25:15Z,,,f452be16aaba22d37eecbf8c34be8eec223d81c6,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26286/commits,https://api.github.com/repos/apache/spark/pulls/26286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26286/comments,https://api.github.com/repos/apache/spark/statuses/d37165b888affa0698525ad27c5ef793b280c057,CONTRIBUTOR,spark,apache,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,jeff303:SPARK-26739,SPARK-26739,d37165b888affa0698525ad27c5ef793b280c057,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,207907929,MDEwOlJlcG9zaXRvcnkyMDc5MDc5Mjk=,spark,jeff303/spark,False,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,https://github.com/jeff303/spark,Apache Spark,True,https://api.github.com/repos/jeff303/spark,https://api.github.com/repos/jeff303/spark/forks,https://api.github.com/repos/jeff303/spark/keys{/key_id},https://api.github.com/repos/jeff303/spark/collaborators{/collaborator},https://api.github.com/repos/jeff303/spark/teams,https://api.github.com/repos/jeff303/spark/hooks,https://api.github.com/repos/jeff303/spark/issues/events{/number},https://api.github.com/repos/jeff303/spark/events,https://api.github.com/repos/jeff303/spark/assignees{/user},https://api.github.com/repos/jeff303/spark/branches{/branch},https://api.github.com/repos/jeff303/spark/tags,https://api.github.com/repos/jeff303/spark/git/blobs{/sha},https://api.github.com/repos/jeff303/spark/git/tags{/sha},https://api.github.com/repos/jeff303/spark/git/refs{/sha},https://api.github.com/repos/jeff303/spark/git/trees{/sha},https://api.github.com/repos/jeff303/spark/statuses/{sha},https://api.github.com/repos/jeff303/spark/languages,https://api.github.com/repos/jeff303/spark/stargazers,https://api.github.com/repos/jeff303/spark/contributors,https://api.github.com/repos/jeff303/spark/subscribers,https://api.github.com/repos/jeff303/spark/subscription,https://api.github.com/repos/jeff303/spark/commits{/sha},https://api.github.com/repos/jeff303/spark/git/commits{/sha},https://api.github.com/repos/jeff303/spark/comments{/number},https://api.github.com/repos/jeff303/spark/issues/comments{/number},https://api.github.com/repos/jeff303/spark/contents/{+path},https://api.github.com/repos/jeff303/spark/compare/{base}...{head},https://api.github.com/repos/jeff303/spark/merges,https://api.github.com/repos/jeff303/spark/{archive_format}{/ref},https://api.github.com/repos/jeff303/spark/downloads,https://api.github.com/repos/jeff303/spark/issues{/number},https://api.github.com/repos/jeff303/spark/pulls{/number},https://api.github.com/repos/jeff303/spark/milestones{/number},"https://api.github.com/repos/jeff303/spark/notifications{?since,all,participating}",https://api.github.com/repos/jeff303/spark/labels{/name},https://api.github.com/repos/jeff303/spark/releases{/id},https://api.github.com/repos/jeff303/spark/deployments,2019-09-11T21:14:13Z,2020-02-07T22:23:18Z,2020-01-10T23:02:50Z,git://github.com/jeff303/spark.git,git@github.com:jeff303/spark.git,https://github.com/jeff303/spark.git,https://github.com/jeff303/spark,,321894,1,1,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,d417113c251defb206ec607f703f5344c6120b7b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26286,https://github.com/apache/spark/pull/26286,https://api.github.com/repos/apache/spark/issues/26286,https://api.github.com/repos/apache/spark/issues/26286/comments,https://api.github.com/repos/apache/spark/pulls/26286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26286/commits,https://api.github.com/repos/apache/spark/statuses/d37165b888affa0698525ad27c5ef793b280c057
210,https://api.github.com/repos/apache/spark/pulls/26272,332840144,MDExOlB1bGxSZXF1ZXN0MzMyODQwMTQ0,https://github.com/apache/spark/pull/26272,https://github.com/apache/spark/pull/26272.diff,https://github.com/apache/spark/pull/26272.patch,https://api.github.com/repos/apache/spark/issues/26272,26272,open,False,[SPARK-27736][Core][SHUFFLE] Improve handling of FetchFailures caused by ExternalShuffleService losing track of executor registrations,"### What changes were proposed in this pull request?
As described in https://issues.apache.org/jira/browse/SPARK-27736, if a single external shuffle service process reboots and fails to recover the list of registered executors, a lot FetchFailedExceptions would be thrown and it would cause application failed eventually.

In this PR, I let externalBlockClient can query  whether executors are registered on the External Shuffle Service.
And when fetchFailedException thrown, I will query whether the executors on this host are registered.
 If not,  unregister relative output.


### Why are the changes needed?
This PR improves handling of FetchFailures caused by ExternalShuffleService losing track of executor registrations 

### Does this PR introduce any user-facing change?
No.


### How was this patch tested?

Added UT.",2019-10-27T09:48:00Z,2020-01-29T03:32:06Z,,,9c2b0d1d6a0e76f8fc99bbdd493a2face8613ec9,,[],[],[],"[{'id': 1406605327, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MzI3', 'url': 'https://api.github.com/repos/apache/spark/labels/SHUFFLE', 'name': 'SHUFFLE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26272/commits,https://api.github.com/repos/apache/spark/pulls/26272/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26272/comments,https://api.github.com/repos/apache/spark/statuses/18b776710fb9331216b00bdc51a5004f5be4dc59,CONTRIBUTOR,spark,apache,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,turboFei:SPARK-27736-executor-not-registered,SPARK-27736-executor-not-registered,18b776710fb9331216b00bdc51a5004f5be4dc59,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,77131854,MDEwOlJlcG9zaXRvcnk3NzEzMTg1NA==,spark,turboFei/spark,False,turboFei,6757692,MDQ6VXNlcjY3NTc2OTI=,https://avatars1.githubusercontent.com/u/6757692?v=4,,https://api.github.com/users/turboFei,https://github.com/turboFei,https://api.github.com/users/turboFei/followers,https://api.github.com/users/turboFei/following{/other_user},https://api.github.com/users/turboFei/gists{/gist_id},https://api.github.com/users/turboFei/starred{/owner}{/repo},https://api.github.com/users/turboFei/subscriptions,https://api.github.com/users/turboFei/orgs,https://api.github.com/users/turboFei/repos,https://api.github.com/users/turboFei/events{/privacy},https://api.github.com/users/turboFei/received_events,User,False,https://github.com/turboFei/spark,Mirror of Apache Spark,True,https://api.github.com/repos/turboFei/spark,https://api.github.com/repos/turboFei/spark/forks,https://api.github.com/repos/turboFei/spark/keys{/key_id},https://api.github.com/repos/turboFei/spark/collaborators{/collaborator},https://api.github.com/repos/turboFei/spark/teams,https://api.github.com/repos/turboFei/spark/hooks,https://api.github.com/repos/turboFei/spark/issues/events{/number},https://api.github.com/repos/turboFei/spark/events,https://api.github.com/repos/turboFei/spark/assignees{/user},https://api.github.com/repos/turboFei/spark/branches{/branch},https://api.github.com/repos/turboFei/spark/tags,https://api.github.com/repos/turboFei/spark/git/blobs{/sha},https://api.github.com/repos/turboFei/spark/git/tags{/sha},https://api.github.com/repos/turboFei/spark/git/refs{/sha},https://api.github.com/repos/turboFei/spark/git/trees{/sha},https://api.github.com/repos/turboFei/spark/statuses/{sha},https://api.github.com/repos/turboFei/spark/languages,https://api.github.com/repos/turboFei/spark/stargazers,https://api.github.com/repos/turboFei/spark/contributors,https://api.github.com/repos/turboFei/spark/subscribers,https://api.github.com/repos/turboFei/spark/subscription,https://api.github.com/repos/turboFei/spark/commits{/sha},https://api.github.com/repos/turboFei/spark/git/commits{/sha},https://api.github.com/repos/turboFei/spark/comments{/number},https://api.github.com/repos/turboFei/spark/issues/comments{/number},https://api.github.com/repos/turboFei/spark/contents/{+path},https://api.github.com/repos/turboFei/spark/compare/{base}...{head},https://api.github.com/repos/turboFei/spark/merges,https://api.github.com/repos/turboFei/spark/{archive_format}{/ref},https://api.github.com/repos/turboFei/spark/downloads,https://api.github.com/repos/turboFei/spark/issues{/number},https://api.github.com/repos/turboFei/spark/pulls{/number},https://api.github.com/repos/turboFei/spark/milestones{/number},"https://api.github.com/repos/turboFei/spark/notifications{?since,all,participating}",https://api.github.com/repos/turboFei/spark/labels{/name},https://api.github.com/repos/turboFei/spark/releases{/id},https://api.github.com/repos/turboFei/spark/deployments,2016-12-22T09:34:08Z,2019-10-25T09:06:55Z,2020-04-08T10:08:56Z,git://github.com/turboFei/spark.git,git@github.com:turboFei/spark.git,https://github.com/turboFei/spark.git,https://github.com/turboFei/spark,,322115,0,0,Scala,False,True,True,False,False,0,,False,False,4,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,4,0,master,apache:master,master,077fb99a26a9e92104503fade25c0a095fec5e5d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26272,https://github.com/apache/spark/pull/26272,https://api.github.com/repos/apache/spark/issues/26272,https://api.github.com/repos/apache/spark/issues/26272/comments,https://api.github.com/repos/apache/spark/pulls/26272/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26272/commits,https://api.github.com/repos/apache/spark/statuses/18b776710fb9331216b00bdc51a5004f5be4dc59
211,https://api.github.com/repos/apache/spark/pulls/26257,332579437,MDExOlB1bGxSZXF1ZXN0MzMyNTc5NDM3,https://github.com/apache/spark/pull/26257,https://github.com/apache/spark/pull/26257.diff,https://github.com/apache/spark/pull/26257.patch,https://api.github.com/repos/apache/spark/issues/26257,26257,open,False,[SPARK-29606][SQL] Improve EliminateOuterJoin performance,"### What changes were proposed in this pull request?

This PR try to improve `EliminateOuterJoin` performance via avoid generating too many constraints. For example:
```scala
import org.apache.spark.sql.catalyst.plans.logical.Project
spark.sql(""CREATE TABLE IF NOT EXISTS spark_29606(a int, b int, c int) USING parquet"")
spark.sql(""SELECT a as a1, b as b1, c as c1, abc as abc1 FROM (SELECT a, b, c, a + b + c as abc FROM spark_29606) t"")
  .queryExecution.analyzed.asInstanceOf[Project].validConstraints.toSeq.sortBy(_.toString).foreach(println)
```

**Before this PR**:
```
(((a#5 + b#6) + c#7) <=> abc#0)
(((a#5 + b#6) + c#7) <=> abc1#4)
(((a#5 + b#6) + c1#3) <=> abc#0)
(((a#5 + b#6) + c1#3) <=> abc1#4)
(((a#5 + b1#2) + c#7) <=> abc#0)
(((a#5 + b1#2) + c#7) <=> abc1#4)
(((a#5 + b1#2) + c1#3) <=> abc#0)
(((a#5 + b1#2) + c1#3) <=> abc1#4)
(((a1#1 + b#6) + c#7) <=> abc#0)
(((a1#1 + b#6) + c#7) <=> abc1#4)
(((a1#1 + b#6) + c1#3) <=> abc#0)
(((a1#1 + b#6) + c1#3) <=> abc1#4)
(((a1#1 + b1#2) + c#7) <=> abc#0)
(((a1#1 + b1#2) + c#7) <=> abc1#4)
(((a1#1 + b1#2) + c1#3) <=> abc#0)
(((a1#1 + b1#2) + c1#3) <=> abc1#4)
(a#5 <=> a1#1)
(abc#0 <=> abc1#4)
(b#6 <=> b1#2)
(c#7 <=> c1#3)
```

**After this PR**:
```
(((a#5 + b#6) + c#7) <=> abc#0)
(a#5 <=> a1#1)
(abc#0 <=> abc1#4)
(b#6 <=> b1#2)
(c#7 <=> c1#3)
```



### Why are the changes needed?
Improve `EliminateOuterJoin` performance.

**Before this PR**:
```
=== Metrics of Analyzer/Optimizer Rules ===
Total number of runs: 9323
Total time: 15.995000924 seconds

Rule                                                                                               Effective Time / Total Time                     Effective Runs / Total Runs

org.apache.spark.sql.catalyst.optimizer.EliminateOuterJoin                                         0 / 13359017999                                 0 / 4
org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations                                   990683801 / 991674120                           2 / 18
org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveTables                                      0 / 443718064                                   0 / 18
org.apache.spark.sql.catalyst.analysis.DecimalPrecision                                            43087519 / 81709524                             2 / 18
org.apache.spark.sql.execution.datasources.PruneFileSourcePartitions                               63414650 / 63414650                             1 / 1
org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences                                  42587256 / 62760566                             5 / 18
...
```

**After this PR**:
```
=== Metrics of Analyzer/Optimizer Rules ===
Total number of runs: 9323
Total time: 3.03253427 seconds

Rule                                                                                               Effective Time / Total Time                     Effective Runs / Total Runs

org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations                                   1130336633 / 1131323257                         2 / 18
org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveTables                                      0 / 448236638                                   0 / 18
org.apache.spark.sql.catalyst.optimizer.EliminateOuterJoin                                         0 / 107133411                                   0 / 4
org.apache.spark.sql.catalyst.analysis.DecimalPrecision                                            43965067 / 84085638                             2 / 18
org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences                                  44448673 / 66690250                             5 / 18
org.apache.spark.sql.execution.datasources.PruneFileSourcePartitions                               59631169 / 59631169                             1 / 1
...
```


### Does this PR introduce any user-facing change?

No.


### How was this patch tested?

Unit test.
",2019-10-25T16:03:13Z,2020-03-01T13:48:22Z,,,99b0554b02c25773eabd5f79b07699dc0a3ad47c,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26257/commits,https://api.github.com/repos/apache/spark/pulls/26257/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26257/comments,https://api.github.com/repos/apache/spark/statuses/29fe7f06b3626d46bf584190e031517b4f65d471,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-29606,SPARK-29606,29fe7f06b3626d46bf584190e031517b4f65d471,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,0e2ca11d80c3921387d7b077cb64c3a0c06b08d7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26257,https://github.com/apache/spark/pull/26257,https://api.github.com/repos/apache/spark/issues/26257,https://api.github.com/repos/apache/spark/issues/26257/comments,https://api.github.com/repos/apache/spark/pulls/26257/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26257/commits,https://api.github.com/repos/apache/spark/statuses/29fe7f06b3626d46bf584190e031517b4f65d471
212,https://api.github.com/repos/apache/spark/pulls/26219,331284190,MDExOlB1bGxSZXF1ZXN0MzMxMjg0MTkw,https://github.com/apache/spark/pull/26219,https://github.com/apache/spark/pull/26219.diff,https://github.com/apache/spark/pull/26219.patch,https://api.github.com/repos/apache/spark/issues/26219,26219,open,False,[SPARK-29563][SQL] CREATE TABLE LIKE should look up catalog/table like v2 commands,"### What changes were proposed in this pull request?
Change to make sure ```CREATE TABLES LIKE```  statement go through the same catalog/table resolution framework of v2 commands.


### Why are the changes needed?
It's important to make all the commands have the same table resolution behavior, to avoid confusing end-users.

### Does this PR introduce any user-facing change?
Yes. Attempting to execute ```CREATE TABLE LIKE``` on v2 catalog results in an error.


### How was this patch tested?
Added unit tests.
",2019-10-23T00:44:24Z,2020-02-17T18:58:07Z,,,cba809899699494e16f8302a29da5927d3ed9752,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26219/commits,https://api.github.com/repos/apache/spark/pulls/26219/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26219/comments,https://api.github.com/repos/apache/spark/statuses/11ea11b80898f006ffe314f626b046a524a15ff6,CONTRIBUTOR,spark,apache,dilipbiswal,14225158,MDQ6VXNlcjE0MjI1MTU4,https://avatars0.githubusercontent.com/u/14225158?v=4,,https://api.github.com/users/dilipbiswal,https://github.com/dilipbiswal,https://api.github.com/users/dilipbiswal/followers,https://api.github.com/users/dilipbiswal/following{/other_user},https://api.github.com/users/dilipbiswal/gists{/gist_id},https://api.github.com/users/dilipbiswal/starred{/owner}{/repo},https://api.github.com/users/dilipbiswal/subscriptions,https://api.github.com/users/dilipbiswal/orgs,https://api.github.com/users/dilipbiswal/repos,https://api.github.com/users/dilipbiswal/events{/privacy},https://api.github.com/users/dilipbiswal/received_events,User,False,dilipbiswal:datasourcev2-createtable-like,datasourcev2-createtable-like,11ea11b80898f006ffe314f626b046a524a15ff6,dilipbiswal,14225158,MDQ6VXNlcjE0MjI1MTU4,https://avatars0.githubusercontent.com/u/14225158?v=4,,https://api.github.com/users/dilipbiswal,https://github.com/dilipbiswal,https://api.github.com/users/dilipbiswal/followers,https://api.github.com/users/dilipbiswal/following{/other_user},https://api.github.com/users/dilipbiswal/gists{/gist_id},https://api.github.com/users/dilipbiswal/starred{/owner}{/repo},https://api.github.com/users/dilipbiswal/subscriptions,https://api.github.com/users/dilipbiswal/orgs,https://api.github.com/users/dilipbiswal/repos,https://api.github.com/users/dilipbiswal/events{/privacy},https://api.github.com/users/dilipbiswal/received_events,User,False,42921897,MDEwOlJlcG9zaXRvcnk0MjkyMTg5Nw==,spark,dilipbiswal/spark,False,dilipbiswal,14225158,MDQ6VXNlcjE0MjI1MTU4,https://avatars0.githubusercontent.com/u/14225158?v=4,,https://api.github.com/users/dilipbiswal,https://github.com/dilipbiswal,https://api.github.com/users/dilipbiswal/followers,https://api.github.com/users/dilipbiswal/following{/other_user},https://api.github.com/users/dilipbiswal/gists{/gist_id},https://api.github.com/users/dilipbiswal/starred{/owner}{/repo},https://api.github.com/users/dilipbiswal/subscriptions,https://api.github.com/users/dilipbiswal/orgs,https://api.github.com/users/dilipbiswal/repos,https://api.github.com/users/dilipbiswal/events{/privacy},https://api.github.com/users/dilipbiswal/received_events,User,False,https://github.com/dilipbiswal/spark,Mirror of Apache Spark,True,https://api.github.com/repos/dilipbiswal/spark,https://api.github.com/repos/dilipbiswal/spark/forks,https://api.github.com/repos/dilipbiswal/spark/keys{/key_id},https://api.github.com/repos/dilipbiswal/spark/collaborators{/collaborator},https://api.github.com/repos/dilipbiswal/spark/teams,https://api.github.com/repos/dilipbiswal/spark/hooks,https://api.github.com/repos/dilipbiswal/spark/issues/events{/number},https://api.github.com/repos/dilipbiswal/spark/events,https://api.github.com/repos/dilipbiswal/spark/assignees{/user},https://api.github.com/repos/dilipbiswal/spark/branches{/branch},https://api.github.com/repos/dilipbiswal/spark/tags,https://api.github.com/repos/dilipbiswal/spark/git/blobs{/sha},https://api.github.com/repos/dilipbiswal/spark/git/tags{/sha},https://api.github.com/repos/dilipbiswal/spark/git/refs{/sha},https://api.github.com/repos/dilipbiswal/spark/git/trees{/sha},https://api.github.com/repos/dilipbiswal/spark/statuses/{sha},https://api.github.com/repos/dilipbiswal/spark/languages,https://api.github.com/repos/dilipbiswal/spark/stargazers,https://api.github.com/repos/dilipbiswal/spark/contributors,https://api.github.com/repos/dilipbiswal/spark/subscribers,https://api.github.com/repos/dilipbiswal/spark/subscription,https://api.github.com/repos/dilipbiswal/spark/commits{/sha},https://api.github.com/repos/dilipbiswal/spark/git/commits{/sha},https://api.github.com/repos/dilipbiswal/spark/comments{/number},https://api.github.com/repos/dilipbiswal/spark/issues/comments{/number},https://api.github.com/repos/dilipbiswal/spark/contents/{+path},https://api.github.com/repos/dilipbiswal/spark/compare/{base}...{head},https://api.github.com/repos/dilipbiswal/spark/merges,https://api.github.com/repos/dilipbiswal/spark/{archive_format}{/ref},https://api.github.com/repos/dilipbiswal/spark/downloads,https://api.github.com/repos/dilipbiswal/spark/issues{/number},https://api.github.com/repos/dilipbiswal/spark/pulls{/number},https://api.github.com/repos/dilipbiswal/spark/milestones{/number},"https://api.github.com/repos/dilipbiswal/spark/notifications{?since,all,participating}",https://api.github.com/repos/dilipbiswal/spark/labels{/name},https://api.github.com/repos/dilipbiswal/spark/releases{/id},https://api.github.com/repos/dilipbiswal/spark/deployments,2015-09-22T08:39:46Z,2019-03-29T17:59:54Z,2020-01-28T06:25:08Z,git://github.com/dilipbiswal/spark.git,git@github.com:dilipbiswal/spark.git,https://github.com/dilipbiswal/spark.git,https://github.com/dilipbiswal/spark,,304408,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,18440151b0bf2d79356393f515b149439e17962e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26219,https://github.com/apache/spark/pull/26219,https://api.github.com/repos/apache/spark/issues/26219,https://api.github.com/repos/apache/spark/issues/26219/comments,https://api.github.com/repos/apache/spark/pulls/26219/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26219/commits,https://api.github.com/repos/apache/spark/statuses/11ea11b80898f006ffe314f626b046a524a15ff6
213,https://api.github.com/repos/apache/spark/pulls/26197,330734430,MDExOlB1bGxSZXF1ZXN0MzMwNzM0NDMw,https://github.com/apache/spark/pull/26197,https://github.com/apache/spark/pull/26197.diff,https://github.com/apache/spark/pull/26197.patch,https://api.github.com/repos/apache/spark/issues/26197,26197,open,False,[SPARK-29577][MLLIB] Implement p-value simulation and unit tests for chi2 test,"### What changes were proposed in this pull request?
This PR implements monte-carlo simulation of p-values for the ChiSqTest in mllib. For other implementations, see the following references:
* https://www.rdocumentation.org/packages/stats/versions/3.6.1/topics/chisq.test
* https://en.wikipedia.org/wiki/Generalized_p-value

### Why are the changes needed?
While monte-carlo simulation is a common approach to estimate p-values, a robust scalable implementation in Spark was non-trivial, so we hope others can re-use these efforts.

### Does this PR introduce any user-facing change?
We provide a new boolean parameter `simulatePValue` to the ChiSqTest so that users can request p-value simulation, and also an integer parameter `numDraw` so that users can specify the number of draws to take. The `getChi2Digest` method is also exposed in case users find value in the digest object itself which allows extraction of arbitrary quantiles, cdf, etc.

### How was this patch tested?
This PR also implements the `ChiSqTestSuite` with some tests to verify that both the ChiSqTest itself and the new p-value simulation are working correctly by evaluating that test cases expected to pass and fail a chi squared test actually work as expected. 

We ran these tests with the following results: 
```
$ build/mvn package -pl mllib -Dtest=none -DwildcardSuites=org.apache.spark.mllib.stat.test.ChiSqTestSuite
...
ChiSqTestSuite:
- theoretical chi2 test
- simulated/empirical chi2 test
Run completed in 1 minute, 22 seconds.
Total number of tests run: 2
Suites: completed 2, aborted 0
Tests: succeeded 2, failed 0, canceled 0, ignored 0, pending 0
All tests passed.
...
[INFO] BUILD SUCCESS
```",2019-10-21T23:01:32Z,2020-02-20T00:52:07Z,,,33014d90380865aff95ce305d65175aa877d781a,,[],[],[],"[{'id': 1405803268, 'node_id': 'MDU6TGFiZWwxNDA1ODAzMjY4', 'url': 'https://api.github.com/repos/apache/spark/labels/MLLIB', 'name': 'MLLIB', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26197/commits,https://api.github.com/repos/apache/spark/pulls/26197/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26197/comments,https://api.github.com/repos/apache/spark/statuses/da1c6fae18aa19d073fae5afc184a14912a50729,NONE,spark,apache,atronchi,4906224,MDQ6VXNlcjQ5MDYyMjQ=,https://avatars2.githubusercontent.com/u/4906224?v=4,,https://api.github.com/users/atronchi,https://github.com/atronchi,https://api.github.com/users/atronchi/followers,https://api.github.com/users/atronchi/following{/other_user},https://api.github.com/users/atronchi/gists{/gist_id},https://api.github.com/users/atronchi/starred{/owner}{/repo},https://api.github.com/users/atronchi/subscriptions,https://api.github.com/users/atronchi/orgs,https://api.github.com/users/atronchi/repos,https://api.github.com/users/atronchi/events{/privacy},https://api.github.com/users/atronchi/received_events,User,False,atronchi:pv_sim,pv_sim,da1c6fae18aa19d073fae5afc184a14912a50729,atronchi,4906224,MDQ6VXNlcjQ5MDYyMjQ=,https://avatars2.githubusercontent.com/u/4906224?v=4,,https://api.github.com/users/atronchi,https://github.com/atronchi,https://api.github.com/users/atronchi/followers,https://api.github.com/users/atronchi/following{/other_user},https://api.github.com/users/atronchi/gists{/gist_id},https://api.github.com/users/atronchi/starred{/owner}{/repo},https://api.github.com/users/atronchi/subscriptions,https://api.github.com/users/atronchi/orgs,https://api.github.com/users/atronchi/repos,https://api.github.com/users/atronchi/events{/privacy},https://api.github.com/users/atronchi/received_events,User,False,216616074,MDEwOlJlcG9zaXRvcnkyMTY2MTYwNzQ=,spark,atronchi/spark,False,atronchi,4906224,MDQ6VXNlcjQ5MDYyMjQ=,https://avatars2.githubusercontent.com/u/4906224?v=4,,https://api.github.com/users/atronchi,https://github.com/atronchi,https://api.github.com/users/atronchi/followers,https://api.github.com/users/atronchi/following{/other_user},https://api.github.com/users/atronchi/gists{/gist_id},https://api.github.com/users/atronchi/starred{/owner}{/repo},https://api.github.com/users/atronchi/subscriptions,https://api.github.com/users/atronchi/orgs,https://api.github.com/users/atronchi/repos,https://api.github.com/users/atronchi/events{/privacy},https://api.github.com/users/atronchi/received_events,User,False,https://github.com/atronchi/spark,Apache Spark,True,https://api.github.com/repos/atronchi/spark,https://api.github.com/repos/atronchi/spark/forks,https://api.github.com/repos/atronchi/spark/keys{/key_id},https://api.github.com/repos/atronchi/spark/collaborators{/collaborator},https://api.github.com/repos/atronchi/spark/teams,https://api.github.com/repos/atronchi/spark/hooks,https://api.github.com/repos/atronchi/spark/issues/events{/number},https://api.github.com/repos/atronchi/spark/events,https://api.github.com/repos/atronchi/spark/assignees{/user},https://api.github.com/repos/atronchi/spark/branches{/branch},https://api.github.com/repos/atronchi/spark/tags,https://api.github.com/repos/atronchi/spark/git/blobs{/sha},https://api.github.com/repos/atronchi/spark/git/tags{/sha},https://api.github.com/repos/atronchi/spark/git/refs{/sha},https://api.github.com/repos/atronchi/spark/git/trees{/sha},https://api.github.com/repos/atronchi/spark/statuses/{sha},https://api.github.com/repos/atronchi/spark/languages,https://api.github.com/repos/atronchi/spark/stargazers,https://api.github.com/repos/atronchi/spark/contributors,https://api.github.com/repos/atronchi/spark/subscribers,https://api.github.com/repos/atronchi/spark/subscription,https://api.github.com/repos/atronchi/spark/commits{/sha},https://api.github.com/repos/atronchi/spark/git/commits{/sha},https://api.github.com/repos/atronchi/spark/comments{/number},https://api.github.com/repos/atronchi/spark/issues/comments{/number},https://api.github.com/repos/atronchi/spark/contents/{+path},https://api.github.com/repos/atronchi/spark/compare/{base}...{head},https://api.github.com/repos/atronchi/spark/merges,https://api.github.com/repos/atronchi/spark/{archive_format}{/ref},https://api.github.com/repos/atronchi/spark/downloads,https://api.github.com/repos/atronchi/spark/issues{/number},https://api.github.com/repos/atronchi/spark/pulls{/number},https://api.github.com/repos/atronchi/spark/milestones{/number},"https://api.github.com/repos/atronchi/spark/notifications{?since,all,participating}",https://api.github.com/repos/atronchi/spark/labels{/name},https://api.github.com/repos/atronchi/spark/releases{/id},https://api.github.com/repos/atronchi/spark/deployments,2019-10-21T16:35:46Z,2019-10-21T16:35:49Z,2019-10-23T18:30:40Z,git://github.com/atronchi/spark.git,git@github.com:atronchi/spark.git,https://github.com/atronchi/spark.git,https://github.com/atronchi/spark,,314601,0,0,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,5867707835a442827c9df17f79c28c86eb9f2c68,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26197,https://github.com/apache/spark/pull/26197,https://api.github.com/repos/apache/spark/issues/26197,https://api.github.com/repos/apache/spark/issues/26197/comments,https://api.github.com/repos/apache/spark/pulls/26197/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26197/commits,https://api.github.com/repos/apache/spark/statuses/da1c6fae18aa19d073fae5afc184a14912a50729
214,https://api.github.com/repos/apache/spark/pulls/26193,330374422,MDExOlB1bGxSZXF1ZXN0MzMwMzc0NDIy,https://github.com/apache/spark/pull/26193,https://github.com/apache/spark/pull/26193.diff,https://github.com/apache/spark/pull/26193.patch,https://api.github.com/repos/apache/spark/issues/26193,26193,open,False,[SPARK-25065][k8s] Allow setting up correct logging configuration on driver and executor.,"#27735 takes a different approach to solve this problem. However, this patch implements a new feature of ability to provide logging configuration via config maps. But, this patch will change if the PR at #27735 is merged before this.

### What changes were proposed in this pull request?

This patch fixes a bug, after submitting a spark job to k8s cluster, kubernetes pods including driver and executor are not able to pick the configured - logging configuration (i.e.`log4j.properties` file specified at `conf` dir located inside the spark home).

 It is picked up correctly after this patch. More details on how to debug is also on the associated JIRA.

This patch also introduces a new feature, propagate correct logging configuration file either by picking up from user specified logger configuration file or through user specified kubernetes config map. Where user specified config map takes precedence.

### Why are the changes needed?
Please see referenced JIRA.
Apart from that, I have added a new feature i.e. an ability to provide logging configuration via a kubernetes config map [link](https://kubernetes.io/docs/concepts/storage/volumes/#configmap).

### Does this PR introduce any user-facing change?
It adds two configuration options, documentation is updated for those.

### How was this patch tested?
Manually tested.
Added some unit tests as well.
Added integration tests for both configuring via a config map and also picking the correct log4j configuration file.
Also added a doc section on the usage of this feature.

#### Current limitation:
_In the client mode, we cannot create a config map on our own, but then that is by design - how k8s mode is designed. So, a user needs to create their config maps containing the log4j configuration and submit. This step is only applicable when in client mode. It can be convenient, if this could be automated as well._
^^ This limitation is overcome by the approach taken in the PR #27735. ",2019-10-21T12:15:59Z,2020-02-28T11:21:58Z,,,d564c669854e7ef7b3b963a6465008e17eecc407,,[],"[{'login': 'srowen', 'id': 822522, 'node_id': 'MDQ6VXNlcjgyMjUyMg==', 'avatar_url': 'https://avatars0.githubusercontent.com/u/822522?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/srowen', 'html_url': 'https://github.com/srowen', 'followers_url': 'https://api.github.com/users/srowen/followers', 'following_url': 'https://api.github.com/users/srowen/following{/other_user}', 'gists_url': 'https://api.github.com/users/srowen/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/srowen/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/srowen/subscriptions', 'organizations_url': 'https://api.github.com/users/srowen/orgs', 'repos_url': 'https://api.github.com/users/srowen/repos', 'events_url': 'https://api.github.com/users/srowen/events{/privacy}', 'received_events_url': 'https://api.github.com/users/srowen/received_events', 'type': 'User', 'site_admin': False}, {'login': 'vanzin', 'id': 1694083, 'node_id': 'MDQ6VXNlcjE2OTQwODM=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/1694083?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/vanzin', 'html_url': 'https://github.com/vanzin', 'followers_url': 'https://api.github.com/users/vanzin/followers', 'following_url': 'https://api.github.com/users/vanzin/following{/other_user}', 'gists_url': 'https://api.github.com/users/vanzin/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/vanzin/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/vanzin/subscriptions', 'organizations_url': 'https://api.github.com/users/vanzin/orgs', 'repos_url': 'https://api.github.com/users/vanzin/repos', 'events_url': 'https://api.github.com/users/vanzin/events{/privacy}', 'received_events_url': 'https://api.github.com/users/vanzin/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26193/commits,https://api.github.com/repos/apache/spark/pulls/26193/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26193/comments,https://api.github.com/repos/apache/spark/statuses/9372b625ff0673c82f13e5405ef082a94ed9abd9,MEMBER,spark,apache,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,ScrapCodes:SPARK-25065/k8s-mount-log-config,SPARK-25065/k8s-mount-log-config,9372b625ff0673c82f13e5405ef082a94ed9abd9,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,17210717,MDEwOlJlcG9zaXRvcnkxNzIxMDcxNw==,spark,ScrapCodes/spark,False,ScrapCodes,992952,MDQ6VXNlcjk5Mjk1Mg==,https://avatars3.githubusercontent.com/u/992952?v=4,,https://api.github.com/users/ScrapCodes,https://github.com/ScrapCodes,https://api.github.com/users/ScrapCodes/followers,https://api.github.com/users/ScrapCodes/following{/other_user},https://api.github.com/users/ScrapCodes/gists{/gist_id},https://api.github.com/users/ScrapCodes/starred{/owner}{/repo},https://api.github.com/users/ScrapCodes/subscriptions,https://api.github.com/users/ScrapCodes/orgs,https://api.github.com/users/ScrapCodes/repos,https://api.github.com/users/ScrapCodes/events{/privacy},https://api.github.com/users/ScrapCodes/received_events,User,False,https://github.com/ScrapCodes/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ScrapCodes/spark,https://api.github.com/repos/ScrapCodes/spark/forks,https://api.github.com/repos/ScrapCodes/spark/keys{/key_id},https://api.github.com/repos/ScrapCodes/spark/collaborators{/collaborator},https://api.github.com/repos/ScrapCodes/spark/teams,https://api.github.com/repos/ScrapCodes/spark/hooks,https://api.github.com/repos/ScrapCodes/spark/issues/events{/number},https://api.github.com/repos/ScrapCodes/spark/events,https://api.github.com/repos/ScrapCodes/spark/assignees{/user},https://api.github.com/repos/ScrapCodes/spark/branches{/branch},https://api.github.com/repos/ScrapCodes/spark/tags,https://api.github.com/repos/ScrapCodes/spark/git/blobs{/sha},https://api.github.com/repos/ScrapCodes/spark/git/tags{/sha},https://api.github.com/repos/ScrapCodes/spark/git/refs{/sha},https://api.github.com/repos/ScrapCodes/spark/git/trees{/sha},https://api.github.com/repos/ScrapCodes/spark/statuses/{sha},https://api.github.com/repos/ScrapCodes/spark/languages,https://api.github.com/repos/ScrapCodes/spark/stargazers,https://api.github.com/repos/ScrapCodes/spark/contributors,https://api.github.com/repos/ScrapCodes/spark/subscribers,https://api.github.com/repos/ScrapCodes/spark/subscription,https://api.github.com/repos/ScrapCodes/spark/commits{/sha},https://api.github.com/repos/ScrapCodes/spark/git/commits{/sha},https://api.github.com/repos/ScrapCodes/spark/comments{/number},https://api.github.com/repos/ScrapCodes/spark/issues/comments{/number},https://api.github.com/repos/ScrapCodes/spark/contents/{+path},https://api.github.com/repos/ScrapCodes/spark/compare/{base}...{head},https://api.github.com/repos/ScrapCodes/spark/merges,https://api.github.com/repos/ScrapCodes/spark/{archive_format}{/ref},https://api.github.com/repos/ScrapCodes/spark/downloads,https://api.github.com/repos/ScrapCodes/spark/issues{/number},https://api.github.com/repos/ScrapCodes/spark/pulls{/number},https://api.github.com/repos/ScrapCodes/spark/milestones{/number},"https://api.github.com/repos/ScrapCodes/spark/notifications{?since,all,participating}",https://api.github.com/repos/ScrapCodes/spark/labels{/name},https://api.github.com/repos/ScrapCodes/spark/releases{/id},https://api.github.com/repos/ScrapCodes/spark/deployments,2014-02-26T13:00:32Z,2019-09-13T08:17:31Z,2020-03-31T07:45:48Z,git://github.com/ScrapCodes/spark.git,git@github.com:ScrapCodes/spark.git,https://github.com/ScrapCodes/spark.git,https://github.com/ScrapCodes/spark,,296150,0,0,Scala,False,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,0,master,apache:master,master,9107f77f15cd0630dc981b6e8a9ca696b79e624f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26193,https://github.com/apache/spark/pull/26193,https://api.github.com/repos/apache/spark/issues/26193,https://api.github.com/repos/apache/spark/issues/26193/comments,https://api.github.com/repos/apache/spark/pulls/26193/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26193/commits,https://api.github.com/repos/apache/spark/statuses/9372b625ff0673c82f13e5405ef082a94ed9abd9
215,https://api.github.com/repos/apache/spark/pulls/26161,329657584,MDExOlB1bGxSZXF1ZXN0MzI5NjU3NTg0,https://github.com/apache/spark/pull/26161,https://github.com/apache/spark/pull/26161.diff,https://github.com/apache/spark/pull/26161.patch,https://api.github.com/repos/apache/spark/issues/26161,26161,open,False,[SPARK-27900][CORE][K8s] Add `spark.driver.killOnOOMError` flag in cluster mode,"### What changes were proposed in this pull request?

- Adds a flag to make the driver exit in case of an oom error in cluster mode (enabled by default).
- Adds integration tests for the K8s manager.
- Adds verbose flag support within the driver's container.

### Why are the changes needed?
See for details Spark-27900. In addition, this follows the discussion here: #24796. Without this pods on K8s will keep running although Spark has failed. In addition current behavior creates a problem to the Spark Operator and any other operator as it cannot detect failure at the K8s level.

### How was this patch tested?
Manually by launching SparkPi with a large number 100000000 which leads to an oom due to the large number of tasks allocated.

```
$kubectl logs spark-pi-driver -n spark
19/10/18 09:47:02 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
19/10/18 09:47:02 INFO BlockManagerMasterEndpoint: Registering block manager 172.17.0.6:33435 with 413.9 MiB RAM, BlockManagerId(2, 172.17.0.6, 33435, None)
#
# java.lang.OutOfMemoryError: Java heap space
# -XX:OnOutOfMemoryError=""kill -9 %p""
#   Executing /bin/sh -c ""kill -9 14""...
```
Also there are two integration tests for the K8s resource manager. Testing might be needed for the other managers.",2019-10-18T09:58:06Z,2020-01-28T13:45:57Z,,,5271422ee7cb8703446717bdd0036eb7a2cafd10,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26161/commits,https://api.github.com/repos/apache/spark/pulls/26161/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26161/comments,https://api.github.com/repos/apache/spark/statuses/550508339d401750d9f1e74f2bcfcd9c83ed4427,CONTRIBUTOR,spark,apache,skonto,7945591,MDQ6VXNlcjc5NDU1OTE=,https://avatars1.githubusercontent.com/u/7945591?v=4,,https://api.github.com/users/skonto,https://github.com/skonto,https://api.github.com/users/skonto/followers,https://api.github.com/users/skonto/following{/other_user},https://api.github.com/users/skonto/gists{/gist_id},https://api.github.com/users/skonto/starred{/owner}{/repo},https://api.github.com/users/skonto/subscriptions,https://api.github.com/users/skonto/orgs,https://api.github.com/users/skonto/repos,https://api.github.com/users/skonto/events{/privacy},https://api.github.com/users/skonto/received_events,User,False,skonto:fix_oom,fix_oom,550508339d401750d9f1e74f2bcfcd9c83ed4427,skonto,7945591,MDQ6VXNlcjc5NDU1OTE=,https://avatars1.githubusercontent.com/u/7945591?v=4,,https://api.github.com/users/skonto,https://github.com/skonto,https://api.github.com/users/skonto/followers,https://api.github.com/users/skonto/following{/other_user},https://api.github.com/users/skonto/gists{/gist_id},https://api.github.com/users/skonto/starred{/owner}{/repo},https://api.github.com/users/skonto/subscriptions,https://api.github.com/users/skonto/orgs,https://api.github.com/users/skonto/repos,https://api.github.com/users/skonto/events{/privacy},https://api.github.com/users/skonto/received_events,User,False,48892104,MDEwOlJlcG9zaXRvcnk0ODg5MjEwNA==,spark,skonto/spark,False,skonto,7945591,MDQ6VXNlcjc5NDU1OTE=,https://avatars1.githubusercontent.com/u/7945591?v=4,,https://api.github.com/users/skonto,https://github.com/skonto,https://api.github.com/users/skonto/followers,https://api.github.com/users/skonto/following{/other_user},https://api.github.com/users/skonto/gists{/gist_id},https://api.github.com/users/skonto/starred{/owner}{/repo},https://api.github.com/users/skonto/subscriptions,https://api.github.com/users/skonto/orgs,https://api.github.com/users/skonto/repos,https://api.github.com/users/skonto/events{/privacy},https://api.github.com/users/skonto/received_events,User,False,https://github.com/skonto/spark,Mirror of Apache Spark,True,https://api.github.com/repos/skonto/spark,https://api.github.com/repos/skonto/spark/forks,https://api.github.com/repos/skonto/spark/keys{/key_id},https://api.github.com/repos/skonto/spark/collaborators{/collaborator},https://api.github.com/repos/skonto/spark/teams,https://api.github.com/repos/skonto/spark/hooks,https://api.github.com/repos/skonto/spark/issues/events{/number},https://api.github.com/repos/skonto/spark/events,https://api.github.com/repos/skonto/spark/assignees{/user},https://api.github.com/repos/skonto/spark/branches{/branch},https://api.github.com/repos/skonto/spark/tags,https://api.github.com/repos/skonto/spark/git/blobs{/sha},https://api.github.com/repos/skonto/spark/git/tags{/sha},https://api.github.com/repos/skonto/spark/git/refs{/sha},https://api.github.com/repos/skonto/spark/git/trees{/sha},https://api.github.com/repos/skonto/spark/statuses/{sha},https://api.github.com/repos/skonto/spark/languages,https://api.github.com/repos/skonto/spark/stargazers,https://api.github.com/repos/skonto/spark/contributors,https://api.github.com/repos/skonto/spark/subscribers,https://api.github.com/repos/skonto/spark/subscription,https://api.github.com/repos/skonto/spark/commits{/sha},https://api.github.com/repos/skonto/spark/git/commits{/sha},https://api.github.com/repos/skonto/spark/comments{/number},https://api.github.com/repos/skonto/spark/issues/comments{/number},https://api.github.com/repos/skonto/spark/contents/{+path},https://api.github.com/repos/skonto/spark/compare/{base}...{head},https://api.github.com/repos/skonto/spark/merges,https://api.github.com/repos/skonto/spark/{archive_format}{/ref},https://api.github.com/repos/skonto/spark/downloads,https://api.github.com/repos/skonto/spark/issues{/number},https://api.github.com/repos/skonto/spark/pulls{/number},https://api.github.com/repos/skonto/spark/milestones{/number},"https://api.github.com/repos/skonto/spark/notifications{?since,all,participating}",https://api.github.com/repos/skonto/spark/labels{/name},https://api.github.com/repos/skonto/spark/releases{/id},https://api.github.com/repos/skonto/spark/deployments,2016-01-01T23:02:52Z,2020-04-09T14:17:08Z,2020-04-09T14:16:44Z,git://github.com/skonto/spark.git,git@github.com:skonto/spark.git,https://github.com/skonto/spark.git,https://github.com/skonto/spark,,309791,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,dba673f0e306ad1564e4e2e92a3c95b9f60f5ae0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26161,https://github.com/apache/spark/pull/26161,https://api.github.com/repos/apache/spark/issues/26161,https://api.github.com/repos/apache/spark/issues/26161/comments,https://api.github.com/repos/apache/spark/pulls/26161/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26161/commits,https://api.github.com/repos/apache/spark/statuses/550508339d401750d9f1e74f2bcfcd9c83ed4427
216,https://api.github.com/repos/apache/spark/pulls/26144,328904620,MDExOlB1bGxSZXF1ZXN0MzI4OTA0NjIw,https://github.com/apache/spark/pull/26144,https://github.com/apache/spark/pull/26144.diff,https://github.com/apache/spark/pull/26144.patch,https://api.github.com/repos/apache/spark/issues/26144,26144,open,False,[SPARK-27903][SQL] Improve the error messages of SQL parser,"Adding grammar rules to capture extra left and extra right parens for expressions and subqueries

Creating reusable parenthesized query rule and plugging into all the places that use it (and updating AstBuilder accordingly)

Adding new test to ErrorParserSuite for asserting the new type of errors

Removing now irrelevant test from ErrorParserSuite

<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Tweaking the SQL grammar file in the following ways:

1. adding parenthesized query rule and swapping that out in various places that had the same definition
1. adding rule for detecting ""dangling"" (extra left or extra right) parentheses for parenthesized expressions within primary expressions, and subqueries

Also updating the `AstBuilder` in accordance with these changes.  Finally, added some tests for the new unbalanced parentheses `ParseException` instances.

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

To help make the error messages more user friendly, and also to allow people to more quickly narrow down on unbalanced parentheses within large, complicated expressions.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

There is a new type of parse error that can be shown, but there is no net behavior change to the SQL parser.

Consider two simple queries.

1. `select (r + 1))`
2. `select ((r + 1)`


Before, the error messages would be the following, respectively.

```
org.apache.spark.sql.catalyst.parser.ParseException: 
extraneous input ')' expecting <EOF>(line 1, pos 14)

== SQL ==
select (r + 1)) 
--------------^^^
org.apache.spark.sql.catalyst.parser.ParseException: 
no viable alternative at input '((r + 1) '(line 1, pos 16)

== SQL ==
select ((r + 1) 
----------------^^^
```

After:

```
org.apache.spark.sql.catalyst.parser.ParseException: 
Unbalanced parentheses (extra right)(line 1, pos 14)

== SQL ==
select (r + 1)) 
--------------^^^

org.apache.spark.sql.catalyst.parser.ParseException: 
Unbalanced parentheses (extra left)(line 1, pos 7)

== SQL ==
select ((r + 1) 
-------^^^
```

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

SQL module `sbt` tests run and confirmed.",2019-10-16T18:48:24Z,2020-01-09T15:30:20Z,,,ee7acee0bd1048e0a0f46a4abc7ded48c3f23b68,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26144/commits,https://api.github.com/repos/apache/spark/pulls/26144/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26144/comments,https://api.github.com/repos/apache/spark/statuses/f34ed69ad5b4a91bebc89ea7e724f70f3e0751e2,CONTRIBUTOR,spark,apache,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,jeff303:SPARK-27903,SPARK-27903,f34ed69ad5b4a91bebc89ea7e724f70f3e0751e2,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,207907929,MDEwOlJlcG9zaXRvcnkyMDc5MDc5Mjk=,spark,jeff303/spark,False,jeff303,3521562,MDQ6VXNlcjM1MjE1NjI=,https://avatars0.githubusercontent.com/u/3521562?v=4,,https://api.github.com/users/jeff303,https://github.com/jeff303,https://api.github.com/users/jeff303/followers,https://api.github.com/users/jeff303/following{/other_user},https://api.github.com/users/jeff303/gists{/gist_id},https://api.github.com/users/jeff303/starred{/owner}{/repo},https://api.github.com/users/jeff303/subscriptions,https://api.github.com/users/jeff303/orgs,https://api.github.com/users/jeff303/repos,https://api.github.com/users/jeff303/events{/privacy},https://api.github.com/users/jeff303/received_events,User,False,https://github.com/jeff303/spark,Apache Spark,True,https://api.github.com/repos/jeff303/spark,https://api.github.com/repos/jeff303/spark/forks,https://api.github.com/repos/jeff303/spark/keys{/key_id},https://api.github.com/repos/jeff303/spark/collaborators{/collaborator},https://api.github.com/repos/jeff303/spark/teams,https://api.github.com/repos/jeff303/spark/hooks,https://api.github.com/repos/jeff303/spark/issues/events{/number},https://api.github.com/repos/jeff303/spark/events,https://api.github.com/repos/jeff303/spark/assignees{/user},https://api.github.com/repos/jeff303/spark/branches{/branch},https://api.github.com/repos/jeff303/spark/tags,https://api.github.com/repos/jeff303/spark/git/blobs{/sha},https://api.github.com/repos/jeff303/spark/git/tags{/sha},https://api.github.com/repos/jeff303/spark/git/refs{/sha},https://api.github.com/repos/jeff303/spark/git/trees{/sha},https://api.github.com/repos/jeff303/spark/statuses/{sha},https://api.github.com/repos/jeff303/spark/languages,https://api.github.com/repos/jeff303/spark/stargazers,https://api.github.com/repos/jeff303/spark/contributors,https://api.github.com/repos/jeff303/spark/subscribers,https://api.github.com/repos/jeff303/spark/subscription,https://api.github.com/repos/jeff303/spark/commits{/sha},https://api.github.com/repos/jeff303/spark/git/commits{/sha},https://api.github.com/repos/jeff303/spark/comments{/number},https://api.github.com/repos/jeff303/spark/issues/comments{/number},https://api.github.com/repos/jeff303/spark/contents/{+path},https://api.github.com/repos/jeff303/spark/compare/{base}...{head},https://api.github.com/repos/jeff303/spark/merges,https://api.github.com/repos/jeff303/spark/{archive_format}{/ref},https://api.github.com/repos/jeff303/spark/downloads,https://api.github.com/repos/jeff303/spark/issues{/number},https://api.github.com/repos/jeff303/spark/pulls{/number},https://api.github.com/repos/jeff303/spark/milestones{/number},"https://api.github.com/repos/jeff303/spark/notifications{?since,all,participating}",https://api.github.com/repos/jeff303/spark/labels{/name},https://api.github.com/repos/jeff303/spark/releases{/id},https://api.github.com/repos/jeff303/spark/deployments,2019-09-11T21:14:13Z,2020-02-07T22:23:18Z,2020-01-10T23:02:50Z,git://github.com/jeff303/spark.git,git@github.com:jeff303/spark.git,https://github.com/jeff303/spark.git,https://github.com/jeff303/spark,,321894,1,1,,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,c49abf820d53fac5d443ded3ef4206935a6b3fd9,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26144,https://github.com/apache/spark/pull/26144,https://api.github.com/repos/apache/spark/issues/26144,https://api.github.com/repos/apache/spark/issues/26144/comments,https://api.github.com/repos/apache/spark/pulls/26144/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26144/commits,https://api.github.com/repos/apache/spark/statuses/f34ed69ad5b4a91bebc89ea7e724f70f3e0751e2
217,https://api.github.com/repos/apache/spark/pulls/26141,328757513,MDExOlB1bGxSZXF1ZXN0MzI4NzU3NTEz,https://github.com/apache/spark/pull/26141,https://github.com/apache/spark/pull/26141.diff,https://github.com/apache/spark/pull/26141.patch,https://api.github.com/repos/apache/spark/issues/26141,26141,open,False,[SPARK-29492][SQL]Reset HiveSession's SessionState conf's ClassLoader when sync mode,"### What changes were proposed in this pull request?
When we use pyhive connect to SparkThriftServer, it will run statement in sync mode.
When we query data of hive table , it will check serde class in HiveTableScanExec#addColumnMetadataToConf

https://github.com/apache/spark/blob/5a482e72091c8db940408905e8c044f7f5d7814f/sql/hive/src/main/scala/org/apache/spark/sql/hive/execution/HiveTableScanExec.scala#L123

Since we run statement in sync mode, it will use HiveSession's SessionState,  and use it's conf's classLoader. then error happened.
We should reset it when we start run sql in sync mode.
### Why are the changes needed?
Fix bug

### Does this PR introduce any user-facing change?
NO


### How was this patch tested?
UT",2019-10-16T13:21:34Z,2020-01-06T06:40:17Z,,,3021b04fac12dc58cdc24fd0e6e146d6ad0ebeec,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26141/commits,https://api.github.com/repos/apache/spark/pulls/26141/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26141/comments,https://api.github.com/repos/apache/spark/statuses/16898a8ed9c1c9645695b5ef0ea6dfedb96be1e8,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:add_jar_in_sync_mode,add_jar_in_sync_mode,16898a8ed9c1c9645695b5ef0ea6dfedb96be1e8,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,5a482e72091c8db940408905e8c044f7f5d7814f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26141,https://github.com/apache/spark/pull/26141,https://api.github.com/repos/apache/spark/issues/26141,https://api.github.com/repos/apache/spark/issues/26141/comments,https://api.github.com/repos/apache/spark/pulls/26141/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26141/commits,https://api.github.com/repos/apache/spark/statuses/16898a8ed9c1c9645695b5ef0ea6dfedb96be1e8
218,https://api.github.com/repos/apache/spark/pulls/26118,328000120,MDExOlB1bGxSZXF1ZXN0MzI4MDAwMTIw,https://github.com/apache/spark/pull/26118,https://github.com/apache/spark/pull/26118.diff,https://github.com/apache/spark/pull/26118.patch,https://api.github.com/repos/apache/spark/issues/26118,26118,open,False,[SPARK-24915][Python] Fix Row handling with Schema.,"### What changes were proposed in this pull request?

This change implements a special handling of `pyspark.sql.Row` within the conversion of a `StructType` into an internal SQL object (`toInternal()`) to fix [SPARK-24915](https://issues.apache.org/jira/browse/SPARK-24915).

Previously, `Row` was processed as `tuple` (since it inherits from `tuple`). In particular, it was expected that values come in the ""right"" order. This works if the internal order of the `Row` (sorted by key in the current implementation) corresponds to the order of fields in the schema. If the fields have a different order *and* need special treatment (e.g. `_needConversion` is `True`) then exceptions happened when creating dataframes.

With this change, it will be processed as a `dict` if it has named columns and as tuple otherwise.

## Design

Re `asDict`: I first had an implementation for `Row` as type. However, that implementation would fail for fields that are unknown to the `Row` object, this is inconsistent with the handling of `dict`s. The most consistent implementation is to convert the `Row` to `dict`.

Note: The underlying problem is that `Row` inherits from `tuple`. This is visible in the tests, too. for `assertEqual` the `Row`s `Row(a=..., b=...)` and `Row(b=..., a=...)` are *not* equal because they are compared as lists (and the order is wrong) while a direct comparison returns `True` (For this reason the tests compare based on `asDict`).

### Why are the changes needed?

The code part being changed relies on `Row`s being RDD-style tuples but breaks for `Row`s created with `kwargs`.

This change fixes SPARK-24915, creating data frames from (pyspark.sql.)Rows which failed if the order of fields in the schema differed from the (internal) order of fields in the Row and the schema is ""complicated"".

Complicated can be if one type of the schema is nested (as in the JIRA issue) or one field needs conversion (e.g. `DateType()`)

Without the change, the following examples fail:

*From JIRA issue:*

```
from pyspark import SparkConf, SparkContext
from pyspark.sql import SparkSession
from pyspark.sql.types import StructType, StructField, StringType, Row

conf = SparkConf().setMaster(""local"").setAppName(""repro"") 
context = SparkContext(conf=conf) 
session = SparkSession(context)
schema = StructType([
    StructField('field2', StructType([StructField('sub_field', StringType(), False)]), False),
    StructField('field1', StringType(), False),
])
data = [Row(field1=""Hello"", field2=Row(sub_field='world'))]
df = session.createDataFrame(data, schema=schema) # this will throw a ValueError
df.show()
```

*Date example:*

```
import datetime as dt
from pyspark.sql import Row, SparkSession
from pyspark.sql.types import StringType, DateType, StructField, StructType
spark = SparkSession.builder.master(""local"").getOrCreate()
schema = StructType([
    StructField(""join_date"", DateType(), False),
    StructField(""name"", StringType(),False),
])
rows = [Row(name='Alice', age=23, join_date=dt.datetime(2019,10,1,23,45,56)),]
spark.createDataFrame(rows, schema=schema).collect()
```

### Does this PR introduce any user-facing change?

This change is not introducing User-facing changes for existing, working pyspark code.

Code that previously caused exceptions b/c of the fixed bug will now work (which - technically - is a user-facing change).

### How was this patch tested?

#### Standard Tests

`ARROW_PRE_0_15_IPC_FORMAT=1 ./dev/run-tests` succeeded on my machine

Python: 3.7.4  
Spark: master (`a42d894a4090c97a90ce23b0989163909ebf548d`)  
OS: MacOS 10.14.6. 

#### New Tests

I added the following tests in module `pyspark.sql.tests.test_types`:

- `test_create_dataframe_from_rows_mixed_with_datetype`: schema with date field doesn't cause exception
- `test_create_dataframe_from_rows_with_nested_row`: schema with nested field doesn't cause exception
- `test_create_dataframe_from_tuple_rows`: Regression test: RDD-style `Row`s still work

The latter corresponds to the test case from SPARK_24915.
",2019-10-14T22:43:04Z,2020-02-05T18:13:54Z,,,25f1cfd2841c3fe0bae1e10a019d701baa4aa287,,[],"[{'login': 'HyukjinKwon', 'id': 6477701, 'node_id': 'MDQ6VXNlcjY0Nzc3MDE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/6477701?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/HyukjinKwon', 'html_url': 'https://github.com/HyukjinKwon', 'followers_url': 'https://api.github.com/users/HyukjinKwon/followers', 'following_url': 'https://api.github.com/users/HyukjinKwon/following{/other_user}', 'gists_url': 'https://api.github.com/users/HyukjinKwon/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/HyukjinKwon/subscriptions', 'organizations_url': 'https://api.github.com/users/HyukjinKwon/orgs', 'repos_url': 'https://api.github.com/users/HyukjinKwon/repos', 'events_url': 'https://api.github.com/users/HyukjinKwon/events{/privacy}', 'received_events_url': 'https://api.github.com/users/HyukjinKwon/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26118/commits,https://api.github.com/repos/apache/spark/pulls/26118/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26118/comments,https://api.github.com/repos/apache/spark/statuses/2490a112e78a8cfe46477b90495e39c1d1f9ce6b,NONE,spark,apache,qudade,7327644,MDQ6VXNlcjczMjc2NDQ=,https://avatars0.githubusercontent.com/u/7327644?v=4,,https://api.github.com/users/qudade,https://github.com/qudade,https://api.github.com/users/qudade/followers,https://api.github.com/users/qudade/following{/other_user},https://api.github.com/users/qudade/gists{/gist_id},https://api.github.com/users/qudade/starred{/owner}{/repo},https://api.github.com/users/qudade/subscriptions,https://api.github.com/users/qudade/orgs,https://api.github.com/users/qudade/repos,https://api.github.com/users/qudade/events{/privacy},https://api.github.com/users/qudade/received_events,User,False,qudade:SPARK-24915,SPARK-24915,2490a112e78a8cfe46477b90495e39c1d1f9ce6b,qudade,7327644,MDQ6VXNlcjczMjc2NDQ=,https://avatars0.githubusercontent.com/u/7327644?v=4,,https://api.github.com/users/qudade,https://github.com/qudade,https://api.github.com/users/qudade/followers,https://api.github.com/users/qudade/following{/other_user},https://api.github.com/users/qudade/gists{/gist_id},https://api.github.com/users/qudade/starred{/owner}{/repo},https://api.github.com/users/qudade/subscriptions,https://api.github.com/users/qudade/orgs,https://api.github.com/users/qudade/repos,https://api.github.com/users/qudade/events{/privacy},https://api.github.com/users/qudade/received_events,User,False,96523146,MDEwOlJlcG9zaXRvcnk5NjUyMzE0Ng==,spark,qudade/spark,False,qudade,7327644,MDQ6VXNlcjczMjc2NDQ=,https://avatars0.githubusercontent.com/u/7327644?v=4,,https://api.github.com/users/qudade,https://github.com/qudade,https://api.github.com/users/qudade/followers,https://api.github.com/users/qudade/following{/other_user},https://api.github.com/users/qudade/gists{/gist_id},https://api.github.com/users/qudade/starred{/owner}{/repo},https://api.github.com/users/qudade/subscriptions,https://api.github.com/users/qudade/orgs,https://api.github.com/users/qudade/repos,https://api.github.com/users/qudade/events{/privacy},https://api.github.com/users/qudade/received_events,User,False,https://github.com/qudade/spark,Mirror of Apache Spark,True,https://api.github.com/repos/qudade/spark,https://api.github.com/repos/qudade/spark/forks,https://api.github.com/repos/qudade/spark/keys{/key_id},https://api.github.com/repos/qudade/spark/collaborators{/collaborator},https://api.github.com/repos/qudade/spark/teams,https://api.github.com/repos/qudade/spark/hooks,https://api.github.com/repos/qudade/spark/issues/events{/number},https://api.github.com/repos/qudade/spark/events,https://api.github.com/repos/qudade/spark/assignees{/user},https://api.github.com/repos/qudade/spark/branches{/branch},https://api.github.com/repos/qudade/spark/tags,https://api.github.com/repos/qudade/spark/git/blobs{/sha},https://api.github.com/repos/qudade/spark/git/tags{/sha},https://api.github.com/repos/qudade/spark/git/refs{/sha},https://api.github.com/repos/qudade/spark/git/trees{/sha},https://api.github.com/repos/qudade/spark/statuses/{sha},https://api.github.com/repos/qudade/spark/languages,https://api.github.com/repos/qudade/spark/stargazers,https://api.github.com/repos/qudade/spark/contributors,https://api.github.com/repos/qudade/spark/subscribers,https://api.github.com/repos/qudade/spark/subscription,https://api.github.com/repos/qudade/spark/commits{/sha},https://api.github.com/repos/qudade/spark/git/commits{/sha},https://api.github.com/repos/qudade/spark/comments{/number},https://api.github.com/repos/qudade/spark/issues/comments{/number},https://api.github.com/repos/qudade/spark/contents/{+path},https://api.github.com/repos/qudade/spark/compare/{base}...{head},https://api.github.com/repos/qudade/spark/merges,https://api.github.com/repos/qudade/spark/{archive_format}{/ref},https://api.github.com/repos/qudade/spark/downloads,https://api.github.com/repos/qudade/spark/issues{/number},https://api.github.com/repos/qudade/spark/pulls{/number},https://api.github.com/repos/qudade/spark/milestones{/number},"https://api.github.com/repos/qudade/spark/notifications{?since,all,participating}",https://api.github.com/repos/qudade/spark/labels{/name},https://api.github.com/repos/qudade/spark/releases{/id},https://api.github.com/repos/qudade/spark/deployments,2017-07-07T09:31:57Z,2019-12-26T19:34:36Z,2019-12-26T19:36:18Z,git://github.com/qudade/spark.git,git@github.com:qudade/spark.git,https://github.com/qudade/spark.git,https://github.com/qudade/spark,,313435,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8d3eed33eee0d6e5d2e4d4907869ca6226d9e37f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26118,https://github.com/apache/spark/pull/26118,https://api.github.com/repos/apache/spark/issues/26118,https://api.github.com/repos/apache/spark/issues/26118/comments,https://api.github.com/repos/apache/spark/pulls/26118/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26118/commits,https://api.github.com/repos/apache/spark/statuses/2490a112e78a8cfe46477b90495e39c1d1f9ce6b
219,https://api.github.com/repos/apache/spark/pulls/26082,326825949,MDExOlB1bGxSZXF1ZXN0MzI2ODI1OTQ5,https://github.com/apache/spark/pull/26082,https://github.com/apache/spark/pull/26082.diff,https://github.com/apache/spark/pull/26082.patch,https://api.github.com/repos/apache/spark/issues/26082,26082,open,False,[SPARK-29431][WebUI] Improve Web UI / Sql tab visualization with cached dataframes.,"### What changes were proposed in this pull request?
With this pull request I want to improve the Web UI / SQL tab visualization. The principal problem that I find is when you have a cache in your plan, the SQL visualization don’t show any information about the part of the plan that has been cached.

Before the change
![image](https://user-images.githubusercontent.com/12819544/66587418-aa7f6280-eb8a-11e9-80cf-bf10d6c0abea.png)
After the change 
![image](https://user-images.githubusercontent.com/12819544/66587526-ddc1f180-eb8a-11e9-92de-c3b3f5657b66.png)

### Why are the changes needed?
When we have a SQL plan with cached dataframes we lose the graphical information of this dataframe in the sql tab

### Does this PR introduce any user-facing change?
Yes, in the sql tab

### How was this patch tested?
Unit testing and manual tests throught spark shell
",2019-10-10T16:29:13Z,2020-02-17T09:01:13Z,,,2e1a4c1272b088f0c0a72e6e3340c9cbd563a3fc,,[],[],[],"[{'id': 1406605079, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDc5', 'url': 'https://api.github.com/repos/apache/spark/labels/WEB%20UI', 'name': 'WEB UI', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26082/commits,https://api.github.com/repos/apache/spark/pulls/26082/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26082/comments,https://api.github.com/repos/apache/spark/statuses/c383de4aed07e7b8e97fd6e83bc8b2896ff2f3f3,CONTRIBUTOR,spark,apache,planga82,12819544,MDQ6VXNlcjEyODE5NTQ0,https://avatars3.githubusercontent.com/u/12819544?v=4,,https://api.github.com/users/planga82,https://github.com/planga82,https://api.github.com/users/planga82/followers,https://api.github.com/users/planga82/following{/other_user},https://api.github.com/users/planga82/gists{/gist_id},https://api.github.com/users/planga82/starred{/owner}{/repo},https://api.github.com/users/planga82/subscriptions,https://api.github.com/users/planga82/orgs,https://api.github.com/users/planga82/repos,https://api.github.com/users/planga82/events{/privacy},https://api.github.com/users/planga82/received_events,User,False,planga82:feature/SPARK-29431_SQL_Cache_webUI,feature/SPARK-29431_SQL_Cache_webUI,c383de4aed07e7b8e97fd6e83bc8b2896ff2f3f3,planga82,12819544,MDQ6VXNlcjEyODE5NTQ0,https://avatars3.githubusercontent.com/u/12819544?v=4,,https://api.github.com/users/planga82,https://github.com/planga82,https://api.github.com/users/planga82/followers,https://api.github.com/users/planga82/following{/other_user},https://api.github.com/users/planga82/gists{/gist_id},https://api.github.com/users/planga82/starred{/owner}{/repo},https://api.github.com/users/planga82/subscriptions,https://api.github.com/users/planga82/orgs,https://api.github.com/users/planga82/repos,https://api.github.com/users/planga82/events{/privacy},https://api.github.com/users/planga82/received_events,User,False,182507758,MDEwOlJlcG9zaXRvcnkxODI1MDc3NTg=,sparkFork,planga82/sparkFork,False,planga82,12819544,MDQ6VXNlcjEyODE5NTQ0,https://avatars3.githubusercontent.com/u/12819544?v=4,,https://api.github.com/users/planga82,https://github.com/planga82,https://api.github.com/users/planga82/followers,https://api.github.com/users/planga82/following{/other_user},https://api.github.com/users/planga82/gists{/gist_id},https://api.github.com/users/planga82/starred{/owner}{/repo},https://api.github.com/users/planga82/subscriptions,https://api.github.com/users/planga82/orgs,https://api.github.com/users/planga82/repos,https://api.github.com/users/planga82/events{/privacy},https://api.github.com/users/planga82/received_events,User,False,https://github.com/planga82/sparkFork,Apache Spark,True,https://api.github.com/repos/planga82/sparkFork,https://api.github.com/repos/planga82/sparkFork/forks,https://api.github.com/repos/planga82/sparkFork/keys{/key_id},https://api.github.com/repos/planga82/sparkFork/collaborators{/collaborator},https://api.github.com/repos/planga82/sparkFork/teams,https://api.github.com/repos/planga82/sparkFork/hooks,https://api.github.com/repos/planga82/sparkFork/issues/events{/number},https://api.github.com/repos/planga82/sparkFork/events,https://api.github.com/repos/planga82/sparkFork/assignees{/user},https://api.github.com/repos/planga82/sparkFork/branches{/branch},https://api.github.com/repos/planga82/sparkFork/tags,https://api.github.com/repos/planga82/sparkFork/git/blobs{/sha},https://api.github.com/repos/planga82/sparkFork/git/tags{/sha},https://api.github.com/repos/planga82/sparkFork/git/refs{/sha},https://api.github.com/repos/planga82/sparkFork/git/trees{/sha},https://api.github.com/repos/planga82/sparkFork/statuses/{sha},https://api.github.com/repos/planga82/sparkFork/languages,https://api.github.com/repos/planga82/sparkFork/stargazers,https://api.github.com/repos/planga82/sparkFork/contributors,https://api.github.com/repos/planga82/sparkFork/subscribers,https://api.github.com/repos/planga82/sparkFork/subscription,https://api.github.com/repos/planga82/sparkFork/commits{/sha},https://api.github.com/repos/planga82/sparkFork/git/commits{/sha},https://api.github.com/repos/planga82/sparkFork/comments{/number},https://api.github.com/repos/planga82/sparkFork/issues/comments{/number},https://api.github.com/repos/planga82/sparkFork/contents/{+path},https://api.github.com/repos/planga82/sparkFork/compare/{base}...{head},https://api.github.com/repos/planga82/sparkFork/merges,https://api.github.com/repos/planga82/sparkFork/{archive_format}{/ref},https://api.github.com/repos/planga82/sparkFork/downloads,https://api.github.com/repos/planga82/sparkFork/issues{/number},https://api.github.com/repos/planga82/sparkFork/pulls{/number},https://api.github.com/repos/planga82/sparkFork/milestones{/number},"https://api.github.com/repos/planga82/sparkFork/notifications{?since,all,participating}",https://api.github.com/repos/planga82/sparkFork/labels{/name},https://api.github.com/repos/planga82/sparkFork/releases{/id},https://api.github.com/repos/planga82/sparkFork/deployments,2019-04-21T08:17:09Z,2020-03-10T20:20:26Z,2020-03-12T19:46:55Z,git://github.com/planga82/sparkFork.git,git@github.com:planga82/sparkFork.git,https://github.com/planga82/sparkFork.git,https://github.com/planga82/sparkFork,,321274,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,8b73b92aadd685b29ef3d9b33366f5e1fd3dae99,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26082,https://github.com/apache/spark/pull/26082,https://api.github.com/repos/apache/spark/issues/26082,https://api.github.com/repos/apache/spark/issues/26082/comments,https://api.github.com/repos/apache/spark/pulls/26082/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26082/commits,https://api.github.com/repos/apache/spark/statuses/c383de4aed07e7b8e97fd6e83bc8b2896ff2f3f3
220,https://api.github.com/repos/apache/spark/pulls/26016,324308440,MDExOlB1bGxSZXF1ZXN0MzI0MzA4NDQw,https://github.com/apache/spark/pull/26016,https://github.com/apache/spark/pull/26016.diff,https://github.com/apache/spark/pull/26016.patch,https://api.github.com/repos/apache/spark/issues/26016,26016,open,False,[SPARK-24914][SQL] Calculated table statistic to improve data size estimate for ORC which manually settable for other columnar formats,"### Why are the changes needed?

Before this change Spark estimated the table size as the sum of all the file sizes. This estimate can be way too low at columnar file formats where huge data can be compressed into a very small file because of serialization (like dictionary encoding) and compression. 

This PR introduces a new statistic called `deserFactor` which is calculated for columnar file formats as a ratio of actual data size (raw data size) to file size which is used for scaling up the file size to improve the estimate of in-memory data size and having a better query optimization (i.e., join strategy decision). This way the OOM error which is the result of a wrongly chosen broadcast join strategy can be avoided.

In case of partitioned table the factors are calculated for each files and the maximum of these factors is taken. Spark stores this factor in the meta store and reuses it so the table can grow without having to recompute this statistic. The stored factor can be removed only by a `TRUNCATE` or a `DROP` table so even a subsequent `ANALYZE TABLE` where the calculation is disabled keeps the old value.

Although this intended to be a generic solution for each columnar file formats this PR currently only focusing on the ORC file format.

### Does this PR introduce any user-facing change?

No

### How was this patch tested?

The StatisticsSuite is extended with a new test: `SPARK-24914 - test deserialization factor (ORC)` which checks:
- the factor calculation and application 
- keeping and using the old factor when the calculation is switched off
- calculating it for multiple partitions
- removing the factor at `TRUNCATE`",2019-10-03T16:44:00Z,2020-03-17T21:04:42Z,,,83c0b167531386fae6524236acec1e04b13daf51,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/26016/commits,https://api.github.com/repos/apache/spark/pulls/26016/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/26016/comments,https://api.github.com/repos/apache/spark/statuses/42933f2e3f6eb699745e399a1fc9f05288603d79,CONTRIBUTOR,spark,apache,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,attilapiros:SPARK-24914-pr,SPARK-24914-pr,42933f2e3f6eb699745e399a1fc9f05288603d79,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,114023960,MDEwOlJlcG9zaXRvcnkxMTQwMjM5NjA=,spark,attilapiros/spark,False,attilapiros,2017933,MDQ6VXNlcjIwMTc5MzM=,https://avatars1.githubusercontent.com/u/2017933?v=4,,https://api.github.com/users/attilapiros,https://github.com/attilapiros,https://api.github.com/users/attilapiros/followers,https://api.github.com/users/attilapiros/following{/other_user},https://api.github.com/users/attilapiros/gists{/gist_id},https://api.github.com/users/attilapiros/starred{/owner}{/repo},https://api.github.com/users/attilapiros/subscriptions,https://api.github.com/users/attilapiros/orgs,https://api.github.com/users/attilapiros/repos,https://api.github.com/users/attilapiros/events{/privacy},https://api.github.com/users/attilapiros/received_events,User,False,https://github.com/attilapiros/spark,Mirror of Apache Spark,True,https://api.github.com/repos/attilapiros/spark,https://api.github.com/repos/attilapiros/spark/forks,https://api.github.com/repos/attilapiros/spark/keys{/key_id},https://api.github.com/repos/attilapiros/spark/collaborators{/collaborator},https://api.github.com/repos/attilapiros/spark/teams,https://api.github.com/repos/attilapiros/spark/hooks,https://api.github.com/repos/attilapiros/spark/issues/events{/number},https://api.github.com/repos/attilapiros/spark/events,https://api.github.com/repos/attilapiros/spark/assignees{/user},https://api.github.com/repos/attilapiros/spark/branches{/branch},https://api.github.com/repos/attilapiros/spark/tags,https://api.github.com/repos/attilapiros/spark/git/blobs{/sha},https://api.github.com/repos/attilapiros/spark/git/tags{/sha},https://api.github.com/repos/attilapiros/spark/git/refs{/sha},https://api.github.com/repos/attilapiros/spark/git/trees{/sha},https://api.github.com/repos/attilapiros/spark/statuses/{sha},https://api.github.com/repos/attilapiros/spark/languages,https://api.github.com/repos/attilapiros/spark/stargazers,https://api.github.com/repos/attilapiros/spark/contributors,https://api.github.com/repos/attilapiros/spark/subscribers,https://api.github.com/repos/attilapiros/spark/subscription,https://api.github.com/repos/attilapiros/spark/commits{/sha},https://api.github.com/repos/attilapiros/spark/git/commits{/sha},https://api.github.com/repos/attilapiros/spark/comments{/number},https://api.github.com/repos/attilapiros/spark/issues/comments{/number},https://api.github.com/repos/attilapiros/spark/contents/{+path},https://api.github.com/repos/attilapiros/spark/compare/{base}...{head},https://api.github.com/repos/attilapiros/spark/merges,https://api.github.com/repos/attilapiros/spark/{archive_format}{/ref},https://api.github.com/repos/attilapiros/spark/downloads,https://api.github.com/repos/attilapiros/spark/issues{/number},https://api.github.com/repos/attilapiros/spark/pulls{/number},https://api.github.com/repos/attilapiros/spark/milestones{/number},"https://api.github.com/repos/attilapiros/spark/notifications{?since,all,participating}",https://api.github.com/repos/attilapiros/spark/labels{/name},https://api.github.com/repos/attilapiros/spark/releases{/id},https://api.github.com/repos/attilapiros/spark/deployments,2017-12-12T18:15:59Z,2020-04-06T17:28:12Z,2020-04-06T17:27:10Z,git://github.com/attilapiros/spark.git,git@github.com:attilapiros/spark.git,https://github.com/attilapiros/spark.git,https://github.com/attilapiros/spark,,325097,1,1,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,c263c154080e54dd07aaa584913773314c3528e5,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/26016,https://github.com/apache/spark/pull/26016,https://api.github.com/repos/apache/spark/issues/26016,https://api.github.com/repos/apache/spark/issues/26016/comments,https://api.github.com/repos/apache/spark/pulls/26016/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/26016/commits,https://api.github.com/repos/apache/spark/statuses/42933f2e3f6eb699745e399a1fc9f05288603d79
221,https://api.github.com/repos/apache/spark/pulls/25965,322516170,MDExOlB1bGxSZXF1ZXN0MzIyNTE2MTcw,https://github.com/apache/spark/pull/25965,https://github.com/apache/spark/pull/25965.diff,https://github.com/apache/spark/pull/25965.patch,https://api.github.com/repos/apache/spark/issues/25965,25965,open,False,[SPARK-26425][SS] Add more constraint checks in file streaming source to avoid checkpoint corruption,"### What changes were proposed in this pull request?

Credits to @tdas who reported and described the fix to [SPARK-26425](https://issues.apache.org/jira/browse/SPARK-26425). I just followed the description of the issue.

This patch adds more checks on file streaming source so that multiple concurrent runs of streaming query don't mess up the status of query/checkpoint. This patch addresses two different spots which are having a bit different issues:

1. HDFSMetadataLog.getLatest()

This is pretty weird to allow reading from non-latest batch metadata and treat it as latest. It only happens when the query succeeds to find the latest batch file from listing but the file is deleted just before reading. It should have treated as critical and end users should be indicated this as it means metadata is being modified from other query (or manually) which is unsafe.

2. FileStreamSource.fetchMaxOffset()

In structured streaming, we don't allow multiple streaming queries to run with same checkpoint (including concurrent runs of same query), so query should fail if it fails to write the metadata of specific batch ID due to same batch ID being written by others.

As described in JIRA issue, assertion is already applied to the `offsetLog` for the same reason.

https://github.com/apache/spark/blob/8167714cab93a5c06c23f92c9077fe8b9677ab28/sql/core/src/main/scala/org/apache/spark/sql/execution/streaming/MicroBatchExecution.scala#L394-L402

### Why are the changes needed?

This prevents the inconsistent behavior on streaming query and lets query fail instead.

### Does this PR introduce any user-facing change?

No.

### How was this patch tested?

N/A, as the change is simple and obvious, and it's really hard to artificially reproduce the issue.",2019-09-29T15:44:37Z,2020-01-13T07:30:07Z,,,71a79cdb7c66d0c71d2ff0648ac710644d70d581,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25965/commits,https://api.github.com/repos/apache/spark/pulls/25965/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25965/comments,https://api.github.com/repos/apache/spark/statuses/726d920db6969a46174f4dac96db8af1a9991cad,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-26425,SPARK-26425,726d920db6969a46174f4dac96db8af1a9991cad,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,67d5b9b1573ac24e8c8c546c195dba2abb911f2f,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25965,https://github.com/apache/spark/pull/25965,https://api.github.com/repos/apache/spark/issues/25965,https://api.github.com/repos/apache/spark/issues/25965/comments,https://api.github.com/repos/apache/spark/pulls/25965/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25965/commits,https://api.github.com/repos/apache/spark/statuses/726d920db6969a46174f4dac96db8af1a9991cad
222,https://api.github.com/repos/apache/spark/pulls/25840,319058629,MDExOlB1bGxSZXF1ZXN0MzE5MDU4NjI5,https://github.com/apache/spark/pull/25840,https://github.com/apache/spark/pull/25840.diff,https://github.com/apache/spark/pull/25840.patch,https://api.github.com/repos/apache/spark/issues/25840,25840,open,False,[SPARK-29166][SQL] Add parameters to limit the number of dynamic partitions for data source table,"### What changes were proposed in this pull request?
Dynamic partition in Hive table has some restrictions like limitation of the max number of partitions. 

 Configuration |  Default |  Note
-- | -- | --
 hive.exec.max.dynamic.partitions.pernode | 100  |  Maximum number of dynamic partitions allowed to be created in each mapper/reducer node
 hive.exec.max.dynamic.partitions | 1000 |  Maximum number of dynamic partitions allowed to be created in total
hive.exec.max.created.files | 100000 | Maximum number of HDFS files created by all mappers/reducers in a MapReduce job

Ref [DynamicPartitionInserts](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-DynamicPartitionInserts) and [Tutorial-Dynamic-PartitionInsert](https://cwiki.apache.org/confluence/display/Hive/Tutorial#Tutorial-Dynamic-PartitionInsert)

It's very useful to prevent to create mistake partitions like ID. Also it can protect the NameNode from mass RPC calls of creating.

Data source table also needs similar limitations.

### Why are the changes needed?
Add a parameter to limit the number of dynamic partitions for data source table.
By default, the max number of partitions is Int.MaxValue. It's nearly no limitation.
When the parameter value we set is reached, it will throw SparkException and abort the job.

 Configuration |  Default |  Note
-- | -- | --
 spark.sql.dynamic.partition.maxPartitionsPerTask | Int.MaxValue  |  Maximum number of dynamic partitions allowed to be created in each task
 spark.sql.dynamic.partition.maxPartitions | Int.MaxValue |  Maximum total number of dynamic partitions allowed to be created by one DML
spark.sql.dynamic.partition.maxCreatedFiles | Int.MaxValue | Maximum total number of files allowed to be created in dynamic partitions write by one DML

### Does this PR introduce any user-facing change?
No.


### How was this patch tested?
Add a unit test.",2019-09-19T01:30:24Z,2020-03-13T06:09:07Z,,,f1d7f2a226e46c0747ad050f50f9ba65cdd8468a,,[],"[{'login': 'viirya', 'id': 68855, 'node_id': 'MDQ6VXNlcjY4ODU1', 'avatar_url': 'https://avatars1.githubusercontent.com/u/68855?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/viirya', 'html_url': 'https://github.com/viirya', 'followers_url': 'https://api.github.com/users/viirya/followers', 'following_url': 'https://api.github.com/users/viirya/following{/other_user}', 'gists_url': 'https://api.github.com/users/viirya/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/viirya/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/viirya/subscriptions', 'organizations_url': 'https://api.github.com/users/viirya/orgs', 'repos_url': 'https://api.github.com/users/viirya/repos', 'events_url': 'https://api.github.com/users/viirya/events{/privacy}', 'received_events_url': 'https://api.github.com/users/viirya/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25840/commits,https://api.github.com/repos/apache/spark/pulls/25840/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25840/comments,https://api.github.com/repos/apache/spark/statuses/cd61ea1f9cc9a826878598b002d8f4e8b5a12b18,CONTRIBUTOR,spark,apache,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,LantaoJin:SPARK-29166,SPARK-29166,cd61ea1f9cc9a826878598b002d8f4e8b5a12b18,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,90969496,MDEwOlJlcG9zaXRvcnk5MDk2OTQ5Ng==,spark,LantaoJin/spark,False,LantaoJin,1853780,MDQ6VXNlcjE4NTM3ODA=,https://avatars0.githubusercontent.com/u/1853780?v=4,,https://api.github.com/users/LantaoJin,https://github.com/LantaoJin,https://api.github.com/users/LantaoJin/followers,https://api.github.com/users/LantaoJin/following{/other_user},https://api.github.com/users/LantaoJin/gists{/gist_id},https://api.github.com/users/LantaoJin/starred{/owner}{/repo},https://api.github.com/users/LantaoJin/subscriptions,https://api.github.com/users/LantaoJin/orgs,https://api.github.com/users/LantaoJin/repos,https://api.github.com/users/LantaoJin/events{/privacy},https://api.github.com/users/LantaoJin/received_events,User,False,https://github.com/LantaoJin/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LantaoJin/spark,https://api.github.com/repos/LantaoJin/spark/forks,https://api.github.com/repos/LantaoJin/spark/keys{/key_id},https://api.github.com/repos/LantaoJin/spark/collaborators{/collaborator},https://api.github.com/repos/LantaoJin/spark/teams,https://api.github.com/repos/LantaoJin/spark/hooks,https://api.github.com/repos/LantaoJin/spark/issues/events{/number},https://api.github.com/repos/LantaoJin/spark/events,https://api.github.com/repos/LantaoJin/spark/assignees{/user},https://api.github.com/repos/LantaoJin/spark/branches{/branch},https://api.github.com/repos/LantaoJin/spark/tags,https://api.github.com/repos/LantaoJin/spark/git/blobs{/sha},https://api.github.com/repos/LantaoJin/spark/git/tags{/sha},https://api.github.com/repos/LantaoJin/spark/git/refs{/sha},https://api.github.com/repos/LantaoJin/spark/git/trees{/sha},https://api.github.com/repos/LantaoJin/spark/statuses/{sha},https://api.github.com/repos/LantaoJin/spark/languages,https://api.github.com/repos/LantaoJin/spark/stargazers,https://api.github.com/repos/LantaoJin/spark/contributors,https://api.github.com/repos/LantaoJin/spark/subscribers,https://api.github.com/repos/LantaoJin/spark/subscription,https://api.github.com/repos/LantaoJin/spark/commits{/sha},https://api.github.com/repos/LantaoJin/spark/git/commits{/sha},https://api.github.com/repos/LantaoJin/spark/comments{/number},https://api.github.com/repos/LantaoJin/spark/issues/comments{/number},https://api.github.com/repos/LantaoJin/spark/contents/{+path},https://api.github.com/repos/LantaoJin/spark/compare/{base}...{head},https://api.github.com/repos/LantaoJin/spark/merges,https://api.github.com/repos/LantaoJin/spark/{archive_format}{/ref},https://api.github.com/repos/LantaoJin/spark/downloads,https://api.github.com/repos/LantaoJin/spark/issues{/number},https://api.github.com/repos/LantaoJin/spark/pulls{/number},https://api.github.com/repos/LantaoJin/spark/milestones{/number},"https://api.github.com/repos/LantaoJin/spark/notifications{?since,all,participating}",https://api.github.com/repos/LantaoJin/spark/labels{/name},https://api.github.com/repos/LantaoJin/spark/releases{/id},https://api.github.com/repos/LantaoJin/spark/deployments,2017-05-11T10:58:27Z,2019-06-03T02:33:56Z,2020-03-24T09:02:44Z,git://github.com/LantaoJin/spark.git,git@github.com:LantaoJin/spark.git,https://github.com/LantaoJin/spark.git,https://github.com/LantaoJin/spark,,323789,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,068bdd44158d591e6fa48b105cf8d3fc33845695,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25840,https://github.com/apache/spark/pull/25840,https://api.github.com/repos/apache/spark/issues/25840,https://api.github.com/repos/apache/spark/issues/25840/comments,https://api.github.com/repos/apache/spark/pulls/25840/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25840/commits,https://api.github.com/repos/apache/spark/statuses/cd61ea1f9cc9a826878598b002d8f4e8b5a12b18
223,https://api.github.com/repos/apache/spark/pulls/25827,318629231,MDExOlB1bGxSZXF1ZXN0MzE4NjI5MjMx,https://github.com/apache/spark/pull/25827,https://github.com/apache/spark/pull/25827.diff,https://github.com/apache/spark/pull/25827.patch,https://api.github.com/repos/apache/spark/issues/25827,25827,open,False,[SPARK-29128][SQL] Split predicate code in OR expressions,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->
This pr is to split predicate code in OR expressions. When I checked if method bytecode size in `BenchmarkQueryTest` went over the OpenJDK default limit (8000) or not in #25788, I found [TPCDSQuerySuite.modified-q3](https://github.com/apache/spark/blob/master/sql/core/src/test/resources/tpcds-modifiedQueries/q3.sql) had too big functions. That's because too long OR chains in the query generate too long code in a single function;

`modified-q3` generates [the code](https://gist.github.com/maropu/9bfdcf9f8b694ad68ad6b3dc67fddb7c#file-non-split-case-in-spark-xxxxx-tpcdsquerysuite-modified-q3) below in the master 
```
== Subtree 2 / 4 (maxMethodCodeSize:12497; maxConstantPoolSize:732(1.12% used); numInnerClasses:1) ==
                                    ^^^^^^
*(3) HashAggregate(keys=[d_year#9, i_brand#62, i_brand_id#61], functions=[partial_sum(UnscaledValue(ss_net_profit#53))], output=[d_year#9, i_brand#62, i_brand_id#61, sum#85L])
+- *(3) Project [d_year#9, ss_net_profit#53, i_brand_id#61, i_brand#62]
....
/* 365 */   private void agg_doAggregateWithKeys_0() throws java.io.IOException {
/* 366 */     if (columnartorow_mutableStateArray_1[0] == null) {
/* 367 */       columnartorow_nextBatch_0();
/* 368 */     }
/* 369 */     while ( columnartorow_mutableStateArray_1[0] != null) {
/* 370 */       int columnartorow_numRows_0 = columnartorow_mutableStateArray_1[0].numRows();
/* 371 */       int columnartorow_localEnd_0 = columnartorow_numRows_0 - columnartorow_batchIdx_0;
/* 372 */       for (int columnartorow_localIdx_0 = 0; columnartorow_localIdx_0 < columnartorow_localEnd_0; columnartorow_localIdx_0++) {
/* 373 */         int columnartorow_rowIdx_0 = columnartorow_batchIdx_0 + columnartorow_localIdx_0;
/* 374 */         do {
/* 375 */           boolean columnartorow_isNull_0 = columnartorow_mutableStateArray_2[0].isNullAt(columnartorow_rowIdx_0);
/* 376 */           int columnartorow_value_0 = columnartorow_isNull_0 ? -1 : (columnartorow_mutableStateArray_2[0].getInt(columnartorow_rowIdx_0));
/* 377 */
/* 378 */           boolean filter_value_2 = !columnartorow_isNull_0;
/* 379 */           if (!filter_value_2) continue;
/* 380 */
/* 381 */           boolean filter_value_12 = false;
/* 382 */           filter_value_12 = columnartorow_value_0 >= 2415355;
/* 383 */           boolean filter_value_11 = false;
/* 384 */
.....
too long code
```

This pr split the predicate code into [small functions](https://gist.github.com/maropu/f2f8dba8fe74b50fc0b8ba73ecfbb5d2) below;
```
== Subtree 2 / 4 (maxMethodCodeSize:688; maxConstantPoolSize:949(1.45% used); numInnerClasses:1) ==
                                    ^^^^
*(3) HashAggregate(keys=[d_year#9, i_brand#62, i_brand_id#61], functions=[partial_sum(UnscaledValue(ss_net_profit#53))], output=[d_year#9, i_brand#62, i_brand_id#61, sum#85L])
+- *(3) Project [d_year#9, ss_net_profit#53, i_brand_id#61, i_brand#62]
...
/* 3285 */   private void agg_doAggregateWithKeys_0() throws java.io.IOException {
/* 3286 */     if (columnartorow_mutableStateArray_1[0] == null) {
/* 3287 */       columnartorow_nextBatch_0();
/* 3288 */     }
/* 3289 */     while ( columnartorow_mutableStateArray_1[0] != null) {
/* 3290 */       int columnartorow_numRows_0 = columnartorow_mutableStateArray_1[0].numRows();
/* 3291 */       int columnartorow_localEnd_0 = columnartorow_numRows_0 - columnartorow_batchIdx_0;
/* 3292 */       for (int columnartorow_localIdx_0 = 0; columnartorow_localIdx_0 < columnartorow_localEnd_0; columnartorow_localIdx_0++) {
/* 3293 */         int columnartorow_rowIdx_0 = columnartorow_batchIdx_0 + columnartorow_localIdx_0;
/* 3294 */         do {
/* 3295 */           boolean columnartorow_isNull_0 = columnartorow_mutableStateArray_2[0].isNullAt(columnartorow_rowIdx_0);
/* 3296 */           int columnartorow_value_0 = columnartorow_isNull_0 ? -1 : (columnartorow_mutableStateArray_2[0].getInt(columnartorow_rowIdx_0));
/* 3297 */
/* 3298 */           boolean filter_value_2 = !columnartorow_isNull_0;
/* 3299 */           if (!filter_value_2) continue;
/* 3300 */
/* 3301 */           boolean filter_value_213 = filter_or_8(columnartorow_value_0, columnartorow_isNull_0);
/* 3302 */           boolean filter_value_5 = true;
/* 3303 */
/* 3304 */           if (!filter_value_213) {
/* 3305 */             boolean filter_value_421 = filter_or_17(columnartorow_value_0, columnartorow_isNull_0);
/* 3306 */             filter_value_5 = filter_value_421;
/* 3307 */           }
/* 3308 */           boolean filter_value_4 = true;
/* 3309 */
/* 3310 */           if (!filter_value_5) {
/* 3311 */             boolean filter_value_630 = filter_or_26(columnartorow_value_0, columnartorow_isNull_0);
/* 3312 */             boolean filter_value_422 = true;
/* 3313 */
/* 3314 */             if (!filter_value_630) {
/* 3315 */               boolean filter_value_838 = filter_or_35(columnartorow_value_0, columnartorow_isNull_0);
/* 3316 */               filter_value_422 = filter_value_838;
/* 3317 */             }
/* 3318 */             filter_value_4 = filter_value_422;
/* 3319 */           }
/* 3320 */           boolean filter_value_3 = true;
/* 3321 */
/* 3322 */           if (!filter_value_4) {
/* 3323 */             boolean filter_value_1048 = filter_or_44(columnartorow_value_0, columnartorow_isNull_0);
/* 3324 */             boolean filter_value_840 = true;
/* 3325 */
/* 3326 */             if (!filter_value_1048) {
/* 3327 */               boolean filter_value_1256 = filter_or_53(columnartorow_value_0, columnartorow_isNull_0);
/* 3328 */               filter_value_840 = filter_value_1256;
/* 3329 */             }
/* 3330 */             boolean filter_value_839 = true;
/* 3331 */
/* 3332 */             if (!filter_value_840) {
/* 3333 */               boolean filter_value_1465 = filter_or_62(columnartorow_value_0, columnartorow_isNull_0);
/* 3334 */               boolean filter_value_1257 = true;
/* 3335 */
/* 3336 */               if (!filter_value_1465) {
/* 3337 */                 boolean filter_value_1673 = filter_or_71(columnartorow_value_0, columnartorow_isNull_0);
/* 3338 */                 filter_value_1257 = filter_value_1673;
/* 3339 */               }
/* 3340 */               filter_value_839 = filter_value_1257;
/* 3341 */             }
/* 3342 */             filter_value_3 = filter_value_839;
/* 3343 */           }
/* 3344 */           if (!filter_value_3) continue;
/* 3345 */
/* 3346 */           boolean columnartorow_isNull_1 = columnartorow_mutableStateArray_2[1].isNullAt(columnartorow_rowIdx_0);
/* 3347 */           int columnartorow_value_1 = columnartorow_isNull_1 ? -1 : (columnartorow_mutableStateArray_2[1].getInt(columnartorow_rowIdx_0));
/* 3348 */
/* 3349 */           boolean filter_value_1676 = !columnartorow_isNull_1;
/* 3350 */           if (!filter_value_1676) continue;
/* 3351 */
```

### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
For better generated code.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
No

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
Existing unit tests.",2019-09-18T05:05:22Z,2020-03-26T03:55:07Z,,,a9cd40d49ab215554a12f885ecfa0e55132a5891,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25827/commits,https://api.github.com/repos/apache/spark/pulls/25827/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25827/comments,https://api.github.com/repos/apache/spark/statuses/543c0167dab23ece2e4db232c0fd7d4c9e5eeb8e,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:SplitOrPredicate,SplitOrPredicate,543c0167dab23ece2e4db232c0fd7d4c9e5eeb8e,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,e6b157cf704544a6217a9f9d191f542518581040,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25827,https://github.com/apache/spark/pull/25827,https://api.github.com/repos/apache/spark/issues/25827,https://api.github.com/repos/apache/spark/issues/25827/comments,https://api.github.com/repos/apache/spark/pulls/25827/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25827/commits,https://api.github.com/repos/apache/spark/statuses/543c0167dab23ece2e4db232c0fd7d4c9e5eeb8e
224,https://api.github.com/repos/apache/spark/pulls/25721,315270340,MDExOlB1bGxSZXF1ZXN0MzE1MjcwMzQw,https://github.com/apache/spark/pull/25721,https://github.com/apache/spark/pull/25721.diff,https://github.com/apache/spark/pull/25721.patch,https://api.github.com/repos/apache/spark/issues/25721,25721,open,False,[WIP][SPARK-29018][SQL] Implement Spark Thrift Server with it's own code base on PROTOCOL_VERSION_V9,"### What changes were proposed in this pull request?
Current SparkThriftServer need to fit so much hive version problem and it implement too much unused feature from HiveServer2. Maybe we should implement thrift server  with spark's own code. 

Changes:

1. Construct RowSet with StructType and Row
2. Old Thrift server avoid conflicts, pass a HiveConf for execution, remove all action about HiveMetaStore to class DelegationTokenHandler
3. Remove unnecessary action for Hive execution.
4. Add `hive-service` API code dependency for `beeline`
5. Implement some class to handle version problem such as `org.apache.spark.sql.hive.thriftserver.cli.Type`, `org.apache.spark.sql.hive.thriftserver.utils.LogHelper/VariableSubstitution`
6. Remove class ThrfitserverShimUtils and dir for hive version v1.2.1 & v2.3.5
7. Based on PROTOCOL_VERSION_V9, backwards compatible， when protocol version update, we can just  replace old and  add some more method since protocol is backwards compatible.




### Why are the changes needed?
Get rider of HiveServer2 API 's limit and fit better for Spark


### Does this PR introduce any user-facing change?
NO


### How was this patch tested?
",2019-09-08T12:25:00Z,2020-03-17T17:04:50Z,,,,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25721/commits,https://api.github.com/repos/apache/spark/pulls/25721/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25721/comments,https://api.github.com/repos/apache/spark/statuses/60415cd012aced3efed30598a8e8e78be1bf6ff0,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-29018,SPARK-29018,60415cd012aced3efed30598a8e8e78be1bf6ff0,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,a75467432eab2ee38b93906d86416fe9e110e82e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25721,https://github.com/apache/spark/pull/25721,https://api.github.com/repos/apache/spark/issues/25721,https://api.github.com/repos/apache/spark/issues/25721/comments,https://api.github.com/repos/apache/spark/pulls/25721/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25721/commits,https://api.github.com/repos/apache/spark/statuses/60415cd012aced3efed30598a8e8e78be1bf6ff0
225,https://api.github.com/repos/apache/spark/pulls/25695,314460664,MDExOlB1bGxSZXF1ZXN0MzE0NDYwNjY0,https://github.com/apache/spark/pull/25695,https://github.com/apache/spark/pull/25695.diff,https://github.com/apache/spark/pull/25695.patch,https://api.github.com/repos/apache/spark/issues/25695,25695,open,False,[SPARK-28992][K8S] Support update dependencies from hdfs when task run on executor pods,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?


Here is a case: 

```shell
bin/spark-submit  --class com.github.ehiggs.spark.terasort.TeraSort hdfs://hz-cluster10/user/kyuubi/udf/spark-terasort-1.1-SNAPSHOT-jar-with-dependencies.jar hdfs://hz-cluster10/user/kyuubi/terasort/1000g hdfs://hz-cluster10/user/kyuubi/terasort/1000g-out1
```
Spark supports add jar logic and application-jar from hdfs - -  http://spark.apache.org/docs/latest/submitting-applications.html#launching-applications-with-spark-submit

Take spark on yarn for example, it creates a _spark_hadoop_conf_.xml file and upload the hadoop distribute cache, the executor processes can use this to identify where their dependencies located.

But on k8s, i tried and failed to update dependencies.
```scala
19/09/04 08:08:52 INFO scheduler.DAGScheduler: ShuffleMapStage 0 (newAPIHadoopFile at TeraSort.scala:60) failed in 1.058 s due to Job aborted due to stage failure: Task 0 in stage 0.0 failed 4 times, most recent failure: Lost task 0.3 in stage 0.0 (TID 9, 100.66.0.75, executor 2): java.lang.IllegalArgumentException: java.net.UnknownHostException: hz-cluster10
	at org.apache.hadoop.security.SecurityUtil.buildTokenService(SecurityUtil.java:378)
	at org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:310)
	at org.apache.hadoop.hdfs.NameNodeProxies.createProxy(NameNodeProxies.java:176)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:678)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:619)
	at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:149)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2669)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:94)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2703)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2685)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:373)
	at org.apache.spark.util.Utils$.getHadoopFileSystem(Utils.scala:1881)
	at org.apache.spark.util.Utils$.doFetchFile(Utils.scala:737)
	at org.apache.spark.util.Utils$.fetchFile(Utils.scala:522)
	at org.apache.spark.executor.Executor.$anonfun$updateDependencies$7(Executor.scala:869)
	at org.apache.spark.executor.Executor.$anonfun$updateDependencies$7$adapted(Executor.scala:860)
	at scala.collection.TraversableLike$WithFilter.$anonfun$foreach$1(TraversableLike.scala:792)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:791)
	at org.apache.spark.executor.Executor.org$apache$spark$executor$Executor$$updateDependencies(Executor.scala:860)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:409)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

We need to update dependencies for task, some of them could located on hdfs

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

no

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

manually test & add uts
",2019-09-05T11:46:31Z,2020-03-03T07:22:06Z,,,6fc84c7069ba285e82727374453855aba251eae8,,[],"[{'login': 'srowen', 'id': 822522, 'node_id': 'MDQ6VXNlcjgyMjUyMg==', 'avatar_url': 'https://avatars0.githubusercontent.com/u/822522?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/srowen', 'html_url': 'https://github.com/srowen', 'followers_url': 'https://api.github.com/users/srowen/followers', 'following_url': 'https://api.github.com/users/srowen/following{/other_user}', 'gists_url': 'https://api.github.com/users/srowen/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/srowen/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/srowen/subscriptions', 'organizations_url': 'https://api.github.com/users/srowen/orgs', 'repos_url': 'https://api.github.com/users/srowen/repos', 'events_url': 'https://api.github.com/users/srowen/events{/privacy}', 'received_events_url': 'https://api.github.com/users/srowen/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25695/commits,https://api.github.com/repos/apache/spark/pulls/25695/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25695/comments,https://api.github.com/repos/apache/spark/statuses/6f96bac00735e1430f54442ff03e2995604d0917,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:SPARK-28992,SPARK-28992,6f96bac00735e1430f54442ff03e2995604d0917,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,103d50b3f64b283e8fcf89f5e6c368535cf262bd,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25695,https://github.com/apache/spark/pull/25695,https://api.github.com/repos/apache/spark/issues/25695,https://api.github.com/repos/apache/spark/issues/25695/comments,https://api.github.com/repos/apache/spark/pulls/25695/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25695/commits,https://api.github.com/repos/apache/spark/statuses/6f96bac00735e1430f54442ff03e2995604d0917
226,https://api.github.com/repos/apache/spark/pulls/25651,313238195,MDExOlB1bGxSZXF1ZXN0MzEzMjM4MTk1,https://github.com/apache/spark/pull/25651,https://github.com/apache/spark/pull/25651.diff,https://github.com/apache/spark/pull/25651.patch,https://api.github.com/repos/apache/spark/issues/25651,25651,open,False,[SPARK-28948][SQL] Support passing all Table metadata in TableProvider,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Currently Data Source V2 has 2 major use cases:
1. users plug in a custom catalog, which is tightly coupled with its own data. For example, users can plug in a cassandra catalog, and use Spark to read/write cassandra tables directly.
2. users read/write the external data as a table directly via `DataFrameReader/Writer`, or register it as a table in Spark.

Use case 1 is newly introduced in the master branch, which greatly improves the user experience when interacting with external storage systems that have catalogs, e.g. cassandra, JDBC, etc.

Use case 2 is the main use case of Data Source V1, which works well if the external storage system doesn't have a catalog, e.g. parquet files on S3.

However, use case 2 is not well supported. For example
```
class MyTableProvider extends TableProvider ...
sql(""CREATE TABLE t USING com.abc.MyTableProvider"")
```
This fails with `AnalysisException: com.abc.MyTableProvider is not a valid Spark SQL Data Source`. The session catalog always treats table provider as v1 source.

To support it, this PR updates `TableProvider#getTable` to accept additional table metadata info. The expected behaviors are defined in https://docs.google.com/document/d/1oaS0eIVL1WsCjr4CqIpRv6CGkS5EoMQrngn3FsY1d-Q/edit?usp=sharing


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->

Make Data Source V2 supports the use case that is supported by Data Source V1.

### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->
Yes, it's a new feature

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->
a new test suite",2019-09-02T12:07:19Z,2020-03-19T07:03:16Z,,,7d153f544e1139b4510f30775bd6fe3a7ca47b78,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25651/commits,https://api.github.com/repos/apache/spark/pulls/25651/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25651/comments,https://api.github.com/repos/apache/spark/statuses/cfbe0a75f80e88d4a5831785d05fb9b708c5ada3,CONTRIBUTOR,spark,apache,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,cloud-fan:dsv2-using,dsv2-using,cfbe0a75f80e88d4a5831785d05fb9b708c5ada3,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,19689699,MDEwOlJlcG9zaXRvcnkxOTY4OTY5OQ==,spark,cloud-fan/spark,False,cloud-fan,3182036,MDQ6VXNlcjMxODIwMzY=,https://avatars3.githubusercontent.com/u/3182036?v=4,,https://api.github.com/users/cloud-fan,https://github.com/cloud-fan,https://api.github.com/users/cloud-fan/followers,https://api.github.com/users/cloud-fan/following{/other_user},https://api.github.com/users/cloud-fan/gists{/gist_id},https://api.github.com/users/cloud-fan/starred{/owner}{/repo},https://api.github.com/users/cloud-fan/subscriptions,https://api.github.com/users/cloud-fan/orgs,https://api.github.com/users/cloud-fan/repos,https://api.github.com/users/cloud-fan/events{/privacy},https://api.github.com/users/cloud-fan/received_events,User,False,https://github.com/cloud-fan/spark,Mirror of Apache Spark,True,https://api.github.com/repos/cloud-fan/spark,https://api.github.com/repos/cloud-fan/spark/forks,https://api.github.com/repos/cloud-fan/spark/keys{/key_id},https://api.github.com/repos/cloud-fan/spark/collaborators{/collaborator},https://api.github.com/repos/cloud-fan/spark/teams,https://api.github.com/repos/cloud-fan/spark/hooks,https://api.github.com/repos/cloud-fan/spark/issues/events{/number},https://api.github.com/repos/cloud-fan/spark/events,https://api.github.com/repos/cloud-fan/spark/assignees{/user},https://api.github.com/repos/cloud-fan/spark/branches{/branch},https://api.github.com/repos/cloud-fan/spark/tags,https://api.github.com/repos/cloud-fan/spark/git/blobs{/sha},https://api.github.com/repos/cloud-fan/spark/git/tags{/sha},https://api.github.com/repos/cloud-fan/spark/git/refs{/sha},https://api.github.com/repos/cloud-fan/spark/git/trees{/sha},https://api.github.com/repos/cloud-fan/spark/statuses/{sha},https://api.github.com/repos/cloud-fan/spark/languages,https://api.github.com/repos/cloud-fan/spark/stargazers,https://api.github.com/repos/cloud-fan/spark/contributors,https://api.github.com/repos/cloud-fan/spark/subscribers,https://api.github.com/repos/cloud-fan/spark/subscription,https://api.github.com/repos/cloud-fan/spark/commits{/sha},https://api.github.com/repos/cloud-fan/spark/git/commits{/sha},https://api.github.com/repos/cloud-fan/spark/comments{/number},https://api.github.com/repos/cloud-fan/spark/issues/comments{/number},https://api.github.com/repos/cloud-fan/spark/contents/{+path},https://api.github.com/repos/cloud-fan/spark/compare/{base}...{head},https://api.github.com/repos/cloud-fan/spark/merges,https://api.github.com/repos/cloud-fan/spark/{archive_format}{/ref},https://api.github.com/repos/cloud-fan/spark/downloads,https://api.github.com/repos/cloud-fan/spark/issues{/number},https://api.github.com/repos/cloud-fan/spark/pulls{/number},https://api.github.com/repos/cloud-fan/spark/milestones{/number},"https://api.github.com/repos/cloud-fan/spark/notifications{?since,all,participating}",https://api.github.com/repos/cloud-fan/spark/labels{/name},https://api.github.com/repos/cloud-fan/spark/releases{/id},https://api.github.com/repos/cloud-fan/spark/deployments,2014-05-12T07:32:26Z,2017-06-22T06:57:26Z,2020-04-10T08:35:09Z,git://github.com/cloud-fan/spark.git,git@github.com:cloud-fan/spark.git,https://github.com/cloud-fan/spark.git,https://github.com/cloud-fan/spark,,319781,1,1,Scala,False,True,True,False,False,1,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,1,1,master,apache:master,master,a988aaf3fa38e89a05ab644ce79ddb14af56859d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25651,https://github.com/apache/spark/pull/25651,https://api.github.com/repos/apache/spark/issues/25651,https://api.github.com/repos/apache/spark/issues/25651/comments,https://api.github.com/repos/apache/spark/pulls/25651/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25651/commits,https://api.github.com/repos/apache/spark/statuses/cfbe0a75f80e88d4a5831785d05fb9b708c5ada3
227,https://api.github.com/repos/apache/spark/pulls/25609,311772489,MDExOlB1bGxSZXF1ZXN0MzExNzcyNDg5,https://github.com/apache/spark/pull/25609,https://github.com/apache/spark/pull/25609.diff,https://github.com/apache/spark/pull/25609.patch,https://api.github.com/repos/apache/spark/issues/25609,25609,open,False,[SPARK-28896][K8S] Support defining HADOOP_CONF_DIR and config map at the same time,"<!--
Thanks for sending a pull request!  Here are some tips for you:
  1. If this is your first time, please read our contributor guidelines: https://spark.apache.org/contributing.html
  2. Ensure you have added or run the appropriate tests for your PR: https://spark.apache.org/developer-tools.html
  3. If the PR is unfinished, add '[WIP]' in your PR title, e.g., '[WIP][SPARK-XXXX] Your PR title ...'.
  4. Be sure to keep the PR description updated to reflect all changes.
  5. Please write your PR title to summarize what this PR proposes.
  6. If possible, provide a concise example to reproduce the issue for a faster review.
-->

### What changes were proposed in this pull request?
<!--
Please clarify what changes you are proposing. The purpose of this section is to outline the changes and how this PR fixes the issue. 
If possible, please consider writing useful notes for better and faster reviews in your PR. See the examples below.
  1. If you refactor some codes with changing classes, showing the class hierarchy will help reviewers.
  2. If you fix some SQL features, you can provide some references of other DBMSes.
  3. If there is design documentation, please add the link.
  4. If there is a discussion in the mailing list, please add the link.
-->

Changes in this pull request will support users to define `HADOOP_CONF_DIR` and `spark.kubernetes.hadoop.configMapName` at the same time. When both of them are defined, Spark will take precedence over the config map to be mounted on the driver pod. This enables the spark client process to communicate any Hadoop cluster if it needs.


### Why are the changes needed?
<!--
Please clarify why the changes are needed. For instance,
  1. If you propose a new API, clarify the use case for a new API.
  2. If you fix a bug, you can clarify why it is a bug.
-->
The *BasicDriverFeatureStep* for Spark on Kubernetes will upload the files/jars specified by --files/–jars to a Hadoop compatible file system configured by spark.kubernetes.file.upload.path. While using HADOOP_CONF_DIR, the spark-submit process can recognize the file system, but when using spark.kubernetes.hadoop.configMapName which only will be mount on the Pods not applied back to our client process. 
 
```scala
 Kent@KentsMacBookPro  ~/Documents/spark-on-k8s/spark-3.0.0-SNAPSHOT-bin-2.7.3  bin/spark-submit --conf spark.kubernetes.file.upload.path=hdfs://hz-cluster10/user/kyuubi/udf --jars /Users/Kent/Documents/spark-on-k8s/spark-3.0.0-SNAPSHOT-bin-2.7.3/hadoop-lzo-0.4.20-SNAPSHOT.jar --conf spark.kerberos.keytab=/Users/Kent/Downloads/kyuubi.keytab --conf spark.kerberos.principal=kyuubi/dev@HADOOP.HZ.NETEASE.COM --conf  spark.kubernetes.kerberos.krb5.path=/etc/krb5.conf  --name hehe --deploy-mode cluster --class org.apache.spark.examples.HdfsTest   local:///opt/spark/examples/jars/spark-examples_2.12-3.0.0-SNAPSHOT.jar hdfs://hz-cluster10/user/kyuubi/hive_db/kyuubi.db/hive_tbl
Listening for transport dt_socket at address: 50014
# spark.master=k8s://https://10.120.238.100:7443
19/08/27 17:21:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
19/08/27 17:21:07 INFO SparkKubernetesClientFactory: Auto-configuring K8S client using current context from users K8S config file
Listening for transport dt_socket at address: 50014
Exception in thread ""main"" org.apache.spark.SparkException: Uploading file /Users/Kent/Documents/spark-on-k8s/spark-3.0.0-SNAPSHOT-bin-2.7.3/hadoop-lzo-0.4.20-SNAPSHOT.jar failed...
	at org.apache.spark.deploy.k8s.KubernetesUtils$.uploadFileUri(KubernetesUtils.scala:287)
	at org.apache.spark.deploy.k8s.KubernetesUtils$.$anonfun$uploadAndTransformFileUris$1(KubernetesUtils.scala:246)
	at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:237)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at scala.collection.TraversableLike.map(TraversableLike.scala:237)
	at scala.collection.TraversableLike.map$(TraversableLike.scala:230)
	at scala.collection.AbstractTraversable.map(Traversable.scala:108)
	at org.apache.spark.deploy.k8s.KubernetesUtils$.uploadAndTransformFileUris(KubernetesUtils.scala:245)
	at org.apache.spark.deploy.k8s.features.BasicDriverFeatureStep.$anonfun$getAdditionalPodSystemProperties$1(BasicDriverFeatur# spark.master=k8s://https://10.120.238.100:7443
eStep.scala:165)
	at scala.collection.immutable.List.foreach(List.scala:392)
	at org.apache.spark.deploy.k8s.features.BasicDriverFeatureStep.getAdditionalPodSystemProperties(BasicDriverFeatureStep.scala:163)
	at org.apache.spark.deploy.k8s.submit.KubernetesDriverBuilder.$anonfun$buildFromFeatures$3(KubernetesDriverBuilder.scala:60)
	at scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)
	at scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)
	at scala.collection.immutable.List.foldLeft(List.scala:89)
	at org.apache.spark.deploy.k8s.submit.KubernetesDriverBuilder.buildFromFeatures(KubernetesDriverBuilder.scala:58)
	at org.apache.spark.deploy.k8s.submit.Client.run(KubernetesClientApplication.scala:101)
	at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.$anonfun$run$10(KubernetesClientApplication.scala:236)
	at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.$anonfun$run$10$adapted(KubernetesClientApplication.scala:229)
	at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2567)
	at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.run(KubernetesClientApplication.scala:229)
	at org.apache.spark.deploy.k8s.submit.KubernetesClientApplication.start(KubernetesClientApplication.scala:198)
	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:920)
	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:179)
	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:202)
	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:89)
	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:999)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1008)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
Caused by: java.lang.IllegalArgumentException: java.net.UnknownHostException: hz-cluster10
	at org.apache.hadoop.security.SecurityUtil.buildTokenService(SecurityUtil.java:378)
	at org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:310)
	at org.apache.hadoop.hdfs.NameNodeProxies.createProxy(NameNodeProxies.java:176)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:678)
	at org.apache.hadoop.hdfs.DFSClient.<init>(DFSClient.java:619)
	at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:149)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2669)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:94)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2703)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2685)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:373)
	at org.apache.spark.util.Utils$.getHadoopFileSystem(Utils.scala:1881)
	at org.apache.spark.deploy.k8s.KubernetesUtils$.uploadFileUri(KubernetesUtils.scala:278)
	... 30 more
Caused by: java.net.UnknownHostException: hz-cluster10
	... 43 more
```

Other related spark configurations
```
spark.master=k8s://https://10.120.238.100:7443
# spark.master=k8s://https://10.120.238.253:7443
spark.kubernetes.container.image=harbor-inner.sparkonk8s.netease.com/tenant1-project1/spark:v3.0.0-20190813
# spark.kubernetes.driver.container.image=harbor-inner.sparkonk8s.netease.com/tenant1-project1/spark:v3.0.0-20190813
# spark.kubernetes.executor.container.image=harbor-inner.sparkonk8s.netease.com/tenant1-project1/spark:v3.0.0-20190813
spark.executor.instanses=5
spark.kubernetes.namespace=ns1
spark.kubernetes.container.image.pullSecrets=mysecret
spark.kubernetes.hadoop.configMapName=hz10-hadoop-dir
spark.kubernetes.kerberos.krb5.path=/etc/krb5.conf
spark.kerberos.principal=kyuubi/dev@HADOOP.HZ.NETEASE.COM
spark.kerberos.keytab=/Users/Kent/Downloads/kyuubi.keytab
```


### Does this PR introduce any user-facing change?
<!--
If yes, please clarify the previous behavior and the change this PR proposes - provide the console output, description and/or an example to show the behavior difference if possible.
If no, write 'No'.
-->

I guess this pr will now use config map of Hadoop from k8s cluster to the local client process if there are files to upload to Hadoop.

### How was this patch tested?
<!--
If tests were added, say they were added here. Please make sure to add some test cases that check the changes thoroughly including negative and positive cases if possible.
If it was tested in a way different from regular unit tests, please clarify how you tested step by step, ideally copy and paste-able, so that other reviewers can test and check, and descendants can verify in the future.
If tests were not added, please describe why they were not added and/or why it was difficult to add.
-->

manually tested with spark + k8s cluster + standalone kerberized hdfs cluster
add an unit test",2019-08-28T10:22:06Z,2020-03-04T10:49:33Z,,,1928fc65409b096f92fb791b100fb0a59ff62954,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25609/commits,https://api.github.com/repos/apache/spark/pulls/25609/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25609/comments,https://api.github.com/repos/apache/spark/statuses/7f2c9579965df56285362363ec4d6e2844a11d04,CONTRIBUTOR,spark,apache,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,yaooqinn:SPARK-28896,SPARK-28896,7f2c9579965df56285362363ec4d6e2844a11d04,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,68077781,MDEwOlJlcG9zaXRvcnk2ODA3Nzc4MQ==,spark,yaooqinn/spark,False,yaooqinn,8326978,MDQ6VXNlcjgzMjY5Nzg=,https://avatars2.githubusercontent.com/u/8326978?v=4,,https://api.github.com/users/yaooqinn,https://github.com/yaooqinn,https://api.github.com/users/yaooqinn/followers,https://api.github.com/users/yaooqinn/following{/other_user},https://api.github.com/users/yaooqinn/gists{/gist_id},https://api.github.com/users/yaooqinn/starred{/owner}{/repo},https://api.github.com/users/yaooqinn/subscriptions,https://api.github.com/users/yaooqinn/orgs,https://api.github.com/users/yaooqinn/repos,https://api.github.com/users/yaooqinn/events{/privacy},https://api.github.com/users/yaooqinn/received_events,User,False,https://github.com/yaooqinn/spark,Mirror of Apache Spark,True,https://api.github.com/repos/yaooqinn/spark,https://api.github.com/repos/yaooqinn/spark/forks,https://api.github.com/repos/yaooqinn/spark/keys{/key_id},https://api.github.com/repos/yaooqinn/spark/collaborators{/collaborator},https://api.github.com/repos/yaooqinn/spark/teams,https://api.github.com/repos/yaooqinn/spark/hooks,https://api.github.com/repos/yaooqinn/spark/issues/events{/number},https://api.github.com/repos/yaooqinn/spark/events,https://api.github.com/repos/yaooqinn/spark/assignees{/user},https://api.github.com/repos/yaooqinn/spark/branches{/branch},https://api.github.com/repos/yaooqinn/spark/tags,https://api.github.com/repos/yaooqinn/spark/git/blobs{/sha},https://api.github.com/repos/yaooqinn/spark/git/tags{/sha},https://api.github.com/repos/yaooqinn/spark/git/refs{/sha},https://api.github.com/repos/yaooqinn/spark/git/trees{/sha},https://api.github.com/repos/yaooqinn/spark/statuses/{sha},https://api.github.com/repos/yaooqinn/spark/languages,https://api.github.com/repos/yaooqinn/spark/stargazers,https://api.github.com/repos/yaooqinn/spark/contributors,https://api.github.com/repos/yaooqinn/spark/subscribers,https://api.github.com/repos/yaooqinn/spark/subscription,https://api.github.com/repos/yaooqinn/spark/commits{/sha},https://api.github.com/repos/yaooqinn/spark/git/commits{/sha},https://api.github.com/repos/yaooqinn/spark/comments{/number},https://api.github.com/repos/yaooqinn/spark/issues/comments{/number},https://api.github.com/repos/yaooqinn/spark/contents/{+path},https://api.github.com/repos/yaooqinn/spark/compare/{base}...{head},https://api.github.com/repos/yaooqinn/spark/merges,https://api.github.com/repos/yaooqinn/spark/{archive_format}{/ref},https://api.github.com/repos/yaooqinn/spark/downloads,https://api.github.com/repos/yaooqinn/spark/issues{/number},https://api.github.com/repos/yaooqinn/spark/pulls{/number},https://api.github.com/repos/yaooqinn/spark/milestones{/number},"https://api.github.com/repos/yaooqinn/spark/notifications{?since,all,participating}",https://api.github.com/repos/yaooqinn/spark/labels{/name},https://api.github.com/repos/yaooqinn/spark/releases{/id},https://api.github.com/repos/yaooqinn/spark/deployments,2016-09-13T05:39:12Z,2020-03-17T14:41:02Z,2020-04-10T17:32:33Z,git://github.com/yaooqinn/spark.git,git@github.com:yaooqinn/spark.git,https://github.com/yaooqinn/spark.git,https://github.com/yaooqinn/spark,,323218,1,1,Scala,False,True,True,False,True,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,1,master,apache:master,master,6252c54e39b04806dcf9be8a9198f9992b318340,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25609,https://github.com/apache/spark/pull/25609,https://api.github.com/repos/apache/spark/issues/25609,https://api.github.com/repos/apache/spark/issues/25609/comments,https://api.github.com/repos/apache/spark/pulls/25609/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25609/commits,https://api.github.com/repos/apache/spark/statuses/7f2c9579965df56285362363ec4d6e2844a11d04
228,https://api.github.com/repos/apache/spark/pulls/25452,307252471,MDExOlB1bGxSZXF1ZXN0MzA3MjUyNDcx,https://github.com/apache/spark/pull/25452,https://github.com/apache/spark/pull/25452.diff,https://github.com/apache/spark/pull/25452.patch,https://api.github.com/repos/apache/spark/issues/25452,25452,open,False,"[SPARK-28710][SQL]to fix replace function, spark should call drop and create function","## What changes were proposed in this pull request?

create or replace function **X as 'Y' using jar Z**;  does not work if the X is already present and is created with some other jar lets say xyz.

As per current implementation spark calls alter Function API of Hive, as of now Hive only alter name, owner, class name, type but not resource URI. After calling alter function only  **X and Y**  are updated **but not Z.**

So when the select is performed on X UDF it throws class not found exception.

Observation 1: Temporary function does not have this problem as it is handled by spark logic 

Observation 2: For permanent function Spark calls the Hive to alter function , as of now Hive only alter name, owner, class name, type but not resource URI.

[SparkCode]
![image](https://user-images.githubusercontent.com/35216143/76546139-fd01d980-64b0-11ea-8a8a-9ee39609fe88.png)


[Hive Code]
![image](https://user-images.githubusercontent.com/35216143/76546060-d9d72a00-64b0-11ea-9543-b4ae0f113cdf.png)


 As per [Hive Documentation](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Create/Drop/ReloadFunction) it does not supports create or replace command for function

## How was this patch tested?

Added UT and also manually tested

Before Fix:
![image](https://user-images.githubusercontent.com/35216143/63011564-308e6e00-bea6-11e9-8b1d-271847a96018.png)

After Fix:
![image](https://user-images.githubusercontent.com/35216143/63011970-fa9db980-bea6-11e9-8d7f-1aece951ca84.png)



",2019-08-14T09:51:18Z,2020-03-12T17:00:03Z,,,9d5cda230151aeb9923c4d300be1ceead8687f25,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25452/commits,https://api.github.com/repos/apache/spark/pulls/25452/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25452/comments,https://api.github.com/repos/apache/spark/statuses/95d1e2391b3c5d8daeb97c41e5eb9a13b73f3743,CONTRIBUTOR,spark,apache,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,sandeep-katta:alterfunction,alterfunction,95d1e2391b3c5d8daeb97c41e5eb9a13b73f3743,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,116654613,MDEwOlJlcG9zaXRvcnkxMTY2NTQ2MTM=,spark,sandeep-katta/spark,False,sandeep-katta,35216143,MDQ6VXNlcjM1MjE2MTQz,https://avatars1.githubusercontent.com/u/35216143?v=4,,https://api.github.com/users/sandeep-katta,https://github.com/sandeep-katta,https://api.github.com/users/sandeep-katta/followers,https://api.github.com/users/sandeep-katta/following{/other_user},https://api.github.com/users/sandeep-katta/gists{/gist_id},https://api.github.com/users/sandeep-katta/starred{/owner}{/repo},https://api.github.com/users/sandeep-katta/subscriptions,https://api.github.com/users/sandeep-katta/orgs,https://api.github.com/users/sandeep-katta/repos,https://api.github.com/users/sandeep-katta/events{/privacy},https://api.github.com/users/sandeep-katta/received_events,User,False,https://github.com/sandeep-katta/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sandeep-katta/spark,https://api.github.com/repos/sandeep-katta/spark/forks,https://api.github.com/repos/sandeep-katta/spark/keys{/key_id},https://api.github.com/repos/sandeep-katta/spark/collaborators{/collaborator},https://api.github.com/repos/sandeep-katta/spark/teams,https://api.github.com/repos/sandeep-katta/spark/hooks,https://api.github.com/repos/sandeep-katta/spark/issues/events{/number},https://api.github.com/repos/sandeep-katta/spark/events,https://api.github.com/repos/sandeep-katta/spark/assignees{/user},https://api.github.com/repos/sandeep-katta/spark/branches{/branch},https://api.github.com/repos/sandeep-katta/spark/tags,https://api.github.com/repos/sandeep-katta/spark/git/blobs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/tags{/sha},https://api.github.com/repos/sandeep-katta/spark/git/refs{/sha},https://api.github.com/repos/sandeep-katta/spark/git/trees{/sha},https://api.github.com/repos/sandeep-katta/spark/statuses/{sha},https://api.github.com/repos/sandeep-katta/spark/languages,https://api.github.com/repos/sandeep-katta/spark/stargazers,https://api.github.com/repos/sandeep-katta/spark/contributors,https://api.github.com/repos/sandeep-katta/spark/subscribers,https://api.github.com/repos/sandeep-katta/spark/subscription,https://api.github.com/repos/sandeep-katta/spark/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/git/commits{/sha},https://api.github.com/repos/sandeep-katta/spark/comments{/number},https://api.github.com/repos/sandeep-katta/spark/issues/comments{/number},https://api.github.com/repos/sandeep-katta/spark/contents/{+path},https://api.github.com/repos/sandeep-katta/spark/compare/{base}...{head},https://api.github.com/repos/sandeep-katta/spark/merges,https://api.github.com/repos/sandeep-katta/spark/{archive_format}{/ref},https://api.github.com/repos/sandeep-katta/spark/downloads,https://api.github.com/repos/sandeep-katta/spark/issues{/number},https://api.github.com/repos/sandeep-katta/spark/pulls{/number},https://api.github.com/repos/sandeep-katta/spark/milestones{/number},"https://api.github.com/repos/sandeep-katta/spark/notifications{?since,all,participating}",https://api.github.com/repos/sandeep-katta/spark/labels{/name},https://api.github.com/repos/sandeep-katta/spark/releases{/id},https://api.github.com/repos/sandeep-katta/spark/deployments,2018-01-08T09:11:40Z,2019-12-08T02:36:49Z,2020-01-30T13:59:01Z,git://github.com/sandeep-katta/spark.git,git@github.com:sandeep-katta/spark.git,https://github.com/sandeep-katta/spark.git,https://github.com/sandeep-katta/spark,,317028,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,23b1312324a173b75a3dd1564eda6eb32776b857,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25452,https://github.com/apache/spark/pull/25452,https://api.github.com/repos/apache/spark/issues/25452,https://api.github.com/repos/apache/spark/issues/25452/comments,https://api.github.com/repos/apache/spark/pulls/25452/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25452/commits,https://api.github.com/repos/apache/spark/statuses/95d1e2391b3c5d8daeb97c41e5eb9a13b73f3743
229,https://api.github.com/repos/apache/spark/pulls/25398,305934957,MDExOlB1bGxSZXF1ZXN0MzA1OTM0OTU3,https://github.com/apache/spark/pull/25398,https://github.com/apache/spark/pull/25398.diff,https://github.com/apache/spark/pull/25398.patch,https://api.github.com/repos/apache/spark/issues/25398,25398,open,False,[SPARK-28659][SQL] Use data source if convertible in insert overwrite directory,"### What changes were proposed in this pull request?
In insert overwrite directory while using `STORED AS file_format`,  files are not compressed.
In this PR it is converted to `datasource`  if it is convertible, to make it inline with`CTAS` behavior which is fixed in this  [PR](https://github.com/apache/spark/pull/22514)

### Why are the changes needed?
To make the behavior inline with `CTAS` while using `STORED AS file_format`

### Does this PR introduce any user-facing change?
Yes, After the fix of this PR now `STORED AS file_format` will be converted to `datasource` if it is convertible 
**Before**
![before](https://user-images.githubusercontent.com/44489863/66637198-28a03f80-ec45-11e9-9eb1-69bc21643138.png)


**After**
![after](https://user-images.githubusercontent.com/44489863/66637058-eb3bb200-ec44-11e9-88a0-2b2ab242f88f.PNG)

### How was this patch tested?
New testcase is added",2019-08-09T10:37:01Z,2020-02-27T02:06:07Z,,,2942a1e782038670d81f3be0a8069442fd36b8c2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25398/commits,https://api.github.com/repos/apache/spark/pulls/25398/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25398/comments,https://api.github.com/repos/apache/spark/statuses/72d6dd4082cdc8d45204af8aabfecf78288c6eed,CONTRIBUTOR,spark,apache,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,Udbhav30:master,master,72d6dd4082cdc8d45204af8aabfecf78288c6eed,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,155533105,MDEwOlJlcG9zaXRvcnkxNTU1MzMxMDU=,spark,Udbhav30/spark,False,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,https://github.com/Udbhav30/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Udbhav30/spark,https://api.github.com/repos/Udbhav30/spark/forks,https://api.github.com/repos/Udbhav30/spark/keys{/key_id},https://api.github.com/repos/Udbhav30/spark/collaborators{/collaborator},https://api.github.com/repos/Udbhav30/spark/teams,https://api.github.com/repos/Udbhav30/spark/hooks,https://api.github.com/repos/Udbhav30/spark/issues/events{/number},https://api.github.com/repos/Udbhav30/spark/events,https://api.github.com/repos/Udbhav30/spark/assignees{/user},https://api.github.com/repos/Udbhav30/spark/branches{/branch},https://api.github.com/repos/Udbhav30/spark/tags,https://api.github.com/repos/Udbhav30/spark/git/blobs{/sha},https://api.github.com/repos/Udbhav30/spark/git/tags{/sha},https://api.github.com/repos/Udbhav30/spark/git/refs{/sha},https://api.github.com/repos/Udbhav30/spark/git/trees{/sha},https://api.github.com/repos/Udbhav30/spark/statuses/{sha},https://api.github.com/repos/Udbhav30/spark/languages,https://api.github.com/repos/Udbhav30/spark/stargazers,https://api.github.com/repos/Udbhav30/spark/contributors,https://api.github.com/repos/Udbhav30/spark/subscribers,https://api.github.com/repos/Udbhav30/spark/subscription,https://api.github.com/repos/Udbhav30/spark/commits{/sha},https://api.github.com/repos/Udbhav30/spark/git/commits{/sha},https://api.github.com/repos/Udbhav30/spark/comments{/number},https://api.github.com/repos/Udbhav30/spark/issues/comments{/number},https://api.github.com/repos/Udbhav30/spark/contents/{+path},https://api.github.com/repos/Udbhav30/spark/compare/{base}...{head},https://api.github.com/repos/Udbhav30/spark/merges,https://api.github.com/repos/Udbhav30/spark/{archive_format}{/ref},https://api.github.com/repos/Udbhav30/spark/downloads,https://api.github.com/repos/Udbhav30/spark/issues{/number},https://api.github.com/repos/Udbhav30/spark/pulls{/number},https://api.github.com/repos/Udbhav30/spark/milestones{/number},"https://api.github.com/repos/Udbhav30/spark/notifications{?since,all,participating}",https://api.github.com/repos/Udbhav30/spark/labels{/name},https://api.github.com/repos/Udbhav30/spark/releases{/id},https://api.github.com/repos/Udbhav30/spark/deployments,2018-10-31T09:42:39Z,2019-08-12T13:11:57Z,2020-03-20T10:48:00Z,git://github.com/Udbhav30/spark.git,git@github.com:Udbhav30/spark.git,https://github.com/Udbhav30/spark.git,https://github.com/Udbhav30/spark,,321089,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,0f2efe6825a5b50b50bd1aeb8ee970fd190824fb,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25398,https://github.com/apache/spark/pull/25398,https://api.github.com/repos/apache/spark/issues/25398,https://api.github.com/repos/apache/spark/issues/25398/comments,https://api.github.com/repos/apache/spark/pulls/25398/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25398/commits,https://api.github.com/repos/apache/spark/statuses/72d6dd4082cdc8d45204af8aabfecf78288c6eed
230,https://api.github.com/repos/apache/spark/pulls/25290,302063464,MDExOlB1bGxSZXF1ZXN0MzAyMDYzNDY0,https://github.com/apache/spark/pull/25290,https://github.com/apache/spark/pull/25290.diff,https://github.com/apache/spark/pull/25290.patch,https://api.github.com/repos/apache/spark/issues/25290,25290,open,False,[SPARK-28551][SQL]Add a Checker Rule when CTAS SQL with LOCATION ,"## What changes were proposed in this pull request?

When we run SQL like 

`CRETE TABLE TBL `
`LOCATION 'PATH_URI`
`AS`
`SELECT QUERY `
It won't check PATH_URI status, if there is some data under this path, it will just overwrite this path.

If user careless write a path with important data store under the path, it will be a disaster。 

So I wish to add a checker rule in PreWriteChecker to avoid this situation happens

## How was this patch tested?
UT & MT
",2019-07-29T13:12:42Z,2020-04-10T13:10:05Z,,,2e20b965374b2e54253a64917bb03196888dc8d2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25290/commits,https://api.github.com/repos/apache/spark/pulls/25290/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25290/comments,https://api.github.com/repos/apache/spark/statuses/6db1d49bee01c44657f9ce7b0a0547b56ca38618,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:SPARK-28551,SPARK-28551,6db1d49bee01c44657f9ce7b0a0547b56ca38618,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,d2ff5c5bfb29a7b22df3cb49b6584c3e2bec397c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25290,https://github.com/apache/spark/pull/25290,https://api.github.com/repos/apache/spark/issues/25290,https://api.github.com/repos/apache/spark/issues/25290/comments,https://api.github.com/repos/apache/spark/pulls/25290/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25290/commits,https://api.github.com/repos/apache/spark/statuses/6db1d49bee01c44657f9ce7b0a0547b56ca38618
231,https://api.github.com/repos/apache/spark/pulls/25201,299316806,MDExOlB1bGxSZXF1ZXN0Mjk5MzE2ODA2,https://github.com/apache/spark/pull/25201,https://github.com/apache/spark/pull/25201.diff,https://github.com/apache/spark/pull/25201.patch,https://api.github.com/repos/apache/spark/issues/25201,25201,open,False,[SPARK-28419][SQL] Enable SparkThriftServer support proxy user's authentication .,"## What changes were proposed in this pull request?

#25179
Since origin SparkThriftServer  can't proxy client user's authentication about hive and HDFS authentications.
this PR is to enable SparkThriftServer can proxy user's authorities.

For this pr, we first obtain HDFS token for current UGI, the it can truly proxy HDFS priority. Then for each proxy user, when we create hiveClient, we obtain a  Hive token for proxy user. Different user use different SparkSession.sharedState.
Then pass DFS toke to each Task, to proxy user's DFS behavior in Executors.


## How was this patch tested?

manual test",2019-07-19T12:37:08Z,2020-02-21T02:13:56Z,,,b1084ad5c32713a95fc44c41c8bff63a6c183392,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/25201/commits,https://api.github.com/repos/apache/spark/pulls/25201/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/25201/comments,https://api.github.com/repos/apache/spark/statuses/424dca304aec99c7c1012197e5369c54b8700a01,CONTRIBUTOR,spark,apache,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,AngersZhuuuu:28419,28419,424dca304aec99c7c1012197e5369c54b8700a01,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,176224753,MDEwOlJlcG9zaXRvcnkxNzYyMjQ3NTM=,spark,AngersZhuuuu/spark,False,AngersZhuuuu,46485123,MDQ6VXNlcjQ2NDg1MTIz,https://avatars1.githubusercontent.com/u/46485123?v=4,,https://api.github.com/users/AngersZhuuuu,https://github.com/AngersZhuuuu,https://api.github.com/users/AngersZhuuuu/followers,https://api.github.com/users/AngersZhuuuu/following{/other_user},https://api.github.com/users/AngersZhuuuu/gists{/gist_id},https://api.github.com/users/AngersZhuuuu/starred{/owner}{/repo},https://api.github.com/users/AngersZhuuuu/subscriptions,https://api.github.com/users/AngersZhuuuu/orgs,https://api.github.com/users/AngersZhuuuu/repos,https://api.github.com/users/AngersZhuuuu/events{/privacy},https://api.github.com/users/AngersZhuuuu/received_events,User,False,https://github.com/AngersZhuuuu/spark,Apache Spark,True,https://api.github.com/repos/AngersZhuuuu/spark,https://api.github.com/repos/AngersZhuuuu/spark/forks,https://api.github.com/repos/AngersZhuuuu/spark/keys{/key_id},https://api.github.com/repos/AngersZhuuuu/spark/collaborators{/collaborator},https://api.github.com/repos/AngersZhuuuu/spark/teams,https://api.github.com/repos/AngersZhuuuu/spark/hooks,https://api.github.com/repos/AngersZhuuuu/spark/issues/events{/number},https://api.github.com/repos/AngersZhuuuu/spark/events,https://api.github.com/repos/AngersZhuuuu/spark/assignees{/user},https://api.github.com/repos/AngersZhuuuu/spark/branches{/branch},https://api.github.com/repos/AngersZhuuuu/spark/tags,https://api.github.com/repos/AngersZhuuuu/spark/git/blobs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/tags{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/refs{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/trees{/sha},https://api.github.com/repos/AngersZhuuuu/spark/statuses/{sha},https://api.github.com/repos/AngersZhuuuu/spark/languages,https://api.github.com/repos/AngersZhuuuu/spark/stargazers,https://api.github.com/repos/AngersZhuuuu/spark/contributors,https://api.github.com/repos/AngersZhuuuu/spark/subscribers,https://api.github.com/repos/AngersZhuuuu/spark/subscription,https://api.github.com/repos/AngersZhuuuu/spark/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/git/commits{/sha},https://api.github.com/repos/AngersZhuuuu/spark/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/issues/comments{/number},https://api.github.com/repos/AngersZhuuuu/spark/contents/{+path},https://api.github.com/repos/AngersZhuuuu/spark/compare/{base}...{head},https://api.github.com/repos/AngersZhuuuu/spark/merges,https://api.github.com/repos/AngersZhuuuu/spark/{archive_format}{/ref},https://api.github.com/repos/AngersZhuuuu/spark/downloads,https://api.github.com/repos/AngersZhuuuu/spark/issues{/number},https://api.github.com/repos/AngersZhuuuu/spark/pulls{/number},https://api.github.com/repos/AngersZhuuuu/spark/milestones{/number},"https://api.github.com/repos/AngersZhuuuu/spark/notifications{?since,all,participating}",https://api.github.com/repos/AngersZhuuuu/spark/labels{/name},https://api.github.com/repos/AngersZhuuuu/spark/releases{/id},https://api.github.com/repos/AngersZhuuuu/spark/deployments,2019-03-18T07:13:25Z,2020-01-27T07:42:01Z,2020-04-10T08:28:12Z,git://github.com/AngersZhuuuu/spark.git,git@github.com:AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark.git,https://github.com/AngersZhuuuu/spark,,326356,0,0,Scala,False,True,True,False,False,0,,False,False,1,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,1,0,master,apache:master,master,453cbf3dd8df5ec4da844c93eb6000610b551541,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/25201,https://github.com/apache/spark/pull/25201,https://api.github.com/repos/apache/spark/issues/25201,https://api.github.com/repos/apache/spark/issues/25201/comments,https://api.github.com/repos/apache/spark/pulls/25201/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/25201/commits,https://api.github.com/repos/apache/spark/statuses/424dca304aec99c7c1012197e5369c54b8700a01
232,https://api.github.com/repos/apache/spark/pulls/24990,292617174,MDExOlB1bGxSZXF1ZXN0MjkyNjE3MTc0,https://github.com/apache/spark/pull/24990,https://github.com/apache/spark/pull/24990.diff,https://github.com/apache/spark/pull/24990.patch,https://api.github.com/repos/apache/spark/issues/24990,24990,open,False,[SPARK-28191][SS] New data source - state - reader part,"## What changes were proposed in this pull request?

Please refer [SPARK-28190](https://issues.apache.org/jira/browse/SPARK-28190) to refer rationalization of introducing new state data source.

This patch proposes introducing a new data source ""state"" on streaming query, and enable users' batch query to read state in checkpoint. The new data source is located in `sql-core` module - I didn't create a new module in external since state is not an external storage.

Given state itself has no schema information ([SPARK-27237](https://issues.apache.org/jira/browse/SPARK-27237) is addressing this), this patch includes some tool  (`StateSchemaExtractor`) to extract the schema of state from streaming query. It would be ideal to adopt SPARK-27237 and get rid of this tool.

State data source leverages existing state store APIs which would be compatible with any state store providers. That said, the data source is generic one, but could be target to specific state store provider to gain optimal performance. (on demand)

## How was this patch tested?

New UTs.",2019-06-27T21:53:59Z,2020-04-10T09:01:15Z,,,0ca667d26819beb6c80dc0d17f9aea83568296ee,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24990/commits,https://api.github.com/repos/apache/spark/pulls/24990/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24990/comments,https://api.github.com/repos/apache/spark/statuses/64a08b957e085b5489b0278d0972889d6e1f1e20,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-28191,SPARK-28191,64a08b957e085b5489b0278d0972889d6e1f1e20,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,88c8d5eed2bf26ec4cc6ef68d9bdabbcb7ba1b83,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24990,https://github.com/apache/spark/pull/24990,https://api.github.com/repos/apache/spark/issues/24990,https://api.github.com/repos/apache/spark/issues/24990/comments,https://api.github.com/repos/apache/spark/pulls/24990/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24990/commits,https://api.github.com/repos/apache/spark/statuses/64a08b957e085b5489b0278d0972889d6e1f1e20
233,https://api.github.com/repos/apache/spark/pulls/24939,290884817,MDExOlB1bGxSZXF1ZXN0MjkwODg0ODE3,https://github.com/apache/spark/pull/24939,https://github.com/apache/spark/pull/24939.diff,https://github.com/apache/spark/pull/24939.patch,https://api.github.com/repos/apache/spark/issues/24939,24939,open,False,"[SPARK-18569][ML][R] Support RFormula arithmetic, I() and spark functions","## What changes were proposed in this pull request?

Added support for arithmetic expressions, use of spark functions and registered udf's inside formula so that expressions like this work as intended in `RFormula`;

`log(y) ~ a + pow(b, 2)`  ->  `log()` and `pow()` spark functions are used on `y` and `b`
`I(y +b) ~ a + x` -> The label term is sum of `y` and `b`

Udf's can also be used once they're registered:
```scala
  val registeredUdf = spark.udf.register(""plusTwo"", (x: Int) => (x + 2))
  val formula = new RFormula()
    .setFormula(""plusTwo(y) ~ a + plusTwo(b)"")

  val df = Seq((1, 4, 4), (2, 5, 6)).toDF(""y"", ""a"", ""b"")
  val model = formula.fit(df)
  model.transform(df).show()

+---+---+---+---------+-----+
|  y|  a|  b| features|label|
+---+---+---+---------+-----+
|  1|  4|  4|[4.0,6.0]|  3.0|
|  2|  5|  6|[5.0,8.0]|  4.0|
+---+---+---+---------+-----+

```
Summary of changes:
- Added `EvalExprParser` trait for parsing arithmetic expressions inside formula
- Added `ExprSelector` transformer which adds columns to a dataframe using `expr` spark function
- Add `ExprSelector` and `ColumnPruner` stages for parsed arithmetic expressions.

The criteria for parsing a term as arithmetic expression is that it's inside 'I(' expression ')', or it's a function (function criteria is ascii chars + alphanumeric chars + '(' args ')' ). From parsed arithmetic expressions, features are generated using `expr` spark function, so anything that can be used with `expr` function should be valid. Due to many ways `expr` function can be used, whether the expression has a valid syntax or whether the function is defined or not is not checked, only parsing rule is balanced parentheses.

## How was this patch tested?

Unit tests to RFormulaParserSuite and RFormulaSuite

@srowen @felixcheung ",2019-06-23T12:13:59Z,2020-03-19T02:11:06Z,,,64c27bb09feaf3b687289254ac3f10ff4cea8ec2,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406606336, 'node_id': 'MDU6TGFiZWwxNDA2NjA2MzM2', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARKR', 'name': 'SPARKR', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24939/commits,https://api.github.com/repos/apache/spark/pulls/24939/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24939/comments,https://api.github.com/repos/apache/spark/statuses/c3d97a351a04474a260ff6ae40909f366a8398cf,CONTRIBUTOR,spark,apache,ozancicek,11628913,MDQ6VXNlcjExNjI4OTEz,https://avatars1.githubusercontent.com/u/11628913?v=4,,https://api.github.com/users/ozancicek,https://github.com/ozancicek,https://api.github.com/users/ozancicek/followers,https://api.github.com/users/ozancicek/following{/other_user},https://api.github.com/users/ozancicek/gists{/gist_id},https://api.github.com/users/ozancicek/starred{/owner}{/repo},https://api.github.com/users/ozancicek/subscriptions,https://api.github.com/users/ozancicek/orgs,https://api.github.com/users/ozancicek/repos,https://api.github.com/users/ozancicek/events{/privacy},https://api.github.com/users/ozancicek/received_events,User,False,ozancicek:formula,formula,c3d97a351a04474a260ff6ae40909f366a8398cf,ozancicek,11628913,MDQ6VXNlcjExNjI4OTEz,https://avatars1.githubusercontent.com/u/11628913?v=4,,https://api.github.com/users/ozancicek,https://github.com/ozancicek,https://api.github.com/users/ozancicek/followers,https://api.github.com/users/ozancicek/following{/other_user},https://api.github.com/users/ozancicek/gists{/gist_id},https://api.github.com/users/ozancicek/starred{/owner}{/repo},https://api.github.com/users/ozancicek/subscriptions,https://api.github.com/users/ozancicek/orgs,https://api.github.com/users/ozancicek/repos,https://api.github.com/users/ozancicek/events{/privacy},https://api.github.com/users/ozancicek/received_events,User,False,189688873,MDEwOlJlcG9zaXRvcnkxODk2ODg4NzM=,spark,ozancicek/spark,False,ozancicek,11628913,MDQ6VXNlcjExNjI4OTEz,https://avatars1.githubusercontent.com/u/11628913?v=4,,https://api.github.com/users/ozancicek,https://github.com/ozancicek,https://api.github.com/users/ozancicek/followers,https://api.github.com/users/ozancicek/following{/other_user},https://api.github.com/users/ozancicek/gists{/gist_id},https://api.github.com/users/ozancicek/starred{/owner}{/repo},https://api.github.com/users/ozancicek/subscriptions,https://api.github.com/users/ozancicek/orgs,https://api.github.com/users/ozancicek/repos,https://api.github.com/users/ozancicek/events{/privacy},https://api.github.com/users/ozancicek/received_events,User,False,https://github.com/ozancicek/spark,Apache Spark,True,https://api.github.com/repos/ozancicek/spark,https://api.github.com/repos/ozancicek/spark/forks,https://api.github.com/repos/ozancicek/spark/keys{/key_id},https://api.github.com/repos/ozancicek/spark/collaborators{/collaborator},https://api.github.com/repos/ozancicek/spark/teams,https://api.github.com/repos/ozancicek/spark/hooks,https://api.github.com/repos/ozancicek/spark/issues/events{/number},https://api.github.com/repos/ozancicek/spark/events,https://api.github.com/repos/ozancicek/spark/assignees{/user},https://api.github.com/repos/ozancicek/spark/branches{/branch},https://api.github.com/repos/ozancicek/spark/tags,https://api.github.com/repos/ozancicek/spark/git/blobs{/sha},https://api.github.com/repos/ozancicek/spark/git/tags{/sha},https://api.github.com/repos/ozancicek/spark/git/refs{/sha},https://api.github.com/repos/ozancicek/spark/git/trees{/sha},https://api.github.com/repos/ozancicek/spark/statuses/{sha},https://api.github.com/repos/ozancicek/spark/languages,https://api.github.com/repos/ozancicek/spark/stargazers,https://api.github.com/repos/ozancicek/spark/contributors,https://api.github.com/repos/ozancicek/spark/subscribers,https://api.github.com/repos/ozancicek/spark/subscription,https://api.github.com/repos/ozancicek/spark/commits{/sha},https://api.github.com/repos/ozancicek/spark/git/commits{/sha},https://api.github.com/repos/ozancicek/spark/comments{/number},https://api.github.com/repos/ozancicek/spark/issues/comments{/number},https://api.github.com/repos/ozancicek/spark/contents/{+path},https://api.github.com/repos/ozancicek/spark/compare/{base}...{head},https://api.github.com/repos/ozancicek/spark/merges,https://api.github.com/repos/ozancicek/spark/{archive_format}{/ref},https://api.github.com/repos/ozancicek/spark/downloads,https://api.github.com/repos/ozancicek/spark/issues{/number},https://api.github.com/repos/ozancicek/spark/pulls{/number},https://api.github.com/repos/ozancicek/spark/milestones{/number},"https://api.github.com/repos/ozancicek/spark/notifications{?since,all,participating}",https://api.github.com/repos/ozancicek/spark/labels{/name},https://api.github.com/repos/ozancicek/spark/releases{/id},https://api.github.com/repos/ozancicek/spark/deployments,2019-06-01T04:07:52Z,2019-06-01T04:08:23Z,2020-01-14T22:43:08Z,git://github.com/ozancicek/spark.git,git@github.com:ozancicek/spark.git,https://github.com/ozancicek/spark.git,https://github.com/ozancicek/spark,,320820,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,582509b7ae76bc298c31a68bcfd7011c1b9e23a7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24939,https://github.com/apache/spark/pull/24939,https://api.github.com/repos/apache/spark/issues/24939,https://api.github.com/repos/apache/spark/issues/24939/comments,https://api.github.com/repos/apache/spark/pulls/24939/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24939/commits,https://api.github.com/repos/apache/spark/statuses/c3d97a351a04474a260ff6ae40909f366a8398cf
234,https://api.github.com/repos/apache/spark/pulls/24936,290652331,MDExOlB1bGxSZXF1ZXN0MjkwNjUyMzMx,https://github.com/apache/spark/pull/24936,https://github.com/apache/spark/pull/24936.diff,https://github.com/apache/spark/pull/24936.patch,https://api.github.com/repos/apache/spark/issues/24936,24936,open,False,[SPARK-24634][SS] Add a new metric regarding number of rows later than watermark plus allowed delay,"## What changes were proposed in this pull request?

Please refer https://issues.apache.org/jira/browse/SPARK-24634 to see rationalization of the issue.

This patch adds a new metric to count the number of rows arrived later than watermark plus allowed delay. To count the number of rows correctly, this patch adds a new physical node before stateful operator node(s) which counts the number of input rows later than watermark plus allowed delay. 

Note that it doesn't mean these rows will be always discarded, since there're some cases we don't discard late input rows, e.g. non-window streaming aggregation.

The metric will be exposed to two places:

* streaming query listener - numLateInputRows in stateOperators
* SQL tab in UI - `number of input rows later than watermark plus allowed delay` in CountLateRowsExec

This is a revised version of #21617.

## How was this patch tested?

Modified UT, and ran manual test reproducing [SPARK-28094](https://issues.apache.org/jira/browse/SPARK-28094).

I've picked the specific case on ""B outer C outer D"" which is enough to represent the ""intermediate late row"" issue due to global watermark.

https://gist.github.com/jammann/b58bfbe0f4374b89ecea63c1e32c8f17

Spark logs warning message on the query which means [SPARK-28074](https://issues.apache.org/jira/browse/SPARK-28074) is working correctly,

```
19/10/01 15:38:53 WARN UnsupportedOperationChecker: Detected pattern of possible 'correctness' issue due to global watermark. The query contains stateful operation which can emit rows older than the current watermark plus allowed late record delay, which are ""late rows"" in downstream stateful operations and these rows can be discarded. Please refer the programming guide doc for more details.;
Project [B_ID#58 AS key#166, to_json(named_struct(B_ID, B_ID#58, B_LAST_MOD, B_LAST_MOD#59-T30000ms, C_FK, C_FK#60, D_FK, D_FK#61, C_ID, C_ID#91, C_LAST_MOD, C_LAST_MOD#92-T30000ms, D_ID, D_ID#120, D_LAST_MOD, D_LAST_MOD#121-T30000ms), Some(UTC)) AS value#167]
+- Join LeftOuter, ((D_FK#61 = D_ID#120) AND (B_LAST_MOD#59-T30000ms = D_LAST_MOD#121-T30000ms))
   :- Join LeftOuter, ((C_FK#60 = C_ID#91) AND (B_LAST_MOD#59-T30000ms = C_LAST_MOD#92-T30000ms))
   :  :- EventTimeWatermark B_LAST_MOD#59: timestamp, interval 30 seconds
   :  :  +- Project [v#56.B_ID AS B_ID#58, v#56.B_LAST_MOD AS B_LAST_MOD#59, v#56.C_FK AS C_FK#60, v#56.D_FK AS D_FK#61]
   :  :     +- Project [from_json(StructField(B_ID,StringType,false), StructField(B_LAST_MOD,TimestampType,false), StructField(C_FK,StringType,true), StructField(D_FK,StringType,true), value#54, Some(UTC)) AS v#56]
   :  :        +- Project [cast(value#41 as string) AS value#54]
   :  :           +- StreamingRelationV2 org.apache.spark.sql.kafka010.KafkaSourceProvider@5b3848b3, kafka, org.apache.spark.sql.kafka010.KafkaSourceProvider$KafkaTable@63c5a407, org.apache.spark.sql.util.CaseInsensitiveStringMap@f2c4a44e, [key#40, value#41, topic#42, partition#43, offset#44L, timestamp#45, timestampType#46], StreamingRelation DataSource(org.apache.spark.sql.SparkSession@69a2d6bd,kafka,List(),None,List(),None,Map(inferSchema -> true, startingOffsets -> latest, subscribe -> B, kafka.bootstrap.servers -> localhost:9092),None), kafka, [key#33, value#34, topic#35, partition#36, offset#37L, timestamp#38, timestampType#39]
   :  +- EventTimeWatermark C_LAST_MOD#92: timestamp, interval 30 seconds
   :     +- Project [v#89.C_ID AS C_ID#91, v#89.C_LAST_MOD AS C_LAST_MOD#92]
   :        +- Project [from_json(StructField(C_ID,StringType,false), StructField(C_LAST_MOD,TimestampType,false), value#87, Some(UTC)) AS v#89]
   :           +- Project [cast(value#74 as string) AS value#87]
   :              +- StreamingRelationV2 org.apache.spark.sql.kafka010.KafkaSourceProvider@79573aa5, kafka, org.apache.spark.sql.kafka010.KafkaSourceProvider$KafkaTable@6bf1c0c, org.apache.spark.sql.util.CaseInsensitiveStringMap@f2c4a44f, [key#73, value#74, topic#75, partition#76, offset#77L, timestamp#78, timestampType#79], StreamingRelation DataSource(org.apache.spark.sql.SparkSession@69a2d6bd,kafka,List(),None,List(),None,Map(inferSchema -> true, startingOffsets -> latest, subscribe -> C, kafka.bootstrap.servers -> localhost:9092),None), kafka, [key#66, value#67, topic#68, partition#69, offset#70L, timestamp#71, timestampType#72]
   +- EventTimeWatermark D_LAST_MOD#121: timestamp, interval 30 seconds
      +- Project [v#118.D_ID AS D_ID#120, v#118.D_LAST_MOD AS D_LAST_MOD#121]
         +- Project [from_json(StructField(D_ID,StringType,false), StructField(D_LAST_MOD,TimestampType,false), value#116, Some(UTC)) AS v#118]
            +- Project [cast(value#103 as string) AS value#116]
               +- StreamingRelationV2 org.apache.spark.sql.kafka010.KafkaSourceProvider@6fa59acf, kafka, org.apache.spark.sql.kafka010.KafkaSourceProvider$KafkaTable@3aa208b7, org.apache.spark.sql.util.CaseInsensitiveStringMap@f2c4a454, [key#102, value#103, topic#104, partition#105, offset#106L, timestamp#107, timestampType#108], StreamingRelation DataSource(org.apache.spark.sql.SparkSession@69a2d6bd,kafka,List(),None,List(),None,Map(inferSchema -> true, startingOffsets -> latest, subscribe -> D, kafka.bootstrap.servers -> localhost:9092),None), kafka, [key#95, value#96, topic#97, partition#98, offset#99L, timestamp#100, timestampType#101]
```

and query plan represents CountLateRows with the number of late rows. Empty batch runs for batch 4 as follows:

![Screen Shot 2019-10-01 at 4 47 21 PM](https://user-images.githubusercontent.com/1317309/65944035-cd639580-e46b-11e9-83e0-bf8574cc6b8b.png)

The boxed node in the detail page for batch 4 represents there're 4 rows emitted from left side of join (B inner C) which rows are all later than watermark + allowed delay.

![Screen Shot 2019-10-01 at 16 50 06](https://user-images.githubusercontent.com/1317309/65944094-ec622780-e46b-11e9-9248-c821342722af.png)

The number of late rows are also reported as streaming query listener as follow (check `numLateInputRows`):

```
{
  ""id"" : ""7c5d10b5-1ae0-4a25-8b2b-f8b8eb4a4b6b"",
  ""runId"" : ""1f7375af-63b0-4272-9b87-4e59928d04d8"",
  ""name"" : ""B_outer_C_outer_D"",
  ""timestamp"" : ""2019-10-01T07:43:40.001Z"",
  ""batchId"" : 4,
  ""numInputRows"" : 0,
  ""inputRowsPerSecond"" : 0.0,
  ""processedRowsPerSecond"" : 0.0,
  ""durationMs"" : {
    ""addBatch"" : 1034,
    ""getBatch"" : 0,
    ""latestOffset"" : 14,
    ""queryPlanning"" : 459,
    ""triggerExecution"" : 1714,
    ""walCommit"" : 113
  },
  ""eventTime"" : {
    ""watermark"" : ""2019-06-01T18:36:58.769Z""
  },
  ""stateOperators"" : [ {
    ""numRowsTotal"" : 2,
    ""numRowsUpdated"" : 0,
    ""numLateInputRows"" : 4,
    ""memoryUsedBytes"" : 3710,
    ""customMetrics"" : {
      ""loadedMapCacheHitCount"" : 8,
      ""loadedMapCacheMissCount"" : 0,
      ""stateOnCurrentVersionSizeBytes"" : 702
    }
  }, {
    ""numRowsTotal"" : 5,
    ""numRowsUpdated"" : 0,
    ""numLateInputRows"" : 0,
    ""memoryUsedBytes"" : 7453,
    ""customMetrics"" : {
      ""loadedMapCacheHitCount"" : 8,
      ""loadedMapCacheMissCount"" : 0,
      ""stateOnCurrentVersionSizeBytes"" : 1485
    }
  } ],
  ""sources"" : [ {
    ""description"" : ""KafkaV2[Subscribe[B]]"",
    ""startOffset"" : {
      ""B"" : {
        ""2"" : 10,
        ""4"" : 10,
        ""1"" : 10,
        ""3"" : 10,
        ""0"" : 10
      }
    },
    ""endOffset"" : {
      ""B"" : {
        ""2"" : 10,
        ""4"" : 10,
        ""1"" : 10,
        ""3"" : 10,
        ""0"" : 10
      }
    },
    ""numInputRows"" : 0,
    ""inputRowsPerSecond"" : 0.0,
    ""processedRowsPerSecond"" : 0.0
  }, {
    ""description"" : ""KafkaV2[Subscribe[C]]"",
    ""startOffset"" : {
      ""C"" : {
        ""2"" : 3,
        ""4"" : 3,
        ""1"" : 2,
        ""3"" : 3,
        ""0"" : 4
      }
    },
    ""endOffset"" : {
      ""C"" : {
        ""2"" : 3,
        ""4"" : 3,
        ""1"" : 2,
        ""3"" : 3,
        ""0"" : 4
      }
    },
    ""numInputRows"" : 0,
    ""inputRowsPerSecond"" : 0.0,
    ""processedRowsPerSecond"" : 0.0
  }, {
    ""description"" : ""KafkaV2[Subscribe[D]]"",
    ""startOffset"" : {
      ""D"" : {
        ""2"" : 0,
        ""4"" : 2,
        ""1"" : 2,
        ""3"" : 1,
        ""0"" : 0
      }
    },
    ""endOffset"" : {
      ""D"" : {
        ""2"" : 0,
        ""4"" : 2,
        ""1"" : 2,
        ""3"" : 1,
        ""0"" : 0
      }
    },
    ""numInputRows"" : 0,
    ""inputRowsPerSecond"" : 0.0,
    ""processedRowsPerSecond"" : 0.0
  } ],
  ""sink"" : {
    ""description"" : ""org.apache.spark.sql.kafka010.KafkaSourceProvider$KafkaTable@11edae5f"",
    ""numOutputRows"" : 2
  }
}
```",2019-06-21T15:26:51Z,2020-03-30T03:38:07Z,,,83829884a986147b4b87fdfc7f2c958624617a2b,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24936/commits,https://api.github.com/repos/apache/spark/pulls/24936/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24936/comments,https://api.github.com/repos/apache/spark/statuses/71bdb2a64cc061a0c8b004fef1e7c9d0c6c88018,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-24634-v2,SPARK-24634-v2,71bdb2a64cc061a0c8b004fef1e7c9d0c6c88018,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,60dd1a690fed62b1d6442cdc8cf3f89ef4304d5a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24936,https://github.com/apache/spark/pull/24936,https://api.github.com/repos/apache/spark/issues/24936,https://api.github.com/repos/apache/spark/issues/24936/comments,https://api.github.com/repos/apache/spark/pulls/24936/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24936/commits,https://api.github.com/repos/apache/spark/statuses/71bdb2a64cc061a0c8b004fef1e7c9d0c6c88018
235,https://api.github.com/repos/apache/spark/pulls/24801,285198292,MDExOlB1bGxSZXF1ZXN0Mjg1MTk4Mjky,https://github.com/apache/spark/pull/24801,https://github.com/apache/spark/pull/24801.diff,https://github.com/apache/spark/pull/24801.patch,https://api.github.com/repos/apache/spark/issues/24801,24801,open,False,[SPARK-27950][DSTREAMS][Kinesis] dynamoDBEndpointUrl and cloudWatchMetricsLevel for Kinesis,"## What changes were proposed in this pull request?

I was researching getting Spark’s Kinesis integration running locally against `localstack`. We found this issue, and it creates a complication: https://github.com/localstack/localstack/issues/677

Effectively, we need to be able to redirect calls for Kinesis, DynamoDB and Cloudwatch in order for the KCL to properly use the `localstack` infrastructure. We have successfully done this with the KCL (both 1.x and 2.x), but with Spark’s integration we are unable to configure DynamoDB and Cloudwatch’s endpoints:

https://github.com/apache/spark/blob/master/external/kinesis-asl/src/main/scala/org/apache/spark/streaming/kinesis/KinesisReceiver.scala#L162

This PR adds optional configuration values to the interfaces for dynamoDBEndpointUrl and cloudWatchMetricsLevel. 

Why cloudWatchMetricsLevel instead of cloudWatchEndpointUrl? Because the 1.x version of the KCL does not expose a means of configuring the cloudWatchEndpointUrl. Localstack users can instead disable metrics entirely by setting the cloudWatchMetricsLevel to Some(MetricsLevel.NONE)

## How was this patch tested?

Existing unit tests were expanded to check that these values were set.

Please review https://spark.apache.org/contributing.html before opening a pull request.
",2019-06-05T01:30:50Z,2020-03-14T02:50:05Z,,,a50be06a4d14aa785a924be50feb0ee62c7dfef7,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24801/commits,https://api.github.com/repos/apache/spark/pulls/24801/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24801/comments,https://api.github.com/repos/apache/spark/statuses/a42ce6e5245abe820977f9a1830c82927f310490,CONTRIBUTOR,spark,apache,etspaceman,630953,MDQ6VXNlcjYzMDk1Mw==,https://avatars1.githubusercontent.com/u/630953?v=4,,https://api.github.com/users/etspaceman,https://github.com/etspaceman,https://api.github.com/users/etspaceman/followers,https://api.github.com/users/etspaceman/following{/other_user},https://api.github.com/users/etspaceman/gists{/gist_id},https://api.github.com/users/etspaceman/starred{/owner}{/repo},https://api.github.com/users/etspaceman/subscriptions,https://api.github.com/users/etspaceman/orgs,https://api.github.com/users/etspaceman/repos,https://api.github.com/users/etspaceman/events{/privacy},https://api.github.com/users/etspaceman/received_events,User,False,etspaceman:kclEndpoints,kclEndpoints,a42ce6e5245abe820977f9a1830c82927f310490,etspaceman,630953,MDQ6VXNlcjYzMDk1Mw==,https://avatars1.githubusercontent.com/u/630953?v=4,,https://api.github.com/users/etspaceman,https://github.com/etspaceman,https://api.github.com/users/etspaceman/followers,https://api.github.com/users/etspaceman/following{/other_user},https://api.github.com/users/etspaceman/gists{/gist_id},https://api.github.com/users/etspaceman/starred{/owner}{/repo},https://api.github.com/users/etspaceman/subscriptions,https://api.github.com/users/etspaceman/orgs,https://api.github.com/users/etspaceman/repos,https://api.github.com/users/etspaceman/events{/privacy},https://api.github.com/users/etspaceman/received_events,User,False,190299449,MDEwOlJlcG9zaXRvcnkxOTAyOTk0NDk=,spark,etspaceman/spark,False,etspaceman,630953,MDQ6VXNlcjYzMDk1Mw==,https://avatars1.githubusercontent.com/u/630953?v=4,,https://api.github.com/users/etspaceman,https://github.com/etspaceman,https://api.github.com/users/etspaceman/followers,https://api.github.com/users/etspaceman/following{/other_user},https://api.github.com/users/etspaceman/gists{/gist_id},https://api.github.com/users/etspaceman/starred{/owner}{/repo},https://api.github.com/users/etspaceman/subscriptions,https://api.github.com/users/etspaceman/orgs,https://api.github.com/users/etspaceman/repos,https://api.github.com/users/etspaceman/events{/privacy},https://api.github.com/users/etspaceman/received_events,User,False,https://github.com/etspaceman/spark,Apache Spark,True,https://api.github.com/repos/etspaceman/spark,https://api.github.com/repos/etspaceman/spark/forks,https://api.github.com/repos/etspaceman/spark/keys{/key_id},https://api.github.com/repos/etspaceman/spark/collaborators{/collaborator},https://api.github.com/repos/etspaceman/spark/teams,https://api.github.com/repos/etspaceman/spark/hooks,https://api.github.com/repos/etspaceman/spark/issues/events{/number},https://api.github.com/repos/etspaceman/spark/events,https://api.github.com/repos/etspaceman/spark/assignees{/user},https://api.github.com/repos/etspaceman/spark/branches{/branch},https://api.github.com/repos/etspaceman/spark/tags,https://api.github.com/repos/etspaceman/spark/git/blobs{/sha},https://api.github.com/repos/etspaceman/spark/git/tags{/sha},https://api.github.com/repos/etspaceman/spark/git/refs{/sha},https://api.github.com/repos/etspaceman/spark/git/trees{/sha},https://api.github.com/repos/etspaceman/spark/statuses/{sha},https://api.github.com/repos/etspaceman/spark/languages,https://api.github.com/repos/etspaceman/spark/stargazers,https://api.github.com/repos/etspaceman/spark/contributors,https://api.github.com/repos/etspaceman/spark/subscribers,https://api.github.com/repos/etspaceman/spark/subscription,https://api.github.com/repos/etspaceman/spark/commits{/sha},https://api.github.com/repos/etspaceman/spark/git/commits{/sha},https://api.github.com/repos/etspaceman/spark/comments{/number},https://api.github.com/repos/etspaceman/spark/issues/comments{/number},https://api.github.com/repos/etspaceman/spark/contents/{+path},https://api.github.com/repos/etspaceman/spark/compare/{base}...{head},https://api.github.com/repos/etspaceman/spark/merges,https://api.github.com/repos/etspaceman/spark/{archive_format}{/ref},https://api.github.com/repos/etspaceman/spark/downloads,https://api.github.com/repos/etspaceman/spark/issues{/number},https://api.github.com/repos/etspaceman/spark/pulls{/number},https://api.github.com/repos/etspaceman/spark/milestones{/number},"https://api.github.com/repos/etspaceman/spark/notifications{?since,all,participating}",https://api.github.com/repos/etspaceman/spark/labels{/name},https://api.github.com/repos/etspaceman/spark/releases{/id},https://api.github.com/repos/etspaceman/spark/deployments,2019-06-05T00:35:56Z,2019-10-31T00:47:05Z,2019-11-01T13:33:28Z,git://github.com/etspaceman/spark.git,git@github.com:etspaceman/spark.git,https://github.com/etspaceman/spark.git,https://github.com/etspaceman/spark,,314451,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ac808e2a02d67ed6210986704b84c8079791b123,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24801,https://github.com/apache/spark/pull/24801,https://api.github.com/repos/apache/spark/issues/24801,https://api.github.com/repos/apache/spark/issues/24801/comments,https://api.github.com/repos/apache/spark/pulls/24801/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24801/commits,https://api.github.com/repos/apache/spark/statuses/a42ce6e5245abe820977f9a1830c82927f310490
236,https://api.github.com/repos/apache/spark/pulls/24618,279281195,MDExOlB1bGxSZXF1ZXN0Mjc5MjgxMTk1,https://github.com/apache/spark/pull/24618,https://github.com/apache/spark/pull/24618.diff,https://github.com/apache/spark/pull/24618.patch,https://api.github.com/repos/apache/spark/issues/24618,24618,open,False,[SPARK-27734][CORE][SQL] Add memory based thresholds for shuffle spill,"## What changes were proposed in this pull request?

When running large shuffles (700TB input data, 200k map tasks, 50k reducers on a 300 nodes cluster) the job is regularly OOMing in map and reduce phase.

IIUC ShuffleExternalSorter (map side) and ExternalAppendOnlyMap and ExternalSorter (reduce side) are trying to max out the available execution memory. This in turn doesn't play nice with the Garbage Collector and executors are failing with OutOfMemoryError when the memory allocation from these in-memory structure is maxing out the available heap size (in our case we are running with 9 cores/executor, 32G per executor)

To mitigate this, one can set `spark.shuffle.spill.numElementsForceSpillThreshold` to force the spill on disk. While this config works, it is not flexible enough as it's expressed in number of elements, and in our case we run multiple shuffles in a single job and element size is different from one stage to another.


This patch extends the spill threshold behaviour and adds two new parameters to control the spill based on memory usage:

- `spark.shuffle.spill.map.maxRecordsSizeForSpillThreshold`
- `spark.shuffle.spill.reduce.maxRecordsSizeForSpillThreshold`


## How was this patch tested?

- internal e2e testing using large jobs
First, in our case for heavy RDD heavy shuffle jobs without setting the existing records based spill threshold (`spark.shuffle.spill.numElementsForceSpillThreshold`) the job in unstable and fails consistently with OOME in executors.
Trying to find the right value for `numElementsForceSpillThreshold` proved to be impossible.
Trying to maximize the job throughput (e.g. memory usage) while ensuring stability rendered to us an unbalanced usage across multiple stages of the job (in memory cached ""elements"" vary in size on map and reduce side combined with multiple map-reduce shuffles where ""elements"" are different)
Overall the best we could get in terms of memory usage is depicted in this snapshot:
![image](https://user-images.githubusercontent.com/728853/74935425-e526c080-53f0-11ea-8a2a-54c99ec2cef9.png)

Working from here, and using `spark.shuffle.spill.map.maxRecordsSizeForSpillThreshold` (map side, size-based spill) and `spark.shuffle.spill.numElementsForceSpillThreshold` (reduce side, size-based spill) we could maximize the memory usage (and in turn job runtime) while still keeping the job stable:
![image](https://user-images.githubusercontent.com/728853/74935955-e2789b00-53f1-11ea-9c6f-5e7025bdf468.png)




- Running existing unit-tests

",2019-05-15T22:07:54Z,2020-04-07T09:43:11Z,,,452877b9cb4dff60a3f103aa343182824e6dd35b,,[],[],[],"[{'id': 1405801482, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDgy', 'url': 'https://api.github.com/repos/apache/spark/labels/SPARK%20CORE', 'name': 'SPARK CORE', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24618/commits,https://api.github.com/repos/apache/spark/pulls/24618/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24618/comments,https://api.github.com/repos/apache/spark/statuses/ab410fc48a039f161693ea81f8d15dbd3041d57f,CONTRIBUTOR,spark,apache,amuraru,728853,MDQ6VXNlcjcyODg1Mw==,https://avatars1.githubusercontent.com/u/728853?v=4,,https://api.github.com/users/amuraru,https://github.com/amuraru,https://api.github.com/users/amuraru/followers,https://api.github.com/users/amuraru/following{/other_user},https://api.github.com/users/amuraru/gists{/gist_id},https://api.github.com/users/amuraru/starred{/owner}{/repo},https://api.github.com/users/amuraru/subscriptions,https://api.github.com/users/amuraru/orgs,https://api.github.com/users/amuraru/repos,https://api.github.com/users/amuraru/events{/privacy},https://api.github.com/users/amuraru/received_events,User,False,amuraru:size_based_spill,size_based_spill,ab410fc48a039f161693ea81f8d15dbd3041d57f,amuraru,728853,MDQ6VXNlcjcyODg1Mw==,https://avatars1.githubusercontent.com/u/728853?v=4,,https://api.github.com/users/amuraru,https://github.com/amuraru,https://api.github.com/users/amuraru/followers,https://api.github.com/users/amuraru/following{/other_user},https://api.github.com/users/amuraru/gists{/gist_id},https://api.github.com/users/amuraru/starred{/owner}{/repo},https://api.github.com/users/amuraru/subscriptions,https://api.github.com/users/amuraru/orgs,https://api.github.com/users/amuraru/repos,https://api.github.com/users/amuraru/events{/privacy},https://api.github.com/users/amuraru/received_events,User,False,184336912,MDEwOlJlcG9zaXRvcnkxODQzMzY5MTI=,spark,amuraru/spark,False,amuraru,728853,MDQ6VXNlcjcyODg1Mw==,https://avatars1.githubusercontent.com/u/728853?v=4,,https://api.github.com/users/amuraru,https://github.com/amuraru,https://api.github.com/users/amuraru/followers,https://api.github.com/users/amuraru/following{/other_user},https://api.github.com/users/amuraru/gists{/gist_id},https://api.github.com/users/amuraru/starred{/owner}{/repo},https://api.github.com/users/amuraru/subscriptions,https://api.github.com/users/amuraru/orgs,https://api.github.com/users/amuraru/repos,https://api.github.com/users/amuraru/events{/privacy},https://api.github.com/users/amuraru/received_events,User,False,https://github.com/amuraru/spark,Apache Spark,True,https://api.github.com/repos/amuraru/spark,https://api.github.com/repos/amuraru/spark/forks,https://api.github.com/repos/amuraru/spark/keys{/key_id},https://api.github.com/repos/amuraru/spark/collaborators{/collaborator},https://api.github.com/repos/amuraru/spark/teams,https://api.github.com/repos/amuraru/spark/hooks,https://api.github.com/repos/amuraru/spark/issues/events{/number},https://api.github.com/repos/amuraru/spark/events,https://api.github.com/repos/amuraru/spark/assignees{/user},https://api.github.com/repos/amuraru/spark/branches{/branch},https://api.github.com/repos/amuraru/spark/tags,https://api.github.com/repos/amuraru/spark/git/blobs{/sha},https://api.github.com/repos/amuraru/spark/git/tags{/sha},https://api.github.com/repos/amuraru/spark/git/refs{/sha},https://api.github.com/repos/amuraru/spark/git/trees{/sha},https://api.github.com/repos/amuraru/spark/statuses/{sha},https://api.github.com/repos/amuraru/spark/languages,https://api.github.com/repos/amuraru/spark/stargazers,https://api.github.com/repos/amuraru/spark/contributors,https://api.github.com/repos/amuraru/spark/subscribers,https://api.github.com/repos/amuraru/spark/subscription,https://api.github.com/repos/amuraru/spark/commits{/sha},https://api.github.com/repos/amuraru/spark/git/commits{/sha},https://api.github.com/repos/amuraru/spark/comments{/number},https://api.github.com/repos/amuraru/spark/issues/comments{/number},https://api.github.com/repos/amuraru/spark/contents/{+path},https://api.github.com/repos/amuraru/spark/compare/{base}...{head},https://api.github.com/repos/amuraru/spark/merges,https://api.github.com/repos/amuraru/spark/{archive_format}{/ref},https://api.github.com/repos/amuraru/spark/downloads,https://api.github.com/repos/amuraru/spark/issues{/number},https://api.github.com/repos/amuraru/spark/pulls{/number},https://api.github.com/repos/amuraru/spark/milestones{/number},"https://api.github.com/repos/amuraru/spark/notifications{?since,all,participating}",https://api.github.com/repos/amuraru/spark/labels{/name},https://api.github.com/repos/amuraru/spark/releases{/id},https://api.github.com/repos/amuraru/spark/deployments,2019-04-30T21:56:40Z,2019-05-15T22:03:39Z,2020-02-17T21:12:24Z,git://github.com/amuraru/spark.git,git@github.com:amuraru/spark.git,https://github.com/amuraru/spark.git,https://github.com/amuraru/spark,,319270,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2854091d12d670b014c41713e72153856f4d3f6a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24618,https://github.com/apache/spark/pull/24618,https://api.github.com/repos/apache/spark/issues/24618,https://api.github.com/repos/apache/spark/issues/24618/comments,https://api.github.com/repos/apache/spark/pulls/24618/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24618/commits,https://api.github.com/repos/apache/spark/statuses/ab410fc48a039f161693ea81f8d15dbd3041d57f
237,https://api.github.com/repos/apache/spark/pulls/24601,278625555,MDExOlB1bGxSZXF1ZXN0Mjc4NjI1NTU1,https://github.com/apache/spark/pull/24601,https://github.com/apache/spark/pull/24601.diff,https://github.com/apache/spark/pull/24601.patch,https://api.github.com/repos/apache/spark/issues/24601,24601,open,False,[SPARK-27702][K8S] Allow using some alternatives for service accounts,"## What changes were proposed in this pull request?
To allow alternatives to serviceaccounts

### Why are the changes needed?
Although we provide some authentication configuration, such as spark.kubernetes.authenticate.driver.mounted.oauthTokenFile, spark.kubernetes.authenticate.driver.mounted.caCertFile, etc. 
But there is a bug as we forced the service account so when we use one of them, driver still use the KUBERNETES_SERVICE_ACCOUNT_TOKEN_PATH file, and the error look like bellow:

the KUBERNETES_SERVICE_ACCOUNT_TOKEN_PATH serviceAccount not exists

### Does this PR introduce any user-facing change?
Yes user can now use `spark.kubernetes.authenticate.driver.mounted.caCertFile`
or token file by `spark.kubernetes.authenticate.driver.mounted.oauthTokenFile` 

## How was this patch tested?
Manually passed the certificates using `spark.kubernetes.authenticate.driver.mounted.caCertFile`
or token file by `spark.kubernetes.authenticate.driver.mounted.oauthTokenFile` if there is no default service account available.",2019-05-14T10:48:21Z,2020-03-12T12:27:33Z,,,271acdfae91a03c7705d325dfb7c6d98ad05aed4,,[],[],[],"[{'id': 1406605057, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MDU3', 'url': 'https://api.github.com/repos/apache/spark/labels/KUBERNETES', 'name': 'KUBERNETES', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24601/commits,https://api.github.com/repos/apache/spark/pulls/24601/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24601/comments,https://api.github.com/repos/apache/spark/statuses/3c9e2d82664aa0bd43b31977e65cacc385de6992,CONTRIBUTOR,spark,apache,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,Udbhav30:serviceaccount,serviceaccount,3c9e2d82664aa0bd43b31977e65cacc385de6992,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,155533105,MDEwOlJlcG9zaXRvcnkxNTU1MzMxMDU=,spark,Udbhav30/spark,False,Udbhav30,44489863,MDQ6VXNlcjQ0NDg5ODYz,https://avatars2.githubusercontent.com/u/44489863?v=4,,https://api.github.com/users/Udbhav30,https://github.com/Udbhav30,https://api.github.com/users/Udbhav30/followers,https://api.github.com/users/Udbhav30/following{/other_user},https://api.github.com/users/Udbhav30/gists{/gist_id},https://api.github.com/users/Udbhav30/starred{/owner}{/repo},https://api.github.com/users/Udbhav30/subscriptions,https://api.github.com/users/Udbhav30/orgs,https://api.github.com/users/Udbhav30/repos,https://api.github.com/users/Udbhav30/events{/privacy},https://api.github.com/users/Udbhav30/received_events,User,False,https://github.com/Udbhav30/spark,Mirror of Apache Spark,True,https://api.github.com/repos/Udbhav30/spark,https://api.github.com/repos/Udbhav30/spark/forks,https://api.github.com/repos/Udbhav30/spark/keys{/key_id},https://api.github.com/repos/Udbhav30/spark/collaborators{/collaborator},https://api.github.com/repos/Udbhav30/spark/teams,https://api.github.com/repos/Udbhav30/spark/hooks,https://api.github.com/repos/Udbhav30/spark/issues/events{/number},https://api.github.com/repos/Udbhav30/spark/events,https://api.github.com/repos/Udbhav30/spark/assignees{/user},https://api.github.com/repos/Udbhav30/spark/branches{/branch},https://api.github.com/repos/Udbhav30/spark/tags,https://api.github.com/repos/Udbhav30/spark/git/blobs{/sha},https://api.github.com/repos/Udbhav30/spark/git/tags{/sha},https://api.github.com/repos/Udbhav30/spark/git/refs{/sha},https://api.github.com/repos/Udbhav30/spark/git/trees{/sha},https://api.github.com/repos/Udbhav30/spark/statuses/{sha},https://api.github.com/repos/Udbhav30/spark/languages,https://api.github.com/repos/Udbhav30/spark/stargazers,https://api.github.com/repos/Udbhav30/spark/contributors,https://api.github.com/repos/Udbhav30/spark/subscribers,https://api.github.com/repos/Udbhav30/spark/subscription,https://api.github.com/repos/Udbhav30/spark/commits{/sha},https://api.github.com/repos/Udbhav30/spark/git/commits{/sha},https://api.github.com/repos/Udbhav30/spark/comments{/number},https://api.github.com/repos/Udbhav30/spark/issues/comments{/number},https://api.github.com/repos/Udbhav30/spark/contents/{+path},https://api.github.com/repos/Udbhav30/spark/compare/{base}...{head},https://api.github.com/repos/Udbhav30/spark/merges,https://api.github.com/repos/Udbhav30/spark/{archive_format}{/ref},https://api.github.com/repos/Udbhav30/spark/downloads,https://api.github.com/repos/Udbhav30/spark/issues{/number},https://api.github.com/repos/Udbhav30/spark/pulls{/number},https://api.github.com/repos/Udbhav30/spark/milestones{/number},"https://api.github.com/repos/Udbhav30/spark/notifications{?since,all,participating}",https://api.github.com/repos/Udbhav30/spark/labels{/name},https://api.github.com/repos/Udbhav30/spark/releases{/id},https://api.github.com/repos/Udbhav30/spark/deployments,2018-10-31T09:42:39Z,2019-08-12T13:11:57Z,2020-03-20T10:48:00Z,git://github.com/Udbhav30/spark.git,git@github.com:Udbhav30/spark.git,https://github.com/Udbhav30/spark.git,https://github.com/Udbhav30/spark,,321089,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ab048990e0bdffe16de6a6b9211f63933976651e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24601,https://github.com/apache/spark/pull/24601,https://api.github.com/repos/apache/spark/issues/24601,https://api.github.com/repos/apache/spark/issues/24601/comments,https://api.github.com/repos/apache/spark/pulls/24601/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24601/commits,https://api.github.com/repos/apache/spark/statuses/3c9e2d82664aa0bd43b31977e65cacc385de6992
238,https://api.github.com/repos/apache/spark/pulls/24553,276877553,MDExOlB1bGxSZXF1ZXN0Mjc2ODc3NTUz,https://github.com/apache/spark/pull/24553,https://github.com/apache/spark/pull/24553.diff,https://github.com/apache/spark/pull/24553.patch,https://api.github.com/repos/apache/spark/issues/24553,24553,open,False,[SPARK-27604][SQL] Enhance constant propagation,"## What changes were proposed in this pull request?

This PR improves `ConstantPropagation` rule, the new implementation:
- Collects constants into a map directly, instead of a list that is then transformed into a map.
- Supports substituting in conflicting equalities:
  e.g. `a = 1 AND a = 2` => `a = 1 AND 1 = 2`
  Before this PR this unsatisfiable filter was not reduced:
  ```
  == Physical Plan ==
  *(1) Project [value#219 AS a#222]
  +- *(1) Filter ((isnotnull(value#219) AND (value#219 = 1)) AND (value#219 = 2))
     +- *(1) LocalTableScan [value#219]
  ```
  But after this PR it is:
  ```
  == Physical Plan ==
  LocalTableScan <empty>, [a#222]
  ```
- Extends propagation from attribute => constant mapping to deterministic expression => constant mapping:
  e.g. `abs(a) = 5 AND b = abs(a) + 3` => `abs(a) = 5 AND b = 8`
- Allows substitution in other than `EqualTo` and `EqualNullSafe` expressions:
  e.g. `a = 5 AND b < a + 3` => `a = 5 AND b < 8`
- Allows propagation of constant non-nullable expressions in `Project` and other nodes (except for `Join`):
  e.g. `SELECT a = 5 AND b = a + 3` => `SELECT a = 5 AND b = 8`
  Before this PR only `Filter` was supported.
- Allows deep constant propagation:
  e.g. `... WHERE IF(..., a = 5 AND b = a + 3, ...)` => `... WHERE IF(..., a = 5 AND b = 8, ...)`
  Before this PR only top level `And`/`Or`/`Not` nodes were supported.
- During expression tree traversal tracks a boolean context that controls if constant propagation of a nullable expression can be safely applied. 
  - E.g. in the case of `... WHERE a = c AND f(a)` or `IF(a = c AND f(a), ..., ...)` where `a` is a nullable expression and `c` is a constant the `null` result of `a = c AND f(a)` means the same as if it resulted `false` therefore constant propagation can be safely applied (`a = c AND f(a)` => `a = c AND f(c)`).
  - In the case of `SELECT a = c AND f(a)` the `null` result really means `null`. In this context constant propagation can't be applied safely.
  - There is also a 3rd context due to an enclosing `Not` in which the context flips. E.g. constant propagation can't be applied on `WHERE NOT(a = c AND f(a))` but can be again on `WHERE NOT(IF(..., NOT(a = c AND f(a)), ...)`.

## Why are the changes needed?
Improve performance.

## Does this PR introduce any user-facing change?
No.

## How was this patch tested?
New UTs.
",2019-05-08T07:02:25Z,2020-02-13T15:53:08Z,,,ae4691c683cf71abe89c9327a408a81e966c9097,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24553/commits,https://api.github.com/repos/apache/spark/pulls/24553/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24553/comments,https://api.github.com/repos/apache/spark/statuses/6d994abcf76b6ee48e8d6dd635a894b931bf8725,CONTRIBUTOR,spark,apache,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,peter-toth:SPARK-27604-enhanced-constant-propagation,SPARK-27604-enhanced-constant-propagation,6d994abcf76b6ee48e8d6dd635a894b931bf8725,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,130546049,MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=,spark,peter-toth/spark,False,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,https://github.com/peter-toth/spark,Mirror of Apache Spark,True,https://api.github.com/repos/peter-toth/spark,https://api.github.com/repos/peter-toth/spark/forks,https://api.github.com/repos/peter-toth/spark/keys{/key_id},https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator},https://api.github.com/repos/peter-toth/spark/teams,https://api.github.com/repos/peter-toth/spark/hooks,https://api.github.com/repos/peter-toth/spark/issues/events{/number},https://api.github.com/repos/peter-toth/spark/events,https://api.github.com/repos/peter-toth/spark/assignees{/user},https://api.github.com/repos/peter-toth/spark/branches{/branch},https://api.github.com/repos/peter-toth/spark/tags,https://api.github.com/repos/peter-toth/spark/git/blobs{/sha},https://api.github.com/repos/peter-toth/spark/git/tags{/sha},https://api.github.com/repos/peter-toth/spark/git/refs{/sha},https://api.github.com/repos/peter-toth/spark/git/trees{/sha},https://api.github.com/repos/peter-toth/spark/statuses/{sha},https://api.github.com/repos/peter-toth/spark/languages,https://api.github.com/repos/peter-toth/spark/stargazers,https://api.github.com/repos/peter-toth/spark/contributors,https://api.github.com/repos/peter-toth/spark/subscribers,https://api.github.com/repos/peter-toth/spark/subscription,https://api.github.com/repos/peter-toth/spark/commits{/sha},https://api.github.com/repos/peter-toth/spark/git/commits{/sha},https://api.github.com/repos/peter-toth/spark/comments{/number},https://api.github.com/repos/peter-toth/spark/issues/comments{/number},https://api.github.com/repos/peter-toth/spark/contents/{+path},https://api.github.com/repos/peter-toth/spark/compare/{base}...{head},https://api.github.com/repos/peter-toth/spark/merges,https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref},https://api.github.com/repos/peter-toth/spark/downloads,https://api.github.com/repos/peter-toth/spark/issues{/number},https://api.github.com/repos/peter-toth/spark/pulls{/number},https://api.github.com/repos/peter-toth/spark/milestones{/number},"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}",https://api.github.com/repos/peter-toth/spark/labels{/name},https://api.github.com/repos/peter-toth/spark/releases{/id},https://api.github.com/repos/peter-toth/spark/deployments,2018-04-22T07:43:37Z,2018-04-22T07:44:03Z,2020-03-31T12:39:44Z,git://github.com/peter-toth/spark.git,git@github.com:peter-toth/spark.git,https://github.com/peter-toth/spark.git,https://github.com/peter-toth/spark,,330225,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,21bc0474bbb16c7648aed40f25a2945d98d2a167,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24553,https://github.com/apache/spark/pull/24553,https://api.github.com/repos/apache/spark/issues/24553,https://api.github.com/repos/apache/spark/issues/24553/comments,https://api.github.com/repos/apache/spark/pulls/24553/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24553/commits,https://api.github.com/repos/apache/spark/statuses/6d994abcf76b6ee48e8d6dd635a894b931bf8725
239,https://api.github.com/repos/apache/spark/pulls/24525,275968579,MDExOlB1bGxSZXF1ZXN0Mjc1OTY4NTc5,https://github.com/apache/spark/pull/24525,https://github.com/apache/spark/pull/24525.diff,https://github.com/apache/spark/pull/24525.patch,https://api.github.com/repos/apache/spark/issues/24525,24525,open,False,[SPARK-27633][SQL] Remove redundant aliases in NestedColumnAliasing,"## What changes were proposed in this pull request?

In NestedColumnAliasing rule, we create aliases for nested field access in project list. We considered that top level parent field and nested fields under it were both accessed. In the case, we don't create the aliases because they are redundant.

There is another case, where a nested parent field and nested fields under it were both accessed, which we don't consider now. We don't need to create aliases in this case too.

## How was this patch tested?

Added test.
",2019-05-05T04:54:46Z,2020-03-04T01:55:18Z,,,431e50c82caa67ddc7b1ca0b02afe3828db853f7,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24525/commits,https://api.github.com/repos/apache/spark/pulls/24525/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24525/comments,https://api.github.com/repos/apache/spark/statuses/a0279469298c0f2db7022796173d091a1bc09d76,MEMBER,spark,apache,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,viirya:SPARK-27633,SPARK-27633,a0279469298c0f2db7022796173d091a1bc09d76,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,21467907,MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==,spark-1,viirya/spark-1,False,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,https://github.com/viirya/spark-1,Mirror of Apache Spark,True,https://api.github.com/repos/viirya/spark-1,https://api.github.com/repos/viirya/spark-1/forks,https://api.github.com/repos/viirya/spark-1/keys{/key_id},https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator},https://api.github.com/repos/viirya/spark-1/teams,https://api.github.com/repos/viirya/spark-1/hooks,https://api.github.com/repos/viirya/spark-1/issues/events{/number},https://api.github.com/repos/viirya/spark-1/events,https://api.github.com/repos/viirya/spark-1/assignees{/user},https://api.github.com/repos/viirya/spark-1/branches{/branch},https://api.github.com/repos/viirya/spark-1/tags,https://api.github.com/repos/viirya/spark-1/git/blobs{/sha},https://api.github.com/repos/viirya/spark-1/git/tags{/sha},https://api.github.com/repos/viirya/spark-1/git/refs{/sha},https://api.github.com/repos/viirya/spark-1/git/trees{/sha},https://api.github.com/repos/viirya/spark-1/statuses/{sha},https://api.github.com/repos/viirya/spark-1/languages,https://api.github.com/repos/viirya/spark-1/stargazers,https://api.github.com/repos/viirya/spark-1/contributors,https://api.github.com/repos/viirya/spark-1/subscribers,https://api.github.com/repos/viirya/spark-1/subscription,https://api.github.com/repos/viirya/spark-1/commits{/sha},https://api.github.com/repos/viirya/spark-1/git/commits{/sha},https://api.github.com/repos/viirya/spark-1/comments{/number},https://api.github.com/repos/viirya/spark-1/issues/comments{/number},https://api.github.com/repos/viirya/spark-1/contents/{+path},https://api.github.com/repos/viirya/spark-1/compare/{base}...{head},https://api.github.com/repos/viirya/spark-1/merges,https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref},https://api.github.com/repos/viirya/spark-1/downloads,https://api.github.com/repos/viirya/spark-1/issues{/number},https://api.github.com/repos/viirya/spark-1/pulls{/number},https://api.github.com/repos/viirya/spark-1/milestones{/number},"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}",https://api.github.com/repos/viirya/spark-1/labels{/name},https://api.github.com/repos/viirya/spark-1/releases{/id},https://api.github.com/repos/viirya/spark-1/deployments,2014-07-03T15:40:08Z,2020-02-26T23:54:48Z,2020-04-05T16:08:34Z,git://github.com/viirya/spark-1.git,git@github.com:viirya/spark-1.git,https://github.com/viirya/spark-1.git,https://github.com/viirya/spark-1,,321190,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3956e95f059ba9599c3cfde29225177d29b2494a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24525,https://github.com/apache/spark/pull/24525,https://api.github.com/repos/apache/spark/issues/24525,https://api.github.com/repos/apache/spark/issues/24525/comments,https://api.github.com/repos/apache/spark/pulls/24525/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24525/commits,https://api.github.com/repos/apache/spark/statuses/a0279469298c0f2db7022796173d091a1bc09d76
240,https://api.github.com/repos/apache/spark/pulls/24457,273482253,MDExOlB1bGxSZXF1ZXN0MjczNDgyMjUz,https://github.com/apache/spark/pull/24457,https://github.com/apache/spark/pull/24457.diff,https://github.com/apache/spark/pull/24457.patch,https://api.github.com/repos/apache/spark/issues/24457,24457,open,False,[SPARK-27340][SS] Alias on TimeWindow expression may cause watermark metadata lost,"## What changes were proposed in this pull request?

`window($""fooTime"", ""2 seconds"").alias(""fooWindow"")` can generate an expression tree  `Alias(fooWindow) <- TimeWindow`. The tree will become `Alias(fooWindow) <- Alias(window) <- Window(start, end)`  after analyzed by TimeWindowing rule. The `Alias(window)` got metadata of watermark when created:
```
val windowStruct = Alias(getWindow(0, 1), WINDOW_COL_NAME)(
exprId = windowAttr.exprId, explicitMetadata = Some(metadata))
``` 
but the `Alias(fooWindow)` is created before  TimeWindowing rule effected. Its code path is:
```
...
case ne: NamedExpression => Alias(expr, alias)(explicitMetadata = Some(ne.metadata))
...
```
before TimeWindowing rule effected, the `ne.metadata`  is  None and cause the watermark metadata lost

We make the `def name(alias: String)` return a `Alias` which  get metadata from its child automatically, when not specifying metadata explicitly.

Thank @LinhongLiu for helping analyzing this problem!

## How was this patch tested?
Add a UT and do the integration tests by run the example in jira successfully and do not throw org.apache.spark.sql.AnalysisException anymore

",2019-04-25T11:19:55Z,2020-01-07T14:18:14Z,,,47786bbc2d87fbae28795d6a236b7f5343fb1538,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24457/commits,https://api.github.com/repos/apache/spark/pulls/24457/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24457/comments,https://api.github.com/repos/apache/spark/statuses/a0508c9286580392a8c69989942ca63d90115d79,NONE,spark,apache,LiangchangZ,34741089,MDQ6VXNlcjM0NzQxMDg5,https://avatars1.githubusercontent.com/u/34741089?v=4,,https://api.github.com/users/LiangchangZ,https://github.com/LiangchangZ,https://api.github.com/users/LiangchangZ/followers,https://api.github.com/users/LiangchangZ/following{/other_user},https://api.github.com/users/LiangchangZ/gists{/gist_id},https://api.github.com/users/LiangchangZ/starred{/owner}{/repo},https://api.github.com/users/LiangchangZ/subscriptions,https://api.github.com/users/LiangchangZ/orgs,https://api.github.com/users/LiangchangZ/repos,https://api.github.com/users/LiangchangZ/events{/privacy},https://api.github.com/users/LiangchangZ/received_events,User,False,LiangchangZ:SPARK-27340,SPARK-27340,a0508c9286580392a8c69989942ca63d90115d79,LiangchangZ,34741089,MDQ6VXNlcjM0NzQxMDg5,https://avatars1.githubusercontent.com/u/34741089?v=4,,https://api.github.com/users/LiangchangZ,https://github.com/LiangchangZ,https://api.github.com/users/LiangchangZ/followers,https://api.github.com/users/LiangchangZ/following{/other_user},https://api.github.com/users/LiangchangZ/gists{/gist_id},https://api.github.com/users/LiangchangZ/starred{/owner}{/repo},https://api.github.com/users/LiangchangZ/subscriptions,https://api.github.com/users/LiangchangZ/orgs,https://api.github.com/users/LiangchangZ/repos,https://api.github.com/users/LiangchangZ/events{/privacy},https://api.github.com/users/LiangchangZ/received_events,User,False,135173190,MDEwOlJlcG9zaXRvcnkxMzUxNzMxOTA=,spark,LiangchangZ/spark,False,LiangchangZ,34741089,MDQ6VXNlcjM0NzQxMDg5,https://avatars1.githubusercontent.com/u/34741089?v=4,,https://api.github.com/users/LiangchangZ,https://github.com/LiangchangZ,https://api.github.com/users/LiangchangZ/followers,https://api.github.com/users/LiangchangZ/following{/other_user},https://api.github.com/users/LiangchangZ/gists{/gist_id},https://api.github.com/users/LiangchangZ/starred{/owner}{/repo},https://api.github.com/users/LiangchangZ/subscriptions,https://api.github.com/users/LiangchangZ/orgs,https://api.github.com/users/LiangchangZ/repos,https://api.github.com/users/LiangchangZ/events{/privacy},https://api.github.com/users/LiangchangZ/received_events,User,False,https://github.com/LiangchangZ/spark,Mirror of Apache Spark,True,https://api.github.com/repos/LiangchangZ/spark,https://api.github.com/repos/LiangchangZ/spark/forks,https://api.github.com/repos/LiangchangZ/spark/keys{/key_id},https://api.github.com/repos/LiangchangZ/spark/collaborators{/collaborator},https://api.github.com/repos/LiangchangZ/spark/teams,https://api.github.com/repos/LiangchangZ/spark/hooks,https://api.github.com/repos/LiangchangZ/spark/issues/events{/number},https://api.github.com/repos/LiangchangZ/spark/events,https://api.github.com/repos/LiangchangZ/spark/assignees{/user},https://api.github.com/repos/LiangchangZ/spark/branches{/branch},https://api.github.com/repos/LiangchangZ/spark/tags,https://api.github.com/repos/LiangchangZ/spark/git/blobs{/sha},https://api.github.com/repos/LiangchangZ/spark/git/tags{/sha},https://api.github.com/repos/LiangchangZ/spark/git/refs{/sha},https://api.github.com/repos/LiangchangZ/spark/git/trees{/sha},https://api.github.com/repos/LiangchangZ/spark/statuses/{sha},https://api.github.com/repos/LiangchangZ/spark/languages,https://api.github.com/repos/LiangchangZ/spark/stargazers,https://api.github.com/repos/LiangchangZ/spark/contributors,https://api.github.com/repos/LiangchangZ/spark/subscribers,https://api.github.com/repos/LiangchangZ/spark/subscription,https://api.github.com/repos/LiangchangZ/spark/commits{/sha},https://api.github.com/repos/LiangchangZ/spark/git/commits{/sha},https://api.github.com/repos/LiangchangZ/spark/comments{/number},https://api.github.com/repos/LiangchangZ/spark/issues/comments{/number},https://api.github.com/repos/LiangchangZ/spark/contents/{+path},https://api.github.com/repos/LiangchangZ/spark/compare/{base}...{head},https://api.github.com/repos/LiangchangZ/spark/merges,https://api.github.com/repos/LiangchangZ/spark/{archive_format}{/ref},https://api.github.com/repos/LiangchangZ/spark/downloads,https://api.github.com/repos/LiangchangZ/spark/issues{/number},https://api.github.com/repos/LiangchangZ/spark/pulls{/number},https://api.github.com/repos/LiangchangZ/spark/milestones{/number},"https://api.github.com/repos/LiangchangZ/spark/notifications{?since,all,participating}",https://api.github.com/repos/LiangchangZ/spark/labels{/name},https://api.github.com/repos/LiangchangZ/spark/releases{/id},https://api.github.com/repos/LiangchangZ/spark/deployments,2018-05-28T14:38:34Z,2018-10-10T06:12:10Z,2019-04-28T07:31:08Z,git://github.com/LiangchangZ/spark.git,git@github.com:LiangchangZ/spark.git,https://github.com/LiangchangZ/spark.git,https://github.com/LiangchangZ/spark,,294671,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,f82ed5e8e0d2081db9894ae0ca737eddc4b0c390,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24457,https://github.com/apache/spark/pull/24457,https://api.github.com/repos/apache/spark/issues/24457,https://api.github.com/repos/apache/spark/issues/24457/comments,https://api.github.com/repos/apache/spark/pulls/24457/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24457/commits,https://api.github.com/repos/apache/spark/statuses/a0508c9286580392a8c69989942ca63d90115d79
241,https://api.github.com/repos/apache/spark/pulls/24421,272125420,MDExOlB1bGxSZXF1ZXN0MjcyMTI1NDIw,https://github.com/apache/spark/pull/24421,https://github.com/apache/spark/pull/24421.diff,https://github.com/apache/spark/pull/24421.patch,https://api.github.com/repos/apache/spark/issues/24421,24421,open,False,[SPARK-12312][SQL]Support Kerberos login in JDBC connector,"## What changes were proposed in this pull request?

Use the provided principal and keytab to do Kerberos login before setting up the JDBC connection.

## How was this patch tested?

Step 1: Configure Microsoft SQL Server

Step 2: Start spark shell 
/spark/bin/spark-shell --master yarn \
  --files hdfs:///spark/admin.keytab

Step 3: Run the following Scala code in spark shell
import java.util.Properties

val dataSrc = ""jdbc""
val hostname = ""master-0.azdata.local""
val port = 1433
val database = ""spark""
val url = s""jdbc:sqlserver://${hostname}:${port};database=${database};integratedSecurity=true;authenticationScheme=JavaKerberos""

val df = Seq(
  (8, ""bat""),
  (64, ""mouse""),
  (-27, ""horse"")
).toDF(""number"", ""word"")

import org.apache.spark.sql.SaveMode  

df.write.mode(SaveMode.Overwrite).format(""jdbc"").option(""principal"", ""admin@AZDATA.LOCAL"").option(""keytab"", ""hdfs:///spark/admin.keytab"").option(""url"", url).option(""dbtable"", ""spark"").save()

val outDf = spark.read.format(""jdbc"").option(""principal"", ""admin@AZDATA.LOCAL"").option(""keytab"", ""admin.keytab"").option(""url"", url).option(""dbtable"", ""spark"").load()

outDf.show()",2019-04-20T02:19:23Z,2020-01-28T20:15:25Z,,,85247c585c6f8a1be8e6321627de792f29b1a5f4,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24421/commits,https://api.github.com/repos/apache/spark/pulls/24421/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24421/comments,https://api.github.com/repos/apache/spark/statuses/652786dad5a65e997d6a5a38a0fa2bbb8a7f145f,NONE,spark,apache,xuzikun2003,25806935,MDQ6VXNlcjI1ODA2OTM1,https://avatars3.githubusercontent.com/u/25806935?v=4,,https://api.github.com/users/xuzikun2003,https://github.com/xuzikun2003,https://api.github.com/users/xuzikun2003/followers,https://api.github.com/users/xuzikun2003/following{/other_user},https://api.github.com/users/xuzikun2003/gists{/gist_id},https://api.github.com/users/xuzikun2003/starred{/owner}{/repo},https://api.github.com/users/xuzikun2003/subscriptions,https://api.github.com/users/xuzikun2003/orgs,https://api.github.com/users/xuzikun2003/repos,https://api.github.com/users/xuzikun2003/events{/privacy},https://api.github.com/users/xuzikun2003/received_events,User,False,xuzikun2003:Victor/supportKerberosJDBC,Victor/supportKerberosJDBC,652786dad5a65e997d6a5a38a0fa2bbb8a7f145f,xuzikun2003,25806935,MDQ6VXNlcjI1ODA2OTM1,https://avatars3.githubusercontent.com/u/25806935?v=4,,https://api.github.com/users/xuzikun2003,https://github.com/xuzikun2003,https://api.github.com/users/xuzikun2003/followers,https://api.github.com/users/xuzikun2003/following{/other_user},https://api.github.com/users/xuzikun2003/gists{/gist_id},https://api.github.com/users/xuzikun2003/starred{/owner}{/repo},https://api.github.com/users/xuzikun2003/subscriptions,https://api.github.com/users/xuzikun2003/orgs,https://api.github.com/users/xuzikun2003/repos,https://api.github.com/users/xuzikun2003/events{/privacy},https://api.github.com/users/xuzikun2003/received_events,User,False,182039781,MDEwOlJlcG9zaXRvcnkxODIwMzk3ODE=,spark,xuzikun2003/spark,False,xuzikun2003,25806935,MDQ6VXNlcjI1ODA2OTM1,https://avatars3.githubusercontent.com/u/25806935?v=4,,https://api.github.com/users/xuzikun2003,https://github.com/xuzikun2003,https://api.github.com/users/xuzikun2003/followers,https://api.github.com/users/xuzikun2003/following{/other_user},https://api.github.com/users/xuzikun2003/gists{/gist_id},https://api.github.com/users/xuzikun2003/starred{/owner}{/repo},https://api.github.com/users/xuzikun2003/subscriptions,https://api.github.com/users/xuzikun2003/orgs,https://api.github.com/users/xuzikun2003/repos,https://api.github.com/users/xuzikun2003/events{/privacy},https://api.github.com/users/xuzikun2003/received_events,User,False,https://github.com/xuzikun2003/spark,Apache Spark,True,https://api.github.com/repos/xuzikun2003/spark,https://api.github.com/repos/xuzikun2003/spark/forks,https://api.github.com/repos/xuzikun2003/spark/keys{/key_id},https://api.github.com/repos/xuzikun2003/spark/collaborators{/collaborator},https://api.github.com/repos/xuzikun2003/spark/teams,https://api.github.com/repos/xuzikun2003/spark/hooks,https://api.github.com/repos/xuzikun2003/spark/issues/events{/number},https://api.github.com/repos/xuzikun2003/spark/events,https://api.github.com/repos/xuzikun2003/spark/assignees{/user},https://api.github.com/repos/xuzikun2003/spark/branches{/branch},https://api.github.com/repos/xuzikun2003/spark/tags,https://api.github.com/repos/xuzikun2003/spark/git/blobs{/sha},https://api.github.com/repos/xuzikun2003/spark/git/tags{/sha},https://api.github.com/repos/xuzikun2003/spark/git/refs{/sha},https://api.github.com/repos/xuzikun2003/spark/git/trees{/sha},https://api.github.com/repos/xuzikun2003/spark/statuses/{sha},https://api.github.com/repos/xuzikun2003/spark/languages,https://api.github.com/repos/xuzikun2003/spark/stargazers,https://api.github.com/repos/xuzikun2003/spark/contributors,https://api.github.com/repos/xuzikun2003/spark/subscribers,https://api.github.com/repos/xuzikun2003/spark/subscription,https://api.github.com/repos/xuzikun2003/spark/commits{/sha},https://api.github.com/repos/xuzikun2003/spark/git/commits{/sha},https://api.github.com/repos/xuzikun2003/spark/comments{/number},https://api.github.com/repos/xuzikun2003/spark/issues/comments{/number},https://api.github.com/repos/xuzikun2003/spark/contents/{+path},https://api.github.com/repos/xuzikun2003/spark/compare/{base}...{head},https://api.github.com/repos/xuzikun2003/spark/merges,https://api.github.com/repos/xuzikun2003/spark/{archive_format}{/ref},https://api.github.com/repos/xuzikun2003/spark/downloads,https://api.github.com/repos/xuzikun2003/spark/issues{/number},https://api.github.com/repos/xuzikun2003/spark/pulls{/number},https://api.github.com/repos/xuzikun2003/spark/milestones{/number},"https://api.github.com/repos/xuzikun2003/spark/notifications{?since,all,participating}",https://api.github.com/repos/xuzikun2003/spark/labels{/name},https://api.github.com/repos/xuzikun2003/spark/releases{/id},https://api.github.com/repos/xuzikun2003/spark/deployments,2019-04-18T07:38:15Z,2019-04-18T07:38:48Z,2019-04-20T02:17:52Z,git://github.com/xuzikun2003/spark.git,git@github.com:xuzikun2003/spark.git,https://github.com/xuzikun2003/spark.git,https://github.com/xuzikun2003/spark,,296642,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,777b4502b206b7240c6655d3c0b0a9ce08f6a09c,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24421,https://github.com/apache/spark/pull/24421,https://api.github.com/repos/apache/spark/issues/24421,https://api.github.com/repos/apache/spark/issues/24421/comments,https://api.github.com/repos/apache/spark/pulls/24421/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24421/commits,https://api.github.com/repos/apache/spark/statuses/652786dad5a65e997d6a5a38a0fa2bbb8a7f145f
242,https://api.github.com/repos/apache/spark/pulls/24173,263419053,MDExOlB1bGxSZXF1ZXN0MjYzNDE5MDUz,https://github.com/apache/spark/pull/24173,https://github.com/apache/spark/pull/24173.diff,https://github.com/apache/spark/pull/24173.patch,https://api.github.com/repos/apache/spark/issues/24173,24173,open,False,[SPARK-27237][SS] Introduce State schema validation among query restart,"## What changes were proposed in this pull request?

Please refer the description of [SPARK-27237](https://issues.apache.org/jira/browse/SPARK-27237) to see rationalization of this patch.

This patch proposes to introduce state schema validation, via storing key schema and value schema to `schema` file (for the first time) and verify new key schema and value schema for state are compatible with existing one. To be clear for definition of ""compatible"", state schema is ""compatible"" when number of fields are same and data type for each field is same - Spark has been allowing rename of field.

This patch will prevent query run which has incompatible state schema, which would reduce the chance to get indeterministic behavior (actually renaming of field is also the smell of semantically incompatible, but end users could just modify its name so we can't say) as well as providing more informative error message.

## How was this patch tested?

Added UTs.",2019-03-21T21:58:01Z,2020-03-31T02:17:06Z,,,9648c6b1c7050308cc7409d57cababbaa0d67c2d,,[],[],[],"[{'id': 1406587328, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzI4', 'url': 'https://api.github.com/repos/apache/spark/labels/STRUCTURED%20STREAMING', 'name': 'STRUCTURED STREAMING', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/24173/commits,https://api.github.com/repos/apache/spark/pulls/24173/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/24173/comments,https://api.github.com/repos/apache/spark/statuses/1fcfff5c2ca78049eb38cf4ef7c041d0005ab9b3,CONTRIBUTOR,spark,apache,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,HeartSaVioR:SPARK-27237,SPARK-27237,1fcfff5c2ca78049eb38cf4ef7c041d0005ab9b3,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,27994296,MDEwOlJlcG9zaXRvcnkyNzk5NDI5Ng==,spark,HeartSaVioR/spark,False,HeartSaVioR,1317309,MDQ6VXNlcjEzMTczMDk=,https://avatars2.githubusercontent.com/u/1317309?v=4,,https://api.github.com/users/HeartSaVioR,https://github.com/HeartSaVioR,https://api.github.com/users/HeartSaVioR/followers,https://api.github.com/users/HeartSaVioR/following{/other_user},https://api.github.com/users/HeartSaVioR/gists{/gist_id},https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo},https://api.github.com/users/HeartSaVioR/subscriptions,https://api.github.com/users/HeartSaVioR/orgs,https://api.github.com/users/HeartSaVioR/repos,https://api.github.com/users/HeartSaVioR/events{/privacy},https://api.github.com/users/HeartSaVioR/received_events,User,False,https://github.com/HeartSaVioR/spark,Mirror of Apache Spark,True,https://api.github.com/repos/HeartSaVioR/spark,https://api.github.com/repos/HeartSaVioR/spark/forks,https://api.github.com/repos/HeartSaVioR/spark/keys{/key_id},https://api.github.com/repos/HeartSaVioR/spark/collaborators{/collaborator},https://api.github.com/repos/HeartSaVioR/spark/teams,https://api.github.com/repos/HeartSaVioR/spark/hooks,https://api.github.com/repos/HeartSaVioR/spark/issues/events{/number},https://api.github.com/repos/HeartSaVioR/spark/events,https://api.github.com/repos/HeartSaVioR/spark/assignees{/user},https://api.github.com/repos/HeartSaVioR/spark/branches{/branch},https://api.github.com/repos/HeartSaVioR/spark/tags,https://api.github.com/repos/HeartSaVioR/spark/git/blobs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/tags{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/refs{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/trees{/sha},https://api.github.com/repos/HeartSaVioR/spark/statuses/{sha},https://api.github.com/repos/HeartSaVioR/spark/languages,https://api.github.com/repos/HeartSaVioR/spark/stargazers,https://api.github.com/repos/HeartSaVioR/spark/contributors,https://api.github.com/repos/HeartSaVioR/spark/subscribers,https://api.github.com/repos/HeartSaVioR/spark/subscription,https://api.github.com/repos/HeartSaVioR/spark/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/git/commits{/sha},https://api.github.com/repos/HeartSaVioR/spark/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/issues/comments{/number},https://api.github.com/repos/HeartSaVioR/spark/contents/{+path},https://api.github.com/repos/HeartSaVioR/spark/compare/{base}...{head},https://api.github.com/repos/HeartSaVioR/spark/merges,https://api.github.com/repos/HeartSaVioR/spark/{archive_format}{/ref},https://api.github.com/repos/HeartSaVioR/spark/downloads,https://api.github.com/repos/HeartSaVioR/spark/issues{/number},https://api.github.com/repos/HeartSaVioR/spark/pulls{/number},https://api.github.com/repos/HeartSaVioR/spark/milestones{/number},"https://api.github.com/repos/HeartSaVioR/spark/notifications{?since,all,participating}",https://api.github.com/repos/HeartSaVioR/spark/labels{/name},https://api.github.com/repos/HeartSaVioR/spark/releases{/id},https://api.github.com/repos/HeartSaVioR/spark/deployments,2014-12-14T12:56:04Z,2014-12-14T12:56:20Z,2020-04-08T06:54:11Z,git://github.com/HeartSaVioR/spark.git,git@github.com:HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark.git,https://github.com/HeartSaVioR/spark,,305593,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,481fb63f97d87d5b2e9e1f9b30bee466605b5a72,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/24173,https://github.com/apache/spark/pull/24173,https://api.github.com/repos/apache/spark/issues/24173,https://api.github.com/repos/apache/spark/issues/24173/comments,https://api.github.com/repos/apache/spark/pulls/24173/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/24173/commits,https://api.github.com/repos/apache/spark/statuses/1fcfff5c2ca78049eb38cf4ef7c041d0005ab9b3
243,https://api.github.com/repos/apache/spark/pulls/23988,258714720,MDExOlB1bGxSZXF1ZXN0MjU4NzE0NzIw,https://github.com/apache/spark/pull/23988,https://github.com/apache/spark/pull/23988.diff,https://github.com/apache/spark/pull/23988.patch,https://api.github.com/repos/apache/spark/issues/23988,23988,open,False,[SPARK-26509][SQL] Parquet DELTA_BYTE_ARRAY is not supported in Spark 2.x's Vectorized Reader,"## What changes were proposed in this pull request?

Implement Parquet delta encoding for vectorized interface, which is needed for V2 pages. The implementation simply delegates the decoding to the Parquet implementation.

## How was this patch tested?

Added new test case for delta encoding, ran unit tests",2019-03-06T13:16:28Z,2020-01-22T02:31:38Z,,,f3d457734aaa5df42c7b52b3ef8c1f194ee00cc4,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/23988/commits,https://api.github.com/repos/apache/spark/pulls/23988/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/23988/comments,https://api.github.com/repos/apache/spark/statuses/35fc3029de19bbd7b5326b1d962cc29af8be7cbd,CONTRIBUTOR,spark,apache,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,nandorKollar:SPARK-26509,SPARK-26509,35fc3029de19bbd7b5326b1d962cc29af8be7cbd,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,148200621,MDEwOlJlcG9zaXRvcnkxNDgyMDA2MjE=,spark,nandorKollar/spark,False,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,https://github.com/nandorKollar/spark,Mirror of Apache Spark,True,https://api.github.com/repos/nandorKollar/spark,https://api.github.com/repos/nandorKollar/spark/forks,https://api.github.com/repos/nandorKollar/spark/keys{/key_id},https://api.github.com/repos/nandorKollar/spark/collaborators{/collaborator},https://api.github.com/repos/nandorKollar/spark/teams,https://api.github.com/repos/nandorKollar/spark/hooks,https://api.github.com/repos/nandorKollar/spark/issues/events{/number},https://api.github.com/repos/nandorKollar/spark/events,https://api.github.com/repos/nandorKollar/spark/assignees{/user},https://api.github.com/repos/nandorKollar/spark/branches{/branch},https://api.github.com/repos/nandorKollar/spark/tags,https://api.github.com/repos/nandorKollar/spark/git/blobs{/sha},https://api.github.com/repos/nandorKollar/spark/git/tags{/sha},https://api.github.com/repos/nandorKollar/spark/git/refs{/sha},https://api.github.com/repos/nandorKollar/spark/git/trees{/sha},https://api.github.com/repos/nandorKollar/spark/statuses/{sha},https://api.github.com/repos/nandorKollar/spark/languages,https://api.github.com/repos/nandorKollar/spark/stargazers,https://api.github.com/repos/nandorKollar/spark/contributors,https://api.github.com/repos/nandorKollar/spark/subscribers,https://api.github.com/repos/nandorKollar/spark/subscription,https://api.github.com/repos/nandorKollar/spark/commits{/sha},https://api.github.com/repos/nandorKollar/spark/git/commits{/sha},https://api.github.com/repos/nandorKollar/spark/comments{/number},https://api.github.com/repos/nandorKollar/spark/issues/comments{/number},https://api.github.com/repos/nandorKollar/spark/contents/{+path},https://api.github.com/repos/nandorKollar/spark/compare/{base}...{head},https://api.github.com/repos/nandorKollar/spark/merges,https://api.github.com/repos/nandorKollar/spark/{archive_format}{/ref},https://api.github.com/repos/nandorKollar/spark/downloads,https://api.github.com/repos/nandorKollar/spark/issues{/number},https://api.github.com/repos/nandorKollar/spark/pulls{/number},https://api.github.com/repos/nandorKollar/spark/milestones{/number},"https://api.github.com/repos/nandorKollar/spark/notifications{?since,all,participating}",https://api.github.com/repos/nandorKollar/spark/labels{/name},https://api.github.com/repos/nandorKollar/spark/releases{/id},https://api.github.com/repos/nandorKollar/spark/deployments,2018-09-10T18:28:14Z,2018-09-10T18:28:42Z,2020-01-03T15:19:40Z,git://github.com/nandorKollar/spark.git,git@github.com:nandorKollar/spark.git,https://github.com/nandorKollar/spark.git,https://github.com/nandorKollar/spark,,292324,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,3fcbc7fb9f7b58b040a85289a82cf551d51bac37,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/23988,https://github.com/apache/spark/pull/23988,https://api.github.com/repos/apache/spark/issues/23988,https://api.github.com/repos/apache/spark/issues/23988/comments,https://api.github.com/repos/apache/spark/pulls/23988/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/23988/commits,https://api.github.com/repos/apache/spark/statuses/35fc3029de19bbd7b5326b1d962cc29af8be7cbd
244,https://api.github.com/repos/apache/spark/pulls/23721,249545240,MDExOlB1bGxSZXF1ZXN0MjQ5NTQ1MjQw,https://github.com/apache/spark/pull/23721,https://github.com/apache/spark/pull/23721.diff,https://github.com/apache/spark/pull/23721.patch,https://api.github.com/repos/apache/spark/issues/23721,23721,open,False,[SPARK-26797][SQL][WIP][test-maven] Start using the new logical types API of Parquet 1.11.0 instead of the deprecated one,"## What changes were proposed in this pull request?

A new, more flexible logical type API was introduced in parquet-mr 1.11.0 (based on the the Thrift field in parquet-format available for a while). This change migrates from the old (now deprecated) enum-based OriginalType API to this new logical type API.

In addition to replacing the deprecated API calls, this PR also introduces support for reading the new subtypes for different timestamp semantics.

Since parquet-mr 1.11.0 is not yet released, this is tested against a release candidate. Before merging, the additional repository should be deleted from pom.xml, which can only be done once parquet-mr 1.11.0 is released.

## How was this patch tested?

Unit tests were added to the PR.",2019-02-01T09:55:34Z,2020-02-20T14:34:16Z,,,50eee800a4654932d0654823e5b7537f7fce4bdc,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/23721/commits,https://api.github.com/repos/apache/spark/pulls/23721/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/23721/comments,https://api.github.com/repos/apache/spark/statuses/9dbf1523ed247dec11d21217241bfb6014dc39ee,CONTRIBUTOR,spark,apache,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,nandorKollar:SPARK-26797,SPARK-26797,9dbf1523ed247dec11d21217241bfb6014dc39ee,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,148200621,MDEwOlJlcG9zaXRvcnkxNDgyMDA2MjE=,spark,nandorKollar/spark,False,nandorKollar,12639187,MDQ6VXNlcjEyNjM5MTg3,https://avatars2.githubusercontent.com/u/12639187?v=4,,https://api.github.com/users/nandorKollar,https://github.com/nandorKollar,https://api.github.com/users/nandorKollar/followers,https://api.github.com/users/nandorKollar/following{/other_user},https://api.github.com/users/nandorKollar/gists{/gist_id},https://api.github.com/users/nandorKollar/starred{/owner}{/repo},https://api.github.com/users/nandorKollar/subscriptions,https://api.github.com/users/nandorKollar/orgs,https://api.github.com/users/nandorKollar/repos,https://api.github.com/users/nandorKollar/events{/privacy},https://api.github.com/users/nandorKollar/received_events,User,False,https://github.com/nandorKollar/spark,Mirror of Apache Spark,True,https://api.github.com/repos/nandorKollar/spark,https://api.github.com/repos/nandorKollar/spark/forks,https://api.github.com/repos/nandorKollar/spark/keys{/key_id},https://api.github.com/repos/nandorKollar/spark/collaborators{/collaborator},https://api.github.com/repos/nandorKollar/spark/teams,https://api.github.com/repos/nandorKollar/spark/hooks,https://api.github.com/repos/nandorKollar/spark/issues/events{/number},https://api.github.com/repos/nandorKollar/spark/events,https://api.github.com/repos/nandorKollar/spark/assignees{/user},https://api.github.com/repos/nandorKollar/spark/branches{/branch},https://api.github.com/repos/nandorKollar/spark/tags,https://api.github.com/repos/nandorKollar/spark/git/blobs{/sha},https://api.github.com/repos/nandorKollar/spark/git/tags{/sha},https://api.github.com/repos/nandorKollar/spark/git/refs{/sha},https://api.github.com/repos/nandorKollar/spark/git/trees{/sha},https://api.github.com/repos/nandorKollar/spark/statuses/{sha},https://api.github.com/repos/nandorKollar/spark/languages,https://api.github.com/repos/nandorKollar/spark/stargazers,https://api.github.com/repos/nandorKollar/spark/contributors,https://api.github.com/repos/nandorKollar/spark/subscribers,https://api.github.com/repos/nandorKollar/spark/subscription,https://api.github.com/repos/nandorKollar/spark/commits{/sha},https://api.github.com/repos/nandorKollar/spark/git/commits{/sha},https://api.github.com/repos/nandorKollar/spark/comments{/number},https://api.github.com/repos/nandorKollar/spark/issues/comments{/number},https://api.github.com/repos/nandorKollar/spark/contents/{+path},https://api.github.com/repos/nandorKollar/spark/compare/{base}...{head},https://api.github.com/repos/nandorKollar/spark/merges,https://api.github.com/repos/nandorKollar/spark/{archive_format}{/ref},https://api.github.com/repos/nandorKollar/spark/downloads,https://api.github.com/repos/nandorKollar/spark/issues{/number},https://api.github.com/repos/nandorKollar/spark/pulls{/number},https://api.github.com/repos/nandorKollar/spark/milestones{/number},"https://api.github.com/repos/nandorKollar/spark/notifications{?since,all,participating}",https://api.github.com/repos/nandorKollar/spark/labels{/name},https://api.github.com/repos/nandorKollar/spark/releases{/id},https://api.github.com/repos/nandorKollar/spark/deployments,2018-09-10T18:28:14Z,2018-09-10T18:28:42Z,2020-01-03T15:19:40Z,git://github.com/nandorKollar/spark.git,git@github.com:nandorKollar/spark.git,https://github.com/nandorKollar/spark.git,https://github.com/nandorKollar/spark,,292324,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8ec6cb67c71c67788230cab8a0cd34d8ad3ce24b,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/23721,https://github.com/apache/spark/pull/23721,https://api.github.com/repos/apache/spark/issues/23721,https://api.github.com/repos/apache/spark/issues/23721/comments,https://api.github.com/repos/apache/spark/pulls/23721/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/23721/commits,https://api.github.com/repos/apache/spark/statuses/9dbf1523ed247dec11d21217241bfb6014dc39ee
245,https://api.github.com/repos/apache/spark/pulls/23531,244274565,MDExOlB1bGxSZXF1ZXN0MjQ0Mjc0NTY1,https://github.com/apache/spark/pull/23531,https://github.com/apache/spark/pull/23531.diff,https://github.com/apache/spark/pull/23531.patch,https://api.github.com/repos/apache/spark/issues/23531,23531,open,False,[SPARK-24497][SQL] Support recursive SQL query,"## What changes were proposed in this pull request?
This PR adds recursive query feature to Spark SQL.

A recursive query is defined using the `WITH RECURSIVE` keywords and referring the name of the common table expression within the query.
The implementation complies with SQL standard and follows similar rules to other relational databases:
- A query is made of an anchor followed by a recursive term.
- The anchor terms doesn't contain self reference and it is used to initialize the query.
- The recursive term contains a self reference and it is used to expand the current set of rows with new ones.
- The anchor and recursive terms must be joined with each other by `UNION` or `UNION ALL` operators.
- New rows can only be derived from the newly added rows of the previous iteration (or from the initial set of rows of anchor terms). This limitation implies that recursive references can't be used with some of the joins, aggregations or subqueries.

Please see `cte-recursive.sql` and `with.sql` for some examples.

Please note that this PR focuses on the minimal working implementation which means:
- SQL recursion is actually loop where the current iteration is computed based on the previous one's result and when an iteration returns no rows the loop is over. The final result is the union of all iteration results. This means that caching intermediate results could speed up the process, but caching was removed from this PR to reduce complexity and can be added back in a follow-up PR.
- A common way to stop SQL recursion is using the LIMIT operator to stop computing more than the required number of rows. LIMIT support was removed from this PR to reduce complexity and can be added back in a follow-up PR.
- Some relational databases are more relaxed in terms how many anchor and recursive terms can be in a recursion. This PR allows the most simple case and allows only 1-1 of them. A follow-up PR can target to relax this limitation.

## Why are the changes needed?
Recursive query is an ANSI SQL feature that is useful to process hierarchical data.

## Does this PR introduce any user-facing change?
Yes, adds recursive query feature.

## How was this patch tested?
Added new UTs and tests in `cte-recursion.sql` and `with.sql`. 
",2019-01-13T12:00:07Z,2020-04-08T08:57:02Z,,,e9a8b081494a1242073e27291e6abbc81958df81,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/23531/commits,https://api.github.com/repos/apache/spark/pulls/23531/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/23531/comments,https://api.github.com/repos/apache/spark/statuses/656995b6bf34bd1a21d1de077e580875e69e8fa8,CONTRIBUTOR,spark,apache,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,peter-toth:SPARK-24497,SPARK-24497,656995b6bf34bd1a21d1de077e580875e69e8fa8,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,130546049,MDEwOlJlcG9zaXRvcnkxMzA1NDYwNDk=,spark,peter-toth/spark,False,peter-toth,7253827,MDQ6VXNlcjcyNTM4Mjc=,https://avatars1.githubusercontent.com/u/7253827?v=4,,https://api.github.com/users/peter-toth,https://github.com/peter-toth,https://api.github.com/users/peter-toth/followers,https://api.github.com/users/peter-toth/following{/other_user},https://api.github.com/users/peter-toth/gists{/gist_id},https://api.github.com/users/peter-toth/starred{/owner}{/repo},https://api.github.com/users/peter-toth/subscriptions,https://api.github.com/users/peter-toth/orgs,https://api.github.com/users/peter-toth/repos,https://api.github.com/users/peter-toth/events{/privacy},https://api.github.com/users/peter-toth/received_events,User,False,https://github.com/peter-toth/spark,Mirror of Apache Spark,True,https://api.github.com/repos/peter-toth/spark,https://api.github.com/repos/peter-toth/spark/forks,https://api.github.com/repos/peter-toth/spark/keys{/key_id},https://api.github.com/repos/peter-toth/spark/collaborators{/collaborator},https://api.github.com/repos/peter-toth/spark/teams,https://api.github.com/repos/peter-toth/spark/hooks,https://api.github.com/repos/peter-toth/spark/issues/events{/number},https://api.github.com/repos/peter-toth/spark/events,https://api.github.com/repos/peter-toth/spark/assignees{/user},https://api.github.com/repos/peter-toth/spark/branches{/branch},https://api.github.com/repos/peter-toth/spark/tags,https://api.github.com/repos/peter-toth/spark/git/blobs{/sha},https://api.github.com/repos/peter-toth/spark/git/tags{/sha},https://api.github.com/repos/peter-toth/spark/git/refs{/sha},https://api.github.com/repos/peter-toth/spark/git/trees{/sha},https://api.github.com/repos/peter-toth/spark/statuses/{sha},https://api.github.com/repos/peter-toth/spark/languages,https://api.github.com/repos/peter-toth/spark/stargazers,https://api.github.com/repos/peter-toth/spark/contributors,https://api.github.com/repos/peter-toth/spark/subscribers,https://api.github.com/repos/peter-toth/spark/subscription,https://api.github.com/repos/peter-toth/spark/commits{/sha},https://api.github.com/repos/peter-toth/spark/git/commits{/sha},https://api.github.com/repos/peter-toth/spark/comments{/number},https://api.github.com/repos/peter-toth/spark/issues/comments{/number},https://api.github.com/repos/peter-toth/spark/contents/{+path},https://api.github.com/repos/peter-toth/spark/compare/{base}...{head},https://api.github.com/repos/peter-toth/spark/merges,https://api.github.com/repos/peter-toth/spark/{archive_format}{/ref},https://api.github.com/repos/peter-toth/spark/downloads,https://api.github.com/repos/peter-toth/spark/issues{/number},https://api.github.com/repos/peter-toth/spark/pulls{/number},https://api.github.com/repos/peter-toth/spark/milestones{/number},"https://api.github.com/repos/peter-toth/spark/notifications{?since,all,participating}",https://api.github.com/repos/peter-toth/spark/labels{/name},https://api.github.com/repos/peter-toth/spark/releases{/id},https://api.github.com/repos/peter-toth/spark/deployments,2018-04-22T07:43:37Z,2018-04-22T07:44:03Z,2020-03-31T12:39:44Z,git://github.com/peter-toth/spark.git,git@github.com:peter-toth/spark.git,https://github.com/peter-toth/spark.git,https://github.com/peter-toth/spark,,330225,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cb26f636b08aea4c5c6bf5035a359cd3cbf335c0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/23531,https://github.com/apache/spark/pull/23531,https://api.github.com/repos/apache/spark/issues/23531,https://api.github.com/repos/apache/spark/issues/23531/comments,https://api.github.com/repos/apache/spark/pulls/23531/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/23531/commits,https://api.github.com/repos/apache/spark/statuses/656995b6bf34bd1a21d1de077e580875e69e8fa8
246,https://api.github.com/repos/apache/spark/pulls/23163,234214245,MDExOlB1bGxSZXF1ZXN0MjM0MjE0MjQ1,https://github.com/apache/spark/pull/23163,https://github.com/apache/spark/pull/23163.diff,https://github.com/apache/spark/pull/23163.patch,https://api.github.com/repos/apache/spark/issues/23163,23163,open,False,[SPARK-26164][SQL] Allow FileFormatWriter to write multiple partitions/buckets without sort,"## What changes were proposed in this pull request?

Currently spark always requires a local sort before writing to output table on partition/bucket columns (see `write.requiredOrdering` in `FileFormatWriter.scala`), which is unnecessary, and can be avoided by keeping multiple output writers concurrently in `FileFormatDataWriter.scala`.

This pr is first doing hash-based write, then falling back to sort-based write (current implementation) when number of opened writer exceeding a threshold (controlled by a config). Specifically:

1. (hash-based write) Maintain mapping between file path and output writer, and re-use writer for writing input row. In case of the number of opened output writers exceeding a threshold (can be changed by a config), we go to 2.

2. (sort-based write) Sort the rest of input rows (use the same sorter in SortExec). Then writing the rest of sorted rows, and we can close the writer on the fly, in case no more rows for current file path.

## How was this patch tested?

Added unit test in `DataFrameReaderWriterSuite.scala`. Existing test like `SQLMetricsSuite.scala` would already exercise the code path of executor write metrics.
",2018-11-28T10:01:48Z,2020-02-04T05:08:26Z,,,144b7e6b965ec10450d19b362f763bfbf3996ec1,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/23163/commits,https://api.github.com/repos/apache/spark/pulls/23163/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/23163/comments,https://api.github.com/repos/apache/spark/statuses/7c544abf4c30474d504b74f2d4c252dc55f1ba4e,NONE,spark,apache,c21,4629931,MDQ6VXNlcjQ2Mjk5MzE=,https://avatars2.githubusercontent.com/u/4629931?v=4,,https://api.github.com/users/c21,https://github.com/c21,https://api.github.com/users/c21/followers,https://api.github.com/users/c21/following{/other_user},https://api.github.com/users/c21/gists{/gist_id},https://api.github.com/users/c21/starred{/owner}{/repo},https://api.github.com/users/c21/subscriptions,https://api.github.com/users/c21/orgs,https://api.github.com/users/c21/repos,https://api.github.com/users/c21/events{/privacy},https://api.github.com/users/c21/received_events,User,False,c21:more-writers,more-writers,7c544abf4c30474d504b74f2d4c252dc55f1ba4e,c21,4629931,MDQ6VXNlcjQ2Mjk5MzE=,https://avatars2.githubusercontent.com/u/4629931?v=4,,https://api.github.com/users/c21,https://github.com/c21,https://api.github.com/users/c21/followers,https://api.github.com/users/c21/following{/other_user},https://api.github.com/users/c21/gists{/gist_id},https://api.github.com/users/c21/starred{/owner}{/repo},https://api.github.com/users/c21/subscriptions,https://api.github.com/users/c21/orgs,https://api.github.com/users/c21/repos,https://api.github.com/users/c21/events{/privacy},https://api.github.com/users/c21/received_events,User,False,159474643,MDEwOlJlcG9zaXRvcnkxNTk0NzQ2NDM=,spark,c21/spark,False,c21,4629931,MDQ6VXNlcjQ2Mjk5MzE=,https://avatars2.githubusercontent.com/u/4629931?v=4,,https://api.github.com/users/c21,https://github.com/c21,https://api.github.com/users/c21/followers,https://api.github.com/users/c21/following{/other_user},https://api.github.com/users/c21/gists{/gist_id},https://api.github.com/users/c21/starred{/owner}{/repo},https://api.github.com/users/c21/subscriptions,https://api.github.com/users/c21/orgs,https://api.github.com/users/c21/repos,https://api.github.com/users/c21/events{/privacy},https://api.github.com/users/c21/received_events,User,False,https://github.com/c21/spark,Mirror of Apache Spark,True,https://api.github.com/repos/c21/spark,https://api.github.com/repos/c21/spark/forks,https://api.github.com/repos/c21/spark/keys{/key_id},https://api.github.com/repos/c21/spark/collaborators{/collaborator},https://api.github.com/repos/c21/spark/teams,https://api.github.com/repos/c21/spark/hooks,https://api.github.com/repos/c21/spark/issues/events{/number},https://api.github.com/repos/c21/spark/events,https://api.github.com/repos/c21/spark/assignees{/user},https://api.github.com/repos/c21/spark/branches{/branch},https://api.github.com/repos/c21/spark/tags,https://api.github.com/repos/c21/spark/git/blobs{/sha},https://api.github.com/repos/c21/spark/git/tags{/sha},https://api.github.com/repos/c21/spark/git/refs{/sha},https://api.github.com/repos/c21/spark/git/trees{/sha},https://api.github.com/repos/c21/spark/statuses/{sha},https://api.github.com/repos/c21/spark/languages,https://api.github.com/repos/c21/spark/stargazers,https://api.github.com/repos/c21/spark/contributors,https://api.github.com/repos/c21/spark/subscribers,https://api.github.com/repos/c21/spark/subscription,https://api.github.com/repos/c21/spark/commits{/sha},https://api.github.com/repos/c21/spark/git/commits{/sha},https://api.github.com/repos/c21/spark/comments{/number},https://api.github.com/repos/c21/spark/issues/comments{/number},https://api.github.com/repos/c21/spark/contents/{+path},https://api.github.com/repos/c21/spark/compare/{base}...{head},https://api.github.com/repos/c21/spark/merges,https://api.github.com/repos/c21/spark/{archive_format}{/ref},https://api.github.com/repos/c21/spark/downloads,https://api.github.com/repos/c21/spark/issues{/number},https://api.github.com/repos/c21/spark/pulls{/number},https://api.github.com/repos/c21/spark/milestones{/number},"https://api.github.com/repos/c21/spark/notifications{?since,all,participating}",https://api.github.com/repos/c21/spark/labels{/name},https://api.github.com/repos/c21/spark/releases{/id},https://api.github.com/repos/c21/spark/deployments,2018-11-28T09:15:08Z,2020-02-06T00:22:51Z,2020-02-06T00:22:15Z,git://github.com/c21/spark.git,git@github.com:c21/spark.git,https://github.com/c21/spark.git,https://github.com/c21/spark,,316490,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,56967b7e288ac54e705b14a21516df5402d4c9d9,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/23163,https://github.com/apache/spark/pull/23163,https://api.github.com/repos/apache/spark/issues/23163,https://api.github.com/repos/apache/spark/issues/23163/comments,https://api.github.com/repos/apache/spark/pulls/23163/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/23163/commits,https://api.github.com/repos/apache/spark/statuses/7c544abf4c30474d504b74f2d4c252dc55f1ba4e
247,https://api.github.com/repos/apache/spark/pulls/22878,226617138,MDExOlB1bGxSZXF1ZXN0MjI2NjE3MTM4,https://github.com/apache/spark/pull/22878,https://github.com/apache/spark/pull/22878.diff,https://github.com/apache/spark/pull/22878.patch,https://api.github.com/repos/apache/spark/issues/22878,22878,open,False,[SPARK-25789][SQL] Support for Dataset of Avro,"## What changes were proposed in this pull request?

Please credit to @bdrillard cause this mainly based on his previous work.

This PR add support for Dataset of Avro records in an API that would allow the user to provide a class to an Encoder for Avro, analogous to the Bean encoder.

- Add `ObjectCast` and `InitializeAvroObject`(analogous to `InitializeJavaBean`) expression.
- Add an AvroEncoder for Datasets of Avro records to Spark.
- Add type-inference utilities `AvroTypeInference` for Avro object and SQL DataType (analogous to `JavaTypeInference`).

## How was this patch tested?

Add UT in AvroSuite.scala and manual test by modified SQLExample with external avro package.
",2018-10-29T15:59:08Z,2020-01-22T12:08:57Z,,,2c455e8f60a19aa397526834e51f6ad6cab0a454,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/22878/commits,https://api.github.com/repos/apache/spark/pulls/22878/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/22878/comments,https://api.github.com/repos/apache/spark/statuses/e59e58c847389a3c7d674745667f8be0f8f7fb0e,CONTRIBUTOR,spark,apache,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,xuanyuanking:SPARK-25789,SPARK-25789,e59e58c847389a3c7d674745667f8be0f8f7fb0e,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,52511431,MDEwOlJlcG9zaXRvcnk1MjUxMTQzMQ==,spark,xuanyuanking/spark,False,xuanyuanking,4833765,MDQ6VXNlcjQ4MzM3NjU=,https://avatars0.githubusercontent.com/u/4833765?v=4,,https://api.github.com/users/xuanyuanking,https://github.com/xuanyuanking,https://api.github.com/users/xuanyuanking/followers,https://api.github.com/users/xuanyuanking/following{/other_user},https://api.github.com/users/xuanyuanking/gists{/gist_id},https://api.github.com/users/xuanyuanking/starred{/owner}{/repo},https://api.github.com/users/xuanyuanking/subscriptions,https://api.github.com/users/xuanyuanking/orgs,https://api.github.com/users/xuanyuanking/repos,https://api.github.com/users/xuanyuanking/events{/privacy},https://api.github.com/users/xuanyuanking/received_events,User,False,https://github.com/xuanyuanking/spark,Mirror of Apache Spark,True,https://api.github.com/repos/xuanyuanking/spark,https://api.github.com/repos/xuanyuanking/spark/forks,https://api.github.com/repos/xuanyuanking/spark/keys{/key_id},https://api.github.com/repos/xuanyuanking/spark/collaborators{/collaborator},https://api.github.com/repos/xuanyuanking/spark/teams,https://api.github.com/repos/xuanyuanking/spark/hooks,https://api.github.com/repos/xuanyuanking/spark/issues/events{/number},https://api.github.com/repos/xuanyuanking/spark/events,https://api.github.com/repos/xuanyuanking/spark/assignees{/user},https://api.github.com/repos/xuanyuanking/spark/branches{/branch},https://api.github.com/repos/xuanyuanking/spark/tags,https://api.github.com/repos/xuanyuanking/spark/git/blobs{/sha},https://api.github.com/repos/xuanyuanking/spark/git/tags{/sha},https://api.github.com/repos/xuanyuanking/spark/git/refs{/sha},https://api.github.com/repos/xuanyuanking/spark/git/trees{/sha},https://api.github.com/repos/xuanyuanking/spark/statuses/{sha},https://api.github.com/repos/xuanyuanking/spark/languages,https://api.github.com/repos/xuanyuanking/spark/stargazers,https://api.github.com/repos/xuanyuanking/spark/contributors,https://api.github.com/repos/xuanyuanking/spark/subscribers,https://api.github.com/repos/xuanyuanking/spark/subscription,https://api.github.com/repos/xuanyuanking/spark/commits{/sha},https://api.github.com/repos/xuanyuanking/spark/git/commits{/sha},https://api.github.com/repos/xuanyuanking/spark/comments{/number},https://api.github.com/repos/xuanyuanking/spark/issues/comments{/number},https://api.github.com/repos/xuanyuanking/spark/contents/{+path},https://api.github.com/repos/xuanyuanking/spark/compare/{base}...{head},https://api.github.com/repos/xuanyuanking/spark/merges,https://api.github.com/repos/xuanyuanking/spark/{archive_format}{/ref},https://api.github.com/repos/xuanyuanking/spark/downloads,https://api.github.com/repos/xuanyuanking/spark/issues{/number},https://api.github.com/repos/xuanyuanking/spark/pulls{/number},https://api.github.com/repos/xuanyuanking/spark/milestones{/number},"https://api.github.com/repos/xuanyuanking/spark/notifications{?since,all,participating}",https://api.github.com/repos/xuanyuanking/spark/labels{/name},https://api.github.com/repos/xuanyuanking/spark/releases{/id},https://api.github.com/repos/xuanyuanking/spark/deployments,2016-02-25T09:08:00Z,2020-03-26T06:11:09Z,2020-03-30T14:23:05Z,git://github.com/xuanyuanking/spark.git,git@github.com:xuanyuanking/spark.git,https://github.com/xuanyuanking/spark.git,https://github.com/xuanyuanking/spark,,315292,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,ab048990e0bdffe16de6a6b9211f63933976651e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/22878,https://github.com/apache/spark/pull/22878,https://api.github.com/repos/apache/spark/issues/22878,https://api.github.com/repos/apache/spark/issues/22878/comments,https://api.github.com/repos/apache/spark/pulls/22878/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/22878/commits,https://api.github.com/repos/apache/spark/statuses/e59e58c847389a3c7d674745667f8be0f8f7fb0e
248,https://api.github.com/repos/apache/spark/pulls/22163,209694503,MDExOlB1bGxSZXF1ZXN0MjA5Njk0NTAz,https://github.com/apache/spark/pull/22163,https://github.com/apache/spark/pull/22163.diff,https://github.com/apache/spark/pull/22163.patch,https://api.github.com/repos/apache/spark/issues/22163,22163,open,False,[SPARK-25166][CORE]Reduce the number of write operations for shuffle write.,"## What changes were proposed in this pull request?

Currently, only one record is written to a buffer each time, which increases the number of copies.
I think we should write as many records as possible each time.

## How was this patch tested?
Existed  unit tests in `UnsafeShuffleWriterSuite`
",2018-08-21T02:51:04Z,2020-03-08T00:18:06Z,,,c340e6f2a31179fb81bc8beeeb61f17bb6c589da,,[],[],[],"[{'id': 1406605327, 'node_id': 'MDU6TGFiZWwxNDA2NjA1MzI3', 'url': 'https://api.github.com/repos/apache/spark/labels/SHUFFLE', 'name': 'SHUFFLE', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/22163/commits,https://api.github.com/repos/apache/spark/pulls/22163/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/22163/comments,https://api.github.com/repos/apache/spark/statuses/6905d3b2580306bccac58c051c3c88058d37de32,CONTRIBUTOR,spark,apache,10110346,24688163,MDQ6VXNlcjI0Njg4MTYz,https://avatars2.githubusercontent.com/u/24688163?v=4,,https://api.github.com/users/10110346,https://github.com/10110346,https://api.github.com/users/10110346/followers,https://api.github.com/users/10110346/following{/other_user},https://api.github.com/users/10110346/gists{/gist_id},https://api.github.com/users/10110346/starred{/owner}{/repo},https://api.github.com/users/10110346/subscriptions,https://api.github.com/users/10110346/orgs,https://api.github.com/users/10110346/repos,https://api.github.com/users/10110346/events{/privacy},https://api.github.com/users/10110346/received_events,User,False,10110346:reducewrite,reducewrite,6905d3b2580306bccac58c051c3c88058d37de32,10110346,24688163,MDQ6VXNlcjI0Njg4MTYz,https://avatars2.githubusercontent.com/u/24688163?v=4,,https://api.github.com/users/10110346,https://github.com/10110346,https://api.github.com/users/10110346/followers,https://api.github.com/users/10110346/following{/other_user},https://api.github.com/users/10110346/gists{/gist_id},https://api.github.com/users/10110346/starred{/owner}{/repo},https://api.github.com/users/10110346/subscriptions,https://api.github.com/users/10110346/orgs,https://api.github.com/users/10110346/repos,https://api.github.com/users/10110346/events{/privacy},https://api.github.com/users/10110346/received_events,User,False,77023032,MDEwOlJlcG9zaXRvcnk3NzAyMzAzMg==,spark,10110346/spark,False,10110346,24688163,MDQ6VXNlcjI0Njg4MTYz,https://avatars2.githubusercontent.com/u/24688163?v=4,,https://api.github.com/users/10110346,https://github.com/10110346,https://api.github.com/users/10110346/followers,https://api.github.com/users/10110346/following{/other_user},https://api.github.com/users/10110346/gists{/gist_id},https://api.github.com/users/10110346/starred{/owner}{/repo},https://api.github.com/users/10110346/subscriptions,https://api.github.com/users/10110346/orgs,https://api.github.com/users/10110346/repos,https://api.github.com/users/10110346/events{/privacy},https://api.github.com/users/10110346/received_events,User,False,https://github.com/10110346/spark,Mirror of Apache Spark,True,https://api.github.com/repos/10110346/spark,https://api.github.com/repos/10110346/spark/forks,https://api.github.com/repos/10110346/spark/keys{/key_id},https://api.github.com/repos/10110346/spark/collaborators{/collaborator},https://api.github.com/repos/10110346/spark/teams,https://api.github.com/repos/10110346/spark/hooks,https://api.github.com/repos/10110346/spark/issues/events{/number},https://api.github.com/repos/10110346/spark/events,https://api.github.com/repos/10110346/spark/assignees{/user},https://api.github.com/repos/10110346/spark/branches{/branch},https://api.github.com/repos/10110346/spark/tags,https://api.github.com/repos/10110346/spark/git/blobs{/sha},https://api.github.com/repos/10110346/spark/git/tags{/sha},https://api.github.com/repos/10110346/spark/git/refs{/sha},https://api.github.com/repos/10110346/spark/git/trees{/sha},https://api.github.com/repos/10110346/spark/statuses/{sha},https://api.github.com/repos/10110346/spark/languages,https://api.github.com/repos/10110346/spark/stargazers,https://api.github.com/repos/10110346/spark/contributors,https://api.github.com/repos/10110346/spark/subscribers,https://api.github.com/repos/10110346/spark/subscription,https://api.github.com/repos/10110346/spark/commits{/sha},https://api.github.com/repos/10110346/spark/git/commits{/sha},https://api.github.com/repos/10110346/spark/comments{/number},https://api.github.com/repos/10110346/spark/issues/comments{/number},https://api.github.com/repos/10110346/spark/contents/{+path},https://api.github.com/repos/10110346/spark/compare/{base}...{head},https://api.github.com/repos/10110346/spark/merges,https://api.github.com/repos/10110346/spark/{archive_format}{/ref},https://api.github.com/repos/10110346/spark/downloads,https://api.github.com/repos/10110346/spark/issues{/number},https://api.github.com/repos/10110346/spark/pulls{/number},https://api.github.com/repos/10110346/spark/milestones{/number},"https://api.github.com/repos/10110346/spark/notifications{?since,all,participating}",https://api.github.com/repos/10110346/spark/labels{/name},https://api.github.com/repos/10110346/spark/releases{/id},https://api.github.com/repos/10110346/spark/deployments,2016-12-21T06:06:02Z,2018-07-31T06:45:30Z,2019-05-08T10:42:16Z,git://github.com/10110346/spark.git,git@github.com:10110346/spark.git,https://github.com/10110346/spark.git,https://github.com/10110346/spark,,289129,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1d95dea30788b9f64c5e304d908b85936aafb238,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/22163,https://github.com/apache/spark/pull/22163,https://api.github.com/repos/apache/spark/issues/22163,https://api.github.com/repos/apache/spark/issues/22163/comments,https://api.github.com/repos/apache/spark/pulls/22163/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/22163/commits,https://api.github.com/repos/apache/spark/statuses/6905d3b2580306bccac58c051c3c88058d37de32
249,https://api.github.com/repos/apache/spark/pulls/22038,207051349,MDExOlB1bGxSZXF1ZXN0MjA3MDUxMzQ5,https://github.com/apache/spark/pull/22038,https://github.com/apache/spark/pull/22038.diff,https://github.com/apache/spark/pull/22038.patch,https://api.github.com/repos/apache/spark/issues/22038,22038,open,False,[SPARK-25056][SQL] Unify the InConversion and BinaryComparison behavior,"## What changes were proposed in this pull request?
before this PR:
```scala
scala> val df = spark.range(4).toDF().selectExpr(""cast(id as decimal(9, 2)) as id"")
df: org.apache.spark.sql.DataFrame = [id: decimal(9,2)]

scala> df.filter(""id in('1', '3')"").show
+---+
| id|
+---+
+---+

scala> df.filter(""id = '1' or id ='3'"").show
+----+
|  id|
+----+
|1.00|
|3.00|
+----+
```
after this PR:
```scala
scala> val df = spark.range(4).toDF().selectExpr(""cast(id as decimal(9, 2)) as id"")
df: org.apache.spark.sql.DataFrame = [id: decimal(9,2)]

scala> df.filter(""id in('1', '3')"").show
+----+
|  id|
+----+
|1.00|
|3.00|
+----+

scala> df.filter(""id = '1' or id ='3'"").show
+----+
|  id|
+----+
|1.00|
|3.00|
+----+
```

This change is the same as [HIVE-20204](https://issues.apache.org/jira/browse/HIVE-20204).

Other database behavior:
**Teradata**:
![image](https://user-images.githubusercontent.com/5399861/44069251-778312cc-9fb0-11e8-8cf1-aa2e5f6b79d3.png)

**Oracle**:
![image](https://user-images.githubusercontent.com/5399861/44069285-95e2a1ec-9fb0-11e8-9266-c5b741cadea2.png)

**MySQL**:
![image](https://user-images.githubusercontent.com/5399861/44069455-72b73b14-9fb1-11e8-9d5c-9efcd9ce57b9.png)

**postgres**
![image](https://user-images.githubusercontent.com/5399861/44085135-316539ce-9feb-11e8-9966-495161a9e506.png)

**Hive-2.3.2**
![image](https://user-images.githubusercontent.com/5399861/44085463-39f19b9a-9fec-11e8-9cc4-ecb5dd3ed345.png)

**Hive** [**current master**](https://github.com/apache/hive/commit/1c8449cce2a961c6ca6ce38bef0d770f34221d4d)
![image](https://user-images.githubusercontent.com/5399861/44087788-86019128-9ff3-11e8-8e33-fe9a24a0361a.png)

**spark-sql**:
![image](https://user-images.githubusercontent.com/5399861/44069556-e95eb8b4-9fb1-11e8-8ad1-5c4c0582b5ae.png)

## How was this patch tested?

unit tests
",2018-08-08T15:39:32Z,2020-03-22T00:34:35Z,,,16e980133513c6d9d6fe54be29bcac368bc7bab2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/22038/commits,https://api.github.com/repos/apache/spark/pulls/22038/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/22038/comments,https://api.github.com/repos/apache/spark/statuses/e60ff29c91ea03f6498c3e63e83f8dcf86285470,MEMBER,spark,apache,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,wangyum:SPARK-25056,SPARK-25056,e60ff29c91ea03f6498c3e63e83f8dcf86285470,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,75173456,MDEwOlJlcG9zaXRvcnk3NTE3MzQ1Ng==,spark,wangyum/spark,False,wangyum,5399861,MDQ6VXNlcjUzOTk4NjE=,https://avatars0.githubusercontent.com/u/5399861?v=4,,https://api.github.com/users/wangyum,https://github.com/wangyum,https://api.github.com/users/wangyum/followers,https://api.github.com/users/wangyum/following{/other_user},https://api.github.com/users/wangyum/gists{/gist_id},https://api.github.com/users/wangyum/starred{/owner}{/repo},https://api.github.com/users/wangyum/subscriptions,https://api.github.com/users/wangyum/orgs,https://api.github.com/users/wangyum/repos,https://api.github.com/users/wangyum/events{/privacy},https://api.github.com/users/wangyum/received_events,User,False,https://github.com/wangyum/spark,Mirror of Apache Spark,True,https://api.github.com/repos/wangyum/spark,https://api.github.com/repos/wangyum/spark/forks,https://api.github.com/repos/wangyum/spark/keys{/key_id},https://api.github.com/repos/wangyum/spark/collaborators{/collaborator},https://api.github.com/repos/wangyum/spark/teams,https://api.github.com/repos/wangyum/spark/hooks,https://api.github.com/repos/wangyum/spark/issues/events{/number},https://api.github.com/repos/wangyum/spark/events,https://api.github.com/repos/wangyum/spark/assignees{/user},https://api.github.com/repos/wangyum/spark/branches{/branch},https://api.github.com/repos/wangyum/spark/tags,https://api.github.com/repos/wangyum/spark/git/blobs{/sha},https://api.github.com/repos/wangyum/spark/git/tags{/sha},https://api.github.com/repos/wangyum/spark/git/refs{/sha},https://api.github.com/repos/wangyum/spark/git/trees{/sha},https://api.github.com/repos/wangyum/spark/statuses/{sha},https://api.github.com/repos/wangyum/spark/languages,https://api.github.com/repos/wangyum/spark/stargazers,https://api.github.com/repos/wangyum/spark/contributors,https://api.github.com/repos/wangyum/spark/subscribers,https://api.github.com/repos/wangyum/spark/subscription,https://api.github.com/repos/wangyum/spark/commits{/sha},https://api.github.com/repos/wangyum/spark/git/commits{/sha},https://api.github.com/repos/wangyum/spark/comments{/number},https://api.github.com/repos/wangyum/spark/issues/comments{/number},https://api.github.com/repos/wangyum/spark/contents/{+path},https://api.github.com/repos/wangyum/spark/compare/{base}...{head},https://api.github.com/repos/wangyum/spark/merges,https://api.github.com/repos/wangyum/spark/{archive_format}{/ref},https://api.github.com/repos/wangyum/spark/downloads,https://api.github.com/repos/wangyum/spark/issues{/number},https://api.github.com/repos/wangyum/spark/pulls{/number},https://api.github.com/repos/wangyum/spark/milestones{/number},"https://api.github.com/repos/wangyum/spark/notifications{?since,all,participating}",https://api.github.com/repos/wangyum/spark/labels{/name},https://api.github.com/repos/wangyum/spark/releases{/id},https://api.github.com/repos/wangyum/spark/deployments,2016-11-30T09:49:08Z,2019-11-04T12:14:48Z,2020-04-09T15:02:00Z,git://github.com/wangyum/spark.git,git@github.com:wangyum/spark.git,https://github.com/wangyum/spark.git,https://github.com/wangyum/spark,,330421,1,1,Scala,True,True,True,False,False,2,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,2,0,1,master,apache:master,master,fae981e5f32e0ddb86591a616829423dfafb4ed0,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/22038,https://github.com/apache/spark/pull/22038,https://api.github.com/repos/apache/spark/issues/22038,https://api.github.com/repos/apache/spark/issues/22038/comments,https://api.github.com/repos/apache/spark/pulls/22038/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/22038/commits,https://api.github.com/repos/apache/spark/statuses/e60ff29c91ea03f6498c3e63e83f8dcf86285470
250,https://api.github.com/repos/apache/spark/pulls/21685,198504773,MDExOlB1bGxSZXF1ZXN0MTk4NTA0Nzcz,https://github.com/apache/spark/pull/21685,https://github.com/apache/spark/pull/21685.diff,https://github.com/apache/spark/pull/21685.patch,https://api.github.com/repos/apache/spark/issues/21685,21685,open,False,[SPARK-24707][DSTREAMS] Enable spark-kafka-streaming to maintain min …,"…buffer using async thread to avoid blocking kafka poll

## What changes were proposed in this pull request?

Currently Spark Kafka RDD will block on kafka consumer poll. Specially in Spark-Kafka-streaming job this poll duration adds into batch processing time which result in 
	* Increased batch processing time (which is apart from time taken to process records)
	* Results in unpredictable batch processing time based on poll time.

This PR consists of changes to maintain min records in buffer, so that streaming batches processing do not have to get blocked on kafka poll.

## How was this patch tested?

Unit test / manual test.
[Before_change.pdf](https://github.com/apache/spark/files/2152353/Before_change.pdf)
[After_change_2000_buffer_per_part.pdf](https://github.com/apache/spark/files/2152354/After_change_2000_buffer_per_part.pdf)
",2018-07-01T03:08:39Z,2020-02-20T09:11:06Z,,,af476266f94d8f73d29a5bce199edb97b66df670,,[],[],[],"[{'id': 1406587334, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzM0', 'url': 'https://api.github.com/repos/apache/spark/labels/DSTREAMS', 'name': 'DSTREAMS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/21685/commits,https://api.github.com/repos/apache/spark/pulls/21685/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/21685/comments,https://api.github.com/repos/apache/spark/statuses/ab181a57b094bc8085e9f310880e1e6bc82c6327,NONE,spark,apache,sidhavratha,2279976,MDQ6VXNlcjIyNzk5NzY=,https://avatars2.githubusercontent.com/u/2279976?v=4,,https://api.github.com/users/sidhavratha,https://github.com/sidhavratha,https://api.github.com/users/sidhavratha/followers,https://api.github.com/users/sidhavratha/following{/other_user},https://api.github.com/users/sidhavratha/gists{/gist_id},https://api.github.com/users/sidhavratha/starred{/owner}{/repo},https://api.github.com/users/sidhavratha/subscriptions,https://api.github.com/users/sidhavratha/orgs,https://api.github.com/users/sidhavratha/repos,https://api.github.com/users/sidhavratha/events{/privacy},https://api.github.com/users/sidhavratha/received_events,User,False,sidhavratha:master,master,ab181a57b094bc8085e9f310880e1e6bc82c6327,sidhavratha,2279976,MDQ6VXNlcjIyNzk5NzY=,https://avatars2.githubusercontent.com/u/2279976?v=4,,https://api.github.com/users/sidhavratha,https://github.com/sidhavratha,https://api.github.com/users/sidhavratha/followers,https://api.github.com/users/sidhavratha/following{/other_user},https://api.github.com/users/sidhavratha/gists{/gist_id},https://api.github.com/users/sidhavratha/starred{/owner}{/repo},https://api.github.com/users/sidhavratha/subscriptions,https://api.github.com/users/sidhavratha/orgs,https://api.github.com/users/sidhavratha/repos,https://api.github.com/users/sidhavratha/events{/privacy},https://api.github.com/users/sidhavratha/received_events,User,False,139294405,MDEwOlJlcG9zaXRvcnkxMzkyOTQ0MDU=,spark,sidhavratha/spark,False,sidhavratha,2279976,MDQ6VXNlcjIyNzk5NzY=,https://avatars2.githubusercontent.com/u/2279976?v=4,,https://api.github.com/users/sidhavratha,https://github.com/sidhavratha,https://api.github.com/users/sidhavratha/followers,https://api.github.com/users/sidhavratha/following{/other_user},https://api.github.com/users/sidhavratha/gists{/gist_id},https://api.github.com/users/sidhavratha/starred{/owner}{/repo},https://api.github.com/users/sidhavratha/subscriptions,https://api.github.com/users/sidhavratha/orgs,https://api.github.com/users/sidhavratha/repos,https://api.github.com/users/sidhavratha/events{/privacy},https://api.github.com/users/sidhavratha/received_events,User,False,https://github.com/sidhavratha/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sidhavratha/spark,https://api.github.com/repos/sidhavratha/spark/forks,https://api.github.com/repos/sidhavratha/spark/keys{/key_id},https://api.github.com/repos/sidhavratha/spark/collaborators{/collaborator},https://api.github.com/repos/sidhavratha/spark/teams,https://api.github.com/repos/sidhavratha/spark/hooks,https://api.github.com/repos/sidhavratha/spark/issues/events{/number},https://api.github.com/repos/sidhavratha/spark/events,https://api.github.com/repos/sidhavratha/spark/assignees{/user},https://api.github.com/repos/sidhavratha/spark/branches{/branch},https://api.github.com/repos/sidhavratha/spark/tags,https://api.github.com/repos/sidhavratha/spark/git/blobs{/sha},https://api.github.com/repos/sidhavratha/spark/git/tags{/sha},https://api.github.com/repos/sidhavratha/spark/git/refs{/sha},https://api.github.com/repos/sidhavratha/spark/git/trees{/sha},https://api.github.com/repos/sidhavratha/spark/statuses/{sha},https://api.github.com/repos/sidhavratha/spark/languages,https://api.github.com/repos/sidhavratha/spark/stargazers,https://api.github.com/repos/sidhavratha/spark/contributors,https://api.github.com/repos/sidhavratha/spark/subscribers,https://api.github.com/repos/sidhavratha/spark/subscription,https://api.github.com/repos/sidhavratha/spark/commits{/sha},https://api.github.com/repos/sidhavratha/spark/git/commits{/sha},https://api.github.com/repos/sidhavratha/spark/comments{/number},https://api.github.com/repos/sidhavratha/spark/issues/comments{/number},https://api.github.com/repos/sidhavratha/spark/contents/{+path},https://api.github.com/repos/sidhavratha/spark/compare/{base}...{head},https://api.github.com/repos/sidhavratha/spark/merges,https://api.github.com/repos/sidhavratha/spark/{archive_format}{/ref},https://api.github.com/repos/sidhavratha/spark/downloads,https://api.github.com/repos/sidhavratha/spark/issues{/number},https://api.github.com/repos/sidhavratha/spark/pulls{/number},https://api.github.com/repos/sidhavratha/spark/milestones{/number},"https://api.github.com/repos/sidhavratha/spark/notifications{?since,all,participating}",https://api.github.com/repos/sidhavratha/spark/labels{/name},https://api.github.com/repos/sidhavratha/spark/releases{/id},https://api.github.com/repos/sidhavratha/spark/deployments,2018-07-01T02:24:30Z,2018-08-03T19:08:18Z,2018-08-10T05:52:02Z,git://github.com/sidhavratha/spark.git,git@github.com:sidhavratha/spark.git,https://github.com/sidhavratha/spark.git,https://github.com/sidhavratha/spark,,278306,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,c32dbd6bd55cdff4d73408ba5fd6fe18056048fe,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/21685,https://github.com/apache/spark/pull/21685,https://api.github.com/repos/apache/spark/issues/21685,https://api.github.com/repos/apache/spark/issues/21685/comments,https://api.github.com/repos/apache/spark/pulls/21685/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/21685/commits,https://api.github.com/repos/apache/spark/statuses/ab181a57b094bc8085e9f310880e1e6bc82c6327
251,https://api.github.com/repos/apache/spark/pulls/21286,187084562,MDExOlB1bGxSZXF1ZXN0MTg3MDg0NTYy,https://github.com/apache/spark/pull/21286,https://github.com/apache/spark/pull/21286.diff,https://github.com/apache/spark/pull/21286.patch,https://api.github.com/repos/apache/spark/issues/21286,21286,open,False,[SPARK-24238][SQL] HadoopFsRelation can't append the same table with multi job at the same time,"## What changes were proposed in this pull request?

When there are multiple jobs at the same time append a `HadoopFsRelation`, there will be an error, there are the following two errors: 

1. A job will succeed, but the data will be wrong and more data than excepted will appear
2. Other jobs will fail with `java.io.FileNotFoundException: Failed to get file status skip_dir/_temporary/0`

The main reason for this problem is because multiple job will use the same `_temporary` directory.

So the core idea of this `PR` is to create a different temporary directory with jobId for the different Job in the `output` folder , so that conflicts can be avoided.

## How was this patch tested?

I manually tested. 
",2018-05-10T02:15:16Z,2020-02-20T16:16:06Z,,,4b806c5017cec09b9de16c93435df14862f9a2bb,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/21286/commits,https://api.github.com/repos/apache/spark/pulls/21286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/21286/comments,https://api.github.com/repos/apache/spark/statuses/49532fe871278473dd18807efdc7fac68e0c0b26,NONE,spark,apache,zheh12,2442257,MDQ6VXNlcjI0NDIyNTc=,https://avatars3.githubusercontent.com/u/2442257?v=4,,https://api.github.com/users/zheh12,https://github.com/zheh12,https://api.github.com/users/zheh12/followers,https://api.github.com/users/zheh12/following{/other_user},https://api.github.com/users/zheh12/gists{/gist_id},https://api.github.com/users/zheh12/starred{/owner}{/repo},https://api.github.com/users/zheh12/subscriptions,https://api.github.com/users/zheh12/orgs,https://api.github.com/users/zheh12/repos,https://api.github.com/users/zheh12/events{/privacy},https://api.github.com/users/zheh12/received_events,User,False,zheh12:SPARK-24238,SPARK-24238,49532fe871278473dd18807efdc7fac68e0c0b26,zheh12,2442257,MDQ6VXNlcjI0NDIyNTc=,https://avatars3.githubusercontent.com/u/2442257?v=4,,https://api.github.com/users/zheh12,https://github.com/zheh12,https://api.github.com/users/zheh12/followers,https://api.github.com/users/zheh12/following{/other_user},https://api.github.com/users/zheh12/gists{/gist_id},https://api.github.com/users/zheh12/starred{/owner}{/repo},https://api.github.com/users/zheh12/subscriptions,https://api.github.com/users/zheh12/orgs,https://api.github.com/users/zheh12/repos,https://api.github.com/users/zheh12/events{/privacy},https://api.github.com/users/zheh12/received_events,User,False,132403805,MDEwOlJlcG9zaXRvcnkxMzI0MDM4MDU=,spark,zheh12/spark,False,zheh12,2442257,MDQ6VXNlcjI0NDIyNTc=,https://avatars3.githubusercontent.com/u/2442257?v=4,,https://api.github.com/users/zheh12,https://github.com/zheh12,https://api.github.com/users/zheh12/followers,https://api.github.com/users/zheh12/following{/other_user},https://api.github.com/users/zheh12/gists{/gist_id},https://api.github.com/users/zheh12/starred{/owner}{/repo},https://api.github.com/users/zheh12/subscriptions,https://api.github.com/users/zheh12/orgs,https://api.github.com/users/zheh12/repos,https://api.github.com/users/zheh12/events{/privacy},https://api.github.com/users/zheh12/received_events,User,False,https://github.com/zheh12/spark,Mirror of Apache Spark,True,https://api.github.com/repos/zheh12/spark,https://api.github.com/repos/zheh12/spark/forks,https://api.github.com/repos/zheh12/spark/keys{/key_id},https://api.github.com/repos/zheh12/spark/collaborators{/collaborator},https://api.github.com/repos/zheh12/spark/teams,https://api.github.com/repos/zheh12/spark/hooks,https://api.github.com/repos/zheh12/spark/issues/events{/number},https://api.github.com/repos/zheh12/spark/events,https://api.github.com/repos/zheh12/spark/assignees{/user},https://api.github.com/repos/zheh12/spark/branches{/branch},https://api.github.com/repos/zheh12/spark/tags,https://api.github.com/repos/zheh12/spark/git/blobs{/sha},https://api.github.com/repos/zheh12/spark/git/tags{/sha},https://api.github.com/repos/zheh12/spark/git/refs{/sha},https://api.github.com/repos/zheh12/spark/git/trees{/sha},https://api.github.com/repos/zheh12/spark/statuses/{sha},https://api.github.com/repos/zheh12/spark/languages,https://api.github.com/repos/zheh12/spark/stargazers,https://api.github.com/repos/zheh12/spark/contributors,https://api.github.com/repos/zheh12/spark/subscribers,https://api.github.com/repos/zheh12/spark/subscription,https://api.github.com/repos/zheh12/spark/commits{/sha},https://api.github.com/repos/zheh12/spark/git/commits{/sha},https://api.github.com/repos/zheh12/spark/comments{/number},https://api.github.com/repos/zheh12/spark/issues/comments{/number},https://api.github.com/repos/zheh12/spark/contents/{+path},https://api.github.com/repos/zheh12/spark/compare/{base}...{head},https://api.github.com/repos/zheh12/spark/merges,https://api.github.com/repos/zheh12/spark/{archive_format}{/ref},https://api.github.com/repos/zheh12/spark/downloads,https://api.github.com/repos/zheh12/spark/issues{/number},https://api.github.com/repos/zheh12/spark/pulls{/number},https://api.github.com/repos/zheh12/spark/milestones{/number},"https://api.github.com/repos/zheh12/spark/notifications{?since,all,participating}",https://api.github.com/repos/zheh12/spark/labels{/name},https://api.github.com/repos/zheh12/spark/releases{/id},https://api.github.com/repos/zheh12/spark/deployments,2018-05-07T03:45:35Z,2018-05-07T03:46:00Z,2018-06-21T08:04:24Z,git://github.com/zheh12/spark.git,git@github.com:zheh12/spark.git,https://github.com/zheh12/spark.git,https://github.com/zheh12/spark,,271524,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,434d74e337465d77fa49ab65e2b5461e5ff7b5c7,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/21286,https://github.com/apache/spark/pull/21286,https://api.github.com/repos/apache/spark/issues/21286,https://api.github.com/repos/apache/spark/issues/21286/comments,https://api.github.com/repos/apache/spark/pulls/21286/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/21286/commits,https://api.github.com/repos/apache/spark/statuses/49532fe871278473dd18807efdc7fac68e0c0b26
252,https://api.github.com/repos/apache/spark/pulls/20826,175079342,MDExOlB1bGxSZXF1ZXN0MTc1MDc5MzQy,https://github.com/apache/spark/pull/20826,https://github.com/apache/spark/pull/20826.diff,https://github.com/apache/spark/pull/20826.patch,https://api.github.com/repos/apache/spark/issues/20826,20826,open,False,[SPARK-2489][SQL] Support Parquet's optional fixed_len_byte_array,"## What changes were proposed in this pull request?
This PR adds support for reading Parquet FIXED_LENGTH_BYTE_ARRAYs as a Binary column if no OriginalType is specified. Parquet-avro writes the Avro fixed type as a Parquet FIXED_LENGTH_BYTE_ARRAY type. Currently when trying to load Parquet files with a column of this type with Spark SQL it throws an exception similar to the following:

```
Caused by: org.apache.spark.sql.AnalysisException: Illegal Parquet type: FIXED_LEN_BYTE_ARRAY;
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter.illegalType$1(ParquetSchemaConverter.scala:108)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter.convertPrimitiveField(ParquetSchemaConverter.scala:177)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter.convertField(ParquetSchemaConverter.scala:90)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter$$anonfun$2.apply(ParquetSchemaConverter.scala:72)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter$$anonfun$2.apply(ParquetSchemaConverter.scala:66)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)
	at scala.collection.Iterator$class.foreach(Iterator.scala:893)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1336)
	at scala.collection.IterableLike$class.foreach(IterableLike.scala:72)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:234)
	at scala.collection.AbstractTraversable.map(Traversable.scala:104)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter.org$apache$spark$sql$execution$datasources$parquet$ParquetToSparkSchemaConverter$$convert(ParquetSchemaConverter.scala:66)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetToSparkSchemaConverter.convert(ParquetSchemaConverter.scala:63)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$readSchemaFromFooter$2.apply(ParquetFileFormat.scala:642)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$readSchemaFromFooter$2.apply(ParquetFileFormat.scala:642)
	at scala.Option.getOrElse(Option.scala:121)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.readSchemaFromFooter(ParquetFileFormat.scala:642)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$9.apply(ParquetFileFormat.scala:599)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$9.apply(ParquetFileFormat.scala:581)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)
	at org.apache.spark.scheduler.Task.run(Task.scala:109)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```

After this change Spark SQL is able to correctly load the Parquet files. There was a PR to fix this 3 years ago (https://github.com/apache/spark/pull/1737) however it was ultimately rejected as the committer went down the path of adding a new SQL Type specifically for FIXED_LENGTH_BYTE_ARRAYs and the maintainers believed this was too intrusive of a change. This PR simply defaults to Binary if no OriginalType is specified. A few updates were required to the VectorizedColumnReader to support Binary FIXED_LENGTH_BYTE_ARRAYs.

Note: All the changes to the gen-java/* files were generated by avro-tools-1.8.1 and the mostly documentation updates look to come from changes in the template avro-tools uses.

## How was this patch tested?

I added a fixed attribute to the AvroPrimitives and AvroOptionalPrimitives record types which are used by the ParquetAvroCompatibilitySuite. These values were populated by taking the same value as other type (""val_$i""), padding it to 8 bytes (the chosen fixed length), and storing it as the fixed type. I verified that before my fix the ""required primitives"" and ""optional primitives"" failed with the same exception we're seeing in our clusters. After my change the tests succeed with the expected results.
",2018-03-14T20:43:30Z,2020-02-05T18:11:03Z,,,7bf110f5af67f4f902eedfe3ba5cab5019c815b2,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/20826/commits,https://api.github.com/repos/apache/spark/pulls/20826/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/20826/comments,https://api.github.com/repos/apache/spark/statuses/27ac6af30cde9cd596929ab8fd076c9b41287384,NONE,spark,apache,aws-awinstan,30934849,MDQ6VXNlcjMwOTM0ODQ5,https://avatars1.githubusercontent.com/u/30934849?v=4,,https://api.github.com/users/aws-awinstan,https://github.com/aws-awinstan,https://api.github.com/users/aws-awinstan/followers,https://api.github.com/users/aws-awinstan/following{/other_user},https://api.github.com/users/aws-awinstan/gists{/gist_id},https://api.github.com/users/aws-awinstan/starred{/owner}{/repo},https://api.github.com/users/aws-awinstan/subscriptions,https://api.github.com/users/aws-awinstan/orgs,https://api.github.com/users/aws-awinstan/repos,https://api.github.com/users/aws-awinstan/events{/privacy},https://api.github.com/users/aws-awinstan/received_events,User,False,aws-awinstan:master,master,27ac6af30cde9cd596929ab8fd076c9b41287384,aws-awinstan,30934849,MDQ6VXNlcjMwOTM0ODQ5,https://avatars1.githubusercontent.com/u/30934849?v=4,,https://api.github.com/users/aws-awinstan,https://github.com/aws-awinstan,https://api.github.com/users/aws-awinstan/followers,https://api.github.com/users/aws-awinstan/following{/other_user},https://api.github.com/users/aws-awinstan/gists{/gist_id},https://api.github.com/users/aws-awinstan/starred{/owner}{/repo},https://api.github.com/users/aws-awinstan/subscriptions,https://api.github.com/users/aws-awinstan/orgs,https://api.github.com/users/aws-awinstan/repos,https://api.github.com/users/aws-awinstan/events{/privacy},https://api.github.com/users/aws-awinstan/received_events,User,False,125093023,MDEwOlJlcG9zaXRvcnkxMjUwOTMwMjM=,spark,aws-awinstan/spark,False,aws-awinstan,30934849,MDQ6VXNlcjMwOTM0ODQ5,https://avatars1.githubusercontent.com/u/30934849?v=4,,https://api.github.com/users/aws-awinstan,https://github.com/aws-awinstan,https://api.github.com/users/aws-awinstan/followers,https://api.github.com/users/aws-awinstan/following{/other_user},https://api.github.com/users/aws-awinstan/gists{/gist_id},https://api.github.com/users/aws-awinstan/starred{/owner}{/repo},https://api.github.com/users/aws-awinstan/subscriptions,https://api.github.com/users/aws-awinstan/orgs,https://api.github.com/users/aws-awinstan/repos,https://api.github.com/users/aws-awinstan/events{/privacy},https://api.github.com/users/aws-awinstan/received_events,User,False,https://github.com/aws-awinstan/spark,Mirror of Apache Spark,True,https://api.github.com/repos/aws-awinstan/spark,https://api.github.com/repos/aws-awinstan/spark/forks,https://api.github.com/repos/aws-awinstan/spark/keys{/key_id},https://api.github.com/repos/aws-awinstan/spark/collaborators{/collaborator},https://api.github.com/repos/aws-awinstan/spark/teams,https://api.github.com/repos/aws-awinstan/spark/hooks,https://api.github.com/repos/aws-awinstan/spark/issues/events{/number},https://api.github.com/repos/aws-awinstan/spark/events,https://api.github.com/repos/aws-awinstan/spark/assignees{/user},https://api.github.com/repos/aws-awinstan/spark/branches{/branch},https://api.github.com/repos/aws-awinstan/spark/tags,https://api.github.com/repos/aws-awinstan/spark/git/blobs{/sha},https://api.github.com/repos/aws-awinstan/spark/git/tags{/sha},https://api.github.com/repos/aws-awinstan/spark/git/refs{/sha},https://api.github.com/repos/aws-awinstan/spark/git/trees{/sha},https://api.github.com/repos/aws-awinstan/spark/statuses/{sha},https://api.github.com/repos/aws-awinstan/spark/languages,https://api.github.com/repos/aws-awinstan/spark/stargazers,https://api.github.com/repos/aws-awinstan/spark/contributors,https://api.github.com/repos/aws-awinstan/spark/subscribers,https://api.github.com/repos/aws-awinstan/spark/subscription,https://api.github.com/repos/aws-awinstan/spark/commits{/sha},https://api.github.com/repos/aws-awinstan/spark/git/commits{/sha},https://api.github.com/repos/aws-awinstan/spark/comments{/number},https://api.github.com/repos/aws-awinstan/spark/issues/comments{/number},https://api.github.com/repos/aws-awinstan/spark/contents/{+path},https://api.github.com/repos/aws-awinstan/spark/compare/{base}...{head},https://api.github.com/repos/aws-awinstan/spark/merges,https://api.github.com/repos/aws-awinstan/spark/{archive_format}{/ref},https://api.github.com/repos/aws-awinstan/spark/downloads,https://api.github.com/repos/aws-awinstan/spark/issues{/number},https://api.github.com/repos/aws-awinstan/spark/pulls{/number},https://api.github.com/repos/aws-awinstan/spark/milestones{/number},"https://api.github.com/repos/aws-awinstan/spark/notifications{?since,all,participating}",https://api.github.com/repos/aws-awinstan/spark/labels{/name},https://api.github.com/repos/aws-awinstan/spark/releases{/id},https://api.github.com/repos/aws-awinstan/spark/deployments,2018-03-13T17:56:33Z,2018-03-15T15:10:29Z,2018-03-15T15:10:26Z,git://github.com/aws-awinstan/spark.git,git@github.com:aws-awinstan/spark.git,https://github.com/aws-awinstan/spark.git,https://github.com/aws-awinstan/spark,,269409,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1098933b0ac5cdb18101d3aebefa773c2ce05a50,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/20826,https://github.com/apache/spark/pull/20826,https://api.github.com/repos/apache/spark/issues/20826,https://api.github.com/repos/apache/spark/issues/20826/comments,https://api.github.com/repos/apache/spark/pulls/20826/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/20826/commits,https://api.github.com/repos/apache/spark/statuses/27ac6af30cde9cd596929ab8fd076c9b41287384
253,https://api.github.com/repos/apache/spark/pulls/20665,171080440,MDExOlB1bGxSZXF1ZXN0MTcxMDgwNDQw,https://github.com/apache/spark/pull/20665,https://github.com/apache/spark/pull/20665.diff,https://github.com/apache/spark/pull/20665.patch,https://api.github.com/repos/apache/spark/issues/20665,20665,open,False,[SPARK-23499][MESOS] Support for priority queues in Mesos scheduler,"As for Yarn, Mesos users should be able to specify priority queues to define a workload management policy for queued drivers in the Mesos Cluster Dispatcher.

## What changes were proposed in this pull request?
This commit introduces the necessary changes to manage such priority queues.

## How was this patch tested?
unit tests
",2018-02-23T18:09:15Z,2020-01-02T18:06:05Z,,,89550273838971ff1af39ff87346acc1bbb18f2f,,[],[],[],"[{'id': 1406625202, 'node_id': 'MDU6TGFiZWwxNDA2NjI1MjAy', 'url': 'https://api.github.com/repos/apache/spark/labels/MESOS', 'name': 'MESOS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/20665/commits,https://api.github.com/repos/apache/spark/pulls/20665/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/20665/comments,https://api.github.com/repos/apache/spark/statuses/67d82bd903d39fe9b12421536da69e6a011580cf,NONE,spark,apache,pgillet,2465217,MDQ6VXNlcjI0NjUyMTc=,https://avatars2.githubusercontent.com/u/2465217?v=4,,https://api.github.com/users/pgillet,https://github.com/pgillet,https://api.github.com/users/pgillet/followers,https://api.github.com/users/pgillet/following{/other_user},https://api.github.com/users/pgillet/gists{/gist_id},https://api.github.com/users/pgillet/starred{/owner}{/repo},https://api.github.com/users/pgillet/subscriptions,https://api.github.com/users/pgillet/orgs,https://api.github.com/users/pgillet/repos,https://api.github.com/users/pgillet/events{/privacy},https://api.github.com/users/pgillet/received_events,User,False,pgillet:mesos-scheduler-priority-queue,mesos-scheduler-priority-queue,67d82bd903d39fe9b12421536da69e6a011580cf,pgillet,2465217,MDQ6VXNlcjI0NjUyMTc=,https://avatars2.githubusercontent.com/u/2465217?v=4,,https://api.github.com/users/pgillet,https://github.com/pgillet,https://api.github.com/users/pgillet/followers,https://api.github.com/users/pgillet/following{/other_user},https://api.github.com/users/pgillet/gists{/gist_id},https://api.github.com/users/pgillet/starred{/owner}{/repo},https://api.github.com/users/pgillet/subscriptions,https://api.github.com/users/pgillet/orgs,https://api.github.com/users/pgillet/repos,https://api.github.com/users/pgillet/events{/privacy},https://api.github.com/users/pgillet/received_events,User,False,121529393,MDEwOlJlcG9zaXRvcnkxMjE1MjkzOTM=,spark,pgillet/spark,False,pgillet,2465217,MDQ6VXNlcjI0NjUyMTc=,https://avatars2.githubusercontent.com/u/2465217?v=4,,https://api.github.com/users/pgillet,https://github.com/pgillet,https://api.github.com/users/pgillet/followers,https://api.github.com/users/pgillet/following{/other_user},https://api.github.com/users/pgillet/gists{/gist_id},https://api.github.com/users/pgillet/starred{/owner}{/repo},https://api.github.com/users/pgillet/subscriptions,https://api.github.com/users/pgillet/orgs,https://api.github.com/users/pgillet/repos,https://api.github.com/users/pgillet/events{/privacy},https://api.github.com/users/pgillet/received_events,User,False,https://github.com/pgillet/spark,Mirror of Apache Spark,True,https://api.github.com/repos/pgillet/spark,https://api.github.com/repos/pgillet/spark/forks,https://api.github.com/repos/pgillet/spark/keys{/key_id},https://api.github.com/repos/pgillet/spark/collaborators{/collaborator},https://api.github.com/repos/pgillet/spark/teams,https://api.github.com/repos/pgillet/spark/hooks,https://api.github.com/repos/pgillet/spark/issues/events{/number},https://api.github.com/repos/pgillet/spark/events,https://api.github.com/repos/pgillet/spark/assignees{/user},https://api.github.com/repos/pgillet/spark/branches{/branch},https://api.github.com/repos/pgillet/spark/tags,https://api.github.com/repos/pgillet/spark/git/blobs{/sha},https://api.github.com/repos/pgillet/spark/git/tags{/sha},https://api.github.com/repos/pgillet/spark/git/refs{/sha},https://api.github.com/repos/pgillet/spark/git/trees{/sha},https://api.github.com/repos/pgillet/spark/statuses/{sha},https://api.github.com/repos/pgillet/spark/languages,https://api.github.com/repos/pgillet/spark/stargazers,https://api.github.com/repos/pgillet/spark/contributors,https://api.github.com/repos/pgillet/spark/subscribers,https://api.github.com/repos/pgillet/spark/subscription,https://api.github.com/repos/pgillet/spark/commits{/sha},https://api.github.com/repos/pgillet/spark/git/commits{/sha},https://api.github.com/repos/pgillet/spark/comments{/number},https://api.github.com/repos/pgillet/spark/issues/comments{/number},https://api.github.com/repos/pgillet/spark/contents/{+path},https://api.github.com/repos/pgillet/spark/compare/{base}...{head},https://api.github.com/repos/pgillet/spark/merges,https://api.github.com/repos/pgillet/spark/{archive_format}{/ref},https://api.github.com/repos/pgillet/spark/downloads,https://api.github.com/repos/pgillet/spark/issues{/number},https://api.github.com/repos/pgillet/spark/pulls{/number},https://api.github.com/repos/pgillet/spark/milestones{/number},"https://api.github.com/repos/pgillet/spark/notifications{?since,all,participating}",https://api.github.com/repos/pgillet/spark/labels{/name},https://api.github.com/repos/pgillet/spark/releases{/id},https://api.github.com/repos/pgillet/spark/deployments,2018-02-14T15:53:47Z,2018-02-14T15:54:15Z,2018-02-23T16:36:34Z,git://github.com/pgillet/spark.git,git@github.com:pgillet/spark.git,https://github.com/pgillet/spark.git,https://github.com/pgillet/spark,,267848,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,049f243c59737699fee54fdc9d65cbd7c788032a,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/20665,https://github.com/apache/spark/pull/20665,https://api.github.com/repos/apache/spark/issues/20665,https://api.github.com/repos/apache/spark/issues/20665/comments,https://api.github.com/repos/apache/spark/pulls/20665/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/20665/commits,https://api.github.com/repos/apache/spark/statuses/67d82bd903d39fe9b12421536da69e6a011580cf
254,https://api.github.com/repos/apache/spark/pulls/20478,166592253,MDExOlB1bGxSZXF1ZXN0MTY2NTkyMjUz,https://github.com/apache/spark/pull/20478,https://github.com/apache/spark/pull/20478.diff,https://github.com/apache/spark/pull/20478.patch,https://api.github.com/repos/apache/spark/issues/20478,20478,open,False, [SPARK-8835][Streaming] Provide pluggable Congestion Strategies for Receiver-based Streams. Take 2 / Spark 2.X merge,"## What changes were proposed in this pull request?

Looks like the [PR](https://github.com/apache/spark/pull/9200) for this ([SPARK-8835](https://issues.apache.org/jira/browse/SPARK-8835)) got dropped quite some time ago, due to build failures. I've merged up to the current master and am re-submitting it (to be clear, I am not the original author).

## How was this patch tested?
Built and tested locally.",2018-02-01T16:49:44Z,2020-04-09T21:28:29Z,,,720778e5a07177c7414d9d5d5e5928b8954eba3d,,[],[],[],"[{'id': 1406587334, 'node_id': 'MDU6TGFiZWwxNDA2NTg3MzM0', 'url': 'https://api.github.com/repos/apache/spark/labels/DSTREAMS', 'name': 'DSTREAMS', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/20478/commits,https://api.github.com/repos/apache/spark/pulls/20478/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/20478/comments,https://api.github.com/repos/apache/spark/statuses/a9517a98ede7ba0829fb0a70ef16420bd5899038,MEMBER,spark,apache,EmergentOrder,415599,MDQ6VXNlcjQxNTU5OQ==,https://avatars0.githubusercontent.com/u/415599?v=4,,https://api.github.com/users/EmergentOrder,https://github.com/EmergentOrder,https://api.github.com/users/EmergentOrder/followers,https://api.github.com/users/EmergentOrder/following{/other_user},https://api.github.com/users/EmergentOrder/gists{/gist_id},https://api.github.com/users/EmergentOrder/starred{/owner}{/repo},https://api.github.com/users/EmergentOrder/subscriptions,https://api.github.com/users/EmergentOrder/orgs,https://api.github.com/users/EmergentOrder/repos,https://api.github.com/users/EmergentOrder/events{/privacy},https://api.github.com/users/EmergentOrder/received_events,User,False,EmergentOrder:feature/CongestionStrategiesTake2,feature/CongestionStrategiesTake2,a9517a98ede7ba0829fb0a70ef16420bd5899038,EmergentOrder,415599,MDQ6VXNlcjQxNTU5OQ==,https://avatars0.githubusercontent.com/u/415599?v=4,,https://api.github.com/users/EmergentOrder,https://github.com/EmergentOrder,https://api.github.com/users/EmergentOrder/followers,https://api.github.com/users/EmergentOrder/following{/other_user},https://api.github.com/users/EmergentOrder/gists{/gist_id},https://api.github.com/users/EmergentOrder/starred{/owner}{/repo},https://api.github.com/users/EmergentOrder/subscriptions,https://api.github.com/users/EmergentOrder/orgs,https://api.github.com/users/EmergentOrder/repos,https://api.github.com/users/EmergentOrder/events{/privacy},https://api.github.com/users/EmergentOrder/received_events,User,False,119862662,MDEwOlJlcG9zaXRvcnkxMTk4NjI2NjI=,spark,EmergentOrder/spark,False,EmergentOrder,415599,MDQ6VXNlcjQxNTU5OQ==,https://avatars0.githubusercontent.com/u/415599?v=4,,https://api.github.com/users/EmergentOrder,https://github.com/EmergentOrder,https://api.github.com/users/EmergentOrder/followers,https://api.github.com/users/EmergentOrder/following{/other_user},https://api.github.com/users/EmergentOrder/gists{/gist_id},https://api.github.com/users/EmergentOrder/starred{/owner}{/repo},https://api.github.com/users/EmergentOrder/subscriptions,https://api.github.com/users/EmergentOrder/orgs,https://api.github.com/users/EmergentOrder/repos,https://api.github.com/users/EmergentOrder/events{/privacy},https://api.github.com/users/EmergentOrder/received_events,User,False,https://github.com/EmergentOrder/spark,Mirror of Apache Spark,True,https://api.github.com/repos/EmergentOrder/spark,https://api.github.com/repos/EmergentOrder/spark/forks,https://api.github.com/repos/EmergentOrder/spark/keys{/key_id},https://api.github.com/repos/EmergentOrder/spark/collaborators{/collaborator},https://api.github.com/repos/EmergentOrder/spark/teams,https://api.github.com/repos/EmergentOrder/spark/hooks,https://api.github.com/repos/EmergentOrder/spark/issues/events{/number},https://api.github.com/repos/EmergentOrder/spark/events,https://api.github.com/repos/EmergentOrder/spark/assignees{/user},https://api.github.com/repos/EmergentOrder/spark/branches{/branch},https://api.github.com/repos/EmergentOrder/spark/tags,https://api.github.com/repos/EmergentOrder/spark/git/blobs{/sha},https://api.github.com/repos/EmergentOrder/spark/git/tags{/sha},https://api.github.com/repos/EmergentOrder/spark/git/refs{/sha},https://api.github.com/repos/EmergentOrder/spark/git/trees{/sha},https://api.github.com/repos/EmergentOrder/spark/statuses/{sha},https://api.github.com/repos/EmergentOrder/spark/languages,https://api.github.com/repos/EmergentOrder/spark/stargazers,https://api.github.com/repos/EmergentOrder/spark/contributors,https://api.github.com/repos/EmergentOrder/spark/subscribers,https://api.github.com/repos/EmergentOrder/spark/subscription,https://api.github.com/repos/EmergentOrder/spark/commits{/sha},https://api.github.com/repos/EmergentOrder/spark/git/commits{/sha},https://api.github.com/repos/EmergentOrder/spark/comments{/number},https://api.github.com/repos/EmergentOrder/spark/issues/comments{/number},https://api.github.com/repos/EmergentOrder/spark/contents/{+path},https://api.github.com/repos/EmergentOrder/spark/compare/{base}...{head},https://api.github.com/repos/EmergentOrder/spark/merges,https://api.github.com/repos/EmergentOrder/spark/{archive_format}{/ref},https://api.github.com/repos/EmergentOrder/spark/downloads,https://api.github.com/repos/EmergentOrder/spark/issues{/number},https://api.github.com/repos/EmergentOrder/spark/pulls{/number},https://api.github.com/repos/EmergentOrder/spark/milestones{/number},"https://api.github.com/repos/EmergentOrder/spark/notifications{?since,all,participating}",https://api.github.com/repos/EmergentOrder/spark/labels{/name},https://api.github.com/repos/EmergentOrder/spark/releases{/id},https://api.github.com/repos/EmergentOrder/spark/deployments,2018-02-01T16:32:19Z,2018-02-01T16:32:46Z,2020-04-09T21:28:22Z,git://github.com/EmergentOrder/spark.git,git@github.com:EmergentOrder/spark.git,https://github.com/EmergentOrder/spark.git,https://github.com/EmergentOrder/spark,,317749,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,1354d2d0de550af1f951a199332cd648644c8c48,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/20478,https://github.com/apache/spark/pull/20478,https://api.github.com/repos/apache/spark/issues/20478,https://api.github.com/repos/apache/spark/issues/20478/comments,https://api.github.com/repos/apache/spark/pulls/20478/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/20478/commits,https://api.github.com/repos/apache/spark/statuses/a9517a98ede7ba0829fb0a70ef16420bd5899038
255,https://api.github.com/repos/apache/spark/pulls/20345,164188883,MDExOlB1bGxSZXF1ZXN0MTY0MTg4ODgz,https://github.com/apache/spark/pull/20345,https://github.com/apache/spark/pull/20345.diff,https://github.com/apache/spark/pull/20345.patch,https://api.github.com/repos/apache/spark/issues/20345,20345,open,False,[SPARK-23172][SQL] Expand the ReorderJoin rule to handle Project nodes,"## What changes were proposed in this pull request?
The current `ReorderJoin` optimizer rule cannot flatten a pattern `Join -> Project -> Join` because `ExtractFiltersAndInnerJoins` doesn't handle `Project` nodes. So, the current master cannot reorder joins in a query below;
```
val df1 = spark.range(100).selectExpr(""id % 10 AS k0"", s""id % 10 AS k1"", s""id % 10 AS k2"", ""id AS v1"")
val df2 = spark.range(10).selectExpr(""id AS k0"", ""id AS v2"")
val df3 = spark.range(10).selectExpr(""id AS k1"", ""id AS v3"")
val df4 = spark.range(10).selectExpr(""id AS k2"", ""id AS v4"")
df1.join(df2, ""k0"").join(df3, ""k1"").join(df4, ""k2"").explain(true)

== Analyzed Logical Plan ==
k2: bigint, k1: bigint, k0: bigint, v1: bigint, v2: bigint, v3: bigint, v4: bigint
Project [k2#5L, k1#4L, k0#3L, v1#6L, v2#16L, v3#24L, v4#32L]
+- Join Inner, (k2#5L = k2#31L)
   :- Project [k1#4L, k0#3L, k2#5L, v1#6L, v2#16L, v3#24L]
   :  +- Join Inner, (k1#4L = k1#23L)
   :     :- Project [k0#3L, k1#4L, k2#5L, v1#6L, v2#16L]
   :     :  +- Join Inner, (k0#3L = k0#15L)
   :     :     :- Project [(id#0L % cast(10 as bigint)) AS k0#3L, (id#0L % cast(10 as bigint)) AS k1#4L, (id#0L % cast(10 as bigint)) AS k2#5L, id#0
L AS v1#6L]
   :     :     :  +- Range (0, 100, step=1, splits=Some(4))
   :     :     +- Project [id#12L AS k0#15L, id#12L AS v2#16L]
   :     :        +- Range (0, 10, step=1, splits=Some(4))
   :     +- Project [id#20L AS k1#23L, id#20L AS v3#24L]
   :        +- Range (0, 10, step=1, splits=Some(4))
   +- Project [id#28L AS k2#31L, id#28L AS v4#32L]
      +- Range (0, 10, step=1, splits=Some(4))
```
To reorder the query, this pr added code to handle `Project` in `ExtractFiltersAndInnerJoins`.

This pr also fixed an output attribute reorder problem when joins reordered; it checks if a join reordered plan and an original plan have the same output attribute order with each other. If not, `ReorderJoin` adds `Project` in the top of the join reordered plan.

## How was this patch tested?
This pr added new tests in `JoinOptimizationSuite` and modified some existing tests in `StarJoinReorderSuite` to check if `ReorderJoin` can handle `Project` nodes correctly. Also, it modified the existing tests in `JoinReorderSuite` for the output attribute reorder issue.",2018-01-21T18:52:21Z,2020-01-21T19:01:11Z,,,80cd2257df87bfa126b85ae524d6ff946a205d3a,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/20345/commits,https://api.github.com/repos/apache/spark/pulls/20345/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/20345/comments,https://api.github.com/repos/apache/spark/statuses/37e5fe284d6d35eda7d61ba01bf43bcba8af844d,MEMBER,spark,apache,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,maropu:FixFlattenJoins,FixFlattenJoins,37e5fe284d6d35eda7d61ba01bf43bcba8af844d,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,27115199,MDEwOlJlcG9zaXRvcnkyNzExNTE5OQ==,spark,maropu/spark,False,maropu,692303,MDQ6VXNlcjY5MjMwMw==,https://avatars3.githubusercontent.com/u/692303?v=4,,https://api.github.com/users/maropu,https://github.com/maropu,https://api.github.com/users/maropu/followers,https://api.github.com/users/maropu/following{/other_user},https://api.github.com/users/maropu/gists{/gist_id},https://api.github.com/users/maropu/starred{/owner}{/repo},https://api.github.com/users/maropu/subscriptions,https://api.github.com/users/maropu/orgs,https://api.github.com/users/maropu/repos,https://api.github.com/users/maropu/events{/privacy},https://api.github.com/users/maropu/received_events,User,False,https://github.com/maropu/spark,Mirror of Apache Spark,True,https://api.github.com/repos/maropu/spark,https://api.github.com/repos/maropu/spark/forks,https://api.github.com/repos/maropu/spark/keys{/key_id},https://api.github.com/repos/maropu/spark/collaborators{/collaborator},https://api.github.com/repos/maropu/spark/teams,https://api.github.com/repos/maropu/spark/hooks,https://api.github.com/repos/maropu/spark/issues/events{/number},https://api.github.com/repos/maropu/spark/events,https://api.github.com/repos/maropu/spark/assignees{/user},https://api.github.com/repos/maropu/spark/branches{/branch},https://api.github.com/repos/maropu/spark/tags,https://api.github.com/repos/maropu/spark/git/blobs{/sha},https://api.github.com/repos/maropu/spark/git/tags{/sha},https://api.github.com/repos/maropu/spark/git/refs{/sha},https://api.github.com/repos/maropu/spark/git/trees{/sha},https://api.github.com/repos/maropu/spark/statuses/{sha},https://api.github.com/repos/maropu/spark/languages,https://api.github.com/repos/maropu/spark/stargazers,https://api.github.com/repos/maropu/spark/contributors,https://api.github.com/repos/maropu/spark/subscribers,https://api.github.com/repos/maropu/spark/subscription,https://api.github.com/repos/maropu/spark/commits{/sha},https://api.github.com/repos/maropu/spark/git/commits{/sha},https://api.github.com/repos/maropu/spark/comments{/number},https://api.github.com/repos/maropu/spark/issues/comments{/number},https://api.github.com/repos/maropu/spark/contents/{+path},https://api.github.com/repos/maropu/spark/compare/{base}...{head},https://api.github.com/repos/maropu/spark/merges,https://api.github.com/repos/maropu/spark/{archive_format}{/ref},https://api.github.com/repos/maropu/spark/downloads,https://api.github.com/repos/maropu/spark/issues{/number},https://api.github.com/repos/maropu/spark/pulls{/number},https://api.github.com/repos/maropu/spark/milestones{/number},"https://api.github.com/repos/maropu/spark/notifications{?since,all,participating}",https://api.github.com/repos/maropu/spark/labels{/name},https://api.github.com/repos/maropu/spark/releases{/id},https://api.github.com/repos/maropu/spark/deployments,2014-11-25T08:00:37Z,2020-04-10T06:53:27Z,2020-04-10T08:27:24Z,git://github.com/maropu/spark.git,git@github.com:maropu/spark.git,https://github.com/maropu/spark.git,https://github.com/maropu/spark,,308375,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,cfb1706eaa59848cfda88a2f3a6fd90262f55b3e,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/20345,https://github.com/apache/spark/pull/20345,https://api.github.com/repos/apache/spark/issues/20345,https://api.github.com/repos/apache/spark/issues/20345/comments,https://api.github.com/repos/apache/spark/pulls/20345/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/20345/commits,https://api.github.com/repos/apache/spark/statuses/37e5fe284d6d35eda7d61ba01bf43bcba8af844d
256,https://api.github.com/repos/apache/spark/pulls/18906,135153098,MDExOlB1bGxSZXF1ZXN0MTM1MTUzMDk4,https://github.com/apache/spark/pull/18906,https://github.com/apache/spark/pull/18906.diff,https://github.com/apache/spark/pull/18906.patch,https://api.github.com/repos/apache/spark/issues/18906,18906,open,False,[SPARK-21692][PYSPARK][SQL] Add nullability support to PythonUDF.,"## What changes were proposed in this pull request?
When registering a Python UDF, a user may know whether the function can return null values or not. PythonUDF and all related classes should handle nullability.

## How was this patch tested?
Existing tests and a few new tests.
",2017-08-10T15:22:59Z,2020-03-16T15:33:59Z,,,31cda44b7a984ee94ee0d53a5dacf83ad72079e5,,[],"[{'login': 'ueshin', 'id': 506656, 'node_id': 'MDQ6VXNlcjUwNjY1Ng==', 'avatar_url': 'https://avatars1.githubusercontent.com/u/506656?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/ueshin', 'html_url': 'https://github.com/ueshin', 'followers_url': 'https://api.github.com/users/ueshin/followers', 'following_url': 'https://api.github.com/users/ueshin/following{/other_user}', 'gists_url': 'https://api.github.com/users/ueshin/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/ueshin/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/ueshin/subscriptions', 'organizations_url': 'https://api.github.com/users/ueshin/orgs', 'repos_url': 'https://api.github.com/users/ueshin/repos', 'events_url': 'https://api.github.com/users/ueshin/events{/privacy}', 'received_events_url': 'https://api.github.com/users/ueshin/received_events', 'type': 'User', 'site_admin': False}, {'login': 'HyukjinKwon', 'id': 6477701, 'node_id': 'MDQ6VXNlcjY0Nzc3MDE=', 'avatar_url': 'https://avatars0.githubusercontent.com/u/6477701?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/HyukjinKwon', 'html_url': 'https://github.com/HyukjinKwon', 'followers_url': 'https://api.github.com/users/HyukjinKwon/followers', 'following_url': 'https://api.github.com/users/HyukjinKwon/following{/other_user}', 'gists_url': 'https://api.github.com/users/HyukjinKwon/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/HyukjinKwon/subscriptions', 'organizations_url': 'https://api.github.com/users/HyukjinKwon/orgs', 'repos_url': 'https://api.github.com/users/HyukjinKwon/repos', 'events_url': 'https://api.github.com/users/HyukjinKwon/events{/privacy}', 'received_events_url': 'https://api.github.com/users/HyukjinKwon/received_events', 'type': 'User', 'site_admin': False}]",[],"[{'id': 1406590181, 'node_id': 'MDU6TGFiZWwxNDA2NTkwMTgx', 'url': 'https://api.github.com/repos/apache/spark/labels/PYSPARK', 'name': 'PYSPARK', 'color': 'ededed', 'default': False, 'description': None}, {'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/18906/commits,https://api.github.com/repos/apache/spark/pulls/18906/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/18906/comments,https://api.github.com/repos/apache/spark/statuses/516a7081f4cbb7b42d463eb9216f9ded18dca40c,CONTRIBUTOR,spark,apache,ptkool,20175793,MDQ6VXNlcjIwMTc1Nzkz,https://avatars2.githubusercontent.com/u/20175793?v=4,,https://api.github.com/users/ptkool,https://github.com/ptkool,https://api.github.com/users/ptkool/followers,https://api.github.com/users/ptkool/following{/other_user},https://api.github.com/users/ptkool/gists{/gist_id},https://api.github.com/users/ptkool/starred{/owner}{/repo},https://api.github.com/users/ptkool/subscriptions,https://api.github.com/users/ptkool/orgs,https://api.github.com/users/ptkool/repos,https://api.github.com/users/ptkool/events{/privacy},https://api.github.com/users/ptkool/received_events,User,False,ptkool:udf_nullability,udf_nullability,516a7081f4cbb7b42d463eb9216f9ded18dca40c,ptkool,20175793,MDQ6VXNlcjIwMTc1Nzkz,https://avatars2.githubusercontent.com/u/20175793?v=4,,https://api.github.com/users/ptkool,https://github.com/ptkool,https://api.github.com/users/ptkool/followers,https://api.github.com/users/ptkool/following{/other_user},https://api.github.com/users/ptkool/gists{/gist_id},https://api.github.com/users/ptkool/starred{/owner}{/repo},https://api.github.com/users/ptkool/subscriptions,https://api.github.com/users/ptkool/orgs,https://api.github.com/users/ptkool/repos,https://api.github.com/users/ptkool/events{/privacy},https://api.github.com/users/ptkool/received_events,User,False,83585082,MDEwOlJlcG9zaXRvcnk4MzU4NTA4Mg==,spark,ptkool/spark,False,ptkool,20175793,MDQ6VXNlcjIwMTc1Nzkz,https://avatars2.githubusercontent.com/u/20175793?v=4,,https://api.github.com/users/ptkool,https://github.com/ptkool,https://api.github.com/users/ptkool/followers,https://api.github.com/users/ptkool/following{/other_user},https://api.github.com/users/ptkool/gists{/gist_id},https://api.github.com/users/ptkool/starred{/owner}{/repo},https://api.github.com/users/ptkool/subscriptions,https://api.github.com/users/ptkool/orgs,https://api.github.com/users/ptkool/repos,https://api.github.com/users/ptkool/events{/privacy},https://api.github.com/users/ptkool/received_events,User,False,https://github.com/ptkool/spark,Mirror of Apache Spark,True,https://api.github.com/repos/ptkool/spark,https://api.github.com/repos/ptkool/spark/forks,https://api.github.com/repos/ptkool/spark/keys{/key_id},https://api.github.com/repos/ptkool/spark/collaborators{/collaborator},https://api.github.com/repos/ptkool/spark/teams,https://api.github.com/repos/ptkool/spark/hooks,https://api.github.com/repos/ptkool/spark/issues/events{/number},https://api.github.com/repos/ptkool/spark/events,https://api.github.com/repos/ptkool/spark/assignees{/user},https://api.github.com/repos/ptkool/spark/branches{/branch},https://api.github.com/repos/ptkool/spark/tags,https://api.github.com/repos/ptkool/spark/git/blobs{/sha},https://api.github.com/repos/ptkool/spark/git/tags{/sha},https://api.github.com/repos/ptkool/spark/git/refs{/sha},https://api.github.com/repos/ptkool/spark/git/trees{/sha},https://api.github.com/repos/ptkool/spark/statuses/{sha},https://api.github.com/repos/ptkool/spark/languages,https://api.github.com/repos/ptkool/spark/stargazers,https://api.github.com/repos/ptkool/spark/contributors,https://api.github.com/repos/ptkool/spark/subscribers,https://api.github.com/repos/ptkool/spark/subscription,https://api.github.com/repos/ptkool/spark/commits{/sha},https://api.github.com/repos/ptkool/spark/git/commits{/sha},https://api.github.com/repos/ptkool/spark/comments{/number},https://api.github.com/repos/ptkool/spark/issues/comments{/number},https://api.github.com/repos/ptkool/spark/contents/{+path},https://api.github.com/repos/ptkool/spark/compare/{base}...{head},https://api.github.com/repos/ptkool/spark/merges,https://api.github.com/repos/ptkool/spark/{archive_format}{/ref},https://api.github.com/repos/ptkool/spark/downloads,https://api.github.com/repos/ptkool/spark/issues{/number},https://api.github.com/repos/ptkool/spark/pulls{/number},https://api.github.com/repos/ptkool/spark/milestones{/number},"https://api.github.com/repos/ptkool/spark/notifications{?since,all,participating}",https://api.github.com/repos/ptkool/spark/labels{/name},https://api.github.com/repos/ptkool/spark/releases{/id},https://api.github.com/repos/ptkool/spark/deployments,2017-03-01T18:05:15Z,2020-01-18T12:28:25Z,2020-01-19T11:59:26Z,git://github.com/ptkool/spark.git,git@github.com:ptkool/spark.git,https://github.com/ptkool/spark.git,https://github.com/ptkool/spark,,318805,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,a6bdea3ad4a5dde8a68aaf1db0d870ec36040c67,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/18906,https://github.com/apache/spark/pull/18906,https://api.github.com/repos/apache/spark/issues/18906,https://api.github.com/repos/apache/spark/issues/18906/comments,https://api.github.com/repos/apache/spark/pulls/18906/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/18906/commits,https://api.github.com/repos/apache/spark/statuses/516a7081f4cbb7b42d463eb9216f9ded18dca40c
257,https://api.github.com/repos/apache/spark/pulls/18423,127533048,MDExOlB1bGxSZXF1ZXN0MTI3NTMzMDQ4,https://github.com/apache/spark/pull/18423,https://github.com/apache/spark/pull/18423.diff,https://github.com/apache/spark/pull/18423.patch,https://api.github.com/repos/apache/spark/issues/18423,18423,open,False,SPARK-21158: Fix case sensitive of temp table/view name,"## What changes were proposed in this pull request?

Most changes have been made to SessionCatalog source file. Shouldn't convert table/view name into lowercase. The hash-table should always contain the exact input name of table. 

## How was this patch tested?

This patch wast tested around containLocalTable and containGlobalTable functions manually for case-sensitive and in-sensitive. They are very simple functions

Please review http://spark.apache.org/contributing.html before opening a pull request.
",2017-06-26T18:24:02Z,2020-01-09T00:15:05Z,,,ddd3097a3667ae29a79e3fbc83a7873d1080784f,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/18423/commits,https://api.github.com/repos/apache/spark/pulls/18423/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/18423/comments,https://api.github.com/repos/apache/spark/statuses/fe044cdb344dfd14ecc014f98004b20ccb78cea9,NONE,spark,apache,cammachusa,28015823,MDQ6VXNlcjI4MDE1ODIz,https://avatars1.githubusercontent.com/u/28015823?v=4,,https://api.github.com/users/cammachusa,https://github.com/cammachusa,https://api.github.com/users/cammachusa/followers,https://api.github.com/users/cammachusa/following{/other_user},https://api.github.com/users/cammachusa/gists{/gist_id},https://api.github.com/users/cammachusa/starred{/owner}{/repo},https://api.github.com/users/cammachusa/subscriptions,https://api.github.com/users/cammachusa/orgs,https://api.github.com/users/cammachusa/repos,https://api.github.com/users/cammachusa/events{/privacy},https://api.github.com/users/cammachusa/received_events,User,False,InspurUSA:SPARK-21158,SPARK-21158,fe044cdb344dfd14ecc014f98004b20ccb78cea9,InspurUSA,27983447,MDEyOk9yZ2FuaXphdGlvbjI3OTgzNDQ3,https://avatars0.githubusercontent.com/u/27983447?v=4,,https://api.github.com/users/InspurUSA,https://github.com/InspurUSA,https://api.github.com/users/InspurUSA/followers,https://api.github.com/users/InspurUSA/following{/other_user},https://api.github.com/users/InspurUSA/gists{/gist_id},https://api.github.com/users/InspurUSA/starred{/owner}{/repo},https://api.github.com/users/InspurUSA/subscriptions,https://api.github.com/users/InspurUSA/orgs,https://api.github.com/users/InspurUSA/repos,https://api.github.com/users/InspurUSA/events{/privacy},https://api.github.com/users/InspurUSA/received_events,Organization,False,89408720,MDEwOlJlcG9zaXRvcnk4OTQwODcyMA==,spark,InspurUSA/spark,False,InspurUSA,27983447,MDEyOk9yZ2FuaXphdGlvbjI3OTgzNDQ3,https://avatars0.githubusercontent.com/u/27983447?v=4,,https://api.github.com/users/InspurUSA,https://github.com/InspurUSA,https://api.github.com/users/InspurUSA/followers,https://api.github.com/users/InspurUSA/following{/other_user},https://api.github.com/users/InspurUSA/gists{/gist_id},https://api.github.com/users/InspurUSA/starred{/owner}{/repo},https://api.github.com/users/InspurUSA/subscriptions,https://api.github.com/users/InspurUSA/orgs,https://api.github.com/users/InspurUSA/repos,https://api.github.com/users/InspurUSA/events{/privacy},https://api.github.com/users/InspurUSA/received_events,Organization,False,https://github.com/InspurUSA/spark,Mirror of Apache Spark,True,https://api.github.com/repos/InspurUSA/spark,https://api.github.com/repos/InspurUSA/spark/forks,https://api.github.com/repos/InspurUSA/spark/keys{/key_id},https://api.github.com/repos/InspurUSA/spark/collaborators{/collaborator},https://api.github.com/repos/InspurUSA/spark/teams,https://api.github.com/repos/InspurUSA/spark/hooks,https://api.github.com/repos/InspurUSA/spark/issues/events{/number},https://api.github.com/repos/InspurUSA/spark/events,https://api.github.com/repos/InspurUSA/spark/assignees{/user},https://api.github.com/repos/InspurUSA/spark/branches{/branch},https://api.github.com/repos/InspurUSA/spark/tags,https://api.github.com/repos/InspurUSA/spark/git/blobs{/sha},https://api.github.com/repos/InspurUSA/spark/git/tags{/sha},https://api.github.com/repos/InspurUSA/spark/git/refs{/sha},https://api.github.com/repos/InspurUSA/spark/git/trees{/sha},https://api.github.com/repos/InspurUSA/spark/statuses/{sha},https://api.github.com/repos/InspurUSA/spark/languages,https://api.github.com/repos/InspurUSA/spark/stargazers,https://api.github.com/repos/InspurUSA/spark/contributors,https://api.github.com/repos/InspurUSA/spark/subscribers,https://api.github.com/repos/InspurUSA/spark/subscription,https://api.github.com/repos/InspurUSA/spark/commits{/sha},https://api.github.com/repos/InspurUSA/spark/git/commits{/sha},https://api.github.com/repos/InspurUSA/spark/comments{/number},https://api.github.com/repos/InspurUSA/spark/issues/comments{/number},https://api.github.com/repos/InspurUSA/spark/contents/{+path},https://api.github.com/repos/InspurUSA/spark/compare/{base}...{head},https://api.github.com/repos/InspurUSA/spark/merges,https://api.github.com/repos/InspurUSA/spark/{archive_format}{/ref},https://api.github.com/repos/InspurUSA/spark/downloads,https://api.github.com/repos/InspurUSA/spark/issues{/number},https://api.github.com/repos/InspurUSA/spark/pulls{/number},https://api.github.com/repos/InspurUSA/spark/milestones{/number},"https://api.github.com/repos/InspurUSA/spark/notifications{?since,all,participating}",https://api.github.com/repos/InspurUSA/spark/labels{/name},https://api.github.com/repos/InspurUSA/spark/releases{/id},https://api.github.com/repos/InspurUSA/spark/deployments,2017-04-25T21:31:52Z,2018-12-06T01:15:55Z,2018-12-06T01:15:53Z,git://github.com/InspurUSA/spark.git,git@github.com:InspurUSA/spark.git,https://github.com/InspurUSA/spark.git,https://github.com/InspurUSA/spark,,283060,1,1,Scala,False,False,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,1,master,apache:master,master,c22810004fb2db249be6477c9801d09b807af851,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/18423,https://github.com/apache/spark/pull/18423,https://api.github.com/repos/apache/spark/issues/18423,https://api.github.com/repos/apache/spark/issues/18423/comments,https://api.github.com/repos/apache/spark/pulls/18423/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/18423/commits,https://api.github.com/repos/apache/spark/statuses/fe044cdb344dfd14ecc014f98004b20ccb78cea9
258,https://api.github.com/repos/apache/spark/pulls/17332,111233399,MDExOlB1bGxSZXF1ZXN0MTExMjMzMzk5,https://github.com/apache/spark/pull/17332,https://github.com/apache/spark/pull/17332.diff,https://github.com/apache/spark/pull/17332.patch,https://api.github.com/repos/apache/spark/issues/17332,17332,open,False,[SPARK-10764][ML] Add optional caching to Pipelines,"
## What changes were proposed in this pull request?
This PR is to allow users to persist the output of a particular `PipelineStage` in the `Pipeline`. It also allows users to persist only a subset of output that is actually needed for the next stage instead of the whole big data frame.

For example, while running LDA a pipeline may look something like `Tokenizer` -> `StopWordRemover` -> `CountVectorizer` -> `LDA`. Here a user might want to `persist` the data frame coming out of `CountVectorizer` so that the LDA iterations work on this persisted data. Also, we need the flexibility to persist only the subset of columns (say docId, and features) that are needed for `LDA` rather than all extra columns that may have been added by the previous stages.

Also, another issue is that once the pipeline is fit on a data, for the `transform` on the same data it has to pass through all the previous stages again. In many cases this can be optimized if we already had access to data cached in the intermediate stage. In the example above, it will be useful if the data previously persisted in `CountVectorizer` can be reused to get `topicDistributions` from the `LDA` on the train data set itself. Otherwise, the data needs to *again* pass through all the stages.

For this, the `PipelineStage` exposes following methods
* `persist(level: StorageLevel, colExprs: String*)` - where the user can specify storage level and subset of the output dataframe of the stage to be persisted.
* `persist(colExprs: String*)` - uses default storage level.
* `getPersistedDf(): Option[DataFrame]` - to retrieve the cached data frame for a stage. This will be useful when we only need to run the pipeline from a specific stage. For instance, `pipelineModel.transform(countVectorizer.getPersistedDf.get)` should only run the final `LDA` stage of the pipeline. The persisted dataframe s only available once the `Pipeline.fit` has been called.

Changes in `Pipeline`
* The `fit` method checks whether a particular stage is marked to persist its output. If yes, it marks the output data frame as persistent according to the storage level and column subset. For `Executors` in the stage, it associates the persistant dataframe with both the `Executor` as well as the resultant `Transformer`.
* The `transformSchema` methods is changes so that the column pruning as result of specifying subset columns for persisting is taken into account.

Changes in `PipelineModel`
* `transform(dataset)` method now checks if the dataset argument was persisted in any of the stages during `Pipeline.fit`. If yes, it ensures only the stages after that stage are run (else all the stages are run). These two cases are handled for `transformSchema`.

## How was this patch tested?
* Existing tests
* Added new test in `PipelineSuite` to test above scenarios.
",2017-03-17T08:24:17Z,2020-01-12T23:54:06Z,,,83a168928a31423e038f607636279212cf9ab3b5,,[],[],[],"[{'id': 1405801475, 'node_id': 'MDU6TGFiZWwxNDA1ODAxNDc1', 'url': 'https://api.github.com/repos/apache/spark/labels/ML', 'name': 'ML', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/17332/commits,https://api.github.com/repos/apache/spark/pulls/17332/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/17332/comments,https://api.github.com/repos/apache/spark/statuses/9a617928316df36e0e8d23db44c4ea01d6d1bca0,NONE,spark,apache,sachintyagi22,10532956,MDQ6VXNlcjEwNTMyOTU2,https://avatars3.githubusercontent.com/u/10532956?v=4,,https://api.github.com/users/sachintyagi22,https://github.com/sachintyagi22,https://api.github.com/users/sachintyagi22/followers,https://api.github.com/users/sachintyagi22/following{/other_user},https://api.github.com/users/sachintyagi22/gists{/gist_id},https://api.github.com/users/sachintyagi22/starred{/owner}{/repo},https://api.github.com/users/sachintyagi22/subscriptions,https://api.github.com/users/sachintyagi22/orgs,https://api.github.com/users/sachintyagi22/repos,https://api.github.com/users/sachintyagi22/events{/privacy},https://api.github.com/users/sachintyagi22/received_events,User,False,sachintyagi22:pipeline-cache,pipeline-cache,9a617928316df36e0e8d23db44c4ea01d6d1bca0,sachintyagi22,10532956,MDQ6VXNlcjEwNTMyOTU2,https://avatars3.githubusercontent.com/u/10532956?v=4,,https://api.github.com/users/sachintyagi22,https://github.com/sachintyagi22,https://api.github.com/users/sachintyagi22/followers,https://api.github.com/users/sachintyagi22/following{/other_user},https://api.github.com/users/sachintyagi22/gists{/gist_id},https://api.github.com/users/sachintyagi22/starred{/owner}{/repo},https://api.github.com/users/sachintyagi22/subscriptions,https://api.github.com/users/sachintyagi22/orgs,https://api.github.com/users/sachintyagi22/repos,https://api.github.com/users/sachintyagi22/events{/privacy},https://api.github.com/users/sachintyagi22/received_events,User,False,56495542,MDEwOlJlcG9zaXRvcnk1NjQ5NTU0Mg==,spark,sachintyagi22/spark,False,sachintyagi22,10532956,MDQ6VXNlcjEwNTMyOTU2,https://avatars3.githubusercontent.com/u/10532956?v=4,,https://api.github.com/users/sachintyagi22,https://github.com/sachintyagi22,https://api.github.com/users/sachintyagi22/followers,https://api.github.com/users/sachintyagi22/following{/other_user},https://api.github.com/users/sachintyagi22/gists{/gist_id},https://api.github.com/users/sachintyagi22/starred{/owner}{/repo},https://api.github.com/users/sachintyagi22/subscriptions,https://api.github.com/users/sachintyagi22/orgs,https://api.github.com/users/sachintyagi22/repos,https://api.github.com/users/sachintyagi22/events{/privacy},https://api.github.com/users/sachintyagi22/received_events,User,False,https://github.com/sachintyagi22/spark,Mirror of Apache Spark,True,https://api.github.com/repos/sachintyagi22/spark,https://api.github.com/repos/sachintyagi22/spark/forks,https://api.github.com/repos/sachintyagi22/spark/keys{/key_id},https://api.github.com/repos/sachintyagi22/spark/collaborators{/collaborator},https://api.github.com/repos/sachintyagi22/spark/teams,https://api.github.com/repos/sachintyagi22/spark/hooks,https://api.github.com/repos/sachintyagi22/spark/issues/events{/number},https://api.github.com/repos/sachintyagi22/spark/events,https://api.github.com/repos/sachintyagi22/spark/assignees{/user},https://api.github.com/repos/sachintyagi22/spark/branches{/branch},https://api.github.com/repos/sachintyagi22/spark/tags,https://api.github.com/repos/sachintyagi22/spark/git/blobs{/sha},https://api.github.com/repos/sachintyagi22/spark/git/tags{/sha},https://api.github.com/repos/sachintyagi22/spark/git/refs{/sha},https://api.github.com/repos/sachintyagi22/spark/git/trees{/sha},https://api.github.com/repos/sachintyagi22/spark/statuses/{sha},https://api.github.com/repos/sachintyagi22/spark/languages,https://api.github.com/repos/sachintyagi22/spark/stargazers,https://api.github.com/repos/sachintyagi22/spark/contributors,https://api.github.com/repos/sachintyagi22/spark/subscribers,https://api.github.com/repos/sachintyagi22/spark/subscription,https://api.github.com/repos/sachintyagi22/spark/commits{/sha},https://api.github.com/repos/sachintyagi22/spark/git/commits{/sha},https://api.github.com/repos/sachintyagi22/spark/comments{/number},https://api.github.com/repos/sachintyagi22/spark/issues/comments{/number},https://api.github.com/repos/sachintyagi22/spark/contents/{+path},https://api.github.com/repos/sachintyagi22/spark/compare/{base}...{head},https://api.github.com/repos/sachintyagi22/spark/merges,https://api.github.com/repos/sachintyagi22/spark/{archive_format}{/ref},https://api.github.com/repos/sachintyagi22/spark/downloads,https://api.github.com/repos/sachintyagi22/spark/issues{/number},https://api.github.com/repos/sachintyagi22/spark/pulls{/number},https://api.github.com/repos/sachintyagi22/spark/milestones{/number},"https://api.github.com/repos/sachintyagi22/spark/notifications{?since,all,participating}",https://api.github.com/repos/sachintyagi22/spark/labels{/name},https://api.github.com/repos/sachintyagi22/spark/releases{/id},https://api.github.com/repos/sachintyagi22/spark/deployments,2016-04-18T09:39:35Z,2016-04-18T09:39:58Z,2017-03-17T08:23:10Z,git://github.com/sachintyagi22/spark.git,git@github.com:sachintyagi22/spark.git,https://github.com/sachintyagi22/spark.git,https://github.com/sachintyagi22/spark,,257632,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,8537c00e0a17eff2a8c6745fbdd1d08873c0434d,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/17332,https://github.com/apache/spark/pull/17332,https://api.github.com/repos/apache/spark/issues/17332,https://api.github.com/repos/apache/spark/issues/17332/comments,https://api.github.com/repos/apache/spark/pulls/17332/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/17332/commits,https://api.github.com/repos/apache/spark/statuses/9a617928316df36e0e8d23db44c4ea01d6d1bca0
259,https://api.github.com/repos/apache/spark/pulls/16478,100288597,MDExOlB1bGxSZXF1ZXN0MTAwMjg4NTk3,https://github.com/apache/spark/pull/16478,https://github.com/apache/spark/pull/16478.diff,https://github.com/apache/spark/pull/16478.patch,https://api.github.com/repos/apache/spark/issues/16478,16478,open,False,[SPARK-7768][SQL] Revise user defined types (UDT),"## What changes were proposed in this pull request?

This patch is going to revise the current API for User Defined Types (UDTs).

Currently the API of `UserDefinedType` asks developers to implement the method that fills user data into SparkSQL's internal format such as `GenericInternalRow`, `UnsafeArrayData`, etc.

One target of this patch is to simplify the way to write UDTs. Developers can just use Scala types, instead of internal types such as ArrayData, when writing UDTs. `UserDefinedType` will use SparkSQL's encoder to convert user data to internal format.

For example, the following is the serialization method of `MatrixUDT`.

Before this patch:

    override def serialize(obj: Matrix): InternalRow = {
      val row = new GenericInternalRow(7)
      obj match {
        case sm: SparseMatrix =>
          row.setByte(0, 0)
          row.setInt(1, sm.numRows)
          row.setInt(2, sm.numCols)
          row.update(3, UnsafeArrayData.fromPrimitiveArray(sm.colPtrs))
          row.update(4, UnsafeArrayData.fromPrimitiveArray(sm.rowIndices))
          row.update(5, UnsafeArrayData.fromPrimitiveArray(sm.values))
          row.setBoolean(6, sm.isTransposed)

        case dm: DenseMatrix =>
          row.setByte(0, 1)
          row.setInt(1, dm.numRows)
          row.setInt(2, dm.numCols)
          row.setNullAt(3)
          row.setNullAt(4)
          row.update(5, UnsafeArrayData.fromPrimitiveArray(dm.values))
          row.setBoolean(6, dm.isTransposed)
      }
      row
    }


After this patch:

    override def writeRow(obj: Matrix): Row = {
      obj match {
        case sm: SparseMatrix =>
          Row(0.toByte, sm.numRows, sm.numCols, sm.colPtrs, sm.rowIndices, sm.values, sm.isTransposed)

        case dm: DenseMatrix =>
          Row(1.toByte, dm.numRows, dm.numCols, null, null, dm.values, dm.isTransposed)
      }
    }

Developers now manipulate external row `Row` and Scala types. Encoder will take care of converting the data to SparkSQL's internal format.


### Main API change

In the past, two main methods are needed to be implemented in developers' UDTs which extend `UserDefinedType`.

    /** Convert the user type to a SQL datum */
    def serialize(obj: UserType): Any

    /** Convert a SQL datum to the user type */
    def deserialize(datum: Any): UserType

Developers put/get the data of user class into/from an internal type of Spark SQL.

Now developers after this patch, are changed to implement two methods which put/get user data into/from an external row of SparkSQL.

    /** Convert the object of user type to an external row. Must be implemented in subclasses. */
    def writeRow(obj: UserType): Row

    /** Convert the external row to an object of user type. Must be implemented in subclasses. */
    def readRow(row: Row): UserType

### Benchmark

Ran a benchmark against previous `UserDefinedType`.

Code:

    private val random = new Random(100)
    private lazy val pointsRDD = (0 to 1000).map { i =>
      val features = (0 to 100).map { _ =>
        random.nextDouble()
      }
      MyLabeledPoint(i % 10, new UDT.MyDenseVector(features.toArray))
    }.toDF()

    test(""serialize MyLabeledPoint"") {
      val N = 10L << 5
      runBenchmark(""serialize MyLabeledPoint"", N) {
        pointsRDD.groupBy('label).agg(max('features)).collect()
      }
    }


Before this patch:

    Java HotSpot(TM) 64-Bit Server VM 1.8.0_102-b14 on Linux 4.4.39-moby
    Intel(R) Core(TM) i7-5557U CPU @ 3.10GHz
    serialize MyLabeledPoint:                Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative
    ------------------------------------------------------------------------------------------------
    serialize MyLabeledPoint wholestage off        271 /  328          0.0      845767.7       1.0X
    serialize MyLabeledPoint wholestage on         131 /  261          0.0      408173.6       2.1X

After this patch:

    Java HotSpot(TM) 64-Bit Server VM 1.8.0_102-b14 on Linux 4.4.39-moby
    Intel(R) Core(TM) i7-5557U CPU @ 3.10GHz
    serialize MyLabeledPoint:                Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative
    ------------------------------------------------------------------------------------------------
    serialize MyLabeledPoint wholestage off        221 /  331          0.0      692100.4       1.0X
    serialize MyLabeledPoint wholestage on         125 /  145          0.0      391120.1       1.8X

Basically, after this patch the serialization/deserialization of `UserDefinedType` can compete or be slightly better than previous one.

## How was this patch tested?

Existing Jenkins tests.

",2017-01-05T13:18:57Z,2020-03-01T15:31:49Z,,,7ca1bda2d52d29bea447b16a175bb217bae65ea0,,[],[],[],"[{'id': 1405794576, 'node_id': 'MDU6TGFiZWwxNDA1Nzk0NTc2', 'url': 'https://api.github.com/repos/apache/spark/labels/SQL', 'name': 'SQL', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/16478/commits,https://api.github.com/repos/apache/spark/pulls/16478/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/16478/comments,https://api.github.com/repos/apache/spark/statuses/72414c635bedfed4a1da4a1398a8f92135d6d204,MEMBER,spark,apache,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,viirya:revise-udt,revise-udt,72414c635bedfed4a1da4a1398a8f92135d6d204,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,21467907,MDEwOlJlcG9zaXRvcnkyMTQ2NzkwNw==,spark-1,viirya/spark-1,False,viirya,68855,MDQ6VXNlcjY4ODU1,https://avatars1.githubusercontent.com/u/68855?v=4,,https://api.github.com/users/viirya,https://github.com/viirya,https://api.github.com/users/viirya/followers,https://api.github.com/users/viirya/following{/other_user},https://api.github.com/users/viirya/gists{/gist_id},https://api.github.com/users/viirya/starred{/owner}{/repo},https://api.github.com/users/viirya/subscriptions,https://api.github.com/users/viirya/orgs,https://api.github.com/users/viirya/repos,https://api.github.com/users/viirya/events{/privacy},https://api.github.com/users/viirya/received_events,User,False,https://github.com/viirya/spark-1,Mirror of Apache Spark,True,https://api.github.com/repos/viirya/spark-1,https://api.github.com/repos/viirya/spark-1/forks,https://api.github.com/repos/viirya/spark-1/keys{/key_id},https://api.github.com/repos/viirya/spark-1/collaborators{/collaborator},https://api.github.com/repos/viirya/spark-1/teams,https://api.github.com/repos/viirya/spark-1/hooks,https://api.github.com/repos/viirya/spark-1/issues/events{/number},https://api.github.com/repos/viirya/spark-1/events,https://api.github.com/repos/viirya/spark-1/assignees{/user},https://api.github.com/repos/viirya/spark-1/branches{/branch},https://api.github.com/repos/viirya/spark-1/tags,https://api.github.com/repos/viirya/spark-1/git/blobs{/sha},https://api.github.com/repos/viirya/spark-1/git/tags{/sha},https://api.github.com/repos/viirya/spark-1/git/refs{/sha},https://api.github.com/repos/viirya/spark-1/git/trees{/sha},https://api.github.com/repos/viirya/spark-1/statuses/{sha},https://api.github.com/repos/viirya/spark-1/languages,https://api.github.com/repos/viirya/spark-1/stargazers,https://api.github.com/repos/viirya/spark-1/contributors,https://api.github.com/repos/viirya/spark-1/subscribers,https://api.github.com/repos/viirya/spark-1/subscription,https://api.github.com/repos/viirya/spark-1/commits{/sha},https://api.github.com/repos/viirya/spark-1/git/commits{/sha},https://api.github.com/repos/viirya/spark-1/comments{/number},https://api.github.com/repos/viirya/spark-1/issues/comments{/number},https://api.github.com/repos/viirya/spark-1/contents/{+path},https://api.github.com/repos/viirya/spark-1/compare/{base}...{head},https://api.github.com/repos/viirya/spark-1/merges,https://api.github.com/repos/viirya/spark-1/{archive_format}{/ref},https://api.github.com/repos/viirya/spark-1/downloads,https://api.github.com/repos/viirya/spark-1/issues{/number},https://api.github.com/repos/viirya/spark-1/pulls{/number},https://api.github.com/repos/viirya/spark-1/milestones{/number},"https://api.github.com/repos/viirya/spark-1/notifications{?since,all,participating}",https://api.github.com/repos/viirya/spark-1/labels{/name},https://api.github.com/repos/viirya/spark-1/releases{/id},https://api.github.com/repos/viirya/spark-1/deployments,2014-07-03T15:40:08Z,2020-02-26T23:54:48Z,2020-04-05T16:08:34Z,git://github.com/viirya/spark-1.git,git@github.com:viirya/spark-1.git,https://github.com/viirya/spark-1.git,https://github.com/viirya/spark-1,,321190,0,0,Scala,False,True,True,False,False,0,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,0,0,0,master,apache:master,master,2f8e4d0d6e56188fa24528741a514ce1f04d2bf2,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/16478,https://github.com/apache/spark/pull/16478,https://api.github.com/repos/apache/spark/issues/16478,https://api.github.com/repos/apache/spark/issues/16478/comments,https://api.github.com/repos/apache/spark/pulls/16478/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/16478/commits,https://api.github.com/repos/apache/spark/statuses/72414c635bedfed4a1da4a1398a8f92135d6d204
260,https://api.github.com/repos/apache/spark/pulls/7842,41383687,MDExOlB1bGxSZXF1ZXN0NDEzODM2ODc=,https://github.com/apache/spark/pull/7842,https://github.com/apache/spark/pull/7842.diff,https://github.com/apache/spark/pull/7842.patch,https://api.github.com/repos/apache/spark/issues/7842,7842,open,False,[SPARK-8542][MLlib]PMML export for Decision Trees,"Added support for PMML export for Decision Trees
",2015-07-31T21:40:17Z,2020-01-03T05:23:07Z,,,cc0f8d479cafefdf8391cc3b4a8f393290f979f0,,[],[],[],"[{'id': 1405803268, 'node_id': 'MDU6TGFiZWwxNDA1ODAzMjY4', 'url': 'https://api.github.com/repos/apache/spark/labels/MLLIB', 'name': 'MLLIB', 'color': 'ededed', 'default': False, 'description': None}]",,False,https://api.github.com/repos/apache/spark/pulls/7842/commits,https://api.github.com/repos/apache/spark/pulls/7842/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/issues/7842/comments,https://api.github.com/repos/apache/spark/statuses/85a4c326c5a573245e40d636c951f0824b7870bc,NONE,spark,apache,JasmineGeorge,1110984,MDQ6VXNlcjExMTA5ODQ=,https://avatars0.githubusercontent.com/u/1110984?v=4,,https://api.github.com/users/JasmineGeorge,https://github.com/JasmineGeorge,https://api.github.com/users/JasmineGeorge/followers,https://api.github.com/users/JasmineGeorge/following{/other_user},https://api.github.com/users/JasmineGeorge/gists{/gist_id},https://api.github.com/users/JasmineGeorge/starred{/owner}{/repo},https://api.github.com/users/JasmineGeorge/subscriptions,https://api.github.com/users/JasmineGeorge/orgs,https://api.github.com/users/JasmineGeorge/repos,https://api.github.com/users/JasmineGeorge/events{/privacy},https://api.github.com/users/JasmineGeorge/received_events,User,False,JasmineGeorge:SPARK-8545-PMML-improvement-umbrella,SPARK-8545-PMML-improvement-umbrella,85a4c326c5a573245e40d636c951f0824b7870bc,JasmineGeorge,1110984,MDQ6VXNlcjExMTA5ODQ=,https://avatars0.githubusercontent.com/u/1110984?v=4,,https://api.github.com/users/JasmineGeorge,https://github.com/JasmineGeorge,https://api.github.com/users/JasmineGeorge/followers,https://api.github.com/users/JasmineGeorge/following{/other_user},https://api.github.com/users/JasmineGeorge/gists{/gist_id},https://api.github.com/users/JasmineGeorge/starred{/owner}{/repo},https://api.github.com/users/JasmineGeorge/subscriptions,https://api.github.com/users/JasmineGeorge/orgs,https://api.github.com/users/JasmineGeorge/repos,https://api.github.com/users/JasmineGeorge/events{/privacy},https://api.github.com/users/JasmineGeorge/received_events,User,False,38859691,MDEwOlJlcG9zaXRvcnkzODg1OTY5MQ==,spark,JasmineGeorge/spark,False,JasmineGeorge,1110984,MDQ6VXNlcjExMTA5ODQ=,https://avatars0.githubusercontent.com/u/1110984?v=4,,https://api.github.com/users/JasmineGeorge,https://github.com/JasmineGeorge,https://api.github.com/users/JasmineGeorge/followers,https://api.github.com/users/JasmineGeorge/following{/other_user},https://api.github.com/users/JasmineGeorge/gists{/gist_id},https://api.github.com/users/JasmineGeorge/starred{/owner}{/repo},https://api.github.com/users/JasmineGeorge/subscriptions,https://api.github.com/users/JasmineGeorge/orgs,https://api.github.com/users/JasmineGeorge/repos,https://api.github.com/users/JasmineGeorge/events{/privacy},https://api.github.com/users/JasmineGeorge/received_events,User,False,https://github.com/JasmineGeorge/spark,Mirror of Apache Spark,True,https://api.github.com/repos/JasmineGeorge/spark,https://api.github.com/repos/JasmineGeorge/spark/forks,https://api.github.com/repos/JasmineGeorge/spark/keys{/key_id},https://api.github.com/repos/JasmineGeorge/spark/collaborators{/collaborator},https://api.github.com/repos/JasmineGeorge/spark/teams,https://api.github.com/repos/JasmineGeorge/spark/hooks,https://api.github.com/repos/JasmineGeorge/spark/issues/events{/number},https://api.github.com/repos/JasmineGeorge/spark/events,https://api.github.com/repos/JasmineGeorge/spark/assignees{/user},https://api.github.com/repos/JasmineGeorge/spark/branches{/branch},https://api.github.com/repos/JasmineGeorge/spark/tags,https://api.github.com/repos/JasmineGeorge/spark/git/blobs{/sha},https://api.github.com/repos/JasmineGeorge/spark/git/tags{/sha},https://api.github.com/repos/JasmineGeorge/spark/git/refs{/sha},https://api.github.com/repos/JasmineGeorge/spark/git/trees{/sha},https://api.github.com/repos/JasmineGeorge/spark/statuses/{sha},https://api.github.com/repos/JasmineGeorge/spark/languages,https://api.github.com/repos/JasmineGeorge/spark/stargazers,https://api.github.com/repos/JasmineGeorge/spark/contributors,https://api.github.com/repos/JasmineGeorge/spark/subscribers,https://api.github.com/repos/JasmineGeorge/spark/subscription,https://api.github.com/repos/JasmineGeorge/spark/commits{/sha},https://api.github.com/repos/JasmineGeorge/spark/git/commits{/sha},https://api.github.com/repos/JasmineGeorge/spark/comments{/number},https://api.github.com/repos/JasmineGeorge/spark/issues/comments{/number},https://api.github.com/repos/JasmineGeorge/spark/contents/{+path},https://api.github.com/repos/JasmineGeorge/spark/compare/{base}...{head},https://api.github.com/repos/JasmineGeorge/spark/merges,https://api.github.com/repos/JasmineGeorge/spark/{archive_format}{/ref},https://api.github.com/repos/JasmineGeorge/spark/downloads,https://api.github.com/repos/JasmineGeorge/spark/issues{/number},https://api.github.com/repos/JasmineGeorge/spark/pulls{/number},https://api.github.com/repos/JasmineGeorge/spark/milestones{/number},"https://api.github.com/repos/JasmineGeorge/spark/notifications{?since,all,participating}",https://api.github.com/repos/JasmineGeorge/spark/labels{/name},https://api.github.com/repos/JasmineGeorge/spark/releases{/id},https://api.github.com/repos/JasmineGeorge/spark/deployments,2015-07-10T03:48:49Z,2017-10-23T20:54:58Z,2017-10-23T21:36:36Z,git://github.com/JasmineGeorge/spark.git,git@github.com:JasmineGeorge/spark.git,https://github.com/JasmineGeorge/spark.git,https://github.com/JasmineGeorge/spark,,248888,0,0,Scala,False,True,True,False,False,1,,False,False,0,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,1,0,0,master,apache:master,master,5a5b6b78517b526771ee5b579d56aa1daa4b3ef1,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,17165658,MDEwOlJlcG9zaXRvcnkxNzE2NTY1OA==,spark,apache/spark,False,apache,47359,MDEyOk9yZ2FuaXphdGlvbjQ3MzU5,https://avatars0.githubusercontent.com/u/47359?v=4,,https://api.github.com/users/apache,https://github.com/apache,https://api.github.com/users/apache/followers,https://api.github.com/users/apache/following{/other_user},https://api.github.com/users/apache/gists{/gist_id},https://api.github.com/users/apache/starred{/owner}{/repo},https://api.github.com/users/apache/subscriptions,https://api.github.com/users/apache/orgs,https://api.github.com/users/apache/repos,https://api.github.com/users/apache/events{/privacy},https://api.github.com/users/apache/received_events,Organization,False,https://github.com/apache/spark,Apache Spark - A unified analytics engine for large-scale data processing,False,https://api.github.com/repos/apache/spark,https://api.github.com/repos/apache/spark/forks,https://api.github.com/repos/apache/spark/keys{/key_id},https://api.github.com/repos/apache/spark/collaborators{/collaborator},https://api.github.com/repos/apache/spark/teams,https://api.github.com/repos/apache/spark/hooks,https://api.github.com/repos/apache/spark/issues/events{/number},https://api.github.com/repos/apache/spark/events,https://api.github.com/repos/apache/spark/assignees{/user},https://api.github.com/repos/apache/spark/branches{/branch},https://api.github.com/repos/apache/spark/tags,https://api.github.com/repos/apache/spark/git/blobs{/sha},https://api.github.com/repos/apache/spark/git/tags{/sha},https://api.github.com/repos/apache/spark/git/refs{/sha},https://api.github.com/repos/apache/spark/git/trees{/sha},https://api.github.com/repos/apache/spark/statuses/{sha},https://api.github.com/repos/apache/spark/languages,https://api.github.com/repos/apache/spark/stargazers,https://api.github.com/repos/apache/spark/contributors,https://api.github.com/repos/apache/spark/subscribers,https://api.github.com/repos/apache/spark/subscription,https://api.github.com/repos/apache/spark/commits{/sha},https://api.github.com/repos/apache/spark/git/commits{/sha},https://api.github.com/repos/apache/spark/comments{/number},https://api.github.com/repos/apache/spark/issues/comments{/number},https://api.github.com/repos/apache/spark/contents/{+path},https://api.github.com/repos/apache/spark/compare/{base}...{head},https://api.github.com/repos/apache/spark/merges,https://api.github.com/repos/apache/spark/{archive_format}{/ref},https://api.github.com/repos/apache/spark/downloads,https://api.github.com/repos/apache/spark/issues{/number},https://api.github.com/repos/apache/spark/pulls{/number},https://api.github.com/repos/apache/spark/milestones{/number},"https://api.github.com/repos/apache/spark/notifications{?since,all,participating}",https://api.github.com/repos/apache/spark/labels{/name},https://api.github.com/repos/apache/spark/releases{/id},https://api.github.com/repos/apache/spark/deployments,2014-02-25T08:00:08Z,2020-04-10T23:28:57Z,2020-04-10T23:28:41Z,git://github.com/apache/spark.git,git@github.com:apache/spark.git,https://github.com/apache/spark.git,https://github.com/apache/spark,https://spark.apache.org/,327034,25666,25666,Scala,False,True,True,False,False,21476,,False,False,261,apache-2.0,Apache License 2.0,Apache-2.0,https://api.github.com/licenses/apache-2.0,MDc6TGljZW5zZTI=,21476,261,25666,master,https://api.github.com/repos/apache/spark/pulls/7842,https://github.com/apache/spark/pull/7842,https://api.github.com/repos/apache/spark/issues/7842,https://api.github.com/repos/apache/spark/issues/7842/comments,https://api.github.com/repos/apache/spark/pulls/7842/comments,https://api.github.com/repos/apache/spark/pulls/comments{/number},https://api.github.com/repos/apache/spark/pulls/7842/commits,https://api.github.com/repos/apache/spark/statuses/85a4c326c5a573245e40d636c951f0824b7870bc
